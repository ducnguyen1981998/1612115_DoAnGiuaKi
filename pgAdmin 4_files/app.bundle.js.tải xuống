define(["translations","pgadmin.browser.endpoints","pgadmin.browser.utils","pgadmin.user_management.current_user","pgadmin.browser.messages","pgadmin.server.supported_servers"],function(i,n,a,r,l,o){return function(s){function e(e){var t=e[0];var i=e[1];var n=e[2];var a,r,l=0,o=[];for(;l<t.length;l++){r=t[l];if(c[r]){o.push(c[r][0])}c[r]=0}for(a in i){if(Object.prototype.hasOwnProperty.call(i,a)){s[a]=i[a]}}if(p)p(e);while(o.length){o.shift()()}u.push.apply(u,n||[]);return d()}function d(){var e;for(var t=0;t<u.length;t++){var i=u[t];var n=true;for(var a=1;a<i.length;a++){var r=i[a];if(c[r]!==0)n=false}if(n){u.splice(t--,1);e=l(l.s=i[0])}}return e}var i={};var c={2:0,3:0,4:0};var u=[];function l(e){if(i[e]){return i[e].exports}var t=i[e]={i:e,l:false,exports:{}};s[e].call(t.exports,t,t.exports,l);t.l=true;return t.exports}l.m=s;l.c=i;l.d=function(e,t,i){if(!l.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:i})}};l.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};l.t=function(t,e){if(e&1)t=l(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var i=Object.create(null);l.r(i);Object.defineProperty(i,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var n in t)l.d(i,n,function(e){return t[e]}.bind(null,n));return i};l.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};l.d(e,"a",e);return e};l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};l.p="";var t=window["webpackJsonp"]=window["webpackJsonp"]||[];var n=t.push.bind(t);t.push=e;t=t.slice();for(var a=0;a<t.length;a++)e(t[a]);var p=n;u.push([217,1,0]);return d()}([,,function(e,t,i){"use strict";var n,a;!(n=[i(39)],a=function(o){return function e(t,a){var i=o[t]?o[t]:t;var n=/([^%]*)%\(([^\)]+)\)s(.*)/;var r;var l=i;do{r=false;l=l.replace(n,function(e,t,i,n){r=true;return t+a[i]+n})}while(r);return l}}.apply(t,n),a!==undefined&&(e.exports=a))},function(n,a,e){"use strict";(function(e){var t,i;function y(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){y=function e(t){return typeof t}}else{y=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return y(e)}!(t=[],i=function(){var e=window.pgAdmin=window.pgAdmin||{};(function(e,t,c){"use strict";function u(e,t,i,n){i=i||"width";var a,r,l,o=(t.match(h)||[])[2],s="px"===o?1:b[o+"toPx"],d=/r?em/i;if(s||d.test(o)&&!n)e=s?e:"rem"===o?m:"fontSize"===i?e.parentNode||e:e,s=s||parseFloat(p(e,"fontSize")),l=parseFloat(t)*s;else{a=e.style,r=a[i];try{a[i]=t}catch(e){return 0}l=a[i]?parseFloat(p(e,i)):0,a[i]=r!==c?r:null}return l}function p(e,t){var i,n,a,r,l,o=/^top|bottom/,s=["paddingTop","paddingBottom","borderTop","borderBottom"],d=4;n=e.style["pixel"+t.charAt(0).toUpperCase()+t.slice(1)];i=g?g(e)[t]:n?n+"px":"fontSize"===t?u(e,"1em","left",1)+"px":e.currentStyle[t];a=(i.match(h)||[])[2];if("%"===a&&f){if(o.test(t)){for(r=(l=e.parentNode||e).offsetHeight;d--;){r-=parseFloat(p(l,s[d]))}i=parseFloat(i)/100*r+"px"}else i=u(e,i)}else("auto"===i||a&&"px"!==a)&&g?i=0:a&&"px"!==a&&!g&&(i=u(e,i)+"px");return i}var f,i=t.createElement("test"),m=t.documentElement,n=t.defaultView,g=n&&n.getComputedStyle,h=/^(-?[\d+\.\-]+)([a-z]+|%)$/i,b={},a=[1/25.4,1/2.54,1/72,1/6],r=["mm","cm","pt","pc","in","mozmm"],l=6;for(m.appendChild(i),g&&(i.style.marginTop="1%",f="1%"===g(i).marginTop);l--;){b[r[l]+"toPx"]=a[l]?a[l]*b.inToPx:u(i,"1"+r[l])}m.removeChild(i),i=c,e.toPx=u})(e,window.document);e.natural_sort=function(e,t,i){i=i||{};var n=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,a=/(^[ ]*|[ ]*$)/g,r=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,o=/^0/,s=function e(t){return i.insensitive&&(""+t).toLowerCase()||""+t},d=s(e).replace(a,"")||"",c=s(t).replace(a,"")||"",u=d.replace(n,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=c.replace(n,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),f=parseInt(d.match(l))||u.length!==1&&d.match(r)&&Date.parse(d),m=parseInt(c.match(l))||f&&c.match(r)&&Date.parse(c)||null,g,h,b=i.desc?-1:1;if(m)if(f<m)return-1*b;else if(f>m)return 1*b;for(var _=0,v=Math.max(u.length,p.length);_<v;_++){g=!(u[_]||"").match(o)&&parseFloat(u[_])||u[_]||0;h=!(p[_]||"").match(o)&&parseFloat(p[_])||p[_]||0;if(isNaN(g)!==isNaN(h)){return(isNaN(g)?1:-1)*b}else if(y(g)!==y(h)){g+="";h+=""}if(g<h)return-1*b;if(g>h)return 1*b}return 0};return e}.apply(a,t),i!==undefined&&(n.exports=i))}).call(this,e(3))},function(e,t,i){"use strict";var n,a;!(n=[i(40)],a=function(l){return function e(t,a){var i=l[t];var n=/([<])([^:^>]*:)?([^>]+)([>])/g,r=i;if(!i)return i;r=r.replace(n,function(e,t,i,n){if(n in a){return a[n]}return e});return r}}.apply(t,n),a!==undefined&&(e.exports=a))},,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.childCreateMenuEnabled=r;t.isTreeItemOfChildOfSchema=l;t.isTreeNodeOfSchemaChild=o;var a=n(i(5));function n(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}function r(e,t,i){if(i&&i.check===false){return true}var n=a.treeMenu.findNodeByDomElement(t);if(n)return n.anyFamilyMember(function(e){return e.getData()._type==="schema"});return false}function l(e,t){var i=a.treeMenu.findNodeByDomElement(t);if(i)return o(i);return false}function o(e){return e.anyParent(function(e){return e.getData()._type==="schema"})}},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SchemaChildNode=void 0;var n=r(i(26));var a=r(i(11));function r(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}var l=n.extend({parent_type:["schema","catalog"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:a.isTreeItemOfChildOfSchema,canCreate:a.childCreateMenuEnabled},false);t.SchemaChildNode=l},,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.parseShortcutValue=r;t.findAndSetFocus=l;t.getEpoch=c;t.getGCD=u;t.isString=t.isFunction=t.isValidData=void 0;var n=a(i(1));function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t="";if(e.alt){t+="alt+"}if(e.shift){t+="shift+"}if(e.control){t+="ctrl+"}t+=e.key.char.toLowerCase();return t}function l(t){if(t.length==0){return}setTimeout(function(){var e=t.find("button.fa-plus:first");if(e.length==0){e=t.find("\n          .pgadmin-controls:first input:enabled,\n          .pgadmin-controls:first .btn:not(.toggle),\n          .CodeMirror-scroll").find('*[tabindex]:not([tabindex="-1"])')}if(e.length>0){e[0].focus()}else{t[0].focus()}},200)}var o=function e(t){return!n.default.isUndefined(t)&&!n.default.isNull(t)};t.isValidData=o;var s=function e(t){return n.default.isFunction(t)};t.isFunction=s;var d=function e(t){return n.default.isString(t)};t.isString=d;function c(e){var t=e?e:new Date;return parseInt(t.getTime()/1e3)}function u(e){var t=function e(t,i){return t==0?i:e(i%t,t)};var i=e.length;if(i<=2){return t(e[0],e[1])}var n=e[0];for(var a=1;a<i;a++){n=t(e[a],n)}return n}},,,,function(t,i,r){var l,o;
/*
  Backform
  http://github.com/amiliaapp/backform

  Copyright (c) 2014 Amilia Inc.
  Written by Martin Drapeau
  Licensed under the MIT @license
 */
/*
  Backform
  http://github.com/amiliaapp/backform

  Copyright (c) 2014 Amilia Inc.
  Written by Martin Drapeau
  Licensed under the MIT @license
 */
(function(n,a){if(true){!(l=[r(1),r(0),r(9)],o=function(e,t,i){return a(n,e,t,i)}.apply(i,l),o!==undefined&&(t.exports=o))}else{var e}})(this,function(e,d,c,u){Backform=e.Backform={formClassName:"backform form-inline",groupClassName:"form-group row",controlLabelClassName:"col-sm-2 col-form-label",controlContainerClassName:"col-sm-10",controlsClassName:"col-sm-8",controlClassName:"form-control",controlFormInlineClassName:"form-inline",helpClassName:"form-text",errorClassName:"has-error",helpMessageClassName:"form-text text-muted",hiddenClassName:"d-none",requiredInputClassName:undefined,resolveNameToClass:function(e,t){if(d.isString(e)){var i=d.map(e.split("-"),function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join("")+t;var n=Backform[i];if(d.isUndefined(n)){throw new ReferenceError("Class '"+i+"' not found")}return n}return e}};var t=Backform.Form=u.View.extend({fields:undefined,errorModel:undefined,tagName:"form",className:function(){return Backform.formClassName},initialize:function(e){if(!(e.fields instanceof u.Collection))e.fields=new r(e.fields||this.fields);this.fields=e.fields;this.model.errorModel=e.errorModel||this.model.errorModel||new u.Model;this.controls=[]},cleanup:function(){d.each(this.controls,function(e){e.remove()});this.controls.length=0},remove:function(){this.cleanup();u.View.prototype.remove.apply(this,arguments)},render:function(){this.cleanup();this.$el.empty();var e=this,i=this.$el,n=this.model,a=this.controls;this.fields.each(function(e){var t=new(e.get("control"))({field:e,model:n});i.append(t.render().$el);a.push(t)});return this}});var i=Backform.ControlFormatter=function(){};d.extend(i.prototype,{fromRaw:function(e,t){return e},toRaw:function(e,t){return e}});var n=Backform.JSONFormatter=function(){};d.extend(n.prototype,{fromRaw:function(e,t){return JSON.stringify(e)},toRaw:function(e,t){return JSON.parse(e)}});var a=Backform.Field=u.Model.extend({defaults:{name:"",placeholder:"",disabled:false,visible:true,required:false,value:undefined,control:undefined,formatter:undefined},initialize:function(e,t){var i=Backform.resolveNameToClass(this.get("control"),"Control");this.set({control:i},{silent:true})}});var r=Backform.Fields=u.Collection.extend({model:a});var l=Backform.Control=u.View.extend({defaults:{},className:function(){return Backform.groupClassName},events:{"keydown :input":"processTab"},template:d.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <span readonly class="<%=Backform.controlClassName%>" value="<%=value%>">',"</div>"].join("\n")),initialize:function(e){this.field=e.field;var t=Backform.resolveNameToClass(this.field.get("formatter")||this.formatter,"Formatter");if(!d.isFunction(t.fromRaw)&&!d.isFunction(t.toRaw)){t=new t}this.formatter=t;var i=this.field.get("name").split(".");var n=i.shift();this.listenTo(this.model,"change:"+n,this.render);if(this.model.errorModel instanceof u.Model)this.listenTo(this.model.errorModel,"change:"+n,this.updateInvalid)},formatter:i,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find(".uneditable-input").text(),this.model)},onChange:function(e){var t=this.model,i=c(e.target),n=this.field.get("name").split("."),a=n.shift(),r=n.join("."),l=this.getValueFromDOM(),o={};if(this.model.errorModel instanceof u.Model){if(d.isEmpty(r)){this.model.errorModel.unset(a)}else{var s=this.model.errorModel.get(a);if(s){this.keyPathSetter(s,r,null);this.model.errorModel.set(a,s)}}}o[a]=d.isEmpty(r)?l:d.clone(t.get(a))||{};if(!d.isEmpty(r))this.keyPathSetter(o[a],r,l);this.stopListening(this.model,"change:"+a,this.render);t.set(o);this.listenTo(this.model,"change:"+a,this.render)},render:function(){var e=d.defaults(this.field.toJSON(),this.defaults),t=this.model.toJSON(),i=e.name.split("."),n=i.shift(),a=i.join("."),r=this.keyPathAccessor(t[n],a),l=d.extend(e,{rawValue:r,value:this.formatter.fromRaw(r,this.model),attributes:t,formatter:this.formatter}),o=function(e,t){return d.isFunction(e)?!!e(t):!!e};d.extend(l,{disabled:o(l.disabled,this.model),visible:o(l.visible,this.model),required:o(l.required,this.model)});this.$el.removeClass(Backform.hiddenClassName);if(!l.visible)this.$el.addClass(Backform.hiddenClassName);if(Backform.requiredInputClassName){this.$el.removeClass(Backform.requiredInputClassName)}if(l.required){this.$el.addClass(Backform.requiredInputClassName)}this.$el.html(this.template(l)).addClass(e.name);this.updateInvalid();return this},clearInvalid:function(){this.$el.removeClass(Backform.errorClassName).find("."+Backform.helpClassName+".error").remove();return this},updateInvalid:function(){var l=this;var o=this.model.errorModel;if(!(o instanceof u.Model))return this;this.clearInvalid();this.$el.find(":input").not("button").each(function(e,t){var i=c(t).attr("name").split("."),n=i.shift(),a=i.join("."),r=l.keyPathAccessor(o.toJSON(),c(t).attr("name"));if(d.isEmpty(r))return;l.$el.addClass(Backform.errorClassName);if(e===0){l.$el.find("."+Backform.controlsClassName).append('<span class="'+Backform.helpClassName+' error">'+(d.isArray(r)?r.join(", "):r)+"</span>")}});return this},keyPathAccessor:function(e,t){var i=e;t=t.split(".");for(var n=0;n<t.length;n++){if(d.isNull(i))return null;if(d.isEmpty(t[n]))continue;if(!d.isUndefined(i[t[n]]))i=i[t[n]]}return d.isObject(i)&&!d.isArray(i)?null:i},keyPathSetter:function(e,t,i){t=t.split(".");while(t.length>1){if(!e[t[0]])e[t[0]]={};e=e[t.shift()]}return e[t.shift()]=i},processTab:function(t){if(t.which==9){var i=c(t.currentTarget);setTimeout(function(){var e;if(t.shiftKey){e=!!i.prevAll(":input:visible").length?i.prevAll(":input:visible").first():i.closest(".control-group:visible").prev(".control-group:visible").find(":input:visible")}else{e=!!i.nextAll(":input:visible").length?i.nextAll(":input:visible").first():i.closest(".control-group:visible").next(".control-group:visible").find(":input:visible")}if(e.length)e.first().focus()},0)}}});var o=Backform.UneditableInputControl=l;var s=Backform.HelpControl=l.extend({template:d.template(['<label class="<%=Backform.controlLabelClassName%>">&nbsp;</label>','<div class="<%=Backform.controlsClassName%>">','  <span class="<%=Backform.helpMessageClassName%> help-block"><%=label%></span>',"</div>"].join("\n"))});var p=Backform.SpacerControl=l.extend({template:d.template(['<div class="<%=Backform.controlsClassName%>"></div>'].join("\n"))});var f=Backform.TextareaControl=l.extend({defaults:{label:"",maxlength:4e3,extraClasses:[],helpMessage:null},template:d.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <textarea class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:d.extend({},l.prototype.events,{"change textarea":"onChange","focus textarea":"clearInvalid"}),getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("textarea").val(),this.model)}});var m=Backform.SelectControl=l.extend({defaults:{label:"",options:[],extraClasses:[]},template:d.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <select class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value="<%-formatter.fromRaw(option.value)%>" <%=option.value === rawValue ? "selected=\'selected\'" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),events:d.extend({},l.prototype.events,{"change select":"onChange","focus select":"clearInvalid"}),formatter:n,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("select").val(),this.model)}});var g=Backform.MultiSelectControl=m.extend({defaults:{label:"",options:[],extraClasses:[],height:"78px"},template:d.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <select multiple="multiple" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-JSON.stringify(value)%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> style="height:<%=height%>">',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value="<%-option.value%>" <%=value != null && _.indexOf(value, option.value) != -1 ? "selected=\'selected\'" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),events:d.extend({},l.prototype.events,{"change select":"onChange","dblclick select":"onDoubleClick","focus select":"clearInvalid"}),formatter:{fromRaw:function(e,t){return e},toRaw:function(e,t){return typeof e=="object"?e:JSON.parse(e)}},onDoubleClick:function(e){this.model.trigger("doubleclick",e)}});var h=Backform.InputControl=l.extend({defaults:{type:"text",label:"",maxlength:255,extraClasses:[],helpMessage:null},template:d.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <input type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),events:d.extend({},l.prototype.events,{"change input":"onChange","focus input":"clearInvalid"}),getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("input").val(),this.model)}});var b=Backform.BooleanControl=h.extend({defaults:{type:"checkbox",label:"",controlLabel:"&nbsp;",extraClasses:[],id:d.uniqueId("bf_")},template:d.template(['<label class="<%=Backform.controlLabelClassName%>"><%=controlLabel%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <div class="form-check">','    <input type="<%=type%>" class="form-check-input <%=extraClasses.join(\' \')%>" id="<%=id%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','    <label class="form-check-label" for="<%=id%>"><%=label%></label>',"  </div>","</div>"].join("\n")),getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("input").is(":checked"),this.model)}});var _=Backform.CheckboxControl=b;var v=Backform.RadioControl=h.extend({defaults:{type:"radio",label:"",options:[],extraClasses:[],helpMessage:null},template:d.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlContainerClassName%> d-flex">',"  <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <% var id = _.uniqueId("bf_"); %>','  <div class="form-check">','    <input type="<%=type%>" class="<%=extraClasses.join(\' \')%>" id="<%=id%>" name="<%=name%>" value="<%-formatter.fromRaw(option.value)%>" <%=rawValue == option.value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','    <label class="form-check-label" for="<%=id%>"><%-option.label%></label>',"  </div>","  <% } %>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),formatter:n,getValueFromDOM:function(){return this.formatter.toRaw(this.$el.find("input:checked").val(),this.model)},bootstrap2:function(){Backform.radioControlsClassName="controls";Backform.radioLabelClassName="radio inline"}});d.extend(Backform,{radioControlsClassName:"checkbox",radioLabelClassName:"checkbox-inline"});var y=Backform.DatepickerControl=h.extend({defaults:{type:"text",label:"",options:{},extraClasses:[],maxlength:255,helpMessage:null},events:d.extend({},l.prototype.events,{"blur input":"onChange","change input":"onChange","changeDate input":"onChange","focus input":"clearInvalid"}),render:function(){h.prototype.render.apply(this,arguments);this.$el.find("input").datepicker(this.field.get("options"));return this}});var w=Backform.ButtonControl=l.extend({defaults:{type:"submit",label:"Submit",status:undefined,message:undefined,extraClasses:[]},template:d.template(['<label class="<%=Backform.controlLabelClassName%>">&nbsp;</label>','<div class="<%=Backform.controlsClassName%>">','  <button type="<%=type%>" name="<%=name%>" class="btn <%=extraClasses.join(\' \')%>" <%=disabled ? "disabled" : ""%> ><%=label%></button>','  <% var cls = ""; if (status == "error") cls = Backform.buttonStatusErrorClassName; if (status == "success") cls = Backform.buttonStatusSuccessClassname; %>','  <span class="status <%=cls%>"><%=message%></span>',"</div>"].join("\n")),initialize:function(){l.prototype.initialize.apply(this,arguments);this.listenTo(this.field,"change:status",this.render);this.listenTo(this.field,"change:message",this.render)},bootstrap2:function(){Backform.buttonStatusErrorClassName="text-error";Backform.buttonStatusSuccessClassname="text-success"}});d.extend(Backform,{buttonStatusErrorClassName:"text-danger",buttonStatusSuccessClassname:"text-success"});return Backform})},,,,,function(e,i,t){"use strict";(function(l){Object.defineProperty(i,"__esModule",{value:true});i.getTreeNodeHierarchyFromElement=e;i.getTreeNodeHierarchyFromIdentifier=t;i.getTreeNodeHierarchy=n;function e(e,t){return n.call(e,t)}function t(e){var t=this.treeMenu.translateTreeNodeIdFromACITree(e);var i=this.treeMenu.findNode(t);return n.call(this,i)}function n(e){var t=0;var i=0;var n={};do{var a=e.getData();if(a._type in this.Nodes&&this.Nodes[a._type].hasId){var r=o(a._type,i);if(n[r]===undefined){n[r]=l.extend({},a,{priority:t});t-=1}}i+=1;e=e.hasParent()?e.parent():null}while(e);return n}function o(e,t){return e==="partition"&&t>0?"table":e}}).call(this,t(1))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var n=a(i(15));i(50);i(68);i(69);i(51);i(70);i(71);i(72);i(73);i(44);i(74);i(52);i(75);i(76);i(77);i(78);i(34);i(41);function a(e){return e&&e.__esModule?e:{default:e}}var r=n.default;t.default=r},function(e,t,i){"use strict";var n,a;!(n=[i(0),i(2),i(4)],a=function(n,o,s){var d={epicRandomString:function e(t){var i=[];var n="0123456789abcdef";for(var a=0;a<36;a++){i[a]=n.substr(Math.floor(Math.random()*16),1)}i[14]="4";i[19]=n.substr(i[19]&3|8,1);i[8]=i[13]=i[18]=i[23]="-";var r=i.join("");return r.replace(/-/g,"").substr(0,t)},getHash:function e(t){var i=0,n=t.length;for(var a=0;a<n;a++){i=(i<<5)-i+t.charCodeAt(a);i|=0}return i},calculateColumnWidth:function e(t){n("body").append('<span id="pg_text" style="visibility: hidden;">'+t+"</span>");var i=n("#pg_text").width()+23;n("#pg_text").remove();return i},capitalizeFirstLetter:function e(t){return t.charAt(0).toUpperCase()+t.slice(1)},previousStatus:null,fetchConnectionStatus:function e(t,a,r){var i=s("sqleditor.connection_status",{trans_id:t.transId});if(document.visibilityState!=="visible"||a.data("panel-visible")!=="visible"){return}var l=t;n.ajax({url:i,method:"GET"}).done(function(e){if(e&&e.data){var t=e.data.status,i=e.data.message,n=false;l.update_notifications(e.data.notifies);switch(t){case 1:if(t==d.previousStatus&&!r.hasClass("fa-hourglass-half")){r.removeClass().addClass("fa fa-hourglass-half");n=true}break;case 2:if(d.previousStatus!=t&&!r.hasClass("fa-clock-o")){r.removeClass().addClass("fa fa-clock-o");n=true}break;case 3:if(d.previousStatus!=t&&!r.hasClass("fa-exclamation-circle")){r.removeClass().addClass("fa fa-exclamation-circle");n=true}break;case 4:if(d.previousStatus!=t&&!r.hasClass("fa-exclamation-triangle")){r.removeClass().addClass("fa fa-exclamation-triangle");n=true}break;default:if(d.previousStatus!=t&&!r.hasClass("fa-query_tool_connected")){r.removeClass().addClass("fa-custom fa-query-tool-connected");n=true}}d.previousStatus=t;if(n){a.popover("hide");a.attr("data-content",i)}}else{d.previousStatus=-99;i=o("An unexpected error occurred - "+"ensure you are logged into the application.");a.attr("data-content",i);if(!r.hasClass("fa-query-tool-disconnected")){a.popover("hide");r.removeClass().addClass("fa-custom fa-query-tool-disconnected")}}}).fail(function(e){d.previousStatus=-1;var t=o("Transaction status check failed.");if(e.readyState==0){t=o("Not connected to the server or the connection to "+"the server has been closed.")}else if(e.responseJSON&&e.responseJSON.errormsg){t=e.responseJSON.errormsg}a.attr("data-content",t);if(!r.hasClass("fa-query-tool-disconnected")){a.popover("hide");r.removeClass().addClass("fa-custom fa-query-tool-disconnected")}})},updateConnectionStatusFlag:function e(t){var i=n(".connection_status");if(i.data("panel-visible")!=t){i.data("panel-visible",t)}},calcFontSize:function e(t){if(t){var i=Number(Math.round(t+"e+2")+"e-2");if(i>0){return i+"em"}}return"1em"},removeSlashInTheString:function e(t){var i=[];var n=0;while(t&&t.indexOf("/")!==-1){i.push(t.indexOf("/")+n);t=t.replace("/","");n++}return{slashLocations:i.join(","),title:encodeURIComponent(t)}}};return d}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.processEventDebugger=k;t.processEventQueryTool=T;t.getInnerPanel=D;t.validateShortcutKeys=S;t._stopEventPropagation=h;t.isMac=r;t.isKeyCtrlAlt=l;t.isKeyAltShift=o;t.isKeyCtrlShift=s;t.isKeyCtrlAltShift=d;t.isAltShiftBoth=c;t.isCtrlShiftBoth=u;t.isCtrlAltBoth=p;t.shortcut_key=f;t.shortcut_title=m;t.shortcut_accesskey_title=g;var b=a(i(0));var n=a(i(2));function a(e){return e&&e.__esModule?e:{default:e}}var _=190,v=191,y=27,w=37,x=38,C=39,N=40;function r(){return window.navigator.platform.search("Mac")!=-1}function l(e){return e.ctrlKey||e.altKey}function o(e){return e.altKey||e.shiftKey}function s(e){return e.ctrlKey||e.shiftKey}function d(e){return e.ctrlKey||e.altKey||e.shiftKey}function c(e){return e.altKey&&e.shiftKey&&!e.ctrlKey}function u(e){return e.ctrlKey&&e.shiftKey&&!e.altKey}function p(e){return e.ctrlKey&&e.altKey&&!e.shiftKey}function f(e){var t="";if(e["key"]&&e["key"]["char"]){t=e["key"]["char"].toUpperCase()}return t}function m(e,t){var i="";if(typeof t==="undefined"||t===null){return i}if(t["alt"]){i=(0,n.default)("Alt")+"+"}if(t["shift"]){i+=(0,n.default)("Shift")+"+"}if(t["control"]){i+=(0,n.default)("Ctrl")+"+"}i+=f(t);return(0,n.default)("%(title)s (%(text_representation)s)",{title:e,text_representation:i})}function g(e,t){return(0,n.default)("%(title)s (accesskey + %(key)s)",{title:e,key:f(t)})}function h(e){e.cancelBubble=true;e.preventDefault();e.stopPropagation();e.stopImmediatePropagation()}function S(e,t){if(!e){return false}var i=t.which||t.keyCode;return e.alt==t.altKey&&e.shift==t.shiftKey&&e.control==t.ctrlKey&&e.key.key_code==i}function k(e,t,i){var n,a,r;if(this.validateShortcutKeys(i.edit_grid_values,t)){this._stopEventPropagation(t);a=e.find('div.wcPanelTabContent:not(".wcPanelTabContentHidden")');if(a.length){r=(0,b.default)(a).find("td.editable:first");if(r.length)r.trigger("click")}}else if(this.validateShortcutKeys(i.move_next,t)){this._stopEventPropagation(t);n=this.getInnerPanel(e,"right")}else if(this.validateShortcutKeys(i.move_previous,t)){this._stopEventPropagation(t);n=this.getInnerPanel(e,"left")}return n}function D(e,t){if(!e||!e.length)return false;var i=e.find(".wcPanelTab");if(!i.length||i.length==1)return false;var n=(0,b.default)(i).filter(".wcPanelTabActive"),a=parseInt((0,b.default)(n).attr("id")),r=0,l=i.length-1;if(t=="left"){if(a>r)a--}else{if(a<l)a++}return a}function T(e,t,i){if(e.isQueryRunning()){return}var n=i.which||i.keyCode,a;var r=e.preferences.execute_query;var l=e.preferences.explain_query;var o=e.preferences.explain_analyze_query;var s=e.preferences.download_csv;var d=e.preferences.move_next;var c=e.preferences.move_previous;var u=e.preferences.toggle_case;var p=e.preferences.commit_transaction;var f=e.preferences.rollback_transaction;if(this.validateShortcutKeys(r,i)){this._stopEventPropagation(i);t.executeQuery(e)}else if(this.validateShortcutKeys(l,i)){this._stopEventPropagation(i);t.explain(e)}else if(this.validateShortcutKeys(o,i)){this._stopEventPropagation(i);t.explainAnalyze(e)}else if(this.validateShortcutKeys(s,i)){this._stopEventPropagation(i);t.download(e)}else if(this.validateShortcutKeys(u,i)){this._stopEventPropagation(i);t.toggleCaseOfSelectedText(e)}else if(this.validateShortcutKeys(p,i)){if(!e.is_transaction_buttons_disabled){this._stopEventPropagation(i);t.executeCommit(e)}}else if(this.validateShortcutKeys(f,i)){if(!e.is_transaction_buttons_disabled){this._stopEventPropagation(i);t.executeRollback(e)}}else if((this.isMac()&&i.metaKey||!this.isMac()&&i.ctrlKey)&&!i.altKey&&i.shiftKey&&n===v){this._stopEventPropagation(i);t.commentBlockCode(e)}else if((this.isMac()&&!this.isKeyCtrlAltShift(i)&&i.metaKey||!this.isMac()&&!this.isKeyAltShift(i)&&i.ctrlKey)&&n===v){this._stopEventPropagation(i);t.commentLineCode(e)}else if((this.isMac()&&!this.isKeyCtrlAltShift(i)&&i.metaKey||!this.isMac()&&!this.isKeyAltShift(i)&&i.ctrlKey)&&n===_){this._stopEventPropagation(i);t.uncommentLineCode(e)}else if(n==y){t.focusOut(e);if((0,b.default)(i.target).hasClass("dropdown-item")&&(0,b.default)(i.target).closest(".dropdown-submenu").length>0){(0,b.default)(i.target).closest(".dropdown-submenu").find(".dropdown-menu").removeClass("show")}}else if(this.validateShortcutKeys(d,i)){this._stopEventPropagation(i);a=this.getInnerPanel(e.container,"right")}else if(this.validateShortcutKeys(c,i)){this._stopEventPropagation(i);a=this.getInnerPanel(e.container,"left")}else if(n===x||n===N){if((0,b.default)(i.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(i);var m=(0,b.default)(i.target).closest("li");(0,b.default)(i.target).closest(".dropdown-menu").find(".show").removeClass("show");if(n===x){m=m.prev()}else if(n===N){m=m.next()}while(m.hasClass("dropdown-divider")||m.find(".dropdown-item").first().hasClass("disabled")){if(n===x){m=m.prev()}else if(n===N){m=m.next()}}m.find(".dropdown-item").trigger("focus")}}else if(n===w||n===C){if((0,b.default)(i.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(i);var g=(0,b.default)(i.target).closest("li");if(n===C){if(g.hasClass("dropdown-submenu")){g.find(".dropdown-menu").addClass("show");g=g.find(".dropdown-menu .dropdown-item").first().trigger("focus")}}else if(n===w){var h=g.closest(".dropdown-menu");if(h.closest(".dropdown-submenu").length>0){h.removeClass("show");g=h.closest(".dropdown-submenu");g.find(".dropdown-item").trigger("focus")}}}}return a}},,,,function(e,l,o){"use strict";(function(t){var i,n,a;function r(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){r=function e(t){return typeof t}}else{r=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return r(e)}(function(e){if((false?undefined:r(l))=="object"&&(false?undefined:r(t))=="object")e(o(15));else if(true)!(n=[o(15)],i=e,a=typeof i==="function"?i.apply(l,n):i,a!==undefined&&(t.exports=a));else{}})(function(w){"use strict";w.pgadminKeywordRangeFinder=function(e,t,i,n){var a=t.line,r=e.getLine(a);var l=r.length,o,s;for(;l>0;){var d=r.lastIndexOf(i,l);var c=i;var u=n;if(d<t.ch){d=r.lastIndexOf("[",l);if(d<t.ch)break;c="[";u="]"}s=e.getTokenAt(w.Pos(a,d+1)).type;if(!/^(comment|string)/.test(s)){o=d;break}l=d-1}if(o==null||r.lastIndexOf(c)>o)return;var p=1,f=e.lineCount(),m,g;e:for(var h=a+1;h<f;++h){var b=e.getLine(h),_=0;for(;;){var v=b.indexOf(c,_),y=b.indexOf(u,_);if(v<0)v=b.length;if(y<0)y=b.length;_=Math.min(v,y);if(_==b.length)break;if(e.getTokenAt(w.Pos(h,_+1)).type==s){if(_==v)++p;else if(!--p){m=h;g=_;break e}}++_}}if(m==null||m==a+1)return;return{from:w.Pos(a,o+i.length),to:w.Pos(m,g)}};w.pgadminBeginRangeFinder=function(e,t){var i="BEGIN";var n="END;";var a=w.pgadminKeywordRangeFinder(e,t,i,n);return a};w.pgadminIfRangeFinder=function(e,t){var i="IF";var n="END IF";var a=w.pgadminKeywordRangeFinder(e,t,i,n);return a};w.pgadminLoopRangeFinder=function(e,t){var i="LOOP";var n="END LOOP";var a=w.pgadminKeywordRangeFinder(e,t,i,n);return a};w.pgadminCaseRangeFinder=function(e,t){var i="CASE";var n="END CASE";var a=w.pgadminKeywordRangeFinder(e,t,i,n);return a}})}).call(this,o(23)(e))},,,,,function(e,t){e.exports=i},function(e,t){e.exports=n},function(e,t,i){"use strict";var n=a(i(15));function a(e){return e&&e.__esModule?e:{default:e}}n.default.defineExtension("centerOnLine",function(e){var t=this.getScrollInfo().clientHeight;var i=this.charCoords({line:e,ch:0},"local");this.scrollTo(null,(i.top+i.bottom-t)/2)})},function(e,t,i){"use strict";var n=r(i(0));var a=r(i(1));function r(e){return e&&e.__esModule?e:{default:e}}function l(){if(!a.default.isUndefined(window.opener)&&!a.default.isNull(window.opener)){return window.opener.pgAdmin.Browser}else{return window.parent.pgAdmin.Browser}}function o(e,t){var i=e.get_preference("browser","enable_acitree_animation").value;if(a.default.isUndefined(t)){t=e.tree}if(i){t.options({animateRoot:true,unanimated:false,show:a.default.extend(t.options().show,{duration:75}),hide:a.default.extend(t.options().hide,{duration:75}),view:a.default.extend(t.options().view,{duration:75})})}else{t.options({animateRoot:false,unanimated:true,show:a.default.extend(t.options().show,{duration:0}),hide:a.default.extend(t.options().hide,{duration:0}),view:a.default.extend(t.options().view,{duration:0})})}}function s(e){if(a.default.isUndefined(e)||a.default.isNull(e)){e=l()}var t=e.get_preference("browser","enable_alertify_animation").value;if(t){(0,n.default)(document).find("link#alertify-no-animation").attr("disabled","disabled");a.default.each(document.getElementsByTagName("iframe"),function(e){(0,n.default)(e.contentDocument).find("link#alertify-no-animation").attr("disabled","disabled")})}else{(0,n.default)(document).find("link#alertify-no-animation").removeAttr("disabled","disabled");a.default.each(document.getElementsByTagName("iframe"),function(e){(0,n.default)(e.contentDocument).find("link#alertify-no-animation").removeAttr("disabled","disabled")})}}e.exports={modifyAcitreeAnimation:o,modifyAlertifyAnimation:s}},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setPGCSRFToken=a;var o=n(i(0));var s=n(i(9));var d=n(i(24));function n(e){return e&&e.__esModule?e:{default:e}}function a(n,a){if(!a){throw"csrf-token meta tag has not been set"}var r=s.default.sync;s.default.sync=function(e,t,i){i.beforeSend=function(e){e.setRequestHeader(n,a)};return r(e,t,i)};var l=s.default.get;s.default.get=function(e,t,i){i.beforeSend=function(e){e.setRequestHeader(n,a)};return l(e,t,i)};o.default.ajaxSetup({beforeSend:function e(t){t.setRequestHeader(n,a)}});d.default.interceptors.request.use(function(e){e.headers[n]=a;return e},function(e){return Promise.reject(e)})}},function(e,t){e.exports=a},,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isValidTreeNodeData=t.Tree=t.TreeNode=void 0;var n=i(18);function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function l(e,t,i){if(t)a(e.prototype,t);if(i)a(e,i);return e}var s=function(){function a(e,t,i,n){r(this,a);this.id=e;this.data=t;this.setParent(n);this.children=[];this.domNode=i}l(a,[{key:"hasParent",value:function e(){return this.parentNode!==null&&this.parentNode!==undefined}},{key:"parent",value:function e(){return this.parentNode}},{key:"setParent",value:function e(t){this.parentNode=t;this.path=this.id;if(t!==null&&t!==undefined&&t.path!==undefined){this.path=t.path+"."+this.id}}},{key:"getData",value:function e(){if(this.data===undefined){return undefined}else if(this.data===null){return null}return Object.assign({},this.data)}},{key:"getHtmlIdentifier",value:function e(){return this.domNode}},{key:"reload",value:function e(t){var i=this;this.unload(t);t.aciTreeApi.setInode(this.domNode);t.aciTreeApi.deselect(this.domNode);setTimeout(function(){t.selectNode(i.domNode)},0)}},{key:"unload",value:function e(t){this.children=[];t.aciTreeApi.unload(this.domNode)}},{key:"ancestorNode",value:function e(t){var i=this;while(i.hasParent()){i=i.parent();if(t(i)){return i}}return null}},{key:"anyFamilyMember",value:function e(t){if(t(this)){return true}return this.ancestorNode(t)!==null}},{key:"anyParent",value:function e(t){return this.ancestorNode(t)!==null}}]);return a}();t.TreeNode=s;var o=function(){function e(){r(this,e);this.rootNode=new s(undefined,{});this.aciTreeApi=undefined}l(e,[{key:"addNewNode",value:function e(t,i,n,a){var r=this.findNode(a);return this.createOrUpdateNode(t,i,r,n)}},{key:"findNode",value:function e(t){if(t===null||t===undefined||t.length===0){return this.rootNode}return d(this.rootNode,t.join("."))}},{key:"findNodeByDomElement",value:function e(t){var i=this.translateTreeNodeIdFromACITree(t);if(!i||!i[0]){return undefined}return this.findNode(i)}},{key:"selected",value:function e(){return this.aciTreeApi.selected()}},{key:"selectNode",value:function e(t){this.aciTreeApi.select(t)}},{key:"createOrUpdateNode",value:function e(t,i,n,a){var r=[t];if(n!==null&&n!==undefined){r=[n.path,t]}var l=this.findNode(r);if(l!==null){l.data=i;return l}var o=new s(t,i,a,n);if(n===this.rootNode){o.parentNode=null}n.children.push(o);return o}},{key:"register",value:function e(t){t.on("acitree",function(e,t,i,n){if(t.isItem(i)){if(n==="added"){var a=t.getId(i);var r=t.itemData(i);var l=this.translateTreeNodeIdFromACITree(t.parent(i));this.addNewNode(a,r,i,l)}}}.bind(this));this.aciTreeApi=t.aciTree("api")}},{key:"translateTreeNodeIdFromACITree",value:function e(t){var i=t;var n=[];while(i!==null&&i!==undefined&&i.length>0){n.unshift(this.aciTreeApi.getId(i));if(this.aciTreeApi.hasParent(i)){i=this.aciTreeApi.parent(i)}else{break}}return n}}]);return e}();t.Tree=o;function d(e,r){if(r===null){return e}return function e(t){for(var i=0,n=t.children.length;i<n;i++){var a=e(t.children[i]);if(a!==null){return a}}if(t.path===r){return t}else{return null}}(e)}var c=n.isValidData;t.isValidTreeNodeData=c},,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initializeToolbar=p;t.enable=f;var n=l(i(2));var a=l(i(1));var r=l(i(3));function l(e){return e&&e.__esModule?e:{default:e}}var o={};var s=null;var d=[{label:(0,n.default)("Filtered Rows"),btnClass:"fa fa-filter",text:"",toggled:false,toggleClass:"",parentClass:"pg-toolbar-btn",enabled:false},{label:(0,n.default)("View Data"),btnClass:"fa fa-table",text:"",toggled:false,toggleClass:"",parentClass:"pg-toolbar-btn",enabled:false},{label:(0,n.default)("Query Tool"),btnClass:"fa fa-bolt",text:"",toggled:false,toggleClass:"",parentClass:"pg-toolbar-btn",enabled:false}];var c=[];function u(e){if(!(e.label in o)||a.default.findIndex(s._buttonList,{name:e.label})<0){s.addButton(e.label,e.btnClass,e.text,e.label,e.toggled,e.toggleClass,e.parentClass,e.enabled);o[e.label]=e}}function p(e,t){s=e;a.default.each(d,function(e){u(e)});a.default.each(c,function(e){u(e)});e.on(t.EVENT.BUTTON,function(e){if("name"in e&&e.name===(0,n.default)("Query Tool"))r.default.DataGrid.show_query_tool("",r.default.Browser.tree.selected());else if("name"in e&&e.name===(0,n.default)("View Data"))r.default.DataGrid.show_data_grid({mnuid:3},r.default.Browser.tree.selected());else if("name"in e&&e.name===(0,n.default)("Filtered Rows"))r.default.DataGrid.show_filtered_row({mnuid:4},r.default.Browser.tree.selected())})}function f(e,t){if(e in o){s.buttonEnable(e,t)}else{console.warn("Developer warning: No tool button found with label: "+e)}}},function(e,t,i){"use strict";var o=n(i(0));var a=n(i(47));var s=i(18);function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function d(e,t,i){if(t)l(e.prototype,t);if(i)l(e,i);return e}var c=function(){function n(e,t,i){r(this,n);this.dialogContainer=e;this.tabSwitching=false;this.tabs=this.dialogContainer.find(".nav-tabs");if(this.tabs.length>0){this.tabs=this.tabs[0]}this.dialogTabBackward=(0,s.parseShortcutValue)(t);this.dialogTabForward=(0,s.parseShortcutValue)(i);(0,a.default)(this.dialogContainer[0]).bind(this.dialogTabBackward,this.onKeyboardEvent.bind(this));(0,a.default)(this.dialogContainer[0]).bind(this.dialogTabForward,this.onKeyboardEvent.bind(this))}d(n,[{key:"onKeyboardEvent",value:function e(t,i){var n=this.dialogContainer.find(".tab-content:first > .tab-pane.active:first"),a=this.isActivePaneHasChildTabs(n);if(this.tabSwitching){return}this.tabSwitching=true;if(a){var r=this.navigate(i,a.childTab,a.childTabPane);if(!r){this.navigate(i,this.tabs,n)}}else{this.navigate(i,this.tabs,n)}}},{key:"isActivePaneHasChildTabs",value:function e(t){var i=t.find(".nav-tabs:first"),n;if(i.length>0){n=t.find(".tab-content:first > .tab-pane.active:first");return{childTab:i,childTabPane:n}}return null}},{key:"navigate",value:function e(t,i,n){if(t==this.dialogTabBackward){return this.navigateBackward(i,n)}else if(t==this.dialogTabForward){return this.navigateForward(i,n)}return false}},{key:"navigateBackward",value:function e(t,i){var n=this,a,r,l=(0,o.default)(t).find("li").has("a.active").prev("li");if(l.length>0){l.find("a").tab("show");a=i.prev();r=a.find(".tab-content:first > .tab-pane.active:first");if(r.length>0){(0,s.findAndSetFocus)(r)}else{(0,s.findAndSetFocus)(a)}setTimeout(function(){n.tabSwitching=false},200);return true}this.tabSwitching=false;return false}},{key:"navigateForward",value:function e(t,i){var n=this,a,r,l=(0,o.default)(t).find("li").has("a.active").next("li");if(l.length>0){l.find("a").tab("show");a=i.next();r=a.find(".tab-content:first > .tab-pane.active:first");if(r.length>0){(0,s.findAndSetFocus)(r)}else{(0,s.findAndSetFocus)(a)}setTimeout(function(){n.tabSwitching=false},200);return true}this.tabSwitching=false;return false}},{key:"detach",value:function e(){(0,a.default)(this.dialogContainer[0]).unbind(this.dialogTabBackward);(0,a.default)(this.dialogContainer[0]).unbind(this.dialogTabForward)}}]);return n}();e.exports={dialogTabNavigator:c}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getTransId=l;t.removeTransId=o;t.set_last_traversed_dir=s;var n=r(i(4));var a=r(i(0));function r(e){return e&&e.__esModule?e:{default:e}}function l(e){return a.default.ajax({data:e,type:"POST",async:false,url:(0,n.default)("file_manager.get_trans_id"),dataType:"json",contentType:"application/json; charset=utf-8"})}function o(e){return a.default.ajax({type:"GET",async:false,url:(0,n.default)("file_manager.delete_trans_id",{trans_id:e}),dataType:"json",contentType:"application/json; charset=utf-8"})}function s(e,t){return a.default.ajax({url:(0,n.default)("file_manager.save_last_dir",{trans_id:t}),type:"POST",data:JSON.stringify(e),contentType:"application/json"})}},function(e,t,i){"use strict";(function(r){Object.defineProperty(t,"__esModule",{value:true});t.enabled=e;var l=i(49);function o(e){return e._type==="database"&&e.allowConn||e._type!=="database"}function s(e){return e.anyFamilyMember(function(e){return e.getData()._type==="catalog"})}function e(e,t,i,n){if(!(0,l.isValidTreeNodeData)(i))return false;var a=e.findNodeByDomElement(n);if(!a){return false}return o(i)&&r.indexOf(t,i._type)!==-1&&!s(a)}}).call(this,i(1))},,function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(8),i(3),i(5),i(108),i(59),i(10),i(6),i(85),i(16)],a=function(g,e,h,b,p,o,a,_,t,i,v,f,n){if(!_.Nodes["server"]){var r=["prefer","require","verify-ca","verify-full"];_.SecLabelModel=_.Node.Model.extend({defaults:{provider:undefined,label:undefined},schema:[{id:"provider",label:g("Provider"),type:"text",editable:true,cellHeaderClasses:"width_percent_50"},{id:"label",label:g("Security label"),type:"text",editable:true,cellHeaderClasses:"override_label_class_font_size"}],validate:function e(){this.errorModel.clear();if(b.isUndefined(this.get("label"))||b.isNull(this.get("label"))||String(this.get("label")).replace(/^\s+|\s+$/g,"")==""){var t=g("Label must be specified.");this.errorModel.set("label",t);return t}return null}});a.Browser.Nodes["server"]=a.Browser.Node.extend({parent_type:"server_group",type:"server",dialogHelp:e("help.static",{filename:"server_dialog.html"}),label:g("Server"),canDrop:true,hasStatistics:true,hasCollectiveStatistics:true,can_expand:function e(t){return t&&t.connected},Init:function e(){if(this.initialized)return;this.initialized=true;_.add_menus([{name:"create_server_on_sg",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:g("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"create_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:3,label:g("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"connect_server",node:"server",module:this,applies:["object","context"],callback:"connect_server",category:"connect",priority:4,label:g("Connect Server"),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_server",node:"server",module:this,applies:["object","context"],callback:"disconnect_server",category:"drop",priority:5,label:g("Disconnect Server"),icon:"fa fa-chain-broken",enable:"is_connected"},{name:"reload_configuration",node:"server",module:this,applies:["tools","context"],callback:"reload_configuration",category:"reload",priority:6,label:g("Reload Configuration"),icon:"fa fa-repeat",enable:"enable_reload_config"},{name:"restore_point",node:"server",module:this,applies:["tools","context"],callback:"restore_point",category:"restore",priority:9,label:g("Add Named Restore Point..."),icon:"fa fa-anchor",enable:"is_applicable"},{name:"change_password",node:"server",module:this,applies:["object"],callback:"change_password",label:g("Change Password..."),priority:10,icon:"fa fa-lock",enable:"is_connected"},{name:"wal_replay_pause",node:"server",module:this,applies:["tools","context"],callback:"pause_wal_replay",category:"wal_replay_pause",priority:7,label:g("Pause Replay of WAL"),icon:"fa fa-pause-circle",enable:"wal_pause_enabled"},{name:"wal_replay_resume",node:"server",module:this,applies:["tools","context"],callback:"resume_wal_replay",category:"wal_replay_resume",priority:8,label:g("Resume Replay of WAL"),icon:"fa fa-play-circle",enable:"wal_resume_enabled"},{name:"clear_saved_password",node:"server",module:this,applies:["object","context"],callback:"clear_saved_password",label:g("Clear Saved Password"),icon:"fa fa-eraser",priority:11,enable:function e(t){if(t&&t._type==="server"&&t.is_password_saved){return true}return false}},{name:"clear_sshtunnel_password",node:"server",module:this,applies:["object","context"],callback:"clear_sshtunnel_password",label:g("Clear SSH Tunnel Password"),icon:"fa fa-eraser",priority:12,enable:function e(t){if(t&&t._type==="server"&&t.is_tunnel_password_saved){return true}return false}}]);b.bindAll(this,"connection_lost");_.Events.on("pgadmin:server:connection:lost",this.connection_lost)},is_not_connected:function e(t){return t&&t.connected!=true},is_connected:function e(t){return t&&t.connected==true},enable_reload_config:function e(t){if(t&&t._type=="server"&&t.connected&&t.user.is_superuser){return true}return false},is_applicable:function e(t){if(t&&t._type=="server"&&t.connected&&t.user.is_superuser&&t.in_recovery==false){return true}return false},wal_pause_enabled:function e(t){if(t&&t._type=="server"&&t.connected&&t.user.is_superuser&&t.in_recovery==true&&t.wal_pause==false){return true}return false},wal_resume_enabled:function e(t){if(t&&t._type=="server"&&t.connected&&t.user.is_superuser&&t.in_recovery==true&&t.wal_pause==true){return true}return false},callbacks:{connect_server:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;s(n,l,a,r,false);return false},disconnect_server:function e(t,i){var n=t||{},a=this,r=_.tree,l="item"in n?n.item:r.selected(),o=l&&l.length==1?r.itemData(l):undefined;if(!o)return false;i=i||b.isUndefined(i)||b.isNull(i);var s=function e(){h.ajax({url:a.generate_url(l,"connect",o,true),type:"DELETE"}).done(function(e){if(e.success==1){v.success(e.info);o=r.itemData(l);r.removeIcon(l);o.connected=false;o.icon="icon-server-not-connected";r.addIcon(l,{icon:o.icon});a.callbacks.refresh.apply(a,[null,l]);if(_.serverInfo&&o._id in _.serverInfo){delete _.serverInfo[o._id]}_.enable_disable_menus(l);_.Events.trigger("pgadmin:server:disconnect",{item:l,data:o},false)}else{try{v.error(e.errormsg)}catch(e){console.warn(e.stack||e)}r.unload(l)}}).fail(function(e,t,i){v.pgRespErrorNotify(e,i);r.unload(l)})};if(i){v.confirm(g("Disconnect server"),g("Are you sure you want to disconnect the server %(server)s?",{server:o.label}),function(){s()},function(){return true})}else{s()}return false},beforeopen:function e(t,i){if(!i||i._type!="server"){return false}_.tree.addIcon(t,{icon:i.icon});if(!i.connected){s(this,i,_.tree,t,false);return false}return true},added:function e(t,i){_.serverInfo=_.serverInfo||{};_.serverInfo[i._id]=b.extend({},i);a.Browser.Node.callbacks.added.apply(this,arguments);return true},reload_configuration:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;v.confirm(g("Reload server configuration"),o(g("Are you sure you want to reload the server configuration on %s?")).sprintf(l.label).value(),function(){h.ajax({url:n.generate_url(r,"reload",l,true),method:"GET"}).done(function(e){if(e.data.status){v.success(e.data.result)}else{v.error(e.data.result)}}).fail(function(e,t,i){v.pgRespErrorNotify(e,i);a.unload(r)})},function(){return true});return false},restore_point:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;v.prompt(g("Enter the name of the restore point to add"),"",function(e,t){if(!b.isUndefined(t)&&!b.isNull(t)&&t!==""&&String(t).replace(/^\s+|\s+$/g,"")!==""){h.ajax({url:n.generate_url(r,"restore_point",l,true),method:"POST",data:{value:JSON.stringify(t)}}).done(function(e){v.success(e.data.result,10)}).fail(function(e,t,i){v.pgRespErrorNotify(e,i);a.unload(r)})}else{e.cancel=true;v.error(g("Please enter a valid name."),10)}},function(e){e.cancel=false}).set({title:g("Restore point name")})},change_password:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined,o=n.generate_url(r,"change_password",l,true),s=false,d=n.generate_url(r,"check_pgpass",l,true);if(!l)return false;if(!v.changeServerPassword){var c=p.Model.extend({defaults:{user_name:undefined,password:undefined,newPassword:undefined,confirmPassword:undefined},validate:function e(){return null}}),u=[{name:"user_name",label:g("User"),type:"text",disabled:true,control:"input"},{name:"password",label:g("Current Password"),type:"password",disabled:function e(){return s},control:"input",required:true},{name:"newPassword",label:g("New Password"),type:"password",disabled:false,control:"input",required:true},{name:"confirmPassword",label:g("Confirm Password"),type:"password",disabled:false,control:"input",required:true}];v.dialog("changeServerPassword",function e(){return{main:function e(t){var i=g("Change Password ");this.set("title",i);this.user_name=t.user.name},setup:function e(){return{buttons:[{text:g("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button",attrs:{name:"cancel"}},{text:g("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button",attrs:{name:"submit"}}],options:{padding:!1,overflow:!1,modal:false,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false}}},hooks:{onclose:function e(){if(this.view){this.view.remove({data:true,internal:true,silent:true})}}},prepare:function e(){var a=this;this.__internal.buttons[1].element.disabled=true;var t=h("<div class='change_password'></div>"),i=new c({user_name:a.user_name}),n=this.view=new f.Form({el:t,model:i,fields:u});n.render();this.elements.content.appendChild(t.get(0));this.view.model.on("change",function(){var e=this,t=this.get("password"),i=this.get("newPassword"),n=this.get("confirmPassword");if(!s&&(b.isUndefined(t)||b.isNull(t)||t=="")||b.isUndefined(i)||b.isNull(i)||i==""||b.isUndefined(n)||b.isNull(n)||n==""){a.__internal.buttons[1].element.disabled=true}else if(i!=n){a.__internal.buttons[1].element.disabled=true;this.errorTimeout&&clearTimeout(this.errorTimeout);this.errorTimeout=setTimeout(function(){e.errorModel.set("confirmPassword",g("Passwords do not match."))},400)}else{e.errorModel.clear();a.__internal.buttons[1].element.disabled=false}})},callback:function e(t){if(t.button.element.name=="submit"){var i=this,n=this.view.model.toJSON();t.cancel=true;h.ajax({url:o,method:"POST",data:{data:JSON.stringify(n)}}).done(function(e){if(e.success){if(s){v.alert(g("Change Password"),g("Please make sure to disconnect the server"+" and update the new password in the pgpass file"+" before performing any other operation"))}v.success(e.info);i.close()}else{v.error(e.errormsg)}}).fail(function(e,t,i){v.pgRespErrorNotify(e,i)})}}}})}h.ajax({url:d,method:"GET"}).done(function(e){if(e.success&&e.data.is_pgpass){s=true}v.changeServerPassword(l).resizeTo("40%","52%")}).fail(function(e,t,i){v.pgRespErrorNotify(e,i)});return false},pause_wal_replay:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;h.ajax({url:n.generate_url(r,"wal_replay",l,true),type:"DELETE",dataType:"json"}).done(function(e){if(e.success==1){v.success(e.info);a.itemData(r).wal_pause=e.data.wal_pause;a.unload(r);a.setInode(r);a.deselect(r);setTimeout(function(){a.select(r)},10)}}).fail(function(e,t,i){v.pgRespErrorNotify(e,i);a.unload(r)})},resume_wal_replay:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;h.ajax({url:n.generate_url(r,"wal_replay",l,true),type:"PUT",dataType:"json"}).done(function(e){if(e.success==1){v.success(e.info);a.itemData(r).wal_pause=e.data.wal_pause;a.unload(r);a.setInode(r);a.deselect(r);setTimeout(function(){a.select(r)},10)}}).fail(function(e,t,i){v.pgRespErrorNotify(e,i);a.unload(r)})},clear_saved_password:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;v.confirm(g("Clear saved password"),o(g("Are you sure you want to clear the saved password for server %s?")).sprintf(l.label).value(),function(){h.ajax({url:n.generate_url(r,"clear_saved_password",l,true),method:"PUT"}).done(function(e){if(e.success==1){v.success(e.info);a.itemData(r).is_password_saved=e.data.is_password_saved}else{v.error(e.info)}}).fail(function(e,t,i){v.pgRespErrorNotify(e,i)})},function(){return true});return false},clear_sshtunnel_password:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;v.confirm(g("Clear SSH Tunnel password"),o(g("Are you sure you want to clear the saved password of SSH Tunnel for server %s?")).sprintf(l.label).value(),function(){h.ajax({url:n.generate_url(r,"clear_sshtunnel_password",l,true),method:"PUT"}).done(function(e){if(e.success==1){v.success(e.info);a.itemData(r).is_tunnel_password_saved=e.data.is_tunnel_password_saved}else{v.error(e.info)}}).fail(function(e,t,i){v.pgRespErrorNotify(e,i)})},function(){return true});return false}},model:a.Browser.Node.Model.extend({defaults:{gid:undefined,id:undefined,name:"",sslmode:"prefer",host:"",hostaddr:"",port:5432,db:"postgres",username:i.name,role:null,connect_now:true,password:undefined,save_password:false,db_res:"",passfile:undefined,sslcompression:false,sslcert:undefined,sslkey:undefined,sslrootcert:undefined,sslcrl:undefined,service:undefined,use_ssh_tunnel:0,tunnel_host:undefined,tunnel_port:22,tunnel_username:undefined,tunnel_identity_file:undefined,tunnel_password:undefined,tunnel_authentication:0,save_tunnel_password:false,connect_timeout:0},initialize:function e(t,i){var n=b.size(t)===0;if(n){this.set({gid:i.node_info["server_group"]._id})}a.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"id",label:g("ID"),type:"int",mode:["properties"]},{id:"name",label:g("Name"),type:"text",mode:["properties","edit","create"]},{id:"gid",label:g("Server group"),type:"int",control:"node-list-by-id",node:"server_group",mode:["create","edit"],select2:{allowClear:false}},{id:"server_type",label:g("Server type"),type:"options",mode:["properties"],visible:"isConnected",options:t},{id:"connected",label:g("Connected?"),type:"switch",mode:["properties"],group:g("Connection"),options:{onText:g("True"),offText:g("False"),size:"mini"}},{id:"version",label:g("Version"),type:"text",group:null,mode:["properties"],visible:"isConnected"},{id:"bgcolor",label:g("Background"),type:"color",group:null,mode:["edit","create"],disabled:"isfgColorSet",deps:["fgcolor"]},{id:"fgcolor",label:g("Foreground"),type:"color",group:null,mode:["edit","create"],disabled:"isConnected"},{id:"connect_now",controlLabel:g("Connect now?"),type:"checkbox",group:null,mode:["create"]},{id:"comment",label:g("Comments"),type:"multiline",group:null,mode:["properties","edit","create"]},{id:"host",label:g("Host name/address"),type:"text",group:g("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"port",label:g("Port"),type:"int",group:g("Connection"),mode:["properties","edit","create"],disabled:"isConnected",min:1,max:65535},{id:"db",label:g("Maintenance database"),type:"text",group:g("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"username",label:g("Username"),type:"text",group:g("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"password",label:g("Password"),type:"password",group:g("Connection"),control:"input",mode:["create"],deps:["connect_now"],visible:function e(t){return t.get("connect_now")&&t.isNew()}},{id:"save_password",controlLabel:g("Save password?"),type:"checkbox",group:g("Connection"),mode:["create"],deps:["connect_now"],visible:function e(t){return t.get("connect_now")&&t.isNew()},disabled:function e(){if(!i.allow_save_password)return true;return false}},{id:"role",label:g("Role"),type:"text",group:g("Connection"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"sslmode",label:g("SSL mode"),type:"options",group:g("SSL"),mode:["properties","edit","create"],disabled:"isConnected",options:[{label:g("Allow"),value:"allow"},{label:g("Prefer"),value:"prefer"},{label:g("Require"),value:"require"},{label:g("Disable"),value:"disable"},{label:g("Verify-CA"),value:"verify-ca"},{label:g("Verify-Full"),value:"verify-full"}]},{id:"sslcert",label:g("Client certificate"),type:"text",group:g("SSL"),mode:["edit","create"],disabled:"isSSL",control:f.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslkey",label:g("Client certificate key"),type:"text",group:g("SSL"),mode:["edit","create"],disabled:"isSSL",control:f.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslrootcert",label:g("Root certificate"),type:"text",group:g("SSL"),mode:["edit","create"],disabled:"isSSL",control:f.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcrl",label:g("Certificate revocation list"),type:"text",group:g("SSL"),mode:["edit","create"],disabled:"isSSL",control:f.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcompression",label:g("SSL compression?"),type:"switch",mode:["edit","create"],group:g("SSL"),options:{size:"mini"},deps:["sslmode"],disabled:"isSSL"},{id:"sslcert",label:g("Client certificate"),type:"text",group:g("SSL"),mode:["properties"],deps:["sslmode"],visible:function e(t){var i=t.get("sslcert");return!b.isUndefined(i)&&!b.isNull(i)}},{id:"sslkey",label:g("Client certificate key"),type:"text",group:g("SSL"),mode:["properties"],deps:["sslmode"],visible:function e(t){var i=t.get("sslkey");return!b.isUndefined(i)&&!b.isNull(i)}},{id:"sslrootcert",label:g("Root certificate"),type:"text",group:g("SSL"),mode:["properties"],deps:["sslmode"],visible:function e(t){var i=t.get("sslrootcert");return!b.isUndefined(i)&&!b.isNull(i)}},{id:"sslcrl",label:g("Certificate revocation list"),type:"text",group:g("SSL"),mode:["properties"],deps:["sslmode"],visible:function e(t){var i=t.get("sslcrl");return!b.isUndefined(i)&&!b.isNull(i)}},{id:"sslcompression",label:g("SSL compression?"),type:"switch",mode:["properties"],group:g("SSL"),options:{size:"mini"},deps:["sslmode"],visible:function e(t){var i=t.get("sslmode");return b.indexOf(r,i)!=-1}},{id:"use_ssh_tunnel",label:g("Use SSH tunneling"),type:"switch",mode:["properties","edit","create"],group:g("SSH Tunnel"),options:{size:"mini"},disabled:function e(t){if(!a.Browser.utils.support_ssh_tunnel){setTimeout(function(){t.set("use_ssh_tunnel",0)},10);return true}return t.get("connected")}},{id:"tunnel_host",label:g("Tunnel host"),type:"text",group:g("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function e(t){return!t.get("use_ssh_tunnel")}},{id:"tunnel_port",label:g("Tunnel port"),type:"int",group:g("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],max:65535,disabled:function e(t){return!t.get("use_ssh_tunnel")}},{id:"tunnel_username",label:g("Username"),type:"text",group:g("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function e(t){return!t.get("use_ssh_tunnel")}},{id:"tunnel_authentication",label:g("Authentication"),type:"switch",mode:["properties","edit","create"],group:g("SSH Tunnel"),options:{onText:g("Identity file"),offText:g("Password"),size:"mini",width:"90"},deps:["use_ssh_tunnel"],disabled:function e(t){return!t.get("use_ssh_tunnel")}},{id:"tunnel_identity_file",label:g("Identity file"),type:"text",group:g("SSH Tunnel"),mode:["edit","create"],control:f.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["tunnel_authentication","use_ssh_tunnel"],disabled:function e(t){var i=t.get("tunnel_identity_file");if(!t.get("tunnel_authentication")&&i){setTimeout(function(){t.set("tunnel_identity_file",null)},10)}return!t.get("tunnel_authentication")||!t.get("use_ssh_tunnel")}},{id:"tunnel_identity_file",label:g("Identity file"),type:"text",group:g("SSH Tunnel"),mode:["properties"]},{id:"tunnel_password",label:g("Password"),type:"password",group:g("SSH Tunnel"),control:"input",mode:["create"],deps:["use_ssh_tunnel"],disabled:function e(t){return!t.get("use_ssh_tunnel")}},{id:"save_tunnel_password",controlLabel:g("Save password?"),type:"checkbox",group:g("SSH Tunnel"),mode:["create"],deps:["connect_now","use_ssh_tunnel"],visible:function e(t){return t.get("connect_now")&&t.isNew()},disabled:function e(t){if(!i.allow_save_tunnel_password||!t.get("use_ssh_tunnel"))return true;return false}},{id:"hostaddr",label:g("Host address"),type:"text",group:g("Advanced"),mode:["properties","edit","create"],disabled:"isConnected"},{id:"db_res",label:g("DB restriction"),type:"select2",group:g("Advanced"),mode:["properties","edit","create"],disabled:"isConnected",select2:{multiple:true,allowClear:false,tags:true,tokenSeparators:[","],first_empty:false,selectOnClose:true,emptyOptions:true}},{id:"passfile",label:g("Password file"),type:"text",group:g("Advanced"),mode:["edit","create"],disabled:"isConnectedWithValidLib",control:f.FileControl,dialog_type:"select_file",supp_types:["*"]},{id:"passfile",label:g("Password file"),type:"text",group:g("Advanced"),mode:["properties"],visible:function e(t){var i=t.get("passfile");return!b.isUndefined(i)&&!b.isNull(i)}},{id:"service",label:g("Service"),type:"text",mode:["properties","edit","create"],disabled:"isConnected",group:g("Connection")},{id:"connect_timeout",label:g("Connection timeout (seconds)"),type:"int",group:g("Advanced"),mode:["properties","edit","create"],disabled:"isConnected",min:0}],validate:function e(){var t=new n.ModelValidation(this);return t.validate()},isConnected:function e(t){return t.get("connected")},isfgColorSet:function e(t){var i=t.get("bgcolor"),n=t.get("fgcolor");if(t.get("connected")){return true}if(b.isUndefined(i)||b.isNull(i)||!i){if(n){t.set("bgcolor","#ffffff")}}return false},isSSL:function e(t){var i=t.get("sslmode");if(t.get("connected")){return true}return b.indexOf(r,i)==-1},isConnectedWithValidLib:function e(t){if(t.get("connected")){return true}return _.utils.pg_libpq_version<1e5}}),connection_lost:function e(i,n){if(_.tree){var t=_.tree,a=i&&t.itemData(i),r=this;while(a&&a._type!="server"){i=t.parent(i);a=i&&t.itemData(i)}if(i&&a&&a._type=="server"){if(b.isUndefined(a.is_connecting)||!a.is_connecting){a.is_connecting=true;var l=function e(t){if(a._id==t){a.is_connecting=false;_.Events.off("pgadmin:server:connect:cancelled",e);_.Events.trigger("pgadmin:database:connect:cancelled",t,n.data.database||a.db);_.Events.trigger("pgadmin:server:disconnect",{item:i,data:a},false)}};_.Events.on("pgadmin:server:connect:cancelled",l);v.confirm(g("Connection lost"),g("Would you like to reconnect to the database?"),function(){s(r,a,t,i,true)},function(){a.is_connecting=false;t.unload(i);t.setInode(i);t.addIcon(i,{icon:"icon-database-not-connected"});_.Events.trigger("pgadmin:server:connect:cancelled",i,a,r);t.select(i)})}}}}});var s=function d(s,c,u,n,e){var a=e||c.connected,p=function e(t,i,n,a,r,l,o,s){c.connected=false;if(!s){u.setInode(o);u.addIcon(o,{icon:"icon-server-not-connected"})}v.pgNotifier("error",t,n,function(e){setTimeout(function(){if(e=="CRYPTKEY_SET"){d(a,r,l,o,s)}else{v.dlgServerPass(g("Connect to Server"),e,a,r,l,o,s).resizeTo()}},100)})},f=function e(t,i,n,a,r,l){if(t&&t.data){if(typeof t.data.icon=="string"){a.removeIcon(r);n.icon=t.data.icon;a.addIcon(r,{icon:n.icon})}b.extend(n,t.data);n.is_connecting=false;var o=_.serverInfo=_.serverInfo||{};o[n._id]=b.extend({},n);v.success(t.info);s.trigger("connected",s,r,n);_.Events.trigger("pgadmin:server:connected",n._id,r,n);_.Events.trigger("pgadmin:database:connected",n._id,n.db,r,n);if(!l){a.setInode(r);a.deselect(r);setTimeout(function(){a.select(r);a.open(r)},10)}else{setTimeout(function(){i.callbacks.refresh.apply(i,[true])},10)}}};if(!v.dlgServerPass){v.dialog("dlgServerPass",function e(){return{main:function e(t,i,n,a,r,l,o,s,d,c){this.set("title",t);this.message=i;this.tree=r;this.nodeData=a;this.nodeItem=l;this.node=n;this.connected=o;this.onSuccess=s||f;this.onFailure=d||p;this.onCancel=c||m},setup:function e(){return{buttons:[{text:g("Cancel"),className:"btn btn-secondary fa fa-times pg-alertify-button",key:27},{text:g("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],focus:{element:"#password",select:true},options:{modal:0,resizable:false,maximizable:false,pinnable:false}}},build:function e(){},prepare:function e(){this.setContent(this.message)},callback:function e(t){var n=this.tree,a=this.nodeItem,r=this.node,l=this.nodeData,o=this.connected,i=this.onSuccess,s=this.onFailure,d=this.onCancel;if(t.button.text==g("OK")){var c=r.generate_url(a,"connect",l,true);if(!o){n.setLeaf(a);n.removeIcon(a);n.addIcon(a,{icon:"icon-server-connecting"})}h.ajax({type:"POST",timeout:3e4,url:c,data:h("#frmPassword").serialize()}).done(function(e){return i(e,r,l,n,a,o)}).fail(function(e,t,i){return s(e,t,i,r,l,n,a,o)})}else{d&&typeof d=="function"&&d(n,a,l,o)}}}})}var m=function e(t,i,n,a){n.is_connecting=false;t.unload(i);t.setInode(i);t.removeIcon(i);t.addIcon(i,{icon:"icon-server-not-connected"});s.trigger("connect:cancelled",c._id,c.db,s,i,n);_.Events.trigger("pgadmin:server:connect:cancelled",c._id,i,n,s);_.Events.trigger("pgadmin:database:connect:cancelled",c._id,c.db,i,n,s);if(a){t.select(i)}};c.is_connecting=true;var t=s.generate_url(n,"connect",c,true);h.post(t).done(function(e){if(e.success==1){return f(e,s,c,u,n,a)}}).fail(function(e,t,i){return p(e,t,i,s,c,u,n,a)})}}return _.Nodes["server"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t){e.exports=r},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(6),i(13),i(11),i(7),i(16)],a=function(l,e,t,o,i,n,s,a,r,d){if(!s.Nodes["coll-function"]){s.Nodes["coll-function"]=s.Collection.extend({node:"function",label:l("Functions"),type:"coll-function",columns:["name","funcowner","description"],hasStatistics:true,canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})}var c=s.Node.Model.extend({idAttribute:"argid",defaults:{argid:undefined,argtype:undefined,argmode:undefined,argname:undefined,argdefval:undefined},schema:[{id:"argid",visible:false,type:"text",mode:["properties","edit","create"]},{id:"argtype",label:l("Data type"),cell:"node-ajax-options",cellHeaderClasses:"width_percent_30",control:"node-ajax-options",type:"text",url:"get_types",editable:function e(t){var i=this.get("node_info");if(i&&"catalog"in i){return false}return o.isUndefined(t.isNew)?true:t.isNew()},first_empty:true},{id:"argmode",label:l("Mode"),type:"options",control:"node-ajax-options",cellHeaderClasses:"width_percent_20",options:[{label:"IN",value:"IN"},{label:"OUT",value:"OUT"},{label:"INOUT",value:"INOUT"},{label:"VARIADIC",value:"VARIADIC"}],editable:function e(t){var i=this.get("node_info");if(i&&"catalog"in i){return false}return o.isUndefined(t.isNew)?true:t.isNew()}},{id:"argname",label:l("Argument name"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_30"},{id:"argdefval",label:l("Default"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_20"}],toJSON:i.Model.prototype.toJSON,isInCatalog:function e(t){var i=this.get("node_info");if(i&&"catalog"in i){return false}if(!o.isUndefined(t.get("argmode"))&&!o.isUndefined(this.get("name"))&&this.get("name")=="argdefval"&&(t.get("argmode")=="INOUT"||t.get("argmode")=="OUT")){return false}return true},validate:function e(){}});if(!s.Nodes["function"]){s.Nodes["function"]=r.SchemaChildNode.extend({type:"function",sqlAlterHelp:"sql-alterfunction.html",sqlCreateHelp:"sql-createfunction.html",dialogHelp:e("help.static",{filename:"function_dialog.html"}),label:l("Function"),collection_type:"coll-function",hasSQL:true,hasDepends:true,width:s.stdW.md+"px",hasStatistics:function e(t){return t.server.server_type!=="gpdb"},hasScriptTypes:["create","select"],Init:function e(){if(this.initialized)return;this.initialized=true;s.add_menus([{name:"create_function_on_coll",node:"coll-function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:true},enable:"canCreate"},{name:"create_function",node:"function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:true},enable:"canCreate"},{name:"create_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:false},enable:"canCreate"}])},model:s.Node.Model.extend({idAttribute:"oid",initialize:function e(t,i){var n=o.size(t)===0;if(n){var a=i.node_info.schema._id;this.set({pronamespace:a},{silent:true});var r=s.serverInfo[i.node_info.server._id].user;this.set({funcowner:r.name},{silent:true})}s.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:undefined,oid:undefined,xmin:undefined,funcowner:undefined,pronamespace:undefined,description:undefined,pronargs:undefined,proargs:undefined,proargtypenames:undefined,prorettypename:undefined,lanname:"sql",provolatile:undefined,proretset:undefined,proisstrict:undefined,prosecdef:undefined,proiswindow:undefined,proparallel:undefined,procost:undefined,prorows:undefined,proleakproof:undefined,arguments:[],prosrc:undefined,prosrc_c:undefined,probin:"$libdir/",options:[],variables:[],proacl:undefined,seclabels:[],acl:[],sysfunc:undefined,sysproc:undefined},schema:[{id:"name",label:l("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:l("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:l("Owner"),cell:"string",control:a.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:l("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:l("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:l("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:l("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:l("Argument count"),cell:"string",type:"text",group:l("Definition"),mode:["properties"]},{id:"proargs",label:l("Arguments"),cell:"string",type:"text",group:l("Definition"),mode:["properties","edit"],disabled:"isDisabled"},{id:"proargtypenames",label:l("Signature arguments"),cell:"string",type:"text",group:l("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:l("Return type"),cell:"string",control:"node-ajax-options",type:"text",group:l("Definition"),url:"get_types",disabled:"isDisabled",first_empty:true,mode:["create"],visible:"isVisible"},{id:"prorettypename",label:l("Return type"),cell:"string",type:"text",group:l("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:l("Language"),cell:"string",control:"node-ajax-options",type:"text",group:l("Definition"),url:"get_languages",disabled:"isDisabled"},{id:"prosrc",label:l("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:l("Definition"),deps:["lanname"],control:a.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function e(t){if(t.get("lanname")=="c"){return false}return true},disabled:"isDisabled"},{id:"probin",label:l("Object file"),cell:"string",type:"text",group:l("Definition"),deps:["lanname"],visible:function e(t){if(t.get("lanname")=="c"){return true}return false},disabled:"isDisabled"},{id:"prosrc_c",label:l("Link symbol"),cell:"string",type:"text",group:l("Definition"),deps:["lanname"],visible:function e(t){if(t.get("lanname")=="c"){return true}return false},disabled:"isDisabled"},{id:"provolatile",label:l("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:l("Options"),deps:["lanname"],options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:false}},{id:"proretset",label:l("Returns a set?"),type:"switch",disabled:"isDisabled",group:l("Options"),visible:"isVisible"},{id:"proisstrict",label:l("Strict?"),type:"switch",group:l("Options"),disabled:"isDisabled",deps:["lanname"]},{id:"prosecdef",label:l("Security of definer?"),group:l("Options"),type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:l("Window?"),group:l("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"proparallel",label:l("Parallel"),cell:"string",control:"node-ajax-options",type:"text",group:l("Options"),deps:["lanname"],options:[{label:"UNSAFE",value:"u"},{label:"RESTRICTED",value:"r"},{label:"SAFE",value:"s"}],disabled:"isDisabled",min_version:90600,select2:{allowClear:false}},{id:"procost",label:l("Estimated cost"),group:l("Options"),cell:"string",type:"text",disabled:"isDisabled",deps:["lanname"]},{id:"prorows",label:l("Estimated rows"),type:"text",deps:["proretset"],visible:"isVisible",disabled:"isDisabled",group:l("Options")},{id:"proleakproof",label:l("Leak proof?"),group:l("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled",deps:["lanname"]},{id:"proacl",label:l("Privileges"),type:"text",mode:["properties"],group:l("Security")},{id:"arguments",label:l("Arguments"),cell:"string",group:l("Arguments"),type:"collection",canAdd:function e(t){return t.isNew()},canDelete:true,model:c,mode:["create","edit"],columns:["argtype","argmode","argname","argdefval"],disabled:"isDisabled",canDeleteRow:function e(t){return t.isNew()}},{id:"variables",label:"",type:"collection",group:l("Parameters"),control:"variable-collection",model:s.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:false,canDelete:true,disabled:"isDisabled"},s.SecurityGroupSchema,{id:"acl",label:l("Privileges"),editable:false,model:s.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],type:"collection",group:"security",mode:["edit","create"],canAdd:true,canDelete:true,control:"unique-col-collection",disabled:"isDisabled"},{id:"seclabels",label:l("Security labels"),canAdd:true,model:s.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canEdit:false,canDelete:true,uniqueCol:["provider"],disabled:"isDisabled",control:"unique-col-collection",visible:function e(){return this.node&&this.node.type!="procedure"}}],validate:function e(){var t={},i,n=this.get("seclabels");if(o.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t["name"]=l("Name cannot be empty.");i=i||t["name"]}if(o.isUndefined(this.get("funcowner"))||String(this.get("funcowner")).replace(/^\s+|\s+$/g,"")==""){t["funcowner"]=l("Owner cannot be empty.");i=i||t["funcowner"]}if(o.isUndefined(this.get("pronamespace"))||String(this.get("pronamespace")).replace(/^\s+|\s+$/g,"")==""){t["pronamespace"]=l("Schema cannot be empty.");i=i||t["pronamespace"]}if(o.isUndefined(this.get("prorettypename"))||String(this.get("prorettypename")).replace(/^\s+|\s+$/g,"")==""){t["prorettypename"]=l("Return type cannot be empty.");i=i||t["prorettypename"]}if(o.isUndefined(this.get("lanname"))||String(this.get("lanname")).replace(/^\s+|\s+$/g,"")==""){t["lanname"]=l("Language cannot be empty.");i=i||t["lanname"]}if(String(this.get("lanname"))=="c"){if(o.isUndefined(this.get("probin"))||String(this.get("probin")).replace(/^\s+|\s+$/g,"")==""){t["probin"]=l("Object File cannot be empty.");i=i||t["probin"]}if(o.isUndefined(this.get("prosrc_c"))||String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,"")==""){t["prosrc_c"]=l("Link Symbol cannot be empty.");i=i||t["prosrc_c"]}}else{if(o.isUndefined(this.get("prosrc"))||String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")==""){t["prosrc"]=l("Code cannot be empty.");i=i||t["prosrc"]}}if(n){var a;for(var r=0;r<n.models.length&&!a;r++){a=n.models[r].validate.apply(n.models[r]);if(a){t["seclabels"]=a;i=i||a}}}this.errorModel.clear().set(t);if(o.size(t)){this.trigger("on-status",{msg:i});return i}return null},isVisible:function e(){if(this.name=="sysproc"){return false}return true},isDisabled:function e(t){if(this.node_info&&"catalog"in this.node_info){return true}switch(this.name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!t.isNew();case"prorows":if(t.get("proretset")==true){return false}return true;default:return false}},canVarAdd:function e(){if(this.node_info&&"catalog"in this.node_info){return false}return true}})})}return s.Nodes["function"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(7),i(16)],a=function(e,t,i,n,a,r,l){if(!r.Nodes["coll-edbfunc"]){r.Nodes["coll-edbfunc"]=r.Collection.extend({node:"edbfunc",label:e("Functions"),type:"coll-edbfunc",columns:["name","funcowner","description"],canDrop:false,canDropCascade:false})}if(!r.Nodes["edbfunc"]){r.Nodes["edbfunc"]=r.Node.extend({type:"edbfunc",dialogHelp:t("help.static",{filename:"edbfunc_dialog.html"}),label:e("Function"),collection_type:"coll-edbfunc",hasDepends:true,canEdit:false,hasSQL:true,hasScriptTypes:[],parent_type:["package"],Init:function e(){if(this.initialized)return;this.initialized=true},canDrop:false,canDropCascade:false,model:r.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,funcowner:undefined,pronargs:undefined,proargs:undefined,proargtypenames:undefined,prorettypename:undefined,lanname:"sql",prosrc:undefined,proacl:undefined,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:true},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",type:"text",disabled:true},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:true},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:true},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),disabled:true,mode:["properties"],visible:"isVisible"},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:true},{id:"lanname",label:e("Language"),cell:"string",type:"text",group:e("Definition"),disabled:true},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),control:l.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function e(t){if(t.get("lanname")=="c"){return false}return true},disabled:true}],validate:function e(){return null},isVisible:function e(){if(this.name=="sysproc"){return false}return true}})})}return r.Nodes["edbfunc"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(11)],a=function(a,e,t,p,i,f,n,r){if(!f.Nodes["coll-rule"]){i.Browser.Nodes["coll-rule"]=i.Browser.Collection.extend({node:"rule",label:a("Rules"),type:"coll-rule",columns:["name","owner","comment"],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})}if(!f.Nodes["rule"]){i.Browser.Nodes["rule"]=f.Node.extend({parent_type:["table","view","partition"],type:"rule",sqlAlterHelp:"sql-alterrule.html",sqlCreateHelp:"sql-createrule.html",dialogHelp:e("help.static",{filename:"rule_dialog.html"}),label:a("rule"),collection_type:"coll-table",hasSQL:true,hasDepends:true,canDrop:function e(t,i){r.isTreeItemOfChildOfSchema.apply(this,[t,i]);if(p.has(t,"label")&&t.label==="_RETURN")return false;else{return true}},canDropCascade:function e(t,i){r.isTreeItemOfChildOfSchema.apply(this,[t,i]);if(p.has(t,"label")&&t.label==="_RETURN")return false;else{return true}},Init:function e(){if(this.initialized)return;this.initialized=true;f.add_menus([{name:"create_rule_on_coll",node:"coll-rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:a("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:true},enable:"canCreate"},{name:"create_rule_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:a("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:true},enable:"canCreate"},{name:"create_rule",node:"rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:a("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:true},enable:"canCreate"},{name:"create_rule",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:true},enable:"canCreate"},{name:"create_rule",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:true},enable:"canCreate"}])},model:i.Browser.Node.Model.extend({idAttribute:"oid",schema:[{id:"name",label:a("Name"),type:"text",disabled:function e(t){if(t&&t.get("name")=="_RETURN"){return true}if(t.isNew()){return false}else if(t.node_info.server.version>=90400){return false}return true}},{id:"oid",label:a("OID"),type:"text",disabled:true,mode:["properties"]},{id:"schema",label:"",type:"text",visible:false,disabled:function e(t){t.set("schema",t.node_info.schema.label)}},{id:"view",label:"",type:"text",visible:false,disabled:function e(t){t.set("view",this.node_data.label)}},{id:"event",label:a("Event"),control:"select2",group:a("Definition"),type:"text",select2:{width:"100%",allowClear:false},options:[{label:"Select",value:"Select"},{label:"Insert",value:"Insert"},{label:"Update",value:"Update"},{label:"Delete",value:"Delete"}]},{id:"do_instead",label:a("Do instead?"),group:a("Definition"),type:"switch"},{id:"condition",label:a("Condition"),type:"text",group:a("Definition"),control:n.SqlFieldControl},{id:"statements",label:a("Commands"),type:"text",group:a("Definition"),control:n.SqlFieldControl},{id:"system_rule",label:a("System rule?"),type:"switch",mode:["properties"]},{id:"enabled",label:a("Enabled?"),type:"switch",mode:["properties"]},{id:"comment",label:a("Comment"),cell:"string",type:"multiline"}],validate:function e(){var t={},i,n=this.get("name");if(p.isUndefined(n)||p.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")===""){t["name"]=a("Please specify name.");i=i||t["name"];this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}return null}}),canCreate:function e(t,i,n){if(n&&n.check===false)return true;var a=f.tree,r=i,l=t;while(r){if(p.indexOf(["schema"],l._type)>-1)return true;if("coll-rule"==l._type){var o=a.hasParent(r)?a.parent(r):null,s=a.hasParent(o)?a.parent(o):null,d=s?a.itemData(s):null,c=a.hasParent(s)?a.parent(s):null,u=c?a.itemData(c):null;if(u._type=="catalog"){return false}else{return true}}else if("view"==l._type||"table"==l._type){o=a.hasParent(r)?a.parent(r):null;s=a.hasParent(o)?a.parent(o):null;d=s?a.itemData(s):null;if(d._type=="schema"){return true}else{return false}}r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}return true}})}return f.Nodes["coll-rule"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(0),i(1),i(9),i(5),i(6),i(12),i(7)],a=function(d,t,c,i,e,n,a){a.PartitionRow=a.Row.extend({modelDuplicateClass:"bg-model-duplicate",initialize:function e(){a.Row.prototype.initialize.apply(this,arguments);var r=this;r.model.on("change:is_attach",function(){setTimeout(function(){r.columns.each(function(e){if(e.get("name")=="partition_name"){var t=r.columns.indexOf(e),i=e.get("cellFunction"),n=new(i.apply(e,[r.model]))({column:e,model:r.model}),a=r.cells[t];a.remove();r.cells[t]=n;r.render()}})},10)});r.listenTo(r.model,"pgadmin-session:model:duplicate",r.modelDuplicate);r.listenTo(r.model,"pgadmin-session:model:unique",r.modelUnique)},modelDuplicate:function e(){t(this.el).removeClass("new");t(this.el).addClass(this.modelDuplicateClass)},modelUnique:function e(){t(this.el).removeClass(this.modelDuplicateClass)}});var r=function e(t){var i=t.get("is_attach");if(i){var n=[];t.set({partition_name:undefined},{silent:true});c.each(t.top.table_options,function(e){n.push([e.label,e.value])});return a.Extension.Select2Cell.extend({optionValues:n})}else{return a.StringCell}};n.PartitionKeyModel=e.Node.Model.extend({defaults:{key_type:"column",pt_column:undefined,expression:undefined},keys:["pt_column"],schema:[{id:"key_type",label:d("Key type"),type:"select2",editable:true,cell:"select2",cellHeaderClasses:"width_percent_25",select2:{allowClear:false},options:[{label:d("Column"),value:"column"},{label:d("Expression"),value:"expression"}]},{id:"pt_column",label:d("Column"),type:"text",cell:a.Extension.Select2DepCell.extend({keyPathAccessor:function e(t,i){var n=t;if(c.isArray(n)){return c.map(n,function(e){return e["pt_column"]})}i=i.split(".");for(var a=0;a<i.length;a++){if(c.isNull(n))return null;if(c.isEmpty(i[a]))continue;if(!c.isUndefined(n[i[a]]))n=n[i[a]]}return c.isObject(n)&&!c.isArray(n)?null:n},initialize:function e(){var t=this;if(this.model.handler){a.Extension.Select2DepCell.prototype.initialize.apply(this,arguments);if(c.isUndefined(t.model.get("oid"))){var i=t.model.top.get("columns");t.listenTo(i,"remove",t.resetColOptions);t.listenTo(i,"change:name",t.resetColOptions)}t.custom_options()}},resetColOptions:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},custom_options:function e(){var t=this.model.top.get("columns"),i=this.model.top.get("typname"),n=this.model.top.of_types_tables,a=[];if(t.length>0){c.each(t.models,function(e){var t=e.get("name");if(!c.isUndefined(t)&&!c.isNull(t)){a.push({label:t,value:t,image:"icon-column"})}})}else if(!c.isUndefined(i)&&!c.isNull(i)&&!c.isUndefined(n)&&n.length>0){c.each(n,function(e){if(e.label==i){c.each(e.oftype_columns,function(e){a.push({label:e.name,value:e.name,image:"icon-column"})})}})}this.column.set("options",a)},remove:function e(){if(this.model.handler){var t=this,i=t.model.top.get("columns");t.stopListening(i,"remove",t.resetColOptions);t.stopListening(i,"change:name",t.resetColOptions);a.Extension.Select2DepCell.prototype.remove.apply(this,arguments)}}}),deps:["key_type"],cellHeaderClasses:"width_percent_30",transform:function e(t){var i=[];if(t&&c.isArray(t)){c.each(t,function(e){i.push({label:e.label,value:e.label,image:"icon-column"})})}return i},select2:{allowClear:false},editable:function e(t){if(t.get("key_type")=="expression"){setTimeout(function(){t.set("pt_column",undefined)},10);return false}return true}},{id:"expression",label:d("Expression"),type:"text",cell:a.Extension.StringDepCell,cellHeaderClasses:"width_percent_45",deps:["key_type"],editable:function e(t){if(t.get("key_type")=="column"){setTimeout(function(){t.set("expression",undefined)},10);return false}return true}}],validate:function e(){var t=this.get("key_type"),i=this.get("pt_column"),n=this.get("expression"),a;this.errorModel.clear();if(c.isUndefined(t)||c.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){a=d("Partition key type cannot be empty.");this.errorModel.set("key_type",a);return a}else if(t=="column"&&c.isUndefined(i)||c.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){a=d("Partition key column cannot be empty.");this.errorModel.set("pt_column",a);return a}else if(t=="expression"&&c.isUndefined(n)||c.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){a=d("Partition key expression cannot be empty.");this.errorModel.set("expression",a);return a}return null}});n.PartitionsModel=e.Node.Model.extend({idAttribute:"oid",defaults:{oid:undefined,is_attach:false,partition_name:undefined,is_default:undefined,values_from:undefined,values_to:undefined,values_in:undefined,values_modulus:undefined,values_remainder:undefined},keys:["partition_name"],schema:[{id:"oid",label:d("OID"),type:"text"},{id:"is_attach",label:d("Operation"),cell:"switch",type:"switch",options:{onText:d("Attach"),offText:d("Create"),width:65},cellHeaderClasses:"width_percent_5",editable:function e(t){if(t instanceof i.Model&&t.isNew()&&!t.top.isNew())return true;return false}},{id:"partition_name",label:d("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_15",editable:function e(t){if(t instanceof i.Model&&t.isNew())return true;return false},cellFunction:r},{id:"is_default",label:d("Default"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_5",min_version:11e4,options:{onText:d("Yes"),offText:d("No")},editable:function e(t){if(t.handler&&t.handler.top&&t.handler.top.attributes&&(t.handler.top.attributes.partition_type==="range"||t.handler.top.attributes.partition_type==="list")&&t instanceof i.Model&&t.isNew()&&t.handler.top.node_info.server.version>=11e4)return true;return false}},{id:"values_from",label:d("From"),type:"text",cell:a.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function e(t){if(t.handler&&t.handler.top&&t.handler.top.attributes&&t.handler.top.attributes.partition_type==="range"&&t instanceof i.Model&&t.isNew()&&t.get("is_default")!==true)return true;return false}},{id:"values_to",label:d("To"),type:"text",cell:a.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function e(t){if(t.handler&&t.handler.top&&t.handler.top.attributes&&t.handler.top.attributes.partition_type==="range"&&t instanceof i.Model&&t.isNew()&&t.get("is_default")!==true)return true;return false}},{id:"values_in",label:d("In"),type:"text",cell:a.Extension.StringDepCell,deps:["is_default"],cellHeaderClasses:"width_percent_15",editable:function e(t){if(t.handler&&t.handler.top&&t.handler.top.attributes&&t.handler.top.attributes.partition_type==="list"&&t instanceof i.Model&&t.isNew()&&t.get("is_default")!==true)return true;return false}},{id:"values_modulus",label:d("Modulus"),type:"int",cell:a.Extension.StringDepCell,cellHeaderClasses:"width_percent_15",editable:function e(t){if(t.handler&&t.handler.top&&t.handler.top.attributes&&t.handler.top.attributes.partition_type==="hash"&&t instanceof i.Model&&t.isNew())return true;return false}},{id:"values_remainder",label:d("Remainder"),type:"int",cell:a.Extension.StringDepCell,cellHeaderClasses:"width_percent_15 width_percent_20",editable:function e(t){if(t.handler&&t.handler.top&&t.handler.top.attributes&&t.handler.top.attributes.partition_type==="hash"&&t instanceof i.Model&&t.isNew())return true;return false}}],validate:function e(){var t=this.get("partition_name"),i=this.get("is_default"),n=this.get("values_from"),a=this.get("values_to"),r=this.get("values_in"),l=this.get("values_modulus"),o=this.get("values_remainder"),s;this.errorModel.clear();if(c.isUndefined(t)||c.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")===""){s=d("Partition name cannot be empty.");this.errorModel.set("partition_name",s);return s}if(this.top.get("partition_type")==="range"){if(i!==true&&(c.isUndefined(n)||c.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==="")){s=d("For range partition From field cannot be empty.");this.errorModel.set("values_from",s);return s}else if(i!==true&&(c.isUndefined(a)||c.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==="")){s=d("For range partition To field cannot be empty.");this.errorModel.set("values_to",s);return s}}else if(this.top.get("partition_type")==="list"){if(i!==true&&(c.isUndefined(r)||c.isNull(r)||String(r).replace(/^\s+|\s+$/g,"")==="")){s=d("For list partition In field cannot be empty.");this.errorModel.set("values_in",s);return s}}else if(this.top.get("partition_type")==="hash"){if(c.isUndefined(l)||c.isNull(l)||String(l).replace(/^\s+|\s+$/g,"")===""){s=d("For hash partition Modulus field cannot be empty.");this.errorModel.set("values_modulus",s);return s}else if(c.isUndefined(o)||c.isNull(o)||String(o).replace(/^\s+|\s+$/g,"")===""){s=d("For hash partition Remainder field cannot be empty.");this.errorModel.set("values_remainder",s);return s}}return null}})}.apply(t,n),a!==undefined&&(e.exports=a))},,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getHelpUrl=n;function n(e,t,i){var n=Math.floor(i/1e4),a=Math.floor(i/100)-n*100,r="";if(n>=10){r=e.replace("$VERSION$",n)}else{r=e.replace("$VERSION$",n+"."+a)}if(r.substr(-1)!="/"){r=r+"/"}return r+t}},function(e,t,i){"use strict";var o=n(i(1));function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i,n,a,r){var l="";o.default.each(o.default.sortBy(o.default.pick(t,a),function(e){return e.priority}),function(e){l="".concat(l,"/").concat(encodeURI(e._id))});l=r?"".concat(l,"/").concat(r):"".concat(l,"/");return"".concat(e).concat(n,"/").concat(i).concat(l)}e.exports={generate_url:a}},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.browserTreeState=t.pgBrowser=void 0;var f=o(i(1));var n=o(i(0));var a=o(i(4));var r=o(i(2));var l=o(i(3));function o(e){return e&&e.__esModule?e:{default:e}}function c(e){return u(e)||d(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++){i[t]=e[t]}return i}}var m=l.default.Browser=l.default.Browser||{};t.pgBrowser=m;var p=m.browserTreeState=m.browserTreeState||{};t.browserTreeState=p;f.default.extend(m.browserTreeState,{parent:"server",orig_parent:"server_group",stored_state:{},last_state:{},current_state:{},init:function e(){var t=m.get_preference("browser","browser_tree_state_save_interval");if(!f.default.isUndefined(t)&&t.value!==-1){setInterval(this.save_state,t.value*1e3);this.fetch_state.apply(this);m.Events.on("pgadmin:browser:tree:expand-from-previous-tree-state",this.expand_from_previous_state,this);m.Events.on("pgadmin:browser:tree:remove-from-tree-state",this.remove_from_cache,this);m.Events.on("pgadmin:browser:tree:update-tree-state",this.update_cache,this)}else if(!f.default.isUndefined(t)){n.default.ajax({url:(0,a.default)("settings.reset_tree_state"),type:"DELETE"}).fail(function(e){var t=e.responseText;if(e.status==417||e.status==410||e.status==500){try{var i=JSON.parse(e.responseText);t=i.errormsg}catch(e){console.warn(e.stack||e)}}console.warn((0,r.default)('Error resetting the tree saved state."'),t)})}},save_state:function e(){var t=m.browserTreeState;if(t.last_state==JSON.stringify(t.current_state))return;n.default.ajax({url:(0,a.default)("settings.save_tree_state"),type:"POST",contentType:"application/json",data:JSON.stringify(t.current_state)}).done(function(){t.last_state=JSON.stringify(t.current_state)}).fail(function(e){var t=e.responseText;if(e.status==417||e.status==410||e.status==500){try{var i=JSON.parse(e.responseText);t=i.errormsg}catch(e){console.warn(e.stack||e)}}console.warn((0,r.default)('Error saving the tree state."'),t)})},fetch_state:function e(){var t=this;n.default.ajax({url:(0,a.default)("settings.get_tree_state"),type:"GET",dataType:"json",contentType:"application/json"}).done(function(e){t.stored_state=e}).fail(function(e){var t=e.responseText;if(e.status==417||e.status==410||e.status==500){try{var i=JSON.parse(e.responseText);t=i.errormsg}catch(e){console.warn(e.stack||e)}}console.warn((0,r.default)("Error fetching the tree state."),t)})},update_cache:function e(t){var i=t&&m.tree.itemData(t),n=i&&m.Nodes[i._type],a=n.getTreeNodeHierarchy(t),r=undefined,l=m.tree.pathId(t),o=l.join(),s=[],d=-1;if(!m.tree.hasParent(t)||!(this.parent in a))return;r=a[this.parent]["_id"];if(m.tree.isOpen(t)){l.push(i.id);s=l.join();if(!(r in this.current_state)){this.current_state[r]={paths:[],selected:{},conn_status:{},is_opened:{}}}var c=f.default.find(this.current_state[r]["paths"],function(e){return e.search(s)!==-1});if(f.default.isUndefined(c)){if(!f.default.isUndefined(this.current_state[r]["paths"])){d=this.current_state[r]["paths"].indexOf(o)}else{this.current_state[r]["paths"]=[]}if(d!==-1){this.current_state[r]["paths"][d]=s}else{this.current_state[r]["paths"].push(s)}}}this.update_database_status(t);this.update_current_selected_item(a)},remove_from_cache:function e(t){var n=this,i=n.stored_state||{},a=t&&m.tree.itemData(t),r=a&&m.Nodes[a._type],l=r&&r.getTreeNodeHierarchy(t);if(!m.tree.hasParent(t)||!(n.parent in l))return;var o=l&&l[n.parent]["_id"],s=l&&l[n.orig_parent]["id"];this.update_database_status(t);if(a._type==n.parent||a._type=="database"){if(o in i&&"paths"in i[o]){i[o]["paths"]=n.current_state[o]["paths"];n.save_state()}return}if(m.tree.isClosed(t)){var d=n.current_state[o]["paths"],c=undefined;if("database"in l)c=l["database"]["id"];if(!f.default.isUndefined(d)&&!f.default.isUndefined(d.length)){var u=0,p=undefined;f.default.each(d,function(e){if(f.default.isUndefined(e))return;var t=e.split(",");if(t.indexOf(a.id)!==-1){if(c===undefined||c!==undefined&&t.indexOf(c)!==-1){var i=t.indexOf(a.id);t.splice(i);p=t.join();if(p==s)n.current_state[o]["paths"].splice(e,1);else n.current_state[o]["paths"][u]=p}}u++})}}},expand_from_previous_state:function e(a){var r=this,l=r.stored_state||{},o=a&&m.tree.itemData(a),t=o&&m.Nodes[o._type],s=t&&t.getTreeNodeHierarchy(a);if(!m.tree.hasParent(a)||!(r.parent in s))return;if(o["_type"]==r.parent&&m.tree.isOpen(a)===false)return;var i=l[s[r.parent]["_id"]];if(o["_type"]=="database"&&i&&"conn_status"in i&&"is_opened"in i&&(i["conn_status"][o["id"]]===0||i["is_opened"][o["id"]]===0||!(o["id"]in i["is_opened"])))return;if(!f.default.isUndefined(i)&&"paths"in i&&!f.default.isUndefined(i["paths"].length)){var n=c(i["paths"]),d=undefined;if("database"in s)d=s["database"]["id"];f.default.each(n,function(e){if(f.default.isUndefined(e))return;var t=e.split(",");if(t.indexOf(o.id)!==-1){if(d===undefined||d!==undefined&&t.indexOf(d)!==-1){var i=t.indexOf(o.id);m.tree.toggle(a);if(i==t.length-1){var n=l[s[r.parent]["_id"]]["paths"].indexOf(e);l[s[r.parent]["_id"]]["paths"].splice(n,1)}}}})}this.select_tree_item(a)},update_database_status:function e(t){var i=t&&m.tree.itemData(t),n=i&&m.Nodes[i._type],a=n.getTreeNodeHierarchy(t);if("database"in a){var r=a["database"]["id"],l=a&&a[this.parent]["_id"];if(l in this.current_state&&"selected"in this.current_state[l]){if(a["database"].connected){this.current_state[l]["conn_status"][r]=1}else{this.current_state[l]["conn_status"][r]=0}if(i._type=="database"){if(m.tree.isOpen(t)){this.current_state[l]["is_opened"][r]=1}else{this.current_state[l]["is_opened"][r]=0}}}}},update_current_selected_item:function e(t){if(!(this.parent in t))return;var i=t&&t[this.parent]["_id"],n=m.tree.itemData(m.tree.selected()),a=undefined;n=n?n.id:undefined;if("database"in t){a=t["database"]["id"]}if(i in this.current_state&&"selected"in this.current_state[i]&&!f.default.isUndefined(n)){this.current_state[i]["selected"][t[this.parent]["id"]]=n;if(!f.default.isUndefined(a))this.current_state[i]["selected"][a]=n}},select_tree_item:function e(t){var i=this.stored_state||{},n=t&&m.tree.itemData(t),a=n&&m.Nodes[n._type],r=a&&a.getTreeNodeHierarchy(t),l=i[r[this.parent]["_id"]];if("database"in r){var o=r["database"]["id"];if(l&&"selected"in l&&o in l["selected"]){if(l["selected"][o]==n.id){m.tree.select(t)}}}}})},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(10),i(3),i(5),i(12),i(21)],a=function(U,A,q,z,n,B,e,L,R){var f=window.wcDocker;var F=function e(t){var i=t.get("type");if(i.indexOf("[]")!=-1){var n=i.replace("[]","");switch(n){case"boolean":return R.Extension.InputBooleanArrayCell;case"integer":case"smallint":case"bigint":case"serial":case"smallserial":case"bigserial":case"oid":case"cid":case"xid":case"tid":return R.Extension.InputIntegerArrayCell;case"real":case"numeric":case"double precision":case"decimal":return R.Extension.InputNumberArrayCell;default:return R.Extension.InputStringArrayCell}}else{switch(i){case"boolean":return R.BooleanCell.extend({formatter:R.BooleanCellFormatter});case"integer":case"smallint":case"bigint":case"serial":case"smallserial":case"bigserial":case"oid":case"cid":case"xid":case"tid":if(t.get("value")!=undefined){t.set({value:parseInt(t.get("value"))},{silent:true})}return R.IntegerCell;case"real":case"numeric":case"double precision":case"decimal":if(t.get("value")!=undefined){t.set({value:parseFloat(t.get("value"))},{silent:true})}return R.NumberCell;case"string":return R.StringCell;case"date":return R.DateCell;default:return R.Cell}}};var H=function e(t){var i=t.get("type");if(i.indexOf("[]")!=-1){return R.StringCell}return R.BooleanCell};var t=n.Model.extend({defaults:{name:undefined,type:undefined,is_null:undefined,expr:undefined,value:undefined,use_default:undefined,default_value:undefined},validate:function e(){if(z.isUndefined(this.get("value"))||z.isNull(this.get("value"))||String(this.get("value")).replace(/^\s+|\s+$/g,"")==""){var t=U("Please enter a value for the parameter.");this.errorModel.set("value",t);return t}else{this.errorModel.unset("value")}return null}});var $=n.Collection.extend({model:t});var V=function e(t){if(t instanceof n.Model){return t.get("use_default")}return false};var W=function e(t){if(t instanceof n.Model){var i=t.get("type");if(i.indexOf("[]")!=-1){return false}return true}};var i=function e(t,i,n){if(!B.debuggerInputArgsDialog){B.dialog("debuggerInputArgsDialog",function e(){return{main:function e(t,i,n,a){this.preferences=window.top.pgAdmin.Browser.get_preferences_for_module("debugger");this.set("title",t);this.set("debug_info",i);this.set("restart_debug",n);var r=this.func_args_data=[];if(n==0){var l=L.tree,o=l.selected(),s=o&&o.length==1?l.itemData(o):undefined,d=s&&L.Nodes[s._type];if(!s)return;var c=d.getTreeNodeHierarchy.apply(d,[o]),u;if(s._type=="function"){u=A("debugger.get_arguments",{sid:c.server._id,did:c.database._id,scid:c.schema._id,func_id:c.function._id})}else if(s._type=="procedure"){u=A("debugger.get_arguments",{sid:c.server._id,did:c.database._id,scid:c.schema._id,func_id:c.procedure._id})}else if(s._type=="edbfunc"){u=A("debugger.get_arguments",{sid:c.server._id,did:c.database._id,scid:c.schema._id,func_id:c.edbfunc._id})}else if(s._type=="edbproc"){u=A("debugger.get_arguments",{sid:c.server._id,did:c.database._id,scid:c.schema._id,func_id:c.edbproc._id})}}else{u=A("debugger.get_arguments",{sid:i.server_id,did:i.database_id,scid:i.schema_id,func_id:i.function_id})}q.ajax({url:u,method:"GET",async:false}).done(function(e){if(e.data.args_count!=0){for(o=0;o<e.data.result.length;o++){r.push({arg_id:e.data.result[o]["arg_id"],is_null:e.data.result[o]["is_null"],is_expression:e.data.result[o]["is_expression"],use_default:e.data.result[o]["use_default"],value:e.data.result[o]["value"]})}}}).fail(function(){B.alert(U("Debugger Error"),U("Unable to fetch the arguments from server"))});var p,f,m,g,h,b;var _=R.HeaderCell.extend({className:"width_percent_25"});var v=[],y=[{name:"name",label:U("Name"),type:"text",editable:false,cell:"string"},{name:"type",label:U("Type"),type:"text",editable:false,cell:"string"},{name:"is_null",label:U("Null?"),type:"boolean",cell:"boolean"},{name:"expr",label:U("Expression?"),type:"boolean",cellFunction:H,editable:W},{name:"value",label:U("Value"),type:"text",editable:true,cellFunction:F,headerCell:_},{name:"use_default",label:U("Use Default?"),type:"boolean",cell:"boolean",editable:V},{name:"default_value",label:U("Default"),type:"text",editable:false,cell:"string"}];var w=[];var x=[];var C=this.input_arg_id=[],N;if(i["proargmodes"]!=null){var S=i["proargmodes"].split(",");for(N=0;N<S.length;N++){if(S[N]=="i"||S[N]=="b"||a&&S[N]=="o"){C.push(N)}}}else{var k=i["proargtypenames"].split(",");for(N=0;N<k.length;N++){C.push(N)}}f=i["proargtypenames"].split(",");if(i["proargmodes"]!=null){m=i["proargmodes"].split(",")}if(i["pronargdefaults"]){g=i["pronargdefaults"];h=i["proargdefaults"].split(",");b=g}var D,T,j,M,O;if(i["proargnames"]!=null){p=i["proargnames"].split(",");for(O=p.length-1;O>=0;O--){if(i["proargmodes"]!=null){if(m[O]=="i"||m[O]=="b"||a&&m[O]=="o"){if(b){b=b-1;v[O]=h[b]}else{v[O]="<no default>"}}}else if(b){b=b-1;v[O]=h[b]}else{v[O]="<no default>"}}if(f.length!=0){for(o=0;o<f.length;o++){if(i["proargmodes"]!=null){if(m[o]=="i"||m[o]=="b"||a&&m[o]=="o"){M=false;if(v[o]!="<no default>"){M=true}w.push({name:p[o],type:f[o],use_default:M,default_value:v[o]})}}else{M=false;if(v[o]!="<no default>"){M=true}w.push({name:p[o],type:f[o],use_default:M,default_value:v[o]})}}}if(r.length!=0){for(o=0;o<r.length;o++){if(i["proargmodes"]!=null&&m[o]=="o"&&!a){continue}j=r[o]["arg_id"];T=[];if(f[j].indexOf("[]")!=-1){D=r[o]["value"].split(",");z.each(D,function(e){T.push({value:e})})}else{T=r[o]["value"]}x.push({name:p[j],type:f[j],is_null:r[o]["is_null"]?true:false,expr:r[o]["is_expression"]?true:false,value:T,use_default:r[o]["use_default"]?true:false,default_value:v[j]})}}}else{var E=[];for(o=0;o<f.length;o++){E[o]="dbgparam"+(o+1)}if(!i["pronargdefaults"]){for(o=0;o<f.length;o++){w.push({name:E[o],type:f[o],use_default:false,default_value:"<No default value>"});v[o]="<No default value>"}}else{for(O=E.length-1;O>=0;O--){if(i["proargmodes"]==null){if(b){b=b-1;v[O]=h[b]}else{v[O]="<No default value>"}}else{if(b){b=b-1;v[O]=h[b]}else{v[O]="<No default value>"}}}for(o=0;o<f.length;o++){if(i["proargmodes"]==null){M=false;if(v[o]!="<No default value>"){M=true}w.push({name:E[o],type:f[o],use_default:M,default_value:v[o]})}else{if(m[o]=="i"||m[o]=="b"||a&&m[o]=="o"){M=false;if(v[o]!="<No default value>"){M=true}w.push({name:E[o],type:f[o],use_default:M,default_value:v[o]})}}}}if(r.length!=0){for(o=0;o<r.length;o++){j=r[o]["arg_id"];T=[];if(f[j].indexOf("[]")!=-1){D=r[o]["value"].split(",");z.each(D,function(e){T.push({value:e})})}else{T=r[o]["value"]}x.push({name:E[j],type:f[j],is_null:r[o]["is_null"]?true:false,expr:r[o]["is_expression"]?true:false,value:T,use_default:r[o]["use_default"]?true:false,default_value:v[j]})}}}if(r.length==0){this.debuggerInputArgsColl=new $(w)}else{this.debuggerInputArgsColl=new $(x)}if(this.grid){this.grid.remove();this.grid=null}var P=this.grid=new R.Grid({columns:y,collection:this.debuggerInputArgsColl,className:"backgrid table table-bordered table-noouter-border table-bottom-border"});P.render();q(this.elements.content).html(P.el);var I=q(P.el).find("input:checkbox").first();if(I.length){setTimeout(function(){I.trigger("click")},250)}},settings:{debug_info:undefined,restart_debug:undefined},setup:function e(){return{buttons:[{text:U("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:U("Debug"),key:13,className:"btn btn-primary fa fa-bug pg-alertify-button"}],options:{padding:!1,overflow:!1,model:0,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false,modal:false}}},callback:function e(t){if(t.button.text===U("Debug")){var r=this;if(r.setting("restart_debug")==0){var i=L.tree,n=i.selected(),l=n&&n.length==1?i.itemData(n):undefined,a=l&&L.Nodes[l._type];if(!l)return;var o=a.getTreeNodeHierarchy.apply(a,[n])}var s=[];var d=this.sqlite_func_args_list=[];var c=0;this.grid.collection.each(function(e){if(e.get("is_null")){s.push({name:e.get("name"),type:e.get("type"),value:"NULL"})}else{if(e.get("use_default")){s.push({name:e.get("name"),type:e.get("type"),value:e.get("default_value")})}else{s.push({name:e.get("name"),type:e.get("type"),value:e.get("value")})}}if(r.setting("restart_debug")==0){var t;if(l._type=="function"){t=o.function._id}else if(l._type=="procedure"){t=o.procedure._id}else if(l._type=="edbfunc"){t=o.edbfunc._id}else if(l._type=="edbproc"){t=o.edbproc._id}d.push({server_id:o.server._id,database_id:o.database._id,schema_id:o.schema._id,function_id:t,arg_id:r.input_arg_id[c],is_null:e.get("is_null")?1:0,is_expression:e.get("expr")?1:0,use_default:e.get("use_default")?1:0,value:e.get("value")})}else{d.push({server_id:r.setting("debug_info").server_id,database_id:r.setting("debug_info").database_id,schema_id:r.setting("debug_info").schema_id,function_id:r.setting("debug_info").function_id,arg_id:r.input_arg_id[c],is_null:e.get("is_null")?1:0,is_expression:e.get("expr")?1:0,use_default:e.get("use_default")?1:0,value:e.get("value")})}c=c+1});var u;if(r.setting("restart_debug")==0){if(l._type=="function"){u=A("debugger.initialize_target_for_function",{debug_type:"direct",sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.function._id})}else if(l._type=="procedure"){u=A("debugger.initialize_target_for_function",{debug_type:"direct",sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.procedure._id})}else if(l._type=="edbfunc"){u=A("debugger.initialize_target_for_function",{debug_type:"direct",sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.edbfunc._id})}else if(l._type=="edbproc"){u=A("debugger.initialize_target_for_function",{debug_type:"direct",sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.edbproc._id})}q.ajax({url:u,method:"POST",data:{data:JSON.stringify(s)}}).done(function(t){var i=A("debugger.direct",{trans_id:t.data.debuggerTransId});if(r.preferences.debugger_new_browser_tab){window.open(i,"_blank")}else{L.Events.once("pgadmin-browser:frame:urlloaded:frm_debugger",function(e){e.openURL(i)});var e=L.docker.findPanels("properties"),n=L.docker.addPanel("frm_debugger",f.DOCK.STACKED,e[0]);n.focus();n.on(f.EVENT.CLOSED,function(){var e=A("debugger.close",{trans_id:t.data.debuggerTransId});q.ajax({url:e,method:"DELETE"})})}var a;if(l._type=="function"){a=A("debugger.set_arguments",{sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.function._id})}else if(l._type=="procedure"){a=A("debugger.set_arguments",{sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.procedure._id})}else if(l._type=="edbfunc"){a=A("debugger.set_arguments",{sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.edbfunc._id})}else if(l._type=="edbproc"){a=A("debugger.set_arguments",{sid:o.server._id,did:o.database._id,scid:o.schema._id,func_id:o.edbproc._id})}q.ajax({url:a,method:"POST",data:{data:JSON.stringify(d)}}).done(function(){}).fail(function(){B.alert(U("Debugger Error"),U("Unable to set the arguments on the server"))})}).fail(function(e){B.alert(U("Debugger Target Initialization Error"),e.responseJSON.errormsg)})}else{u=A("debugger.start_listener",{trans_id:r.setting("debug_info").trans_id});q.ajax({url:u,method:"POST",data:{data:JSON.stringify(s)}}).done(function(){}).fail(function(e){B.alert(U("Debugger Listener Startup Error"),e.responseJSON.errormsg)});var p=A("debugger.set_arguments",{sid:r.setting("debug_info").server_id,did:r.setting("debug_info").database_id,scid:r.setting("debug_info").schema_id,func_id:r.setting("debug_info").function_id});q.ajax({url:p,method:"POST",data:{data:JSON.stringify(d)}}).done(function(){}).fail(function(){B.alert(U("Debugger Error"),U("Unable to set the arguments on the server"))})}return true}if(t.button.text===U("Cancel")){return false}},build:function e(){B.pgDialogBuild.apply(this)},prepare:function e(){q(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties");if(this.func_args_data.length==0){this.__internal.buttons[1].element.disabled=true}else{this.__internal.buttons[1].element.disabled=false}this.grid.listenTo(this.debuggerInputArgsColl,"backgrid:edited",function(i){return function(){var e=false;for(var t=0;t<this.collection.length;t++){if(this.collection.models[t].get("is_null")){i.__internal.buttons[1].element.disabled=false;e=true;continue}if(this.collection.models[t].get("value")==null||this.collection.models[t].get("value")==undefined){e=true;if(this.collection.models[t].get("use_default")){i.__internal.buttons[1].element.disabled=false}else{i.__internal.buttons[1].element.disabled=true;break}}}if(!e)i.__internal.buttons[1].element.disabled=false}}(this));this.grid.listenTo(this.debuggerInputArgsColl,"backgrid:error",function(e){return function(){e.__internal.buttons[1].element.disabled=true}}(this))}}})}B.debuggerInputArgsDialog(U("Debugger"),t,i,n).resizeTo(L.stdW.md,L.stdH.md)};return i}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";function n(e,t){var i=9;if(!t)return;var n=t.which||t.keyCode;if(n!==i){e.focus()}}function a(e){var t;if(e){if(e.procedure&&e.procedure._id){t=e.procedure._id}else if(e.edbproc&&e.edbproc._id){t=e.edbproc._id}}return t}e.exports={setFocusToDebuggerEditor:n,getProcedureId:a}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ModelValidation=void 0;var n=a(i(2));var r=a(i(1));var l=i(200);function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function d(e,t,i){if(t)s(e.prototype,t);if(i)s(e,i);return e}var c=function(){function a(e){o(this,a);this.err={};this.errmsg="";this.model=e}d(a,[{key:"validate",value:function e(){var t=this.model.get("service");if(!this.model.isNew()&&"id"in this.model.sessAttrs){this.err["id"]=(0,n.default)("The ID cannot be changed.");this.errmsg=this.err["id"]}else{this.model.errorModel.unset("id")}this.checkForEmpty("name",(0,n.default)("Name must be specified."));if(a.isEmptyString(t)){this.setNullValueForEmptyString("service");this.checkHostAndHostAddress();this.checkForEmpty("db",(0,n.default)("Maintenance database must be specified."))}else{this.clearHostAddressAndDbErrors()}this.checkForEmpty("username",(0,n.default)("Username must be specified."));this.checkForEmpty("port",(0,n.default)("Port must be specified."));if(this.model.get("use_ssh_tunnel")){this.checkForEmpty("tunnel_host",(0,n.default)("SSH Tunnel host must be specified."));this.checkForEmpty("tunnel_port",(0,n.default)("SSH Tunnel port must be specified."));this.checkForEmpty("tunnel_username",(0,n.default)("SSH Tunnel username must be specified."));if(this.model.get("tunnel_authentication")){this.checkForEmpty("tunnel_identity_file",(0,n.default)("SSH Tunnel identity file must be specified."))}}this.model.errorModel.set(this.err);if(r.default.size(this.err)){return this.errmsg}return null}},{key:"setNullValueForEmptyString",value:function e(t){var i=this.model.get(t);if(r.default.isUndefined(i)||r.default.isNull(i))return;if(String(i).trim()===""){this.model.set(t,null)}}},{key:"clearHostAddressAndDbErrors",value:function e(){var t=this;r.default.each(["host","hostaddr","db"],function(e){t.setNullValueForEmptyString(e);t.model.errorModel.unset(e)})}},{key:"checkHostAndHostAddress",value:function e(){var t=(0,n.default)("Either Host name, Address or Service must "+"be specified.");if(this.checkForEmpty("host",t)&&this.checkForEmpty("hostaddr",t)){this.errmsg=this.errmsg||t}else{this.errmsg=undefined;delete this.err["host"];delete this.err["hostaddr"]}this.checkForValidIp(this.model.get("hostaddr"),(0,n.default)("Host address must be valid IPv4 or IPv6 address."))}},{key:"checkForValidIp",value:function e(t,i){if(t){var n=new l.Address6(t).isValid();var a=new l.Address4(t).isValid();if(!a&&!n){this.err["hostaddr"]=i;this.errmsg=i}}else{this.model.errorModel.unset("hostaddr")}}},{key:"checkForEmpty",value:function e(t,i){var n=this.model.get(t);if(a.isEmptyString(n)){this.err[t]=i;this.errmsg=this.errmsg||i;return true}else{this.model.errorModel.unset(t);return false}}}],[{key:"isEmptyString",value:function e(t){return r.default.isUndefined(t)||r.default.isNull(t)||String(t).trim()===""}}]);return a}();t.ModelValidation=c},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(10),i(5),i(9),i(19),i(22),i(26),i(59),i(81),i(66)],a=function(m,n,g,h,b,_,a,v,y,i,e,r){if(a.UserManagement){return a.UserManagement}var w=n("user_management.users"),x=n("user_management.roles"),C=function e(t){return new y.Extension.ClientSideFilter({collection:t,placeholder:h("Filter by email"),wait:150})};a.UserManagement={init:function e(){if(this.initialized)return;this.initialized=true;return this},change_password:function e(t){var i=m("Change Password");if(!_.ChangePassword){_.dialog("ChangePassword",function e(){return{main:function e(t,i){this.set({title:t,url:i})},build:function e(){_.pgDialogBuild.apply(this)},settings:{url:undefined},setup:function e(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:m("Change Password"),url:n("help.static",{filename:"change_user_password.html"})}},{text:m("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:false,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false,closable:false}}},hooks:{onclose:function e(){return setTimeout(function(){return _.ChangePassword().destroy()},500)}},prepare:function e(){var t=document.createElement("iframe");t.frameBorder="no";t.width="100%";t.height="100%";t.src=this.setting("url");this.elements.content.appendChild(t)},callback:function e(t){if(t.button.element.name=="dialog_help"){t.cancel=true;a.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);return}}}})}_.ChangePassword(i,t).resizeTo(a.stdW.lg,a.stdH.md)},isPgaLoginRequired:function e(t){if(t.responseJSON===undefined&&t.data!==undefined){return t.status===401&&t.data&&t.data.info&&t.data.info==="PGADMIN_LOGIN_REQUIRED"}return t.status===401&&t.responseJSON&&t.responseJSON.info&&t.responseJSON.info==="PGADMIN_LOGIN_REQUIRED"},pgaLogin:function e(t){var i=m("pgAdmin 4 login");t=t||n("security.login");if(!_.PgaLogin){_.dialog("PgaLogin",function e(){return{main:function e(t,i){this.set({title:t,url:i})},build:function e(){_.pgDialogBuild.apply(this)},settings:{url:undefined},setup:function e(){return{buttons:[{text:m("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{padding:!1,overflow:!1,modal:true,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false,closable:false}}},hooks:{onclose:function e(){return setTimeout(function(){return _.PgaLogin().destroy()})}},prepare:function e(){var t=this,i=document.createElement("iframe"),n=this.setting("url");i.onload=function(){var e=this.contentDocument||this.contentWindow.document;if(e.location.href.indexOf(n)==-1){this.contentWindow.stop();this.onload=null;t.close();a.Events.trigger("pgadmin:user:logged-in")}};i.frameBorder="no";i.width="100%";i.height="100%";i.src=n;t.elements.content.appendChild(i)}}})}_.PgaLogin(i,t).resizeTo(a.stdW.md,a.stdH.md)},show_users:function e(){if(!r["is_admin"])return;var u=[];var p=a.Node.Model.extend({idAttribute:"id",urlRoot:w,defaults:{id:undefined,email:undefined,active:true,role:undefined,newPassword:undefined,confirmPassword:undefined},schema:[{id:"email",label:m("Email"),type:"text",cell:y.Extension.StringDepCell,cellHeaderClasses:"width_percent_30",deps:["id"],editable:function e(t){if(t instanceof v.Collection){return false}if(t.isNew()){return true}return false}},{id:"role",label:m("Role"),type:"text",control:"Select2",cellHeaderClasses:"width_percent_20",cell:"select2",select2:{allowClear:false,openOnEnter:false},options:function t(e){var t=[];if(e instanceof i.Control){h.each(u,function(e){t.push({label:e.name,value:e.id.toString()})})}else{h.each(u,function(e){t.push([e.name,e.id.toString()])})}return t},editable:function e(t){if(t instanceof v.Collection){return true}if(t.get("id")==r["id"]){return false}else{return true}}},{id:"active",label:m("Active"),type:"switch",cell:"switch",cellHeaderClasses:"width_percent_10",editable:function e(t){if(t instanceof v.Collection){return true}if(t.get("id")==r["id"]){return false}else{return true}}},{id:"newPassword",label:m("New password"),type:"password",disabled:false,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"},{id:"confirmPassword",label:m("Confirm password"),type:"password",disabled:false,control:"input",cell:"password",cellHeaderClasses:"width_percent_20"}],validate:function e(){var t=null,i=this.changed||{},n=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;if(("email"in i||!this.isNew())&&(h.isUndefined(this.get("email"))||h.isNull(this.get("email"))||String(this.get("email")).replace(/^\s+|\s+$/g,"")=="")){t=m("Email address cannot be empty.");this.errorModel.set("email",t);return t}else if(!!this.get("email")&&!n.test(this.get("email"))){t=b(m("Invalid email address: %s.")).sprintf(this.get("email")).value();this.errorModel.set("email",t);return t}else if(!!this.get("email")&&this.collection.where({email:this.get("email")}).length>1){t=b(m("The email address %s already exists.")).sprintf(this.get("email")).value();this.errorModel.set("email",t);return t}else{this.errorModel.unset("email")}if("role"in i&&(h.isUndefined(this.get("role"))||h.isNull(this.get("role"))||String(this.get("role")).replace(/^\s+|\s+$/g,"")=="")){t=b(m("Role cannot be empty for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("role",t);return t}else{this.errorModel.unset("role")}if(this.isNew()){if("newPassword"in i&&(h.isUndefined(this.get("newPassword"))||h.isNull(this.get("newPassword"))||this.get("newPassword")=="")){t=b(m("Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("newPassword",t);return t}else if(!h.isUndefined(this.get("newPassword"))&&!h.isNull(this.get("newPassword"))&&this.get("newPassword").length<6){t=b(m("Password must be at least 6 characters for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("newPassword",t);return t}else{this.errorModel.unset("newPassword")}if("confirmPassword"in i&&(h.isUndefined(this.get("confirmPassword"))||h.isNull(this.get("confirmPassword"))||this.get("confirmPassword")=="")){t=b(m("Confirm Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("confirmPassword",t);return t}else{this.errorModel.unset("confirmPassword")}if(!!this.get("newPassword")&&!!this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword")){t=b(m("Passwords do not match for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("confirmPassword",t);return t}else{this.errorModel.unset("confirmPassword")}}else{if((h.isUndefined(this.get("newPassword"))||h.isNull(this.get("newPassword"))||this.get("newPassword")=="")&&(h.isUndefined(this.get("confirmPassword"))||h.isNull(this.get("confirmPassword"))||this.get("confirmPassword")=="")){this.errorModel.unset("newPassword");if(this.get("newPassword")==""){this.set({newPassword:undefined})}this.errorModel.unset("confirmPassword");if(this.get("confirmPassword")==""){this.set({confirmPassword:undefined})}}else if(!h.isUndefined(this.get("newPassword"))&&!h.isNull(this.get("newPassword"))&&!this.get("newPassword")==""&&this.get("newPassword").length<6){t=b(m("Password must be at least 6 characters for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("newPassword",t);return t}else if(h.isUndefined(this.get("confirmPassword"))||h.isNull(this.get("confirmPassword"))||this.get("confirmPassword")==""){t=b(m("Confirm Password cannot be empty for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("confirmPassword",t);return t}else if(!!this.get("newPassword")&&!!this.get("confirmPassword")&&this.get("newPassword")!=this.get("confirmPassword")){t=b(m("Passwords do not match for user %s.")).sprintf(this.get("email")||"").value();this.errorModel.set("confirmPassword",t);return t}else{this.errorModel.unset("newPassword");this.errorModel.unset("confirmPassword")}}return null}}),f=i.generateGridColumnsFromModel(null,p,"edit"),t=y.Extension.DeleteCell.extend({deleteRow:function e(t){var i=this;t.preventDefault();if(i.model.get("id")==r["id"]){_.alert(m("Cannot delete user."),m("Cannot delete currently logged in user."),function(){return true});return true}var n=!h.isUndefined(this.column.get("canDeleteRow"))&&h.isFunction(this.column.get("canDeleteRow"))?y.callByNeed(this.column.get("canDeleteRow"),this.column,this.model):true;if(n){if(i.model.isNew()){i.model.destroy()}else{_.confirm(m("Delete user?"),m("Are you sure you wish to delete this user?"),function(){i.model.destroy({wait:true,success:function e(){_.success(m("User deleted."))},error:function e(){_.error(m("Error during deleting user."))}})},function(){return true})}}else{_.alert(m("Error"),m("This user cannot be deleted."),function(){return true})}}});f.columns.unshift({name:"pg-backform-delete",label:"",cell:t,editable:false,cell_priority:-1,canDeleteRow:true});if(!_.UserManagement){_.dialog("UserManagement",function e(){return{main:function e(t){this.set("title",t)},build:function e(){_.pgDialogBuild.apply(this)},setup:function e(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:m("Users"),url:n("help.static",{filename:"pgadmin_user.html"})}},{text:m("Close"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button user_management_pg-alertify-button",attrs:{name:"close",type:"button"}}],options:{title:m("User Management"),padding:!1,overflow:!1,modal:false,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false,closable:false}}},hooks:{onclose:function e(){if(this.view){this.view.remove({data:true,internal:true,silent:true});this.$content.remove()}}},prepare:function e(){var t=h.template(['<div class="pg-prop-footer" style="visibility:hidden;">',' <div class="pg-prop-status-bar">','    <div class="error-in-footer"> ','      <div class="d-flex px-2 py-1"> ','        <div class="pr-2"> ','          <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i> ',"        </div> ",'        <div class="alert-text"></div> ','        <div class="ml-auto close-error-bar"> ','          <a class="close-error fa fa-times text-danger"></a> ',"        </div> ","      </div> ","    </div> "," </div>","</div>"].join("\n")),a=g(t()),i=y.Row.extend({userInvalidClass:"bg-user-invalid",initialize:function e(){y.Row.prototype.initialize.apply(this,arguments);this.listenTo(this.model,"pgadmin:user:invalid",this.userInvalid);this.listenTo(this.model,"pgadmin:user:valid",this.userValid)},userInvalid:function e(){g(this.el).removeClass("new");g(this.el).addClass(this.userInvalidClass)},userValid:function e(){g(this.el).removeClass(this.userInvalidClass)}}),n=v.Collection.extend({model:p,url:w,initialize:function e(){v.Collection.prototype.initialize.apply(this,arguments);var i=this;i.changedUser=null;i.invalidUsers={};i.on("add",i.onModelAdd);i.on("remove",i.onModelRemove);i.on("pgadmin-session:model:invalid",function(e,t){i.invalidUsers[t.cid]=e;t.trigger("pgadmin:user:invalid",t);a.find(".alert-text").html(e);a.css("visibility","visible")});i.on("pgadmin-session:model:valid",function(e){delete i.invalidUsers[e.cid];e.trigger("pgadmin:user:valid",e);this.updateErrorMsg();this.saveUser(e)})},onModelAdd:function e(t){t.startNewSession()},onModelRemove:function e(t){delete this.invalidUsers[t.cid];this.updateErrorMsg()},updateErrorMsg:function e(){var t=this,i=null;for(var n in t.invalidUsers){i=t.invalidUsers[n];if(i){break}}if(i){a.find(".alert-text").html(i);a.css("visibility","visible")}else{a.find(".alert-text").empty();a.css("visibility","hidden")}},saveUser:function e(n){var t=n.toJSON(true);if(n.isNew()&&(!n.get("email")||!n.get("role")||!n.get("newPassword")||!n.get("confirmPassword")||n.get("newPassword")!=n.get("confirmPassword"))){return false}else if(!n.isNew()&&n.get("newPassword")!=n.get("confirmPassword")){return false}if(n.sessChanged()&&t&&!h.isEmpty(t)){n.stopSession();n.save({},{attrs:t,wait:true,success:function e(){n.set({newPassword:undefined,confirmPassword:undefined});n.startNewSession();_.success(b(m("User '%s' saved.")).sprintf(n.get("email")).value())},error:function e(t,i){n.startNewSession();_.error(b(m("Error saving user: '%s'")).sprintf(i.responseJSON.errormsg).value())}})}}}),s=this.userCollection=new n,r='<div class="navtab-inline-controls">\n                    <div class="input-group">\n                      <div class="input-group-prepend">\n                        <span class="input-group-text fa fa-search" id="labelSearch"></span>\n                        </div>\n                          <input type="search" class="form-control" id="txtGridSearch" placeholder="Search" aria-label="Search" aria-describedby="labelSearch" />\n                        </div>\n                        <button id="btn_refresh" type="button" class="btn btn-secondary btn-navtab-inline add" title="Add">\n                          <span class="fa fa-plus "></span>\n                        </button>\n                      </div>\n                    </div>\n                  </div>',l=h.template(r),o={canAdd:true,add_title:m("Add new user")},d=g("<div></div>",{class:"user_container"});g.ajax({url:x,method:"GET",async:false}).done(function(e){u=e}).fail(function(){setTimeout(function(){_.alert(m("Error"),m("Cannot load user roles."))},100)});var c=this.view=new y.Grid({row:i,columns:f.columns,collection:s,className:"backgrid table table-bordered table-noouter-border table-hover"});d.append(c.render().$el[0]);this.$content=g("<div class='user_management object subnode subnode-noouter-border'></div>").append(l(o)).append(d).append(a);this.elements.content.appendChild(this.$content[0]);C(s).setCustomSearchBox(g("#txtGridSearch"));s.fetch();this.$content.find("a.close-error").on("click",function(){a.find(".alert-text").empty();a.css("visibility","hidden")});this.$content.find("button.add").first().on("click",function(e){e.preventDefault();var t=true;if(t){var i=false,n=null;s.each(function(e){if(!i){i=e.isNew();n=e}});var a;if(i){a=s.indexOf(n);var r=c.body.rows[a].$el;r.addClass("new");g(r).pgMakeVisible("backform-tab");return false}g(c.body.$el.find(g("tr.new"))).removeClass("new");var l=new p(null,{handler:s,top:s,collection:s});s.add(l);a=s.indexOf(l);var o=c.body.rows[a].$el;o.addClass("new");g(o).pgMakeVisible("backform-tab");return false}})},callback:function e(t){if(t.button.element.name=="dialog_help"){t.cancel=true;a.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);return}if(t.button.element.name=="close"){var i=this;if(!h.all(this.userCollection.pluck("id"))||!h.isEmpty(this.userCollection.invalidUsers)){t.cancel=true;_.confirm(m("Discard unsaved changes?"),m("Are you sure you want to close the dialog? Any unsaved changes will be lost."),function(){i.close();return true},function(){return true})}}}}})}_.UserManagement(true).resizeTo(a.stdW.md,a.stdH.md)}};return a.UserManagement}.apply(t,n),a!==undefined&&(e.exports=a))},,,,,,,,function(e,t,i){"use strict";var n,a;!(n=[i(0),i(1),i(8)],a=function(e,r,l){var t=function e(t,i){if(r.isUndefined(i)||r.isNull(i)){return true}if(l.startsWith(i,"coll-")){i=i.replace("coll-","")}var n=["server_group","server","catalog_object_column"];if(r.indexOf(n,i)>=0){return true}var a=t.get_preference("browser","show_node_"+i);if(a){return a.value}else{return true}};return t}.apply(t,n),a!==undefined&&(e.exports=a))},,function(e,i,n){"use strict";(function(l){Object.defineProperty(i,"__esModule",{value:true});i.pgBrowser=void 0;var a=t(n(3));var r=t(n(4));var o=t(n(0));var s=e(n(10));var d=e(n(29));function e(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}function t(e){return e&&e.__esModule?e:{default:e}}var c=n(42);var u=a.default.Browser=a.default.Browser||{};i.pgBrowser=u;l.extend(u,{preferences_cache:[],prefcache_version:0,generate_preference_version:function e(){return(new Date).getTime()},preference_version:function e(t){if(t){this.prefcache_version=t}else{return this.prefcache_version}},get_preference:function e(t,i){var n=this;if(l.size(n.preferences_cache)==0){var a=function e(){if(n.preferences_cache.length>0){clearInterval(r);return l.findWhere(n.preferences_cache,{module:t,name:i})}},r=setInterval(a,1e3)}else{return l.findWhere(n.preferences_cache,{module:t,name:i})}},get_preferences_for_module:function e(t){var i=this;var n={};l.each(l.where(i.preferences_cache,{module:t}),function(e){n[e.name]=e.value});if(Object.keys(n).length>0){return n}},get_preference_for_id:function e(t){var i=this;return l.findWhere(i.preferences_cache,{id:t})},cache_preferences:function e(t){var i=this,n={};n[a.default.csrf_token_header]=a.default.csrf_token;setTimeout(function(){o.default.ajax({url:(0,r.default)("preferences.get_all"),headers:n}).done(function(e){i.preferences_cache=e;i.preference_version(i.generate_preference_version());u.keyboardNavigation.init();if(u.tree){c.modifyAcitreeAnimation(i);c.modifyAlertifyAnimation(i)}u.browserTreeState.init();if(t){if(typeof t==="string"){o.default.event.trigger("prefchange:"+t)}else{l.each(t,function(e,t){o.default.event.trigger("prefchange:"+t)})}}}).fail(function(e,t,i){s.pgRespErrorNotify(e,i)})},500)},reflectPreferences:function e(t){var i=this;if(t==="sqleditor"||t===null||typeof t==="undefined"){var n=i.get_preferences_for_module("sqleditor");(0,o.default)(i.editor.getWrapperElement()).css("font-size",d.calcFontSize(n.sql_font_size));i.editor.setOption("tabSize",n.tab_size);i.editor.setOption("lineWrapping",n.wrap_code);i.editor.setOption("autoCloseBrackets",n.insert_pair_brackets);i.editor.setOption("matchBrackets",n.brace_matching);i.editor.refresh()}},onPreferencesChange:function e(t,i){window.parent.$(parent.document).on("prefchange:"+t,function(e){if(window.top===null){window.$(document).off(e)}else{i(e)}})}})}).call(this,n(1))},function(e,t){e.exports=l},function(e,c,u){"use strict";(function(a){Object.defineProperty(c,"__esModule",{value:true});c.pgBrowser=void 0;var e=i(u(3));var r=i(u(4));var l=i(u(0));var n=t(u(10));var o=i(u(2));u(21);function t(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}function i(e){return e&&e.__esModule?e:{default:e}}var s=e.default.Browser=e.default.Browser||{};c.pgBrowser=s;var d=window.wcDocker;a.extend(s,{lock_layout_levels:{PREVENT_DOCKING:"docking",FULL:"full",NONE:"none"},buildDefaultLayout:function e(t){var i=t.addPanel("browser",d.DOCK.LEFT);var n=t.addPanel("dashboard",d.DOCK.RIGHT,i);t.addPanel("properties",d.DOCK.STACKED,n,{tabOrientation:d.TAB.TOP});t.addPanel("sql",d.DOCK.STACKED,n);t.addPanel("statistics",d.DOCK.STACKED,n);t.addPanel("dependencies",d.DOCK.STACKED,n);t.addPanel("dependents",d.DOCK.STACKED,n)},save_current_layout:function e(t,i){if(i){var n=i.save(),a={setting:t,value:n};l.default.ajax({type:"POST",url:(0,r.default)("settings.store_bulk"),data:a})}},restore_layout:function e(t,i,n){if(i!=""){try{t.restore(i)}catch(e){t.clear();if(n){n(t)}}}else{if(n){n(t)}}var a=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;var r=setInterval(function(){var e=a.get_preferences_for_module("browser");if(e){clearInterval(r);a.reflectLocklayoutChange(t);a.onPreferencesChange("browser",function(){a.reflectLocklayoutChange(t)})}},500)},reflectLocklayoutChange:function e(t){var i=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;var n=i.get_preferences_for_module("browser");i.lock_layout(t,n.lock_layout)},lock_layout:function e(t,i){var n=this.menus["file"]["mnu_locklayout"]["menu_items"];switch(i){case this.lock_layout_levels.PREVENT_DOCKING:t.lockLayout(d.LOCK_LAYOUT_LEVEL.PREVENT_DOCKING);break;case this.lock_layout_levels.FULL:t.lockLayout(d.LOCK_LAYOUT_LEVEL.FULL);break;case this.lock_layout_levels.NONE:t.lockLayout(d.LOCK_LAYOUT_LEVEL.NONE);break}a.each(n,function(e){if(e.name!="mnu_lock_"+i){e.change_checked(false)}else{e.change_checked(true)}})},save_lock_layout:function e(t){var i=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;l.default.ajax({url:(0,r.default)("browser.lock_layout"),method:"PUT",contentType:"application/json",data:JSON.stringify({value:t})}).done(function(){i.cache_preferences("browser")}).fail(function(e,t){n.pgNotifier(t,e,(0,o.default)("Failed to save the lock layout setting."))})},mnu_lock_docking:function e(){this.lock_layout(this.docker,this.lock_layout_levels.PREVENT_DOCKING);this.save_lock_layout(this.lock_layout_levels.PREVENT_DOCKING)},mnu_lock_full:function e(){this.lock_layout(this.docker,this.lock_layout_levels.FULL);this.save_lock_layout(this.lock_layout_levels.FULL)},mnu_lock_none:function e(){this.lock_layout(this.docker,this.lock_layout_levels.NONE);this.save_lock_layout(this.lock_layout_levels.NONE)}})}).call(this,u(1))},function(e,t,i){"use strict";var c=d(i(1));var u=d(i(3));var l=d(i(0));var o=d(i(47));var n=s(i(18));var a=d(i(54));var r=s(i(30));function s(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}function d(e){return e&&e.__esModule?e:{default:e}}var p=u.default.Browser=u.default.Browser||{};p.keyboardNavigation=p.keyboardNavigation||{};c.default.extend(p.keyboardNavigation,{init:function e(){o.default.reset();if(p.preferences_cache.length>0){this.keyboardShortcut={file_shortcut:n.parseShortcutValue(p.get_preference("browser","main_menu_file").value),object_shortcut:n.parseShortcutValue(p.get_preference("browser","main_menu_object").value),tools_shortcut:n.parseShortcutValue(p.get_preference("browser","main_menu_tools").value),help_shortcut:n.parseShortcutValue(p.get_preference("browser","main_menu_help").value),left_tree_shortcut:n.parseShortcutValue(p.get_preference("browser","browser_tree").value),tabbed_panel_backward:n.parseShortcutValue(p.get_preference("browser","tabbed_panel_backward").value),tabbed_panel_forward:n.parseShortcutValue(p.get_preference("browser","tabbed_panel_forward").value),sub_menu_query_tool:n.parseShortcutValue(p.get_preference("browser","sub_menu_query_tool").value),sub_menu_view_data:n.parseShortcutValue(p.get_preference("browser","sub_menu_view_data").value),sub_menu_properties:n.parseShortcutValue(p.get_preference("browser","sub_menu_properties").value),sub_menu_create:n.parseShortcutValue(p.get_preference("browser","sub_menu_create").value),sub_menu_delete:n.parseShortcutValue(p.get_preference("browser","sub_menu_delete").value),sub_menu_refresh:n.parseShortcutValue(p.get_preference("browser","sub_menu_refresh").value),context_menu:n.parseShortcutValue(p.get_preference("browser","context_menu").value),direct_debugging:n.parseShortcutValue(p.get_preference("browser","direct_debugging").value),drop_multiple_objects:n.parseShortcutValue(p.get_preference("browser","grid_menu_drop_multiple").value),drop_cascade_multiple_objects:n.parseShortcutValue(p.get_preference("browser","grid_menu_drop_cascade_multiple").value)};this.shortcutMethods={bindMainMenu:{shortcuts:[this.keyboardShortcut.file_shortcut,this.keyboardShortcut.object_shortcut,this.keyboardShortcut.tools_shortcut,this.keyboardShortcut.help_shortcut]},bindRightPanel:{shortcuts:[this.keyboardShortcut.tabbed_panel_backward,this.keyboardShortcut.tabbed_panel_forward]},bindLeftTree:{shortcuts:this.keyboardShortcut.left_tree_shortcut},bindSubMenuQueryTool:{shortcuts:this.keyboardShortcut.sub_menu_query_tool},bindSubMenuViewData:{shortcuts:this.keyboardShortcut.sub_menu_view_data},bindSubMenuProperties:{shortcuts:this.keyboardShortcut.sub_menu_properties},bindSubMenuCreate:{shortcuts:this.keyboardShortcut.sub_menu_create},bindSubMenuDelete:{shortcuts:this.keyboardShortcut.sub_menu_delete},bindSubMenuRefresh:{shortcuts:this.keyboardShortcut.sub_menu_refresh,bindElem:"#tree"},bindContextMenu:{shortcuts:this.keyboardShortcut.context_menu},bindDirectDebugging:{shortcuts:this.keyboardShortcut.direct_debugging},bindDropMultipleObjects:{shortcuts:this.keyboardShortcut.drop_multiple_objects},bindDropCascadeMultipleObjects:{shortcuts:this.keyboardShortcut.drop_cascade_multiple_objects}};this.bindShortcuts()}},bindShortcuts:function e(){var i=this;c.default.each(i.shortcutMethods,function(e,t){i._bindWithMousetrap(e.shortcuts,i[t],e.bindElem)});var t=37,n=38,a=39,r=40;(0,l.default)(".pg-navbar").on("keydown",function(e){switch(e.keyCode){case t:i.bindMainMenuLeft(e);break;case n:i.bindMainMenuUpDown(e,"up");break;case a:i.bindMainMenuRight(e);break;case r:i.bindMainMenuUpDown(e,"down");break}})},_bindWithMousetrap:function e(t,i,n){var a=this;o.default.unbind(t);if(n){var r=document.querySelector(n);(0,o.default)(r).bind(t,function(){i.apply(this,arguments)}.bind(r))}else{o.default.bind(t,function(){i.apply(a,arguments)})}},unbindShortcuts:function e(){var t=this;c.default.each(t.mousetrapInstances,function(e){e["instance"].reset()});t.mousetrapInstances=[]},bindMainMenu:function e(t,i){var n=this.keyboardShortcut;if(i===n.file_shortcut)(0,l.default)("#mnu_file a.dropdown-toggle").dropdown("toggle");if(i===n.object_shortcut)(0,l.default)("#mnu_obj a.dropdown-toggle").first().dropdown("toggle");if(i===n.tools_shortcut)(0,l.default)("#mnu_tools a.dropdown-toggle").dropdown("toggle");if(i===n.help_shortcut)(0,l.default)("#mnu_help a.dropdown-toggle").dropdown("toggle")},bindRightPanel:function e(t,i){var n=u.default.Browser.docker.findPanels();var a=0;var r=n.length;var l=1;var o=0;var s=false;var d=this.keyboardShortcut;c.default.each(u.default.Browser.docker.findPanels(),function(e,t){if(e.isVisible()&&!s&&e._type!=="browser"){o=t;s=true}});if(i===d.tabbed_panel_backward)a=o>0?o-1:l;else if(i===d.tabbed_panel_forward)a=o<r?o+1:r;u.default.Browser.docker.findPanels()[a].focus();setTimeout(function(){if(document.activeElement instanceof HTMLIFrameElement){document.activeElement.blur()}},1e3)},bindMainMenuLeft:function e(t){if((0,l.default)(t.target).hasClass("nav-link")){var i=(0,l.default)(t.target).closest(".nav-item");r._stopEventPropagation(t);i=i.prev(".nav-item");while(i.hasClass("d-none")){i=i.prev(".nav-item")}i.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,l.default)(t.target).closest(".dropdown-menu").length>0){var n=(0,l.default)(t.target).closest("li");r._stopEventPropagation(t);var a=n.closest(".dropdown-menu");if(a.closest(".dropdown-submenu").length>0){a.removeClass("show");a.closest(".dropdown-submenu").removeClass("dropdown-submenu-visible");n=a.closest(".dropdown-submenu");n.find(".dropdown-item").trigger("focus")}}},bindMainMenuRight:function e(t){if((0,l.default)(t.target).hasClass("nav-link")){var i=(0,l.default)(t.target).closest(".nav-item");r._stopEventPropagation(t);i=i.next(".nav-item");while(i.hasClass("d-none")){i=i.next(".nav-item")}i.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,l.default)(t.target).closest(".dropdown-menu").length>0){var n=(0,l.default)(t.target).closest("li");r._stopEventPropagation(t);if(n.hasClass("dropdown-submenu")){n.addClass("dropdown-submenu-visible");n.find(".dropdown-menu").addClass("show");n=n.find(".dropdown-menu .dropdown-item").first().trigger("focus")}}},bindMainMenuUpDown:function e(t,i){if((0,l.default)(t.target).closest(".dropdown-menu").length>0){r._stopEventPropagation(t);var n=(0,l.default)(t.target).closest("li");var a=(0,l.default)(t.target).closest(".dropdown-menu");a.find(".show").removeClass("show");a.find(".dropdown-submenu").removeClass("dropdown-submenu-visible");if(i==="up"){n=n.prev()}else if(i==="down"){n=n.next()}while(n.hasClass("dropdown-divider")||n.find(".dropdown-item").first().hasClass("disabled")){if(i==="up"){n=n.prev()}else if(i==="down"){n=n.next()}}n.find(".dropdown-item").trigger("focus")}},bindLeftTree:function e(){var t=this.getTreeDetails();(0,l.default)("#tree").trigger("focus");t.t.focus(t.i);t.t.select(t.i)},bindSubMenuQueryTool:function e(){var t=this.getTreeDetails();if(!t.d)return;u.default.DataGrid.show_query_tool("",t.i)},bindSubMenuViewData:function e(){var t=this.getTreeDetails();if(!t.d)return;u.default.DataGrid.show_data_grid({mnuid:1},t.i)},bindSubMenuProperties:function e(){var t=this.getTreeDetails();if(!t.d||u.default.Browser.Nodes[t.t.itemData(t.i)._type].collection_node===true)return;u.default.Browser.Node.callbacks.show_obj_properties.call(u.default.Browser.Nodes[t.t.itemData(t.i)._type],{action:"edit"})},bindSubMenuCreate:function e(){var t=this.getTreeDetails();if(!t.d||u.default.Browser.Nodes[t.t.itemData(t.i)._type].collection_node===true)return;u.default.Browser.Node.callbacks.show_obj_properties.call(u.default.Browser.Nodes[t.t.itemData(t.i)._type],{action:"create"})},bindSubMenuDelete:function e(){var t=this.getTreeDetails();if(!t.d||u.default.Browser.Nodes[t.t.itemData(t.i)._type].collection_node===true)return;u.default.Browser.Node.callbacks.delete_obj.call(u.default.Browser.Nodes[t.t.itemData(t.i)._type])},bindSubMenuRefresh:function e(t){t.preventDefault();var i=p.keyboardNavigation.getTreeDetails();u.default.Browser.Node.callbacks.refresh.call(u.default.Browser.Nodes[i.t.itemData(i.i)._type])},bindContextMenu:function e(t){var i=this.getTreeDetails();var n=(0,l.default)(t.srcElement).find(".aciTreeEntry").position().left+70;var a=(0,l.default)(t.srcElement).find(".aciTreeEntry").position().top+70;i.t.blur(i.i);(0,l.default)("#tree").trigger("blur");i.i.children().contextMenu({x:n,y:a})},bindDirectDebugging:function e(){var t=this.getTreeDetails();var i=t.t.itemData(t.i)._type;if(!t.d||i!=="function"&&i!=="procedure")return;if(u.default.Tools.Debugger.can_debug(t.d,t.i,{debug_type:"direct"})){u.default.Tools.Debugger.get_function_information(u.default.Browser.Nodes[i])}},bindDropMultipleObjects:function e(){var t=this.isPropertyPanelVisible();if(t===true&&(0,l.default)("button.delete_multiple").length>0){(0,l.default)("button.delete_multiple").click()}},bindDropCascadeMultipleObjects:function e(){var t=this.isPropertyPanelVisible();if(t===true&&(0,l.default)("button.delete_multiple_cascade").length>0){(0,l.default)("button.delete_multiple_cascade").click()}},isPropertyPanelVisible:function e(){var t=false;c.default.each(u.default.Browser.docker.findPanels(),function(e){if(e._type==="properties")t=e.isVisible()});return t},getTreeDetails:function e(){var t=u.default.Browser.tree;var i=t.selected().length>0?t.selected():t.first();var n=i&&i.length===1?t.itemData(i):undefined;return{t:t,i:i,d:n}},getDialogTabNavigator:function e(t){var i=p.get_preference("browser","dialog_tab_backward").value;var n=p.get_preference("browser","dialog_tab_forward").value;return new a.default.dialogTabNavigator(t,i,n)}});e.exports=u.default.Browser.keyboardNavigation},,function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(10),i(3),i(5),i(9),i(12),i(6),i(28),i(83),i(30),i(84),i(21)],a=function(c,s,d,u,p,l,f,m,g,e,t,r,o,h){var a=t.default,b=window.wcDocker;if(l.Browser.tree!=null){l=l||window.pgAdmin||{}}var _=l.Tools=l.Tools||{};if(_.DirectDebug)return _.DirectDebug;var v=new function(){};u.extend(v,m.Events,{enable:function e(t,i){this.trigger("pgDebugger:button:state:"+t,i)},set_breakpoint:function e(t,i,n){var a=s("debugger.set_breakpoint",{trans_id:t,line_no:i,set_type:n});d.ajax({url:a,method:"GET"}).done(function(e){if(e.data.status){}}).fail(function(){p.alert(c("Debugger Error"),c("Error while setting debugging breakpoint."))})},UpdateBreakpoint:function e(t){var i=this;var n=i.GetBreakpointInformation(t);if(n.length==1&&n[0].linenumber==-1)return;var a=new Array;for(var r=0;r<n.length;r++){if(n[r].linenumber!=-1){a.push(n[r].linenumber)}}for(r=0;r<a.length;r++){var l=_.DirectDebug.editor.lineInfo(a[r]-1);if(l.gutterMarkers!=undefined){_.DirectDebug.editor.setGutterMarker(a[r]-1,"breakpoints",null)}else{_.DirectDebug.editor.setGutterMarker(a[r]-1,"breakpoints",function(){var e=document.createElement("div");e.style.color="#822";e.innerHTML="";return e}())}}},GetBreakpointInformation:function e(t){var i="";var n=s("debugger.execute_query",{trans_id:t,query_type:"get_breakpoints"});d.ajax({url:n,method:"GET",async:false}).done(function(e){if(e.data.status==="Success"){i=e.data.result}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while fetching breakpoint information."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while fetching breakpoint information."))});return i},setActiveLine:function e(t){var i=this;var n=_.DirectDebug.editor;if(t&&i.active_line_no){n.removeLineClass(i.active_line_no,"wrap","CodeMirror-activeline-background")}if(!t&&i.active_line_no){t=i.active_line_no}if(t>0){i.active_line_no=t;n.addLineClass(i.active_line_no,"wrap","CodeMirror-activeline-background");n.centerOnLine(i.active_line_no)}},start_execution:function e(t,i){var n=this;var a=s("debugger.start_execution",{trans_id:t,port_num:i});d.ajax({url:a,method:"GET"}).done(function(e){if(e.data.status==="Success"){n.execute_query(t)}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while starting debugging session."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while starting debugging session."))})},execute_query:function e(t){var i=this;var n=s("debugger.execute_query",{trans_id:t,query_type:"wait_for_breakpoint"});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status==="Success"){if(e.data.result[0].src!=null&&e.data.result[0].linenumber!=null){_.DirectDebug.editor.setValue(e.data.result[0].src);i.setActiveLine(e.data.result[0].linenumber-2)}i.GetStackInformation(t);if(_.DirectDebug.debug_type){i.poll_end_execution_result(t)}}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while executing requested debugging information."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while executing requested debugging information."))})},GetLocalVariables:function e(t){var i=this;var n=s("debugger.execute_query",{trans_id:t,query_type:"get_variables"});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status==="Success"){i.AddLocalVariables(e.data.result);i.AddParameters(e.data.result);if(_.DirectDebug.debug_restarted){if(_.DirectDebug.debug_type){i.poll_end_execution_result(t)}_.DirectDebug.debug_restarted=false}}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while fetching variable information."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while fetching variable information."))})},GetStackInformation:function e(t){var i=this;var n=s("debugger.execute_query",{trans_id:t,query_type:"get_stack_info"});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status==="Success"){i.AddStackInformation(e.data.result);i.GetLocalVariables(_.DirectDebug.trans_id)}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while fetching stack information."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while fetching stack information."))})},poll_result:function e(t){var i=this;if(!_.DirectDebug.is_polling_required){return}var n=s("debugger.poll_result",{trans_id:t}),a;if(_.DirectDebug.polling_timeout_idle){a=1e3}else{a=200}setTimeout(function(){d.ajax({url:n,method:"GET",beforeSend:function e(t){t.setRequestHeader(l.csrf_token_header,l.csrf_token);d(".debugger-container").addClass("show_progress")}}).done(function(e){d(".debugger-container").removeClass("show_progress");if(e.data.status==="Success"){if(e.data.result==null||e.data.result.length==0){i.poll_result(t)}else{if(e.data.result[0].src!=undefined||e.data.result[0].src!=null){_.DirectDebug.polling_timeout_idle=false;_.DirectDebug.docker.finishLoading(50);if(e.data.result[0].src!=_.DirectDebug.editor.getValue()){_.DirectDebug.editor.setValue(e.data.result[0].src);i.UpdateBreakpoint(t)}i.setActiveLine(e.data.result[0].linenumber-2);i.GetStackInformation(t)}else if(!_.DirectDebug.debug_type&&!_.DirectDebug.first_time_indirect_debug){_.DirectDebug.docker.finishLoading(50);i.setActiveLine(-1);i.clear_all_breakpoint(t);i.execute_query(t);_.DirectDebug.first_time_indirect_debug=true;_.DirectDebug.polling_timeout_idle=false}else{_.DirectDebug.polling_timeout_idle=false;_.DirectDebug.docker.finishLoading(50);if(e.data.result[0].src!=_.DirectDebug.editor.getValue()){_.DirectDebug.editor.setValue(e.data.result[0].src);i.UpdateBreakpoint(t)}i.setActiveLine(e.data.result[0].linenumber-2);i.GetStackInformation(t)}setTimeout(function(){i.enable("stop",true);i.enable("step_over",true);i.enable("step_into",true);i.enable("continue",true);i.enable("toggle_breakpoint",true);i.enable("clear_all_breakpoints",true)},500)}}else if(e.data.status==="Busy"){_.DirectDebug.polling_timeout_idle=true;if(!_.DirectDebug.debug_type){_.DirectDebug.docker.startLoading(c("Waiting for another session to invoke the target..."));i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("continue",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);_.DirectDebug.first_time_indirect_debug=false;i.poll_result(t)}else{i.poll_result(t)}}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while polling result."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while polling result."))})},a)},update_messages:function e(t){t=u.escape(t);var i="",n="";i=_.DirectDebug.messages_panel.$container.find(".messages").html();if(i){n=(i+"\n"+t).replace(/(?:\r\n|\r|\n)/g,"<br />").replace(/(<br\ ?\/?>)+/g,"<br />")}else{n=t}_.DirectDebug.messages_panel.$container.find(".messages").html(n)},poll_end_execution_result:function e(t){var i=this;if(!_.DirectDebug.is_polling_required){return}var n=s("debugger.poll_end_execution_result",{trans_id:t}),a;if(_.DirectDebug.polling_timeout_idle){a=1200}else{a=250}setTimeout(function(){d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status==="Success"){if(e.data.result==undefined){i.setActiveLine(-1);_.DirectDebug.direct_execution_completed=true;_.DirectDebug.polling_timeout_idle=true;p.success(e.info,3);if(e.data.status_message){i.update_messages(e.data.status_message)}d(".debugger-container").removeClass("show_progress");setTimeout(function(){i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);i.enable("continue",true)},500);_.DirectDebug.is_polling_required=false}else{if(e.data.result!=null){i.setActiveLine(-1);i.AddResults(e.data.col_info,e.data.result);_.DirectDebug.results_panel.focus();_.DirectDebug.direct_execution_completed=true;_.DirectDebug.polling_timeout_idle=true;p.success(e.info,3);if(e.data.status_message){i.update_messages(e.data.status_message)}d(".debugger-container").removeClass("show_progress");setTimeout(function(){i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);i.enable("continue",true)},500);_.DirectDebug.is_polling_required=false}}}else if(e.data.status==="Busy"){i.poll_end_execution_result(t);if(e.data.status_message){i.update_messages(e.data.status_message)}}else if(e.data.status==="NotConnected"){p.alert(c("Debugger poll end execution error"),e.data.result)}else if(e.data.status==="ERROR"){_.DirectDebug.direct_execution_completed=true;i.setActiveLine(-1);if(!_.DirectDebug.is_user_aborted_debugging){p.error(e.info,3)}if(e.data.status_message){i.update_messages(e.data.status_message)}_.DirectDebug.messages_panel.focus();d(".debugger-container").removeClass("show_progress");i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);if(!_.DirectDebug.is_user_aborted_debugging){i.enable("continue",true);_.DirectDebug.is_user_aborted_debugging=false}_.DirectDebug.is_polling_required=false}}).fail(function(){p.alert(c("Debugger Error"),c("Error while polling result."))})},a)},Restart:function e(n){var a=this,t=s("debugger.restart",{trans_id:n});a.enable("stop",false);a.enable("step_over",false);a.enable("step_into",false);a.enable("toggle_breakpoint",false);a.enable("clear_all_breakpoints",false);a.enable("continue",false);_.DirectDebug.messages_panel.$container.find(".messages").html("");d.ajax({url:t}).done(function(e){var t=e.data.restart_debug?1:0;_.DirectDebug.polling_timeout_idle=false;_.DirectDebug.is_polling_required=true;a.poll_result(n);if(t){_.DirectDebug.debug_restarted=true}if(e.data.result.require_input){r(e.data.result,t)}else{var i=s("debugger.start_listener",{trans_id:n});d.ajax({url:i,method:"GET"}).done(function(){if(_.DirectDebug.debug_type){a.poll_end_execution_result(n)}}).fail(function(){p.alert(c("Debugger Error"),c("Error while polling result."))})}}).fail(function(e){try{var t=JSON.parse(e.responseText);if(t.success==0){p.alert(c("Debugger Error"),t.errormsg)}}catch(e){console.warn(e.stack||e)}})},Continue:function e(t){var i=this;i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);i.enable("continue",false);if(_.DirectDebug.direct_execution_completed&&_.DirectDebug.direct_execution_completed==_.DirectDebug.polling_timeout_idle){i.Restart(t)}else{var n=s("debugger.execute_query",{trans_id:t,query_type:"continue"});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status){i.poll_result(t)}else{p.alert(c("Debugger Error"),c("Error while executing continue in debugging session."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while executing continue in debugging session."))})}},Step_over:function e(t){var i=this;i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);i.enable("continue",false);var n=s("debugger.execute_query",{trans_id:t,query_type:"step_over"});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status){i.poll_result(t)}else{p.alert(c("Debugger Error"),c("Error while executing step over in debugging session."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while executing step over in debugging session."))})},Step_into:function e(t){var i=this;i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);i.enable("continue",false);var n=s("debugger.execute_query",{trans_id:t,query_type:"step_into"});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status){i.poll_result(t)}else{p.alert(c("Debugger Error"),c("Error while executing step into in debugging session."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while executing step into in debugging session."))})},Stop:function e(t){var i=this;i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);i.enable("continue",false);var n=s("debugger.execute_query",{trans_id:t,query_type:"abort_target"});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status){i.setActiveLine(-1);_.DirectDebug.direct_execution_completed=true;_.DirectDebug.is_user_aborted_debugging=true;_.DirectDebug.is_polling_required=false;i.enable("continue",false);p.success(e.info,3)}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while executing stop in debugging session."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while executing stop in debugging session."))})},toggle_breakpoint:function e(t){var i=this;i.enable("stop",false);i.enable("step_over",false);i.enable("step_into",false);i.enable("toggle_breakpoint",false);i.enable("clear_all_breakpoints",false);i.enable("continue",false);var n=_.DirectDebug.editor.lineInfo(i.active_line_no);var a="";if(n.gutterMarkers==undefined){a=s("debugger.set_breakpoint",{trans_id:t,line_no:i.active_line_no+1,set_type:"1"})}else{a=s("debugger.set_breakpoint",{trans_id:t,line_no:i.active_line_no+1,set_type:"0"})}d.ajax({url:a,method:"GET"}).done(function(e){if(e.data.status){var t=_.DirectDebug.editor.lineInfo(i.active_line_no);if(t.gutterMarkers!=undefined){_.DirectDebug.editor.setGutterMarker(i.active_line_no,"breakpoints",null)}else{_.DirectDebug.editor.setGutterMarker(i.active_line_no,"breakpoints",function(){var e=document.createElement("div");e.style.color="#822";e.innerHTML="";return e}())}i.enable("stop",true);i.enable("step_over",true);i.enable("step_into",true);i.enable("toggle_breakpoint",true);i.enable("clear_all_breakpoints",true);i.enable("continue",true)}else if(e.data.status==="NotConnected"){p.alert(c("Debugger Error"),c("Error while toggling breakpoint."))}}).fail(function(){p.alert(c("Debugger Error"),c("Error while toggling breakpoint."))})},clear_all_breakpoint:function e(t){var n=this,i=n.GetBreakpointInformation(t);if(i.length==1&&i[0].linenumber==-1)return;n.enable("stop",false);n.enable("step_over",false);n.enable("step_into",false);n.enable("toggle_breakpoint",false);n.enable("clear_all_breakpoints",false);n.enable("continue",false);var a=new Array;for(var r=0;r<i.length;r++){if(i[r].linenumber!=-1){a.push(i[r].linenumber)}}var l=s("debugger.clear_all_breakpoint",{trans_id:t});d.ajax({url:l,method:"POST",data:{breakpoint_list:a.join()}}).done(function(e){if(e.data.status){for(var t=0;t<a.length;t++){var i=_.DirectDebug.editor.lineInfo(a[t]-1);if(i){if(i.gutterMarkers!=undefined){_.DirectDebug.editor.setGutterMarker(a[t]-1,"breakpoints",null)}}}}n.enable("stop",true);n.enable("step_over",true);n.enable("step_into",true);n.enable("toggle_breakpoint",true);n.enable("clear_all_breakpoints",true);n.enable("continue",true)}).fail(function(){p.alert(c("Debugger Error"),c("Error while clearing all breakpoint."))})},AddStackInformation:function e(t){var i=this;if(i.stack_grid){i.stack_grid.remove();i.stack_grid=null}var n=m.Model.extend({defaults:{frame_id:0,name:undefined,value:undefined,line_no:undefined}});var a=m.Collection.extend({model:n});var r=[{name:"name",label:c("Name"),type:"text",editable:false,cell:"string"},{name:"value",label:c("Value"),type:"text",editable:false,cell:"string"},{name:"line_no",label:c("Line No."),type:"text",editable:false,cell:"string"}];var l=[];for(var o=0;o<t.length;o++){l.push({frame_id:o,name:t[o].targetname,value:t[o].args,line_no:t[o].linenumber})}var s=this.stackColl=new a(l);this.stackColl.on("backgrid:row:selected",i.select_frame,i);var d=this.stack_grid=new g.Grid({emptyText:"No data found",columns:r,row:g.Row.extend({events:{click:"rowClick"},rowClick:function e(){i.frame_id=this.model.get("frame_id");this.model.trigger("backgrid:row:selected",this);i.stack_grid.$el.find("td").css("background-color",this.disabledColor);this.$el.find("td").css("background-color",this.highlightColor)}}),collection:s,className:"backgrid table table-bordered table-noouter-border table-bottom-border"});d.render();_.DirectDebug.stack_pane_panel.$container.find(".stack_pane").append(d.el)},AddResults:function e(t,i){var n=this;if(n.result_grid){n.result_grid.remove();n.result_grid=null}var a=m.Model.extend({defaults:{name:undefined}});var r=m.Collection.extend({model:a});var l=[];if(u.size(t)){u.each(t,function(e){var t={type:"text",editable:false,cell:"string"};t["name"]=t["label"]=e.name;l.push(t)})}var o=this.result_grid=new g.Grid({emptyText:"No data found",columns:l,collection:new r(i),className:"backgrid table table-bordered table-noouter-border table-bottom-border"});o.render();_.DirectDebug.results_panel.$container.find(".debug_results").append(o.el)},AddLocalVariables:function e(t){var i=this;if(i.variable_grid){i.variable_grid.remove();i.variable_grid=null}var n=m.Model.extend({defaults:{name:undefined,type:undefined,value:undefined}});var a=m.Collection.extend({model:n});a.prototype.on("change",i.deposit_parameter_value,i);var r=[{name:"name",label:c("Name"),type:"text",editable:false,cell:"string"},{name:"type",label:c("Type"),type:"text",editable:false,cell:"string"},{name:"value",label:c("Value"),type:"text",cell:"string"}];var l=[];if(t.length!=0){for(var o=0;o<t.length;o++){if(t[o].varclass=="L"){l.push({name:t[o].name,type:t[o].dtype,value:t[o].value})}}}var s=this.variable_grid=new g.Grid({emptyText:"No data found",columns:r,collection:new a(l),className:"backgrid table table-bordered table-noouter-border table-bottom-border"});s.collection.on("backgrid:edited",function(e,t,i){h.setFocusToDebuggerEditor(_.DirectDebug.editor,i)});s.render();_.DirectDebug.local_variables_panel.$container.find(".local_variables").append(s.el)},AddParameters:function e(t){var i=this;if(i.param_grid){i.param_grid.remove();i.param_grid=null}var n=m.Model.extend({defaults:{name:undefined,type:undefined,value:undefined}});var a=i.ParametersCollection=m.Collection.extend({model:n});a.prototype.on("change",i.deposit_parameter_value,i);var r=[{name:"name",label:c("Name"),type:"text",editable:false,cell:"string"},{name:"type",label:c("Type"),type:"text",editable:false,cell:"string"},{name:"value",label:c("Value"),type:"text",cell:"string"}];var l=[];if(t.length!=0){for(var o=0;o<t.length;o++){if(t[o].varclass=="A"){l.push({name:t[o].name,type:t[o].dtype,value:t[o].value})}}}var s=this.param_grid=new g.Grid({emptyText:"No data found",columns:r,collection:new a(l),className:"backgrid table table-bordered table-noouter-border table-bottom-border"});s.collection.on("backgrid:edited",function(e,t,i){h.setFocusToDebuggerEditor(_.DirectDebug.editor,i)});s.render();_.DirectDebug.parameters_panel.$container.find(".parameters").append(s.el)},deposit_parameter_value:function e(t){var i=this;var n=[];n.push({name:t.get("name"),type:t.get("type"),value:t.get("value")});var a=s("debugger.deposit_value",{trans_id:_.DirectDebug.trans_id});d.ajax({url:a,method:"POST",data:{data:JSON.stringify(n)}}).done(function(e){if(e.data.status){i.GetLocalVariables(_.DirectDebug.trans_id);if(e.data.result){p.success(e.data.info,3)}else{p.error(e.data.info,3)}}}).fail(function(){p.alert(c("Debugger Error"),c("Error while depositing variable value."))})},select_frame:function e(){var t=this;var i=s("debugger.select_frame",{trans_id:_.DirectDebug.trans_id,frame_id:t.frame_id});d.ajax({url:i,method:"GET"}).done(function(e){if(e.data.status){_.DirectDebug.editor.setValue(e.data.result[0].src);t.UpdateBreakpoint(_.DirectDebug.trans_id);t.setActiveLine(e.data.result[0].linenumber-2);t.GetLocalVariables(_.DirectDebug.trans_id)}}).fail(function(){p.alert(c("Debugger Error"),c("Error while selecting frame."))})}});var y=m.View.extend({el:".debugger_main_container",initialize:function e(){v.on("pgDebugger:button:state:stop",this.enable_stop,this);v.on("pgDebugger:button:state:step_over",this.enable_step_over,this);v.on("pgDebugger:button:state:step_into",this.enable_step_into,this);v.on("pgDebugger:button:state:continue",this.enable_continue,this);v.on("pgDebugger:button:state:toggle_breakpoint",this.enable_toggle_breakpoint,this);v.on("pgDebugger:button:state:clear_all_breakpoints",this.enable_clear_all_breakpoints,this)},events:{"click .btn-stop":"on_stop","click .btn-clear-breakpoint":"on_clear_all_breakpoint","click .btn-toggle-breakpoint":"on_toggle_breakpoint","click .btn-continue":"on_continue","click .btn-step-over":"on_step_over","click .btn-step-into":"on_step_into",keydown:"keyAction"},enable_stop:function e(t){var i=this.$el.find(".btn-stop");if(t){i.prop("disabled",false);i.removeAttr("disabled")}else{i.prop("disabled",true);i.attr("disabled","disabled")}},enable_step_over:function e(t){var i=this.$el.find(".btn-step-over");if(t){i.prop("disabled",false);i.removeAttr("disabled")}else{i.prop("disabled",true);i.attr("disabled","disabled")}},enable_step_into:function e(t){var i=this.$el.find(".btn-step-into");if(t){i.prop("disabled",false);i.removeAttr("disabled")}else{i.prop("disabled",true);i.attr("disabled","disabled")}},enable_continue:function e(t){var i=this.$el.find(".btn-continue");if(t){i.prop("disabled",false);i.removeAttr("disabled")}else{i.prop("disabled",true);i.attr("disabled","disabled")}},enable_toggle_breakpoint:function e(t){var i=this.$el.find(".btn-toggle-breakpoint");if(t){i.prop("disabled",false);i.removeAttr("disabled")}else{i.prop("disabled",true);i.attr("disabled","disabled")}},enable_clear_all_breakpoints:function e(t){var i=this.$el.find(".btn-clear-breakpoint");if(t){i.prop("disabled",false);i.removeAttr("disabled")}else{i.prop("disabled",true);i.attr("disabled","disabled")}},on_stop:function e(){v.Stop(_.DirectDebug.trans_id)},on_clear_all_breakpoint:function e(){v.clear_all_breakpoint(_.DirectDebug.trans_id)},on_toggle_breakpoint:function e(){v.toggle_breakpoint(_.DirectDebug.trans_id)},on_continue:function e(){v.Continue(_.DirectDebug.trans_id)},on_step_over:function e(){v.Step_over(_.DirectDebug.trans_id)},on_step_into:function e(){v.Step_into(_.DirectDebug.trans_id)},keyAction:function e(t){var i=this.$el,n,a,r=this;n=o.processEventDebugger(i,t,r.preferences);if(!u.isUndefined(n)&&!u.isNull(n)){a=n+1;_.DirectDebug.docker.findPanels()[a].focus()}}});var i=function e(){};u.extend(i.prototype,{load:function e(t,i,n,a){var r=this;u.bindAll(_.DirectDebug,"messages");if(this.initialized)return;var l;this.initialized=true;this.trans_id=t;this.debug_type=i;this.first_time_indirect_debug=false;this.direct_execution_completed=false;this.polling_timeout_idle=false;this.debug_restarted=false;this.is_user_aborted_debugging=false;this.is_polling_required=true;this.function_name_with_arguments=n;this.layout=a;var o=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;this.preferences=o.get_preferences_for_module("sqleditor");this.docker=new b("#container",{allowContextMenu:false,allowCollapse:false,loadingClass:"pg-sp-icon",themePath:s("static",{filename:"css"}),theme:"webcabin.overrides.css"});this.panels=[];f.bind_beforeunload();if(t!=undefined&&!i){l=s("debugger.start_listener",{trans_id:t});d.ajax({url:l,method:"GET"}).done(function(e){if(e.data.status){r.intializePanels();v.poll_result(t)}}).fail(function(e){try{var t=JSON.parse(e.responseText);if(t.success==0){p.alert(c("Debugger Error"),t.errormsg)}}catch(e){p.alert(c("Debugger Error"),c("Error while starting debugging listener."))}})}else if(t!=undefined&&i){l=s("debugger.start_listener",{trans_id:t});d.ajax({url:l,method:"GET"}).done(function(e){if(e.data.status){r.messages(t)}}).fail(function(e){try{var t=JSON.parse(e.responseText);if(t.success==0){p.alert(c("Debugger Error"),t.errormsg)}}catch(e){p.alert(c("Debugger Error"),c("Error while starting debugging listener."))}})}else this.intializePanels()},messages:function e(t){var i=this;var n=s("debugger.messages",{trans_id:t});d.ajax({url:n,method:"GET"}).done(function(e){if(e.data.status==="Success"){i.intializePanels();v.start_execution(t,e.data.result)}else if(e.data.status==="Busy"){i.messages(t)}else if(e.data.status==="NotConnected"){p.alert(c("Not connected to server or connection with the server has been closed."),e.data.result)}}).fail(function(){p.alert(c("Debugger Error"),c("Error while fetching messages information."))})},onBreakPoint:function e(t,i,n){var a=this;if(n=="breakpoints"&&!_.DirectDebug.polling_timeout_idle){var r=t.lineInfo(i);if(r.gutterMarkers==undefined){v.set_breakpoint(a.trans_id,i+1,1)}else{if(r.gutterMarkers.breakpoints==undefined){v.set_breakpoint(a.trans_id,i+1,1)}else{v.set_breakpoint(a.trans_id,i+1,0)}}var l=r.gutterMarkers;if(l!=undefined&&r.gutterMarkers.breakpoints==undefined)l=r.gutterMarkers.breakpoints;t.setGutterMarker(i,"breakpoints",l?null:function(){var e=document.createElement("div");e.style.color="#822";e.innerHTML="";return e}())}},buildDefaultLayout:function e(t){var i=t.addPanel("code",b.DOCK.TOP);var n=t.addPanel("parameters",b.DOCK.BOTTOM,i);t.addPanel("local_variables",b.DOCK.STACKED,n,{tabOrientation:b.TAB.TOP});t.addPanel("messages",b.DOCK.STACKED,n);t.addPanel("results",b.DOCK.STACKED,n);t.addPanel("stack_pane",b.DOCK.STACKED,n)},intializePanels:function e(){var r=this;this.registerPanel("code",r.function_name_with_arguments,"100%","50%",function(){var e=new l.Browser.Panel({name:"parameters",title:c("Parameters"),width:"100%",height:"100%",isCloseable:false,isPrivate:true,content:'<div id ="parameters" class="parameters" tabindex="0"></div>'});var t=new l.Browser.Panel({name:"local_variables",title:c("Local variables"),width:"100%",height:"100%",isCloseable:false,isPrivate:true,content:'<div id ="local_variables" class="local_variables" tabindex="0"></div>'});var i=new l.Browser.Panel({name:"messages",title:c("Messages"),width:"100%",height:"100%",isCloseable:false,isPrivate:true,content:'<div id="messages" class="messages" tabindex="0"></div>'});var n=new l.Browser.Panel({name:"results",title:c("Results"),width:"100%",height:"100%",isCloseable:false,isPrivate:true,content:'<div id="debug_results" class="debug_results" tabindex="0"></div>'});var a=new l.Browser.Panel({name:"stack_pane",title:c("Stack"),width:"100%",height:"100%",isCloseable:false,isPrivate:true,content:'<div id="stack_pane" class="stack_pane" tabindex="0"></div>'});e.load(r.docker);t.load(r.docker);i.load(r.docker);n.load(r.docker);a.load(r.docker)});f.restore_layout(r.docker,r.layout,this.buildDefaultLayout.bind(this));r.docker.on(b.EVENT.LAYOUT_CHANGED,function(){f.save_current_layout("Debugger/Layout",r.docker)});r.code_editor_panel=r.docker.findPanels("code")[0];r.parameters_panel=r.docker.findPanels("parameters")[0];r.local_variables_panel=r.docker.findPanels("local_variables")[0];r.messages_panel=r.docker.findPanels("messages")[0];r.results_panel=r.docker.findPanels("results")[0];r.stack_pane_panel=r.docker.findPanels("stack_pane")[0];var t=d('<div id="stack_editor_pane" '+'class="pg-panel-content info"></div>');var i=d('<textarea id="debugger-editor-textarea">'+"</textarea>").appendTo(t);r.code_editor_panel.layout().addItem(t);r.editor=a.fromTextArea(i.get(0),{tabindex:-1,lineNumbers:true,foldOptions:{widget:""},foldGutter:{rangeFinder:a.fold.combine(a.pgadminBeginRangeFinder,a.pgadminIfRangeFinder,a.pgadminLoopRangeFinder,a.pgadminCaseRangeFinder)},gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","breakpoints"],mode:"text/x-pgsql",readOnly:true,extraKeys:l.Browser.editor_shortcut_keys,indentWithTabs:l.Browser.editor_options.indent_with_tabs,indentUnit:l.Browser.editor_options.tabSize,tabSize:l.Browser.editor_options.tabSize,lineWrapping:l.Browser.editor_options.wrapCode,autoCloseBrackets:l.Browser.editor_options.insert_pair_brackets,matchBrackets:l.Browser.editor_options.brace_matching});a.on(r.editor,"keydown",function(e,t){if(t.keyCode==27){document.activeElement.blur()}});var n=function e(){r.docker.finishLoading(100);r.docker.off(b.EVENT.LOADED);r.editor.on("gutterClick",r.onBreakPoint.bind(r),r);if(r.docker.$container){r.docker.$container.parent().focus()}var i=setInterval(function(){try{var e=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;if(e.preference_version()>0){clearInterval(i);r.reflectPreferences();if(r.preferences.debugger_new_browser_tab){var t=setInterval(function(){if(window.opener&&window.opener.pgAdmin){r.reflectPreferences()}else{clearInterval(t)}},1e3)}}}catch(e){clearInterval(i);throw e}},0)};r.docker.startLoading(c("Loading..."));r.docker.on(b.EVENT.LOADED,n);this.toolbarView=new y;f.onPreferencesChange("debugger",function(){r.reflectPreferences()})},reflectPreferences:function e(){var t=this,i=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;t.preferences=i.get_preferences_for_module("debugger");t.toolbarView.preferences=t.preferences;t.toolbarView.$el.find("#btn-step-into").attr("title",o.shortcut_accesskey_title("Step into",t.preferences.btn_step_into)).attr("accesskey",o.shortcut_key(t.preferences.btn_step_into));t.toolbarView.$el.find("#btn-step-over").attr("title",o.shortcut_accesskey_title("Step over",t.preferences.btn_step_over)).attr("accesskey",o.shortcut_key(t.preferences.btn_step_over));t.toolbarView.$el.find("#btn-continue").attr("title",o.shortcut_accesskey_title("Continue/Start",t.preferences.btn_start)).attr("accesskey",o.shortcut_key(t.preferences.btn_start));t.toolbarView.$el.find("#btn-toggle-breakpoint").attr("title",o.shortcut_accesskey_title("Toggle breakpoint",t.preferences.btn_toggle_breakpoint)).attr("accesskey",o.shortcut_key(t.preferences.btn_toggle_breakpoint));t.toolbarView.$el.find("#btn-clear-breakpoint").attr("title",o.shortcut_accesskey_title("Clear all breakpoints",t.preferences.btn_clear_breakpoints)).attr("accesskey",o.shortcut_key(t.preferences.btn_clear_breakpoints));t.toolbarView.$el.find("#btn-stop").attr("title",o.shortcut_accesskey_title("Stop",t.preferences.btn_stop)).attr("accesskey",o.shortcut_key(t.preferences.btn_stop))},registerPanel:function e(i,n,a,r,l){var o=this;this.docker.registerPanelType(i,{title:n,isPrivate:true,onCreate:function e(t){o.panels[i]=t;t.initSize(a,r);if(!n)t.title(false);else t.title(n);t.closeable(false);t.layout().addItem(d('<div tabindex="0">',{class:"pg-debugger-panel"}));if(l){l.apply(o,[t])}}})}});_.DirectDebug=new i;_.DirectDebug["jquery"]=d;return _.DirectDebug}.apply(t,n),a!==undefined&&(e.exports=a))},,,function(e,t,i){"use strict";var n,a;var r=r||{};r.dashboard=i(105);var r=r||{};r.tools=r.tools||{};r.tools.user_management=i(86);var r=r||{};r.browser=r.browser||{};r.browser.object_statistics=i(109);var r=r||{};r.browser=r.browser||{};r.browser.dependencies=i(112);var r=r||{};r.browser=r.browser||{};r.browser.dependents=i(113);var r=r||{};r.browser=r.browser||{};r.browser.object_sql=i(114);var r=r||{};r.browser=r.browser||{};r.browser.bgprocess=i(115);var r=r||{};r.node=r.node||{};r.node.server_group=i(116);var r=r||{};r.node=r.node||{};r.node.server=i(58);var r=r||{};r.node=r.node||{};r.node.database=i(117);var r=r||{};r.node=r.node||{};r.node.role=i(118);var r=r||{};r.node=r.node||{};r.node.cast=i(119);var r=r||{};r.node=r.node||{};r.node.tablespace=i(120);var r=r||{};r.node=r.node||{};r.node.resource_group=i(121);var r=r||{};r.node=r.node||{};r.node.event_trigger=i(122);var r=r||{};r.node=r.node||{};r.node.extension=i(123);var r=r||{};r.node=r.node||{};r.node.language=i(124);var r=r||{};r.node=r.node||{};r.node.foreign_data_wrapper=i(125);var r=r||{};r.node=r.node||{};r.node.foreign_server=i(126);var r=r||{};r.node=r.node||{};r.node.user_mapping=i(127);var r=r||{};r.node=r.node||{};r.node.schema=i(128);var r=r||{};r.node=r.node||{};r.node.catalog=i(129);var r=r||{};r.node=r.node||{};r.node.catalog_object=i(130);var r=r||{};r.node=r.node||{};r.node.collation=i(131);var r=r||{};r.node=r.node||{};r.node.domain=i(132);var r=r||{};r.node=r.node||{};r.node.domain_constraints=i(133);var r=r||{};r.node=r.node||{};r.node.foreign_table=i(134);var r=r||{};r.node=r.node||{};r.node.fts_configuration=i(135);var r=r||{};r.node=r.node||{};r.node.fts_dictionary=i(136);var r=r||{};r.node=r.node||{};r.node.fts_parser=i(137);var r=r||{};r.node=r.node||{};r.node.fts_template=i(138);var r=r||{};r.node=r.node||{};r.node.function=i(60);var r=r||{};r.node=r.node||{};r.node.procedure=i(139);var r=r||{};r.node=r.node||{};r.node.edbfunc=i(61);var r=r||{};r.node=r.node||{};r.node.edbproc=i(140);var r=r||{};r.node=r.node||{};r.node.edbvar=i(141);var r=r||{};r.node=r.node||{};r.node.trigger_function=i(142);var r=r||{};r.node=r.node||{};r.node.package=i(143);var r=r||{};r.node=r.node||{};r.node.sequence=i(144);var r=r||{};r.node=r.node||{};r.node.synonym=i(145);var r=r||{};r.node=r.node||{};r.node.type=i(146);var r=r||{};r.node=r.node||{};r.node.rule=i(62);var r=r||{};r.node=r.node||{};r.node.index=i(147);var r=r||{};r.node=r.node||{};r.node.trigger=i(148);var r=r||{};r.node=r.node||{};r.node.catalog_object_column=i(149);var r=r||{};r.node=r.node||{};r.node.view=i(150);var r=r||{};r.node=r.node||{};r.node.mview=i(151);var r=r||{};r.node=r.node||{};r.node.table=i(152);var r=r||{};r.node=r.node||{};r.node.partition=i(162);!(n=[i(2),i(4),i(0),i(1),i(10),i(3),i(28),i(29),i(9),i(163),i(164),i(165),i(53),i(21)],a=function(m,g,h,d,p,f,e,b,t,_,i,a,c){var v=window.wcDocker,y=f.Browser,w=e.default;if(f.DataGrid)return f.DataGrid;f.DataGrid=d.extend({init:function e(){if(this.initialized)return;this.initialized=true;this.title_index=1;var t=this;var i=setInterval(function(){if(y.preference_version()>0){t.preferences=y.get_preferences_for_module("sqleditor");clearInterval(i)}},0);y.onPreferencesChange("sqleditor",function(){t.preferences=y.get_preferences_for_module("sqleditor")});var n=["table","view","mview","foreign_table","catalog_object","partition"],a=function e(t){var i=function(){if(!d.isUndefined(t)&&!d.isNull(t))return d.indexOf(n,t._type)!==-1?true:false;else return false}();c.enable(m("View Data"),i);c.enable(m("Filtered Rows"),i);return i},r=function e(t){var i=function(){if(!d.isUndefined(t)&&!d.isNull(t)){if(d.indexOf(f.unsupported_nodes,t._type)==-1){if(t._type=="database"&&t.allowConn){return true}else if(t._type!="database"){return true}else{return false}}else{return false}}else{return false}}();c.enable(m("Query Tool"),i);return i};var l=[{name:"query_tool",module:this,applies:["tools"],callback:"show_query_tool",enable:r,priority:1,label:m("Query Tool"),icon:"fa fa-bolt"}];for(var o=0;o<n.length;o++){l.push({name:"view_all_rows_context_"+n[o],node:n[o],module:this,data:{mnuid:3},applies:["context","object"],callback:"show_data_grid",enable:a,category:"view_data",priority:101,label:m("All Rows")},{name:"view_first_100_rows_context_"+n[o],node:n[o],module:this,data:{mnuid:1},applies:["context","object"],callback:"show_data_grid",enable:a,category:"view_data",priority:102,label:m("First 100 Rows")},{name:"view_last_100_rows_context_"+n[o],node:n[o],module:this,data:{mnuid:2},applies:["context","object"],callback:"show_data_grid",enable:a,category:"view_data",priority:103,label:m("Last 100 Rows")},{name:"view_filtered_rows_context_"+n[o],node:n[o],module:this,data:{mnuid:4},applies:["context","object"],callback:"show_filtered_row",enable:a,category:"view_data",priority:104,label:m("Filtered Rows...")})}f.Browser.add_menu_category("view_data",m("View/Edit Data"),100,"");f.Browser.add_menus(l);var s=new f.Browser.Frame({name:"frm_datagrid",showTitle:true,isCloseable:true,isPrivate:true,url:"about:blank"});s.load(y.docker);this.on("pgadmin-datagrid:transaction:created",function(e){this.launch_grid(e)})},show_data_grid:function e(t,i){_.showDataGrid(this,y,p,t,i)},show_filtered_row:function e(t,i){var r=this,n=f.Browser.tree.itemData(i);if(n===undefined){p.alert(m("Data Grid Error"),m("No object selected."));return}var a=y.Nodes[n._type],l=a.getTreeNodeHierarchy(i);if(l.server===undefined||l.database===undefined){return}if(l.schema===undefined&&l.view===undefined&&l.catalog===undefined){return}var o=_.retrieveNameSpaceName(l);var s={cmd_type:t.mnuid,obj_type:n._type,sgid:l.server_group._id,sid:l.server._id,did:l.database._id,obj_id:n._id};var d=g("datagrid.initialize_datagrid",s);var c=g("datagrid.filter_validate",{sid:s["sid"],did:s["did"],obj_id:s["obj_id"]});var u=_.generateDatagridTitle(l,o,n);if(!p.filterDialog){p.dialog("filterDialog",function e(){return{main:function e(t,i,n,a){this.set("title",t);this.message=i;this.baseUrl=n;this.validateUrl=a},setup:function e(){return{buttons:[{text:m("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:m("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],options:{modal:0,resizable:true,maximizable:false,pinnable:false,autoReset:false}}},build:function e(){p.pgDialogBuild.apply(this)},prepare:function e(){var t=this,i=h(this.message),n=i.find("#sql_filter");h(this.elements.header).attr("data-title",this.get("title"));h(this.elements.body.childNodes[0]).addClass("dataview_filter_dialog");this.setContent(i.get(0));t.__internal.buttons[1].element.disabled=true;this.filter_obj=w.fromTextArea(n.get(0),{lineNumbers:true,mode:"text/x-pgsql",extraKeys:y.editor_shortcut_keys,indentWithTabs:!r.preferences.use_spaces,indentUnit:r.preferences.tab_size,tabSize:r.preferences.tab_size,lineWrapping:r.preferences.wrap_code,autoCloseBrackets:r.preferences.insert_pair_brackets,matchBrackets:r.preferences.brace_matching});var a=b.calcFontSize(r.preferences.sql_font_size);h(this.filter_obj.getWrapperElement()).css("font-size",a);setTimeout(function(){t.filter_obj.refresh();t.filter_obj.focus()},500);t.filter_obj.on("change",function(){if(t.filter_obj.getValue()!==""){t.__internal.buttons[1].element.disabled=false}else{t.__internal.buttons[1].element.disabled=true}})},callback:function e(t){if(t.button.text==m("OK")){var i=this.filter_obj.getValue();var n=this;t.cancel=true;h.ajax({url:n.validateUrl,method:"POST",async:false,contentType:"application/json",data:JSON.stringify(i)}).done(function(e){if(e.data.status){r.create_transaction(n.baseUrl,null,"false",l.server.server_type,"",u,i,false);n.close()}else{p.alert(m("Validation Error"),e.data.result)}}).fail(function(e){p.alert(m("Validation Error"),e)})}}}})}h.get(g("datagrid.filter"),function(e){p.filterDialog("Data Filter",e,d,c).resizeTo(y.stdW.sm,y.stdH.sm)})},get_panel_title:function e(){return i.getPanelTitle(y)},show_query_tool:function e(t,i,n){a.showQueryTool(this,y,p,t,i,n)},create_transaction:function e(t,i,n,a,r,l,o,s){var d=this;i=i||d;if(s){t+="?recreate=1"}var c=null;if(o!=""){c=JSON.stringify(o)}h.ajax({url:t,method:"POST",dataType:"json",data:c,contentType:"application/json"}).done(function(e){e.data.is_query_tool=n;e.data.server_type=a;e.data.sURL=r;e.data.panel_title=l;i.trigger("pgadmin-datagrid:transaction:created",e.data)}).fail(function(e){if(i!==d){if(e.status==503&&e.responseJSON.info!=undefined&&e.responseJSON.info=="CONNECTION_LOST"){setTimeout(function(){i.handle_connection_lost(true,e)});return}}try{var t=JSON.parse(e.responseText);p.alert(m("Query Tool initialization error"),t.errormsg)}catch(e){p.alert(m("Query Tool initialization error"),e.statusText)}})},launch_grid:function e(t){var i=this,n=t.panel_title,a=i.get_panel_title(),r="",l="";if(t.is_query_tool=="false"){a=n+"/"+a;l=m("View/Edit Data - ")+a;n=a;r="fa fa-table"}else{if(n){l=n.toUpperCase()+" "+m("Script - ")+a;n=a;r="fa fa-file-text-o"}else{l=m("Query Tool - ")+a;n=a;r="fa fa-bolt"}}var o=b.removeSlashInTheString(a);var s={trans_id:t.gridTransId,is_query_tool:t.is_query_tool,editor_title:o.title},d=g("datagrid.panel",s)+"?"+"query_url="+encodeURI(t.sURL)+"&server_type="+encodeURIComponent(t.server_type)+"&fslashes="+o.slashLocations;if(i.preferences.new_browser_tab){var c=window.open(d,"_blank");c.addEventListener("load",function(){c.document.title=n})}else{var u=y.docker.findPanels("properties");var p=y.docker.addPanel("frm_datagrid",v.DOCK.STACKED,u[0]);p.title('<span title="'+l+'">'+n+"</span>");p.icon(r);p.focus();p.on(v.EVENT.CLOSED,function(){h.ajax({url:g("datagrid.close",{trans_id:t.gridTransId}),method:"DELETE"})});var f=function e(i){var n=h('<div class="pg-sp-container">\n                    <div class="pg-sp-content">\n                        <div class="row">\n                            <div class="col-12 pg-sp-icon"></div>\n                        </div>\n                    </div>\n                </div>').appendTo(h(i).data("embeddedFrame").$container);var a=setInterval(function(){var e=h(i).data("frameInitialized");if(e){clearInterval(a);var t=h(i).data("embeddedFrame");if(t){t.onLoaded(function(){n.remove()});t.openURL(d)}}},100)};f(p)}}},t.Events);return f.DataGrid}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,a){"use strict";var i,n;function s(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};var n=Object.keys(i);if(typeof Object.getOwnPropertySymbols==="function"){n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))}n.forEach(function(e){r(t,e,i[e])})}return t}function r(e,t,i){if(t in e){Object.defineProperty(e,t,{value:i,enumerable:true,configurable:true,writable:true})}else{e[t]=i}return e}!(i=[a(4),a(2),a,a(0),a(1),a(3),a(9),a(19),a(106),a(10),a(6),a(107),a(18),a(5),a(93),a(21)],n=function(m,g,e,h,b,_,u,p,l,f,v,y,w){_.Browser=_.Browser||{};var x=_.Browser;if(_.Dashboard)return;var C=true,N="",S="",k=false,D,T,j=false,M=false;var O=p.Extension.DeleteCell.extend({render:function e(){this.$el.empty();var t=this,i=t.column.get("cell_action");if(i==="cancel"){this.$el.html("<i class='fa fa-stop' data-toggle='tooltip' "+"title='"+g("Cancel the active query")+"'></i>")}else{this.$el.html("<i class='fa fa-times-circle text-danger' data-toggle='tooltip' "+"title='"+g("Terminate the session")+"'></i>")}this.delegateEvents();return this},deleteRow:function e(t){var i=this,n,a,r,l,o,s=i.column.get("cell_action");t.preventDefault();var d=p.callByNeed(i.column.get("canDeleteRow"),i.column,i.model);if(!d)return;var c=function e(){h("#btn_refresh").trigger("click")};if(s==="cancel"){n=g("Cancel Active Query?");a=g("Are you sure you wish to cancel the active query?");r=g("Active query cancelled successfully.");l=g("An error occurred whilst cancelling the active query.");o=N+i.model.get("pid")}else{n=g("Terminate Session?");a=g("Are you sure you wish to terminate the session?");r=g("Session terminated successfully.");l=g("An error occurred whilst terminating the active query.");o=S+i.model.get("pid")}f.confirm(n,a,function(){h.ajax({url:o,type:"DELETE"}).done(function(e){if(e==g("Success")){f.success(r);c()}else{f.error(l)}}).fail(function(e,t,i){f.pgRespErrorNotify(e,i)})},function(){return true})}});var E=p.Extension.ObjectCell.extend({enterEditMode:function e(){this.model.trigger("enteringEditMode",[this]);p.Cell.prototype.enterEditMode.apply(this,arguments);this.delegateEvents();var t=p.callByNeed(this.column.editable(),this.column,this.model);if(t){this.$el.html("<i class='fa fa-caret-down subnode-edit-in-process'></i>");this.model.trigger("pg-sub-node:opened",this.model,this)}},render:function e(){this.$el.empty();this.$el.html("<i class='fa fa-caret-right' data-toggle='tooltip' "+"title='"+g("View the active session details")+"'></i>");this.delegateEvents();if(this.grabFocus)this.$el.trigger("focus");return this}});var P=u.Model.extend({defaults:{version:null},schema:[{id:"backend_type",label:g("Backend type"),type:"text",editable:true,disabled:true,group:g("Details"),visible:function e(){return this.version>=1e5}},{id:"query_start",label:g("Query started at"),type:"text",editable:false,disabled:true,group:g("Details")},{id:"state_change",label:g("Last state changed at"),type:"text",editable:true,disabled:true,group:g("Details")},{id:"query",label:g("SQL"),type:"text",editable:true,disabled:true,control:v.SqlFieldControl,group:g("Details")}]});_.Dashboard={init:function e(){if(this.initialized)return;this.initialized=true;this.sid=this.did=-1;this.version=-1;var t=this.object_selected.bind(this);var i=this.object_disconnected.bind(this);x.Events.on("pgadmin-browser:tree:selected",t);x.Events.on("pgadmin:server:disconnect",i);var n=m("dashboard.index");this.chart_store={};this.charts_poller_int_id=-1;var a=x.panels["dashboard"].panel;if(a){var r=a.layout().scene().find(".pg-panel-content");if(r){var l=function i(){h.ajax({url:n,type:"GET",dataType:"html"}).done(function(e){h(r).html(e)}).fail(function(e,t){f.pgNotifier(t,e,g("An error occurred whilst loading the dashboard."),function(e){if(e==="CRYPTKEY_SET"){i()}else{h(r).html('<div class="alert alert-danger pg-panel-message" role="alert">'+g("An error occurred whilst loading the dashboard.")+"</div>")}})})};h(r).html('<div class="alert alert-info pg-panel-message" role="alert">'+g("Loading dashboard...")+"</div>");l();h(a).data("sid",-1);h(a).data("did",-1)}}},object_disconnected:function e(){var t=x.tree.selected(),i=t&&x.tree.itemData(t);if(t.length!=0){this.object_selected(t,i,x.Nodes[i._type])}},object_selected:function e(t,i,n){var a=this;if(C===false){if(!b.isUndefined(i.connected)&&i.connected!==true){a.clearChartFromStore()}}else if(i&&i._type){var r=n.getTreeNodeHierarchy(t),l=y.url(i,t,r);if(l===null){l=m("dashboard.index");a.version=r.server&&r.server.version||0;N=l+"cancel_query/";S=l+"terminate_session/";var o=r["server"];T=o&&o.db||null;if(o&&o.user&&o.user.is_superuser){k=true}else{k=false;D=o&&o.user?o.user.name:null}if("database"in r){a.sid=r.server._id;a.did=r.database._id;j=false;M=true;l+=a.sid+"/"+a.did;N+=a.sid+"/"+a.did+"/";S+=a.sid+"/"+a.did+"/"}else if("server"in r){a.sid=r.server._id;a.did=-1;j=true;M=false;l+=a.sid;N+=a.sid+"/";S+=a.sid+"/"}else{j=M=false}}else{j=M=false}var s=x.panels["dashboard"].panel;if(s){var d=s.layout().scene().find(".pg-panel-content");if(d){if(i.connected||b.isUndefined(i.connected)){if(l!==h(s).data("dashboard_url")||l===h(s).data("dashboard_url")&&h(s).data("server_status")==false){h(d).empty();a.clearChartFromStore();var c=function i(){h.ajax({url:l,type:"GET",dataType:"html"}).done(function(e){h(d).html(e);a.init_dashboard()}).fail(function(e,t){f.pgNotifier(t,e,g("An error occurred whilst loading the dashboard."),function(e){if(e==="CRYPTKEY_SET"){i()}else{h(d).html('<div class="alert alert-danger pg-panel-message" role="alert">'+g("An error occurred whilst loading the dashboard.")+"</div>")}})})};h(d).html('<div class="alert alert-info pg-panel-message" role="alert">'+g("Loading dashboard...")+"</div>");c();h(s).data("server_status",true)}}else{h(d).empty();if(!b.isUndefined(i.connected)&&i.connected!==true){a.clearChartFromStore()}h(d).html('<div class="alert alert-info pg-panel-message" role="alert">'+g("Please connect to the selected server to view the dashboard.")+"</div>");h(s).data("server_status",false)}h(s).data("dashboard_url",l)}}}},renderCharts:function e(t){var n=this,a=function e(t,i){return"Seconds ago: ".concat(parseInt(i.x*t),"</br>\n                  Value: ").concat(i.y)},r=w.getEpoch();n.stopChartsPoller();t.map(function(e){if(n.chart_store[e.chart_name]&&n.old_preferences[e.refresh_pref_name]!=n.preferences[e.refresh_pref_name]){n.clearChartFromStore(e.chart_name)}if(n.chart_store[e.chart_name]){var t=n.chart_store[e.chart_name].chart_obj;t.setOptions(e.options,false);t.setTooltipFormatter(a.bind(null,n.preferences[e.refresh_pref_name]))}if(!n.chart_store[e.chart_name]){var i=new l.Chart(e.container,e.options);i.setTooltipFormatter(a.bind(null,n.preferences[e.refresh_pref_name]));i.setOtherData("counter",e.counter);n.chart_store[e.chart_name]={chart_obj:i,refresh_on:r,refresh_rate:n.preferences[e.refresh_pref_name]}}});n.startChartsPoller(n.chart_store,n.sid,n.did)},getStatsUrl:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var a=m("dashboard.dashboard_stats");a+="/"+t;a+=i>0?"/"+i:"";a+="?chart_names="+n.join(",");return a},updateChart:function e(t,n){var a=t.getOtherData("dataset")||[],r=t.getOtherData("counter_prev_data")||n,l=t.getOtherData("counter")||false;if(a.length==0){for(var i in n){a.push({data:[[0,l?n[i]-r[i]:n[i]]],label:i})}}else{Object.keys(n).map(function(e,t){if(!l){a[t]["data"].unshift([0,n[e]])}else{if(b.isUndefined(r))return;a[t]["data"].unshift([0,n[e]-r[e]])}for(var i=0;i<a[t]["data"].length;i++){a[t]["data"][i][0]=i}});r=n}for(var o=0;o<a.length;o++){if(a[o]["data"].length>101){a[o]["data"].pop()}}t.setOtherData("dataset",a);t.setOtherData("counter_prev_data",r);if(t.isInPage()){if(t.isVisible()){t.draw(a)}}else{return}},stopChartsPoller:function e(){clearInterval(this.charts_poller_int_id)},startChartsPoller:function e(l,r,o){var s=this;var t=w.getGCD(Object.values(l).map(function(e){return e.refresh_rate}));var d=3;var c=0;s.stopChartsPoller();var i=function e(){var t=w.getEpoch();var i=[];for(var n in l){if(l[n].refresh_on<=t){l[n].refresh_on=t+l[n].refresh_rate;i.push(n)}}if(i.length==0||c>0){c--;return}var a=s.getStatsUrl(r,o,i);h.ajax({url:a,type:"GET"}).done(function(e){c=0;for(var t in e){var i=l[t].chart_obj;h(i.getContainer()).removeClass("graph-error");s.updateChart(i,e[t])}}).fail(function(e){c=0;var t="";var i="";var n="info";if(e.readyState===0){i=g("Not connected to the server or the connection to the server has been closed.")}else{t=JSON.parse(e.responseText);i=t.errormsg;if(e.status===428){if(b.isUndefined(i)||b.isNull(i)){i=g("Please connect to the selected server to view the graph.")}}else{i=g("An error occurred whilst rendering the graph.");n="danger"}}for(var a in l){var r=l[a].chart_obj;h(r.getContainer()).addClass("graph-error");h(r.getContainer()).html('<div class="alert alert-'+n+' pg-panel-message" role="alert">'+i+"</div>")}});c=d};i();s.charts_poller_int_id=setInterval(i,t*1e3)},add_new_server:function e(){if(x&&x.tree){var t=x.tree.selected().length!=0?x.tree.selected():x.tree.first(null,false),i=a(58),n=x.tree.itemData(t);while(n&&n._type!="server_group"){t=x.tree.next(t);n=x.tree.itemData(t)}if(!n){return}if(i){i.callbacks.show_obj_properties.apply(i,[{action:"create"},t])}}},render_grid:function e(t,i,n){var a=u.Model.extend({}),r=this;var l=i+r.sid;if(r.did!=-1){l+="/"+r.did}var o=u.Collection.extend({model:a,url:l,mode:"client"});var s=new o;var d=new p.Grid({emptyText:"No data found",columns:n,collection:s,className:"backgrid presentation table table-bordered table-noouter-border table-hover"});h(t).empty();h(t).append(d.render().el);var c=new p.Extension.ClientSideFilter({collection:s});c.setCustomSearchBox(h("#txtGridSearch"));h(t).data("data",s);h(t).data("grid",d);h(t).data("filter",c)},render_grid_data:function e(l){var o=h(l).data("data"),t=h(l).data("grid"),s=h(l).data("filter");if(b.isUndefined(o)){return null}o.fetch({reset:true,success:function e(){if(h(l).hasClass("grid-error")){h(l).removeClass("grid-error");h(l).html(t.render().el);h(s.el).show()}s.search()},error:function e(t,i){var n="";var a="";var r="info";if(i.readyState===0){a=g("Not connected to the server or the connection to the server has been closed.")}else{n=JSON.parse(i.responseText);a=n.errormsg;if(i.status===428){if(b.isUndefined(a)||b.isNull(a)){a=g("Please connect to the selected server to view the table.")}}else{a=g("An error occurred whilst rendering the table.");r="danger"}}if(!h(l).hasClass("grid-error")){h(s.el).hide();h(l).addClass("grid-error")}h(l).html('<div class="alert alert-'+r+' pg-panel-message" role="alert">'+a+"</div>");setTimeout(function(){_.Dashboard.render_grid_data(l,o)},5e3)}})},clearChartFromStore:function e(t){var i=this;if(!t){i.stopChartsPoller();b.each(i.chart_store,function(e,t){delete i.chart_store[t]})}else{delete i.chart_store[t]}},init_dashboard:function e(){var t=this;var i=setInterval(function(){try{if(window.top.pgAdmin.Browser.preference_version()>0){clearInterval(i);t.reflectPreferences()}}catch(e){clearInterval(i);throw e}},0);x.onPreferencesChange("dashboards",function(){t.reflectPreferences()})},reflectPreferences:function e(){var t=this;if(t.preferences){t.old_preferences=t.preferences;t.preferences=window.top.pgAdmin.Browser.get_preferences_for_module("dashboards")}else{t.preferences=window.top.pgAdmin.Browser.get_preferences_for_module("dashboards");t.old_preferences=t.preferences}if(j||M){var i=h(".dashboard-container").find("#graph-sessions")[0];var n=h(".dashboard-container").find("#graph-tps")[0];var a=h(".dashboard-container").find("#graph-ti")[0];var r=h(".dashboard-container").find("#graph-to")[0];var l=h(".dashboard-container").find("#graph-bio")[0];var o={parseFloat:false,xaxis:{min:100,max:0,autoscale:0},yaxis:{autoscale:1}};if(t.preferences.graph_data_points){o=s({},o,{points:{show:true,radius:1,hitRadius:3}})}if(t.preferences.graph_mouse_track){o=s({},o,{mouse:{track:true,position:"sw"}})}if(t.preferences.show_graphs&&h("#dashboard-graphs").hasClass("dashboard-hidden")){h("#dashboard-graphs").removeClass("dashboard-hidden")}else if(!t.preferences.show_graphs){h("#dashboard-graphs").addClass("dashboard-hidden");t.clearChartFromStore()}if(t.preferences.show_activity&&h("#dashboard-activity").hasClass("dashboard-hidden")){h("#dashboard-activity").removeClass("dashboard-hidden")}else if(!t.preferences.show_activity){h("#dashboard-activity").addClass("dashboard-hidden")}if(t.preferences.show_graphs){_.Dashboard.renderCharts([{chart_name:"session_stats",container:i,options:o,counter:false,refresh_pref_name:"session_stats_refresh"},{chart_name:"tps_stats",container:n,options:o,counter:true,refresh_pref_name:"tps_stats_refresh"},{chart_name:"ti_stats",container:a,options:o,counter:true,refresh_pref_name:"ti_stats_refresh"},{chart_name:"to_stats",container:r,options:o,counter:true,refresh_pref_name:"to_stats_refresh"},{chart_name:"bio_stats",container:l,options:o,counter:true,refresh_pref_name:"bio_stats_refresh"}])}if(!t.preferences.show_graphs&&!t.preferences.show_activity){h("#dashboard-none-show").removeClass("dashboard-hidden")}else{h("#dashboard-none-show").addClass("dashboard-hidden")}if(j){t.reflectPreferencesServer()}else if(M){t.reflectPreferencesDatabase()}}},reflectPreferencesServer:function e(){var t=this;var i=h(".dashboard-container");var n=i.find("#server_activity").get(0);var a=i.find("#server_locks").get(0);var r=i.find("#server_prepared").get(0);var l=i.find("#server_config").get(0);var o={tab_server_activity:n,tab_server_locks:a,tab_server_prepared:r,tab_server_config:l};if(t.preferences.show_activity){var s=[{name:"pid",label:g("PID"),editable:false,cell:"string"},{name:"datname",label:g("Database"),editable:false,cell:"string"},{name:"usename",label:g("User"),editable:false,cell:"string"},{name:"application_name",label:g("Application"),editable:false,cell:"string"},{name:"client_addr",label:g("Client"),editable:false,cell:"string"},{name:"backend_start",label:g("Backend start"),editable:false,cell:"string"},{name:"state",label:g("State"),editable:false,cell:"string"}];if(t.version<90600){s=s.concat([{name:"waiting",label:g("Waiting?"),editable:false,cell:"string"}])}else{s=s.concat([{name:"wait_event",label:g("Wait event"),editable:false,cell:"string"},{name:"blocking_pids",label:g("Blocking PIDs"),editable:false,cell:"string"}])}var d=new P;var c=v.generateViewSchema(null,d,"create",null,null,true);b.each(c[0].fields,function(e){e["version"]=t.version});s.unshift({name:"pg-backform-expand",label:"",cell:E,cell_priority:-1,postgres_version:t.version,schema:c});s.unshift({name:"pg-backform-delete",label:"",cell:O,cell_action:"cancel",editable:false,cell_priority:-1,canDeleteRow:_.Dashboard.can_take_action,postgres_version:t.version});s.unshift({name:"pg-backform-delete",label:"",cell:O,cell_action:"terminate",editable:false,cell_priority:-1,canDeleteRow:_.Dashboard.can_take_action,postgres_version:t.version});var u=[{name:"pid",label:g("PID"),editable:false,cell:"string"},{name:"datname",label:g("Database"),editable:false,cell:"string"},{name:"locktype",label:g("Lock type"),editable:false,cell:"string"},{name:"relation",label:g("Target relation"),editable:false,cell:"string"},{name:"page",label:g("Page"),editable:false,cell:"string"},{name:"tuple",label:g("Tuple"),editable:false,cell:"string"},{name:"virtualxid",label:g("vXID (target)"),editable:false,cell:"string"},{name:"transactionid",label:g("XID (target)"),editable:false,cell:"string"},{name:"classid",label:g("Class"),editable:false,cell:"string"},{name:"objid",label:g("Object ID"),editable:false,cell:"string"},{name:"virtualtransaction",label:g("vXID (owner)"),editable:false,cell:"string"},{name:"mode",label:g("Mode"),editable:false,cell:"string"},{name:"granted",label:g("Granted?"),editable:false,cell:"string"}];var p=[{name:"git",label:g("Name"),editable:false,cell:"string"},{name:"database",label:g("Database"),editable:false,cell:"string"},{name:"Owner",label:g("Owner"),editable:false,cell:"string"},{name:"transaction",label:g("XID"),editable:false,cell:"string"},{name:"prepared",label:g("Prepared at"),editable:false,cell:"string"}];var f=[{name:"name",label:g("Name"),editable:false,cell:"string"},{name:"category",label:g("Category"),editable:false,cell:"string"},{name:"setting",label:g("Setting"),editable:false,cell:"string"},{name:"unit",label:g("Unit"),editable:false,cell:"string"},{name:"short_desc",label:g("Description"),editable:false,cell:"string"}];h(n).addClass("pg-el-container");h(n).attr("el","sm");_.Dashboard.render_grid(n,m("dashboard.activity"),s);_.Dashboard.render_grid(a,m("dashboard.locks"),u);_.Dashboard.render_grid(r,m("dashboard.prepared"),p);_.Dashboard.render_grid(l,m("dashboard.config"),f);_.Dashboard.render_grid_data(n);h('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=o[h(e.relatedTarget).attr("aria-controls")];h(t).data("filtertext",h("#txtGridSearch").val());var i=o[h(e.target).attr("aria-controls")];h("#txtGridSearch").val(h(i).data("filtertext"));_.Dashboard.render_grid_data(i)});h("#btn_refresh").off("click").on("click",function(){var e=o[h("#dashboard-activity .nav-tabs .active").attr("aria-controls")];_.Dashboard.render_grid_data(e)})}},reflectPreferencesDatabase:function e(){var t=this;var i=document.getElementById("database_activity");var n=document.getElementById("database_locks");var a=document.getElementById("database_prepared");var r={tab_database_activity:i,tab_database_locks:n,tab_database_prepared:a};if(t.preferences.show_activity){var l=[{name:"pid",label:g("PID"),editable:false,cell:"string"},{name:"usename",label:g("User"),editable:false,cell:"string"},{name:"application_name",label:g("Application"),editable:false,cell:"string"},{name:"client_addr",label:g("Client"),editable:false,cell:"string"},{name:"backend_start",label:g("Backend start"),editable:false,cell:"string"},{name:"state",label:g("State"),editable:false,cell:"string"}];if(t.version<90600){l=l.concat([{name:"waiting",label:g("Waiting?"),editable:false,cell:"string"}])}else{l=l.concat([{name:"wait_event",label:g("Wait event"),editable:false,cell:"string"},{name:"blocking_pids",label:g("Blocking PIDs"),editable:false,cell:"string"}])}var o=new P;var s=v.generateViewSchema(null,o,"create",null,null,true);b.each(s[0].fields,function(e){e["version"]=t.version});l.unshift({name:"pg-backform-expand",label:"",cell:E,cell_priority:-1,postgres_version:t.version,schema:s});l.unshift({name:"pg-backform-delete",label:"",cell:O,cell_action:"cancel",editable:false,cell_priority:-1,canDeleteRow:_.Dashboard.can_take_action,postgres_version:t.version});l.unshift({name:"pg-backform-delete",label:"",cell:O,cell_action:"terminate",editable:false,cell_priority:-1,canDeleteRow:_.Dashboard.can_take_action,postgres_version:t.version});var d=[{name:"pid",label:g("PID"),editable:false,cell:"string"},{name:"locktype",label:g("Lock type"),editable:false,cell:"string"},{name:"relation",label:g("Target relation"),editable:false,cell:"string"},{name:"page",label:g("Page"),editable:false,cell:"string"},{name:"tuple",label:g("Tuple"),editable:false,cell:"string"},{name:"virtualxid",label:g("vXID (target)"),editable:false,cell:"string"},{name:"transactionid",label:g("XID (target)"),editable:false,cell:"string"},{name:"classid",label:g("Class"),editable:false,cell:"string"},{name:"objid",label:g("Object ID"),editable:false,cell:"string"},{name:"virtualtransaction",label:g("vXID (owner)"),editable:false,cell:"string"},{name:"mode",label:g("Mode"),editable:false,cell:"string"},{name:"granted",label:g("Granted?"),editable:false,cell:"string"}];var c=[{name:"git",label:g("Name"),editable:false,cell:"string"},{name:"Owner",label:g("Owner"),editable:false,cell:"string"},{name:"transaction",label:g("XID"),editable:false,cell:"string"},{name:"prepared",label:g("Prepared at"),editable:false,cell:"string"}];h(i).addClass("pg-el-container");h(i).attr("el","sm");_.Dashboard.render_grid(i,m("dashboard.activity"),l);_.Dashboard.render_grid(n,m("dashboard.locks"),d);_.Dashboard.render_grid(a,m("dashboard.prepared"),c);_.Dashboard.render_grid_data(i);h('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=r[h(e.relatedTarget).attr("aria-controls")];h(t).data("filtertext",h("#txtGridSearch").val());var i=r[h(e.target).attr("aria-controls")];h("#txtGridSearch").val(h(i).data("filtertext"));_.Dashboard.render_grid_data(i)});h("#btn_refresh").off("click").on("click",function(){var e=r[h("#dashboard-activity .nav-tabs .active").attr("aria-controls")];_.Dashboard.render_grid_data(e)})}},toggleVisibility:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;C=t;if(i){this.clearChartFromStore()}},can_take_action:function e(t){var i=t.collection.where({state:"active"}),n=this.get("postgres_version")||null,a=this.get("cell_action")||null,r=a==="cancel",l=r?g("cancel"):g("terminate");if(n&&n>=1e5&&!t.get("datname")){f.info(g("You cannot ")+l+g(" background worker processes."));return false}else if(T==t.get("datname")&&t.get("state")=="active"&&i.length==1){f.error(g("You are not allowed to ")+l+g(" the main active session."));return false}else if(r&&t.get("state")=="idle"){f.info(g("The session is already in idle state."));return false}else if(k){return true}else if(D&&D==t.get("usename")){return true}else{f.error(g("Superuser privileges are required to ")+l+g(" another users query."));return false}}};return _.Dashboard}.apply(t,i),n!==undefined&&(e.exports=n))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Chart=void 0;var n=a(i(207));function a(e){return e&&e.__esModule?e:{default:e}}function r(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};var n=Object.keys(i);if(typeof Object.getOwnPropertySymbols==="function"){n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))}n.forEach(function(e){l(t,e,i[e])})}return t}function l(e,t,i){if(t in e){Object.defineProperty(e,t,{value:i,enumerable:true,configurable:true,writable:true})}else{e[t]=i}return e}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function d(e,t,i){if(t)s(e.prototype,t);if(i)s(e,i);return e}var c=function(){function i(e,t){o(this,i);this.chartApi=n.default;this._container=e;this._options={};this._defaultOptions={legend:{position:"nw",backgroundColor:"#D2E8FF"},lines:{show:true,lineWidth:2},shadowSize:0,resolution:3};this._dataset=null;this._tooltipFormatter=null;this._otherData={};this.setOptions(t)}d(i,[{key:"getContainer",value:function e(){return this._container}},{key:"getContainerDimensions",value:function e(){return{height:this._container.clientHeight,width:this._container.clientWidth}}},{key:"getOptions",value:function e(){return this._options}},{key:"setOptions",value:function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(i){this._options=r({},this._defaultOptions,this._options,t)}else{this._options=r({},this._defaultOptions,t)}}},{key:"removeOptions",value:function e(t){if(this._options[t]){delete this._options[t]}}},{key:"getOtherData",value:function e(t){if(this._otherData[t]){return this._otherData[t]}}},{key:"setOtherData",value:function e(t,i){this._otherData[t]=i}},{key:"isVisible",value:function e(){var t=this.getContainerDimensions();return t.height>0&&t.width>0}},{key:"isInPage",value:function e(){return this._container===document.body?false:document.body.contains(this._container)}},{key:"setTooltipFormatter",value:function e(t){var i=this.getOptions();this._tooltipFormatter=t;if(this._tooltipFormatter){this.setOptions({mouse:r({},i.mouse,{trackFormatter:this._tooltipFormatter})})}}},{key:"draw",value:function e(t){this._dataset=t;if(this._container){n.default.draw(this._container,this._dataset,this._options)}}}]);return i}();t.Chart=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.url=a;var l=i(18);var o=n(i(5));function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,a){var i=o.default.treeMenu.findNodeByDomElement(t);var r=null;if(i){i.anyFamilyMember(function(e){var t=e.getData();var i=o.default.Nodes[t._type];var n=i&&i.dashboard;if((0,l.isFunction)(n)){n=n.apply(i,[e,t,a])}r=(0,l.isString)(n)?n:null;return r!==null})}return r}},function(e,t){e.exports=o},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(1),i(8),i(0),i(9),i(3),i(5),i(12),i(17),i(110),i(111)],a=function(h,b,_,v,i,y,w,x,C,s,N){if(w.NodeStatistics)return w.NodeStatistics;w.NodeStatistics=w.NodeStatistics||{};if(w.NodeStatistics.initialized){return w.NodeStatistics}var d=x.SizeFormatter=function(){};b.extend(d.prototype,{fromRaw:function e(t){return s(t)},toRaw:function e(t){return t}});var e=x.Extension.SwitchCell.extend({defaults:b.extend({},x.Extension.SwitchCell.prototype.defaults)}),c={16:e,20:x.IntegerCell,21:x.IntegerCell,23:x.IntegerCell,700:x.NumberCell,701:x.NumberCell,1700:x.NumberCell,702:x.DatetimeCell,703:x.DatetimeCell,1082:x.DatetimeCell.extend({includeDate:true,includeTime:false,includeMilli:false}),1083:x.DatetimeCell.extend({includeDate:false,includeTime:true,includeMilli:true}),1114:x.DatetimeCell.extend({includeDate:true,includeTime:true,includeMilli:true}),1184:"string",1266:"string"},S="backgrid presentation table table-bordered table-noouter-border table-hover",k=window.wcDocker;b.extend(e.prototype.defaults.options,{onText:h("True"),offText:h("False"),onColor:"success",offColor:"primary",size:"mini"});b.extend(w.NodeStatistics,{init:function e(){if(this.initialized){return}this.initialized=true;b.bindAll(this,"showStatistics","panelVisibilityChanged","__createMultiLineStatistics","__createSingleLineStatistics","__loadMoreRows");b.extend(this,{initialized:true,collection:new i.Collection(null),statistic_columns:[{editable:false,name:"statistics",label:h("Statistics"),cell:"string",headerCell:x.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_25"},{editable:false,name:"value",label:h("Value"),cell:"string"}],panel:w.docker.findPanels("statistics"),columns:null,grid:null});var t=this;w.Events.on("pgadmin-browser:panel-statistics:"+k.EVENT.VISIBILITY_CHANGED,this.panelVisibilityChanged);w.Events.on("pgadmin:browser:node:updated",function(){if(this.panel&&this.panel.length){v(this.panel[0]).data("node-prop","");this.panelVisibilityChanged(this.panel[0])}},this);if(this.panel.length==0){w.Events.on("pgadmin-browser:panel-statistics:"+k.EVENT.INIT,function(){t.panel=w.docker.findPanels("statistics");if(t.panel[0].isVisible()||t.panel.length!=1){w.Events.on("pgadmin-browser:tree:selected",this.showStatistics);w.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this)}}.bind(this))}else{if(t.panel[0].isVisible()||t.panel.length!=1){w.Events.on("pgadmin-browser:tree:selected",this.showStatistics);w.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this)}}if(t.panel.length>0&&t.panel[0].isVisible()){w.Events.on("pgadmin-browser:tree:selected",this.showStatistics);w.Events.on("pgadmin-browser:tree:refreshing",this.refreshStatistics,this)}},__updateCollection:function e(t,i,r,n){var a=this.panel[0].layout().scene().find(".pg-panel-content"),l=a.find(".pg-panel-statistics-message"),o=a.find(".pg-panel-statistics-container"),s=this.panel,d=this,c="",u=n;if(i){c=h("No statistics are available for the selected object.");var p=i.getTreeNodeHierarchy(r);var f={node_type:n,url:t};if(b.isEqual(v(s[0]).data("node-prop"),f)){return}v(s[0]).data("node-prop",f);if(N.nodeHasStatistics(i,r)){c="";var m;var g=function a(){v.ajax({url:t,type:"GET",beforeSend:function e(t){t.setRequestHeader(y.csrf_token_header,y.csrf_token);m=setTimeout(function(){l.text(h("Retrieving data from the server..."));l.removeClass("d-none");if(d.grid){d.grid.remove()}},1e3)}}).done(function(e){clearTimeout(m);l.text("");if(e.data){var t=d.data=e.data;if(i.hasCollectiveStatistics||t["rows"].length>1){w.Events.on("pgadmin-browser:panel-statistics:"+k.EVENT.SCROLLED,d.__loadMoreRows);d.__createMultiLineStatistics.call(d,t,i.statsPrettifyFields)}else{w.Events.off("pgadmin-browser:panel-statistics:"+k.EVENT.SCROLLED,d.__loadMoreRows);d.__createSingleLineStatistics.call(d,t,i.statsPrettifyFields)}if(d.grid){delete d.grid;d.grid=null}d.grid=new x.Grid({emptyText:"No data found",columns:d.columns,collection:d.collection,className:S});d.grid.render();o.empty();o.append(d.grid.$el);if(!l.hasClass("d-none")){l.addClass("d-none")}o.removeClass("d-none")}else if(e.info){if(!o.hasClass("d-none")){o.addClass("d-none")}l.text(e.info);l.removeClass("d-none")}}).fail(function(e,t,i){var n=p[u].label;w.Events.trigger("pgadmin:node:retrieval:error","statistics",e,t,i,r);if(!C.pgHandleItemError(e,t,i,{item:r,info:p})){C.pgNotifier(t,e,_(h("Error retrieving the information - %s")).sprintf(i||n).value(),function(e){if(e==="CRYPTKEY_SET"){a()}else{console.warn(arguments)}})}l.text(h("Failed to retrieve data from the server."))})};g()}}if(c!=""){if(!o.hasClass("d-none"))o.addClass("d-none");l.removeClass("d-none");l.text(c)}},refreshStatistics:function e(t,i,n){var a=this,r={node_type:i._type,url:n.generate_url(t,"stats",i,true)};if(b.isEqual(v(a.panel[0]).data("node-prop"),r)){v(a.panel[0]).data("node-prop","");a.showStatistics(t,i,n)}},showStatistics:function e(t,i,n){var a=this;if(!n){return}if(n){if(a.timeout){clearTimeout(a.timeout)}a.timeout=setTimeout(function(){a.__updateCollection.call(a,n.generate_url(t,"stats",i,true),n,t,i._type)},400)}},__createMultiLineStatistics:function e(t,i){var n=t["rows"],a=t["columns"];this.columns=[];for(var r in a){var l=a[r],o=c[l["type_code"]]||"string";if(l["name"]=="PID"){o=o.extend({orderSeparator:""})}var s={editable:false,name:l["name"],cell:o};if(b.indexOf(i,l["name"])!=-1){s["formatter"]=d}this.columns.push(s)}this.collection.reset(n.splice(0,50))},__loadMoreRows:function e(){var t=v(".pg-panel-statistics-container").closest(".wcFrameCenter")[0];if(t.scrollHeight-10<t.scrollTop+t.offsetHeight){var i=this.data["rows"];if(i.length>0){this.collection.add(i.splice(0,50))}}},__createSingleLineStatistics:function e(t,i){var n=t["rows"][0],a=t["columns"],r=[],l;this.columns=this.statistic_columns;for(var o in a){l=a[o]["name"];r.push({statistics:l,value:n&&n[l]?b.indexOf(i,l)!=-1?s(n[l]):n[l]:null})}this.collection.reset(r)},panelVisibilityChanged:function e(t){if(t.isVisible()){var i=w.tree,n=i.selected(),a=n&&i.itemData(n),r=n&&a&&w.Nodes[a._type];w.NodeStatistics.showStatistics.apply(w.NodeStatistics,[n,a,r]);w.Events.on("pgadmin-browser:tree:selected",w.NodeStatistics.showStatistics);w.Events.on("pgadmin-browser:tree:refreshing",w.NodeStatistics.refreshStatistics,this)}else{w.Events.off("pgadmin-browser:tree:selected",w.NodeStatistics.showStatistics);w.Events.off("pgadmin-browser:tree:refreshing",w.NodeStatistics.refreshStatistics,this)}}});return w.NodeStatistics}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[],a=function(){var e=function e(t){var i=Math.abs(t),n=10*1024,a=n-1,r=0,l=["bytes","kB","MB","GB","TB","PB"];if(i<n)return i+" "+l[r];else{do{i=i/1024;r+=1}while(i>a);return Math.round(i)+" "+l[r]}};return e}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.nodeHasStatistics=n;function n(e,t){if(typeof e.hasStatistics==="function"){var i=e.getTreeNodeHierarchy(t);return e.hasStatistics(i)}return e.hasStatistics}},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(1),i(8),i(0),i(9),i(3),i(5),i(10),i(12)],a=function(m,n,g,h,i,b,_,v,a){if(_.NodeDependencies)return _.NodeDependencies;var y=window.wcDocker;_.NodeDependencies=_.NodeDependencies||{};n.extend(_.NodeDependencies,{init:function e(){if(this.initialized){return}this.initialized=true;this.dependenciesPanel=_.docker.findPanels("dependencies")[0];n.bindAll(this,"showDependencies","__loadMoreRows","__appendGridToPanel");var t=i.Model.extend({defaults:{icon:"icon-unknown",type:undefined,name:undefined,field:undefined},parse:function e(t){var i=_.Nodes[t.type];t.icon=i?n.isFunction(i["node_image"])?i["node_image"].apply(i,[null,null]):i["node_image"]||"icon-"+t.type:"icon-"+t.type;t.type=g.titleize(t.type.replace(/_/g," "),true);return t}});this.dependenciesCollection=new(i.Collection.extend({model:t}))(null);_.Events.on("pgadmin-browser:tree:selected",this.showDependencies);this.__appendGridToPanel()},__appendGridToPanel:function e(){var t=this.dependenciesPanel.layout().scene().find(".pg-panel-content"),i=t.find(".pg-panel-dependencies-container"),n=new a.Grid({emptyText:"No data found",columns:[{name:"type",label:m("Type"),cell:a.Cell.extend({render:function e(){a.Cell.prototype.render.apply(this,arguments);this.$el.prepend(h("<i>",{class:"wcTabIcon "+this.model.get("icon")}));return this}}),editable:false},{name:"name",label:m("Name"),cell:"string",editable:false},{name:"field",label:"",cell:"string",editable:false}],collection:this.dependenciesCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});this.dependenciesGrid=n;i.append(n.render().el);return true},showDependencies:function e(a,r,l){var o=this,i=m("Please select an object in the tree view."),t=this.dependenciesPanel,n=t.layout().scene().find(".pg-panel-content"),s=n.find(".pg-panel-depends-message"),d=n.find(".pg-panel-dependencies-container"),c=l.getTreeNodeHierarchy(a),u=r._type,p=l.generate_url(a,"dependency",r,true);if(l){i=m("No dependency information is available for the selected object.");if(l.hasDepends){this.dependenciesGrid.columns.models[2].set({label:m("Restriction")});s.addClass("d-none");d.removeClass("d-none");var f="";h.ajax({url:p,type:"GET",beforeSend:function e(t){t.setRequestHeader(b.csrf_token_header,b.csrf_token);f=setTimeout(function(){s.text(m("Fetching dependency information from the server..."));s.removeClass("d-none");i=""},1e3)}}).done(function(e){clearTimeout(f);if(e.length>0){if(!s.hasClass("d-none")){s.addClass("d-none")}d.removeClass("d-none");o.dependenciesData=e;o.dependenciesCollection.reset(o.dependenciesData.splice(0,100),{parse:true});_.Events.on("pgadmin-browser:panel-dependencies:"+y.EVENT.SCROLLED,o.__loadMoreRows)}else{_.Events.off("pgadmin-browser:panel-dependencies:"+y.EVENT.SCROLLED);o.dependenciesCollection.reset({silent:true});s.text(i);s.removeClass("d-none");if(!d.hasClass("d-none")){d.addClass("d-none")}}}).fail(function(e,t,i){var n=c[u].label;_.Events.trigger("pgadmin:node:retrieval:error","depends",e,t,i);if(!v.pgHandleItemError(e,t,i,{item:a,info:c})){v.pgNotifier(t,e,g(m("Error retrieving data from the server: %s")).sprintf(i||n).value(),function(e){if(e==="CRYPTKEY_SET"){o.showDependencies(a,r,l)}else{console.warn(arguments)}})}s.text(m("Failed to retrieve data from the server."))})}}if(i!=""){s.text(i);s.removeClass("d-none");if(!d.hasClass("d-none")){d.addClass("d-none")}}},__loadMoreRows:function e(){if(this.dependenciesPanel.length<1)return;var t=this.dependenciesPanel.$container.find(".pg-panel-dependencies-container").closest(".wcFrameCenter")[0];if(t.scrollHeight-10<t.scrollTop+t.offsetHeight){if(this.dependenciesData.length>0){this.dependenciesCollection.add(this.dependenciesData.splice(0,100),{parse:true})}}}});return _.NodeDependencies}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(1),i(8),i(0),i(9),i(3),i(5),i(10),i(12)],a=function(m,n,g,h,i,b,_,v,a){if(_.NodeDependents)return _.NodeDependents;var y=window.wcDocker;_.NodeDependents=_.NodeDependents||{};n.extend(_.NodeDependents,{init:function e(){if(this.initialized){return}this.initialized=true;this.dependentsPanel=_.docker.findPanels("dependents")[0];n.bindAll(this,"showDependents","__loadMoreRows","__appendGridToPanel");var t=i.Model.extend({defaults:{icon:"icon-unknown",type:undefined,name:undefined,field:undefined},parse:function e(t){var i=_.Nodes[t.type];t.icon=i?n.isFunction(i["node_image"])?i["node_image"].apply(i,[null,null]):i["node_image"]||"icon-"+t.type:"icon-"+t.type;t.type=g.titleize(t.type.replace(/_/g," "),true);return t}});this.dependentCollection=new(i.Collection.extend({model:t}))(null);_.Events.on("pgadmin-browser:tree:selected",this.showDependents);_.Events.on("pgadmin-browser:tree:refreshing",this.refreshDependents,this);this.__appendGridToPanel()},__appendGridToPanel:function e(){var t=this.dependentsPanel.layout().scene().find(".pg-panel-content"),i=t.find(".pg-panel-dependents-container"),n=new a.Grid({emptyText:"No data found",columns:[{name:"type",label:m("Type"),cell:a.Cell.extend({render:function e(){a.Cell.prototype.render.apply(this,arguments);this.$el.prepend(h("<i>",{class:"wcTabIcon "+this.model.get("icon")}));return this}}),editable:false},{name:"name",label:m("Name"),cell:"string",editable:false},{name:"field",label:"",cell:"string",editable:false}],collection:this.dependentCollection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});this.dependentGrid=n;i.append(n.render().el);return true},showDependents:function e(a,r,l){var o=this,i=m("Please select an object in the tree view."),t=this.dependentsPanel,n=t.layout().scene().find(".pg-panel-content"),s=n.find(".pg-panel-depends-message"),d=n.find(".pg-panel-dependents-container"),c=l.getTreeNodeHierarchy(a),u=r._type,p=l.generate_url(a,"dependent",r,true);if(l){i=m("No dependent information is available for the selected object.");if(l.hasDepends){if(l.type=="tablespace"||l.type=="role"){this.dependentGrid.columns.models[2].set({label:m("Database")})}else{this.dependentGrid.columns.models[2].set({label:m("Restriction")})}s.addClass("d-none");d.removeClass("d-none");var f="";h.ajax({url:p,type:"GET",beforeSend:function e(t){t.setRequestHeader(b.csrf_token_header,b.csrf_token);f=setTimeout(function(){s.text(m("Fetching dependent information from the server..."));s.removeClass("d-none");i=""},1e3)}}).done(function(e){clearTimeout(f);if(e.length>0){if(!s.hasClass("d-none")){s.addClass("d-none")}d.removeClass("d-none");o.dependentData=e;o.dependentCollection.reset(o.dependentData.splice(0,100),{parse:true});_.Events.on("pgadmin-browser:panel-dependents:"+y.EVENT.SCROLLED,o.__loadMoreRows)}else{_.Events.off("pgadmin-browser:panel-dependents:"+y.EVENT.SCROLLED);o.dependentCollection.reset({silent:true});s.text(i);s.removeClass("d-none");if(!d.hasClass("d-none")){d.addClass("d-none")}}}).fail(function(e,t,i){var n=c[u].label;_.Events.trigger("pgadmin:node:retrieval:error","depends",e,t,i);if(!v.pgHandleItemError(e,t,i,{item:a,info:c})){v.pgNotifier(t,e,g(m("Error retrieving data from the server: %s")).sprintf(i||n).value(),function(e){if(e==="CRYPTKEY_SET"){o.showDependents(a,r,l)}else{console.warn(arguments)}})}s.text(m("Failed to retrieve data from the server."))})}}if(i!=""){s.text(i);s.removeClass("d-none");if(!d.hasClass("d-none")){d.addClass("d-none")}}},__loadMoreRows:function e(){if(this.dependentsPanel.length<1)return;var t=this.dependentsPanel.$container.find(".pg-panel-dependents-container").closest(".wcFrameCenter")[0];if(t.scrollHeight-10<t.scrollTop+t.offsetHeight){if(this.dependentData.length>0){this.dependentCollection.add(this.dependentData.splice(0,100),{parse:true})}}}});return _.NodeDependents}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(1),i(8),i(0),i(3),i(5),i(10)],a=function(u,p,f,m,g,h,b){h.ShowNodeSQL=h.ShowNodeSQL||{};if(h.ShowNodeSQL.initialized){return h.ShowNodeSQL}var i=window.wcDocker;p.extend(h.ShowNodeSQL,{init:function e(){if(this.initialized){return}this.initialized=true;p.bindAll(this,"showSQL","sqlPanelVisibilityChanged");var t;this.sqlPanels=t=h.docker.findPanels("sql");h.Events.on("pgadmin-browser:panel-sql:"+i.EVENT.VISIBILITY_CHANGED,this.sqlPanelVisibilityChanged);h.Events.on("pgadmin:browser:node:updated",function(){if(this.sqlPanels&&this.sqlPanels.length){m(this.sqlPanels[0]).data("node-prop","");this.sqlPanelVisibilityChanged(this.sqlPanels[0])}},this);if(t.length==0){h.Events.on("pgadmin-browser:panel-sql:"+i.EVENT.INIT,function(){if(t[0].isVisible()||t.length!=1){h.Events.on("pgadmin-browser:tree:selected",this.showSQL);h.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this)}}.bind(this))}else{if(t[0].isVisible()||t.length!=1){h.Events.on("pgadmin-browser:tree:selected",this.showSQL);h.Events.on("pgadmin-browser:tree:refreshing",this.refreshSQL,this)}}},refreshSQL:function e(t,i,n){var a=this,r={node_type:i._type,url:n.generate_url(t,"sql",i,true)};if(p.isEqual(m(a.sqlPanels[0]).data("node-prop"),r)){m(a.sqlPanels[0]).data("node-prop","");a.showSQL(t,i,n)}},showSQL:function e(o,s,d){this.timeout&&clearTimeout(this.timeout);var c=this;this.timeout=setTimeout(function(){var e="-- "+u("Please select an object in the tree view.");if(d){e="-- "+u("No SQL could be generated for the selected object.");var r=s._type,t=d.generate_url(o,"sql",s,true),l=d.getTreeNodeHierarchy(o),i={node_type:r,url:t};if(p.isEqual(m(c.sqlPanels[0]).data("node-prop"),i)){return}m(c.sqlPanels[0]).data("node-prop",i);if(d.hasSQL){e="";var n;var a=function a(){m.ajax({url:t,type:"GET",beforeSend:function e(t){t.setRequestHeader(g.csrf_token_header,g.csrf_token);n=setTimeout(function(){g.Browser.editor.setValue(u("Retrieving data from the server..."))},1e3)}}).done(function(e){if(g.Browser.editor.getValue()!=e){g.Browser.editor.setValue(e)}clearTimeout(n)}).fail(function(e,t,i){var n=l[r].label;h.Events.trigger("pgadmin:node:retrieval:error","sql",e,t,i,o);if(!b.pgHandleItemError(e,t,i,{item:o,info:l})){b.pgNotifier(t,e,f(u("Error retrieving the information - %s")).sprintf(i||n).value(),function(e){if(e==="CRYPTKEY_SET"){a()}else{console.warn(arguments)}})}})};a()}}if(e!=""){g.Browser.editor.setValue(e)}},400)},sqlPanelVisibilityChanged:function e(t){if(t.isVisible()){var i=h.tree,n=i.selected(),a=n&&i.itemData(n),r=n&&a&&h.Nodes[a._type];h.ShowNodeSQL.showSQL.apply(h.ShowNodeSQL,[n,a,r]);h.Events.on("pgadmin-browser:tree:selected",h.ShowNodeSQL.showSQL);h.Events.on("pgadmin-browser:tree:refreshing",h.ShowNodeSQL.refreshSQL,this)}else{h.Events.off("pgadmin-browser:tree:selected",h.ShowNodeSQL.showSQL);h.Events.off("pgadmin-browser:tree:refreshing",h.ShowNodeSQL.refreshSQL,this)}}});return h.ShowNodeSQL}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(3),i(2),i(4),i(1),i(8),i(0),i(5),i(17)],a=function(c,u,i,p,f,m,g,o){g.BackgroundProcessObsorver=g.BackgroundProcessObsorver||{};if(g.BackgroundProcessObsorver.initialized){return g.BackgroundProcessObsorver}var h=window.wcDocker;var r=function e(t,i){var n=this;setTimeout(function(){n.initialize.apply(n,[t,i])},1)};p.extend(r.prototype,{success_status_tpl:p.template('\n      <div class="d-flex px-2 py-1 bg-success-light border border-success rounded">\n        <div class="pr-2">\n          <i class="fa fa-check fa-lg text-success pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),failed_status_tpl:p.template('\n      <div class="d-flex px-2 py-1 bg-danger-lighter border border-danger rounded">\n        <div class="pr-2">\n          <i class="fa fa-close fa-lg text-danger pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),other_status_tpl:p.template('\n      <div class="d-flex px-2 py-1 bg-primary-light border border-primary rounded">\n        <div class="pr-2">\n          <i class="fa fa-info fa-lg text-primary pg-bg-status-icon" aria-hidden="true"></i>\n        </div>\n        <div class="text-body mx-auto pg-bg-status-text"><%-status_text%></div>\n      </div>'),initialize:function e(t,i){p.extend(this,{details:false,notify:p.isUndefined(i)||i,curr_status:null,state:0,completed:false,id:t["id"],type_desc:null,desc:null,detailed_desc:null,stime:null,exit_code:null,acknowledge:t["acknowledge"],execution_time:null,out:-1,err:-1,lot_more:false,notifier:null,container:null,panel:null,logs:m("<ol></ol>",{class:"pg-bg-process-logs"})});if(this.notify){g.Events&&g.Events.on("pgadmin-bgprocess:started:"+this.id,function(e){if(!e.notifier)e.show.apply(e)});g.Events&&g.Events.on("pgadmin-bgprocess:finished:"+this.id,function(e){if(!e.notifier)e.show.apply(e)})}var n=this;setTimeout(function(){n.update.apply(n,[t])},1)},bgprocess_url:function e(t){switch(t){case"status":if(this.details&&this.out!=-1&&this.err!=-1){return i("bgprocess.detailed_status",{pid:this.id,out:this.out,err:this.err})}return i("bgprocess.status",{pid:this.id});case"acknowledge":return i("bgprocess.acknowledge",{pid:this.id});case"stop_process":return i("bgprocess.stop_process",{pid:this.id});default:return i("bgprocess.list")}},update:function e(t){var i=this,n=[],a=[];if("stime"in t)i.stime=new Date(t.stime);if("execution_time"in t)i.execution_time=parseFloat(t.execution_time);if("type_desc"in t)i.type_desc=t.type_desc;if("desc"in t)i.desc=t.desc;if("details"in t)i.detailed_desc=t.details;if("exit_code"in t)i.exit_code=t.exit_code;if("process_state"in t)i.state=t.process_state;if("out"in t){i.out=t.out&&t.out.pos;if(t.out&&t.out.lines){n=t.out.lines}}if("err"in t){i.err=t.err&&t.err.pos;if(t.err&&t.err.lines){a=t.err.lines}}i.completed=i.completed||"err"in t&&"out"in t&&t.err.done&&t.out.done||!i.details&&!p.isNull(i.exit_code);var r=0,l=0,o=[],s=document.createElement("textarea"),d=function e(t){s.textContent=t;return s.innerHTML};while(r<n.length&&l<a.length){if(c.natural_sort(n[r][0],a[l][0])<=0){o.push('<li class="pg-bg-res-out">'+d(n[r++][1])+"</li>")}else{o.push('<li class="pg-bg-res-err">'+d(a[l++][1])+"</li>")}}while(r<n.length){o.push('<li class="pg-bg-res-out">'+d(n[r++][1])+"</li>")}while(l<a.length){o.push('<li class="pg-bg-res-err">'+d(a[l++][1])+"</li>")}if(o.length){i.logs.append(o.join(""));setTimeout(function(){i.logs[0].scrollTop=i.logs[0].scrollHeight})}if(i.stime){i.curr_status=i.other_status_tpl({status_text:u("Started")});if(i.execution_time>=2){i.curr_status=i.other_status_tpl({status_text:u("Running...")})}if(!p.isNull(i.exit_code)){if(i.state===3){i.curr_status=i.failed_status_tpl({status_text:u("Terminated by user.")})}else if(i.exit_code==0){i.curr_status=i.success_status_tpl({status_text:u("Successfully completed.")})}else{i.curr_status=i.failed_status_tpl({status_text:f(u("Failed (exit code: %s).")).sprintf(String(i.exit_code)).value()})}}if(i.state==0&&i.stime){i.state=1;g.Events&&g.Events.trigger("pgadmin-bgprocess:started:"+i.id,i,i)}if(i.state==1&&!p.isNull(i.exit_code)){i.state=2;g.Events&&g.Events.trigger("pgadmin-bgprocess:finished:"+i.id,i,i)}setTimeout(function(){i.show.apply(i)},10)}if(!i.completed){setTimeout(function(){i.status.apply(i)},1e3)}},status:function e(){var t=this;m.ajax({typs:"GET",timeout:3e4,url:t.bgprocess_url("status"),cache:false,async:true,contentType:"application/json"}).done(function(e){setTimeout(function(){t.update(e)},10)}).fail(function(e){if(e.status!=410)setTimeout(function(){t.update(e)},1e4)})},show:function e(){var t=this;if(t.notify&&!t.details){if(!t.notifier){var i=m('\n            <div class="card">\n              <div class="card-header bg-primary d-flex">\n                <div>'.concat(t.type_desc,'</div>\n                <div class="ml-auto">\n                  <button class="btn btn-sm-sq btn-primary pg-bg-close"><i class="fa fa-lg fa-close"></i></button>\n                </div>\n              </div>\n              <div class="card-body px-2">\n                <div class="py-1">').concat(t.desc,'</div>\n                <div class="py-1">').concat(t.stime.toString(),'</div>\n                <div class="d-flex py-1">\n                  <div class="my-auto mr-2">\n                    <span class="fa fa-clock-o fa-2x"></span>\n                  </div>\n                  <div class="pg-bg-etime my-auto mr-2"></div>\n                  <div class="ml-auto">\n                    <button class="btn btn-secondary pg-bg-more-details"><span class="fa fa-info-circle"></span>&nbsp;').concat(u("More details..."),'</button>\n                    <button class="btn btn-danger bg-process-stop"><span class="fa fa-times-circle"></span>&nbsp;').concat(u("Stop Process"),'</button>\n                  </div>\n                </div>\n                <div class="pg-bg-status py-1">\n                </div>\n              </div>\n            </div>\n            '));var n=i.find(".pg-bg-more-details");var a=i.find(".pg-bg-close");t.container=i;t.notifier=o.notify(i.get(0),"bg-bgprocess",0,null);n.on("click",function(e){e=e||window.event;e.cancelBubble=true;e.stopPropagation();this.notifier.dismiss();this.notifier=null;this.completed=false;this.show_detailed_view.apply(this)}.bind(t));a.on("click",function(){this.notifier.dismiss();this.notifier=null;this.acknowledge_server.apply(this)}.bind(this));t.container.on("click",function(e){e=e||window.event;e.cancelBubble=true;e.stopPropagation();return});i.find(".bg-process-stop").off("click").on("click",t.stop_process.bind(this))}t.container.find(".pg-bg-etime").empty().append(m("<span></span>").text(String(t.execution_time))).append(m("<span></span>").text(" "+u("seconds")));var r=m(t.container.find(".pg-bg-status"));r.html(t.curr_status);var l=m(t.container.find(".bg-process-stop"));if(isNaN(parseInt(t.exit_code))){l.attr("disabled",false)}else{l.attr("disabled",true)}}else{t.show_detailed_view.apply(t)}},show_detailed_view:function e(){var t=this,i=this.panel,n=false;if(!t.panel){n=true;i=this.panel=g.BackgroundProcessObsorver.create_panel();i.title("Process Watcher - "+t.type_desc);i.focus()}var a=i.$container,r=a.find(".bg-process-watcher"),l=a.find(".bg-process-details"),o=a.find(".bg-process-footer"),s=a.find(".bg-process-stop");if(isNaN(parseInt(t.exit_code))){s.attr("disabled",false)}else{s.attr("disabled",true)}s.off("click").on("click",t.stop_process.bind(this));if(n){r.html(t.logs);setTimeout(function(){t.logs[0].scrollTop=t.logs[0].scrollHeight});l.find(".bg-detailed-desc").html(t.detailed_desc)}l.find(".bg-process-stats .bgprocess-start-time").html(t.stime);o.find(".bg-process-status").html(t.curr_status);o.find(".bg-process-exec-time p").empty().append(m("<span></span>").text(String(t.execution_time))).append(m("<span></span>").text(" "+u("seconds")));if(n){t.details=true;t.err=0;t.out=0;setTimeout(function(){t.status.apply(t)},1e3);var d=function(e,t,i){var n=t.outerHeight()+i.outerHeight();e.css("padding-bottom",n)}.bind(i,r,l,o);i.on(h.EVENT.RESIZED,d);i.on(h.EVENT.ATTACHED,d);i.on(h.EVENT.DETACHED,d);d();i.on(h.EVENT.CLOSED,function(e){e.panel=null;e.details=false;if(e.exit_code!=null){e.acknowledge_server.apply(e)}}.bind(i,this))}},acknowledge_server:function e(){var t=this;m.ajax({type:"PUT",timeout:3e4,url:t.bgprocess_url("acknowledge"),cache:false,async:true,contentType:"application/json"}).done(function(){return}).fail(function(){console.warn(arguments)})},stop_process:function e(){var t=this;t.state=3;m.ajax({type:"PUT",timeout:3e4,url:t.bgprocess_url("stop_process"),cache:false,async:true,contentType:"application/json"}).done(function(){return}).fail(function(){console.warn(arguments)})}});p.extend(g.BackgroundProcessObsorver,{bgprocesses:{},init:function e(){var t=this;if(t.initialized){return}t.initialized=true;setTimeout(function(){t.update_process_list.apply(t)},1e3);g.Events.on("pgadmin-bgprocess:created",function(){setTimeout(function(){g.BackgroundProcessObsorver.update_process_list(true)},1e3)})},update_process_list:function e(n){var a=this;m.ajax({typs:"GET",timeout:3e4,url:i("bgprocess.list"),cache:false,async:true,contentType:"application/json"}).done(function(e){if(!e||!p.isArray(e)){return}for(var t in e){var i=e[t];if("id"in i){if(!(i.id in a.bgprocesses)){a.bgprocesses[i.id]=new r(i)}}}if(n&&e.length==0){setTimeout(function(){a.update_process_list(false)},3e3)}}).fail(function(){console.warn(arguments)})},create_panel:function e(){this.register_panel();return g.docker.addPanel("bg_process_watcher",h.DOCK.FLOAT,null,{w:screen.width<700?screen.width*.95:screen.width*.5,h:screen.height<500?screen.height*.95:screen.height*.5,x:screen.width<700?"2%":"25%",y:screen.height<500?"2%":"25%"})},register_panel:function e(){var t=g.docker,i=t.findPanels("bg_process_watcher");if(i&&i.length>=1)return;var n=new g.Panel({name:"bg_process_watcher",showTitle:true,isCloseable:true,isPrivate:true,content:'<div class="bg-process-details">'+'<div class="bg-detailed-desc"></div>'+'<div class="bg-process-stats d-flex py-1">'+'<div class="my-auto mr-2">'+'<span class="fa fa-clock-o fa-2x"></span>'+"</div>"+'<div class="pg-bg-etime my-auto mr-2">'+"<span>"+u("Start time")+': <span class="bgprocess-start-time"></span>'+"</span>"+"</div>"+'<div class="ml-auto">'+'<button type="button" class="btn btn-danger bg-process-stop"><span class="fa fa-times-circle"></span>&nbsp;'+u("Stop Process")+"</button>"+"</div>"+"</div>"+"</div>"+'<div class="bg-process-watcher">'+"</div>"+'<div class="bg-process-footer p-2 d-flex">'+'<div class="bg-process-status flex-grow-1">'+"</div>"+'<div class="bg-process-exec-time ml-4 my-auto">'+'<div class="exec-div">'+"<span>"+u("Execution time")+":</span><p></p>"+"</div>"+"</div>"+"</div>",onCreate:function e(t,i){i.addClass("pg-no-overflow p-2")}});n.load(g.docker)}});return g.BackgroundProcessObsorver}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(26)],a=function(i,e,t,n,a){if(!a.Browser.Nodes["server_group"]){a.Browser.Nodes["server_group"]=a.Browser.Node.extend({parent_type:null,type:"server_group",dialogHelp:e("help.static",{filename:"server_group_dialog.html"}),label:i("Server Group"),width:"250px",height:"150px",is_collection:true,Init:function e(){if(this.initialized)return;this.initialized=true;a.Browser.add_menus([{name:"create_server_group",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:i("Server Group..."),data:{action:"create"},icon:"wcTabIcon icon-server_group"}])},model:a.Browser.Node.Model.extend({defaults:{id:undefined,name:null},schema:[{id:"id",label:i("ID"),type:"int",group:null,mode:["properties"]},{id:"name",label:i("Name"),type:"text",group:null,mode:["properties","edit","create"]}],validate:function e(){var t=null;this.errorModel.clear();if(!this.isNew()&&"id"in this.changed){t=i("The ID cannot be changed.");this.errorModel.set("id",t);return t}if(n.isUndefined(this.get("name"))||n.isNull(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=i("Name cannot be empty.");this.errorModel.set("name",t);return t}return null}}),canDrop:function e(t){return t.can_delete},canDelete:function e(t){var i=a.Browser.tree.siblings(t,true);if(!i||i.length==0){return false}return true}})}return a.Browser.Nodes["server_group"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(46),i(10),i(6),i(7),i(16),i(87)],a=function(f,e,s,d,o,t,m,g,i){if(!m.Nodes["coll-database"]){m.Nodes["coll-database"]=m.Collection.extend({node:"database",label:f("Databases"),type:"coll-database",columns:["name","datowner","comments"],hasStatistics:true,canDrop:true,canDropCascade:false,statsPrettifyFields:[f("Size"),f("Size of temporary files")]})}if(!m.Nodes["database"]){m.Nodes["database"]=m.Node.extend({parent_type:"server",type:"database",sqlAlterHelp:"sql-alterdatabase.html",sqlCreateHelp:"sql-createdatabase.html",dialogHelp:e("help.static",{filename:"database_dialog.html"}),hasSQL:true,hasDepends:true,hasStatistics:true,statsPrettifyFields:[f("Size"),f("Size of temporary files")],canDrop:function e(t){return t.canDrop},label:f("Database"),node_image:function e(){return"pg-icon-database"},Init:function e(){if(this.initialized)return;this.initialized=true;m.add_menus([{name:"create_database_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:f("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database_on_coll",node:"coll-database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:f("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:f("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"connect_database",node:"database",module:this,applies:["object","context"],callback:"connect_database",category:"connect",priority:4,label:f("Connect Database..."),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_database",node:"database",module:this,applies:["object","context"],callback:"disconnect_database",category:"drop",priority:5,label:f("Disconnect Database..."),icon:"fa fa-chain-broken",enable:"is_connected"}]);d.bindAll(this,"connection_lost");m.Events.on("pgadmin:database:connection:lost",this.connection_lost)},can_create_database:function e(t,i){var n=this.getTreeNodeHierarchy(i),a=n["server"];return a.connected&&a.user.can_create_db},is_not_connected:function e(t){return t&&t.connected!=true&&t.allowConn==true},is_connected:function e(t){return t&&t.connected==true&&t.canDisconn==true},is_conn_allow:function e(t){return t&&t.allowConn==true},connection_lost:function e(t,i,n){if(m.tree){var a=m.tree,r=t&&a.itemData(t),l=this;while(r&&r._type!="database"){t=a.parent(t);r=t&&a.itemData(t)}if(t&&r){if(!r.allowConn)return false;if(d.isUndefined(r.is_connecting)||!r.is_connecting){r.is_connecting=true;var o=function e(t,i){if(i._id==this._id){r.is_connecting=false;m.Events.off("pgadmin:database:connect:cancelled",e);t=t&&a.parent(t);i=t&&a.itemData(t);if(t&&i){m.Events.trigger("pgadmin:server:disconnect",{item:t,data:i},false)}}};m.Events.on("pgadmin:database:connect:cancelled",o);if(n){c(l,r,a,t,true);return}g.confirm(f("Connection lost"),f("Would you like to reconnect to the database?"),function(){c(l,r,a,t,true)},function(){r.is_connecting=false;a.unload(t);a.setInode(t);a.addIcon(t,{icon:"icon-database-not-connected"});m.Events.trigger("pgadmin:database:connect:cancelled",t,r,l)})}}}},callbacks:{connect_database:function e(t){var i=t||{},n=this,a=m.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l||l.label=="template0")return false;h(n,l,a,r,true);return false},disconnect_database:function e(t){var i=t||{},n=this,a=m.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;g.confirm(f("Disconnect the database"),o(f("Are you sure you want to disconnect the database - %s?")).sprintf(l.label).value(),function(){var i=l;s.ajax({url:n.generate_url(r,"connect",l,true),type:"DELETE"}).done(function(e){if(e.success==1){var t=a.parent(r);g.success(e.info);a.removeIcon(r);i.connected=false;i.icon="icon-database-not-connected";a.addIcon(r,{icon:i.icon});a.unload(r);a.setInode(r);setTimeout(function(){a.select(t)},10)}else{try{g.error(e.errormsg)}catch(e){console.warn(e.stack||e)}a.unload(r)}}).fail(function(e,t,i){g.pgRespErrorNotify(e,i);a.unload(r)})},function(){return true});return false},beforeopen:function e(t,i){if(!i||i._type!="database"||i.label=="template0"){return false}m.tree.addIcon(t,{icon:i.icon});if(!i.connected&&i.allowConn){h(this,i,m.tree,t,true);return false}return true},selected:function e(t,i){if(!i||i._type!="database"){return false}m.tree.addIcon(t,{icon:i.icon});if(!i.connected&&i.allowConn){h(this,i,m.tree,t,false);return false}return m.Node.callbacks.selected.apply(this,arguments)},refresh:function e(t,i){var n=m.tree,a=i||n.selected(),r=n.itemData(a);if(!r.allowConn)return;m.Node.callbacks.refresh.apply(this,arguments)}},model:m.Node.Model.extend({idAttribute:"did",defaults:{name:undefined,owner:undefined,comment:undefined,encoding:"UTF8",template:undefined,tablespace:undefined,collation:undefined,char_type:undefined,datconnlimit:-1,datallowconn:undefined,variables:[],privileges:[],securities:[],datacl:[],deftblacl:[],deffuncacl:[],defseqacl:[],is_template:false,deftypeacl:[]},initialize:function e(t,i){var n=d.size(t)===0;if(n){var a=m.serverInfo[i.node_info.server._id].user;this.set({datowner:a.name},{silent:true})}m.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:f("Database"),cell:"string",editable:false,type:"text"},{id:"did",label:f("OID"),cell:"string",mode:["properties"],editable:false,type:"text"},{id:"datowner",label:f("Owner"),editable:false,type:"text",node:"role",control:i.NodeListByNameControl,select2:{allowClear:false}},{id:"acl",label:f("Privileges"),type:"text",group:f("Security"),mode:["properties"],disabled:true},{id:"tblacl",label:f("Default TABLE privileges"),type:"text",group:f("Security"),mode:["properties"],disabled:true},{id:"seqacl",label:f("Default SEQUENCE privileges"),type:"text",group:f("Security"),mode:["properties"],disabled:true},{id:"funcacl",label:f("Default FUNCTION privileges"),type:"text",group:f("Security"),mode:["properties"],disabled:true},{id:"typeacl",label:f("Default TYPE privileges"),type:"text",group:f("Security"),mode:["properties"],disabled:true,min_version:90200},{id:"comments",label:f("Comment"),editable:false,type:"multiline"},{id:"encoding",label:f("Encoding"),editable:false,type:"text",group:f("Definition"),disabled:function e(t){return!t.isNew()},url:"get_encodings",control:"node-ajax-options",cache_level:"server"},{id:"template",label:f("Template"),editable:false,type:"text",group:f("Definition"),disabled:function e(t){return!t.isNew()},control:"node-list-by-name",url:"get_databases",cache_level:"server",select2:{allowClear:false},mode:["create"],transform:function e(t,i){var n=[],a=i||this,r=a.model.get("name");if(!a.model.isNew()){n.push({label:r,value:r})}else{if(t&&d.isArray(t)){d.each(t,function(e){n.push({label:e,value:e,image:"pg-icon-database"})})}}return n}},{id:"spcname",label:f("Tablespace"),editable:false,type:"text",group:f("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:false},filter:function e(t){if(t.label=="pg_global")return false;else return true}},{id:"datcollate",label:f("Collation"),editable:false,type:"text",group:f("Definition"),disabled:function e(t){return!t.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datctype",label:f("Character type"),editable:false,type:"text",group:f("Definition"),disabled:function e(t){return!t.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datconnlimit",label:f("Connection limit"),editable:false,type:"int",group:f("Definition"),min:-1},{id:"is_template",label:f("Template?"),editable:false,type:"switch",group:f("Definition"),disabled:true,mode:["properties","edit"]},{id:"datallowconn",label:f("Allow connections?"),editable:false,type:"switch",group:f("Definition"),mode:["properties"],disabled:true},{id:"datacl",label:f("Privileges"),type:"collection",model:m.Node.PrivilegeRoleModel.extend({privileges:["C","T","c"]}),uniqueCol:["grantee","grantor"],editable:false,group:f("Security"),mode:["edit","create"],canAdd:true,canDelete:true,control:"unique-col-collection"},{id:"variables",label:"",type:"collection",model:m.Node.VariableModel.extend({keys:["name","role"]}),editable:false,group:f("Parameters"),mode:["edit","create"],canAdd:true,canEdit:false,canDelete:true,hasRole:true,control:i.VariableCollectionControl,node:"role"},{id:"seclabels",label:f("Security labels"),model:m.SecLabelModel,editable:false,type:"collection",canEdit:false,group:f("Security"),canDelete:true,mode:["edit","create"],canAdd:true,control:"unique-col-collection",uniqueCol:["provider"],min_version:90200},{type:"nested",control:"tab",group:f("Default Privileges"),mode:["edit"],schema:[{id:"deftblacl",model:m.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:"",editable:false,type:"collection",group:f("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:m.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:"",editable:false,type:"collection",group:f("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:m.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:"",editable:false,type:"collection",group:f("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:m.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:"",editable:false,type:"collection",group:"deftypesacl_group",mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"],min_version:90200},{id:"deftypesacl_group",type:"group",label:f("Types"),mode:["edit","create"],min_version:90200}]}],validate:function e(){var t=this.get("name");if(d.isUndefined(t)||d.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){var i=f("Name cannot be empty.");this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}return null}})});m.SecurityGroupSchema={id:"security",label:f("Security"),type:"group",visible:function e(t){if(t&&"node_info"in t){var i=t.node_info||t.handler.node_info;return"catalog"in i?false:true}return true}};var h=function e(t,i,n,a){c(t,i,n,a)},c=function e(o,n,d,a,c){var r=c||n.connected,l=function t(e,i,n,a,r,l,o,s){if(!s){d.setInode(o);d.addIcon(o,{icon:"icon-database-not-connected"})}g.pgNotifier("error",e,n,function(e){setTimeout(function(){if(e=="CRYPTKEY_SET"){h(a,r,l,o,c)}else{g.dlgServerPass(f("Connect to database"),e,a,r,l,o,s,u,t,p).resizeTo()}},100)})},u=function e(t,i,n,a,r,l){n.is_connecting=false;if(!l){a.deselect(r);a.setInode(r)}if(t&&t.data){if(typeof t.data.connected=="boolean"){n.connected=t.data.connected}if(typeof t.data.icon=="string"){a.removeIcon(r);n.icon=t.data.icon;a.addIcon(r,{icon:n.icon})}g.success(t.info);o.trigger("connected",o,r,n);m.Events.trigger("pgadmin:database:connected",r,n);if(!l){setTimeout(function(){a.select(r);a.open(r)},10)}}},p=function e(t,i,n){n.is_connecting=false;var a=t.parent(i);t.unload(i);t.setInode(i);t.removeIcon(i);t.addIcon(i,{icon:"icon-database-not-connected"});o.trigger("connect:cancelled",o,i,n);m.Events.trigger("pgadmin:database:connect:cancelled",i,n,o);t.select(a)};s.post(o.generate_url(a,"connect",n,true)).done(function(e){if(e.success==1){return u(e,o,n,d,a,r)}}).fail(function(e,t,i){return l(e,t,i,o,n,d,a,r)})}}return m.Nodes["coll-database"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(17),i(6),i(67),i(7),i(35),i(87)],a=function(m,e,g,h,t,i,n,a,b){if(!n.Nodes["coll-role"]){i.Browser.Nodes["coll-role"]=i.Browser.Collection.extend({node:"role",type:"coll-role",columns:["rolname","rolvaliduntil","rolconnlimit","rolcanlogin","rolsuper","rolcreaterole","rolcreatedb","rolcatupdate","rolinherit","rolreplication"],canDrop:true,canDropCascade:false})}var r=i.Browser.SecurityModel=i.Browser.SecurityModel||i.Browser.Node.Model.extend({defaults:{provider:null,label:null},schema:[{id:"provider",label:m("Provider"),type:"text",disabled:false,cellHeaderClasses:"width_percent_50"},{id:"label",label:m("Security label"),type:"text",disabled:false}],validate:function e(){var t=this.toJSON(),i;if(h.isUndefined(t.provider)||h.isNull(t.provider)||String(t.provider).replace(/^\s+|\s+$/g,"")==""){i=m("Please specify the value for all the security providers.");this.errorModel.set("provider",i);return i}else{this.errorModel.unset("provider")}if(h.isUndefined(t.label)||h.isNull(t.label)||String(t.label).replace(/^\s+|\s+$/g,"")==""){i=m("Please specify the value for all the security providers.");this.errorModel.set("label",i);return i}else{this.errorModel.unset("label")}return null}});var l=b.Control.extend({defaults:h.defaults({extraClasses:["col-12 col-sm-12 col-md-12"]},b.NodeListByNameControl.prototype.defaults),initialize:function e(){b.NodeListByNameControl.prototype.initialize.apply(this,arguments)},formatter:{fromRaw:function e(t){var i=h.isObject(t)?t:JSON.parse(t);return h.pluck(i,"role")},toRaw:function e(t){return t}},template:h.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <select multiple="multiple" style="width:100%;" class="pgadmin-controls <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-JSON.stringify(value)%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>>',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value=<%-option.value%> data-icon=<%-option.image%> <%=value != null && _.indexOf(value, option.value) != -1 ? "selected" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),selectionTemplate:h.template(["<span>",'  <span class="wcTabIcon <%= optimage %>"></span>',"  <span><%= opttext %><span>","  <% if (checkbox) { %>",'  <input type="checkbox" <%=disabled ? "disabled=\'disabled\'" : ""%>/>',"  <% } %>","</span>"].join("\n")),events:{"change select":"onChange"},getValueFromDOM:function e(){var t=[];this.$el.find("select").find(":selected").each(function(){t.push(g(this).attr("value"))});return t},render:function e(){var t=h.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),a=n.shift(),r=n.join("."),l=this.keyPathAccessor(i[a],r),o=h.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),s=function e(t,i,n){return h.isFunction(t)?!!t.apply(i,[n]):!!t},d=function e(t,i,n){return h.isFunction(t)?t.apply(i,[n]):t};h.extend(o,{disabled:s(o.disabled,o,this.model),visible:s(o.visible,o,this.model),required:s(o.required,o,this.model),helpMessage:d(o.helpMessage,o,this.model)});if(h.isFunction(o.options)){try{o.options=o.options.apply(this)}catch(e){o.options=[];this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}}this.$el.removeClass(b.hiddenClassName);if(!o.visible)this.$el.addClass(b.hiddenClassName);this.$el.html(this.template(o)).addClass(t.name);this.updateInvalid();var c=this,u=this.model.get(this.field.get("name")),p=function e(t){if(!t.id){return t.text}var i=g(t.element).data("icon");if(!i){return t.text}else{var n=h.extend({},o,{opttext:h.escape(t.text),optimage:i,checkbox:false});return g(c.selectionTemplate(n))}},f=function e(i){if(!i.id){return i.text}var t=g(i.element).data("icon"),n=function e(t){h.each(u.where({role:i.id}),function(e){e.set("admin",g(t.target).is(":checked"))});return false};if(!t){return i.text}else{var a=h.extend({},o,{opttext:h.escape(i.text),optimage:t,checkbox:true}),r=g(c.selectionTemplate(a));setTimeout(function(){h.each(u.where({role:i.id}),function(e){r.find("input").prop("checked",e.get("admin"))})},200);r.find("input").on("change",n);return r}};this.$el.find("select").select2({templateResult:p,templateSelection:f,multiple:true,tags:true,allowClear:o.disabled?false:true,placeholder:o.disabled?"":m("Select members"),width:"style"}).on("change",function(e){g(e.target).find(":selected").each(function(){})});return this},onChange:function e(){var t=this.model,i=this.field.get("name").split("."),n=i.shift(),a=this.getValueFromDOM(),r=t.get(n),l=[];this.stopListening(this.model,"change:"+n,this.render);r.each(function(e){var t=e.get("role"),i=h.indexOf(a,t);if(i>-1){a.splice(i,1)}else{l.push(t)}});h.each(a,function(e){r.add({role:e})});h.each(l,function(e){r.remove(r.where({role:e}))});this.listenTo(this.model,"change:"+n,this.render)}});if(!n.Nodes["role"]){i.Browser.Nodes["role"]=i.Browser.Node.extend({parent_type:"server",type:"role",sqlAlterHelp:"sql-alterrole.html",sqlCreateHelp:"sql-createrole.html",dialogHelp:e("help.static",{filename:"role_dialog.html"}),label:m("Login/Group Role"),hasSQL:true,width:"550px",canDrop:function e(t,i){var n=this.getTreeNodeHierarchy(i),a=n["server"];if(t.is_superuser){return a.connected&&a.user.is_superuser}return a.connected&&a.user.can_create_role},hasDepends:true,node_label:function e(t){return t.label},node_image:function e(t){if(t==null||t==undefined)return"icon-role";return t.can_login?"icon-role":"icon-group"},title:function e(t){if(!t){return this.label}if(t.can_login){return m("Login Role")+" - "+t.label}return m("Group Role")+" - "+t.label},Init:function e(){if(this.initialized)return;this.initialized=true;n.add_menus([{name:"create_role_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role_on_roles",node:"coll-role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role",node:"role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:m("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"}])},can_create_role:function e(t,i){var n=this.getTreeNodeHierarchy(i),a=n["server"];return a.connected&&a.user.can_create_role},model:i.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:null,rolname:undefined,rolcanlogin:false,rolpassword:null,rolconnlimit:-1,rolsuper:false,rolcreaterole:false,rolcreatedb:false,rolinherit:true,rolcatupdate:false,rolreplication:false,rolmembership:[],rolvaliduntil:null,seclabels:[],variables:[]},schema:[{id:"rolname",label:m("Name"),type:"text",disabled:"readonly"},{id:"oid",label:m("OID"),cell:"string",mode:["properties"],editable:false,type:"text",visible:true,disabled:true},{id:"rolpassword",label:m("Password"),type:"password",group:m("Definition"),mode:["edit","create"],control:"input",deps:["rolcanlogin"],retype:true,cell:"string",disabled:function e(t){if(!t.isNew()){var i=this.node_info.server.user;return!(i.is_superuser||i.can_create_role)&&i.id!=t.get("oid")}return false}},{id:"rolvaliduntil",disabled:"readonly",type:"text",group:m("Definition"),label:m("Account expires"),mode:["properties","edit","create"],control:"datetimepicker",deps:["rolcanlogin"],options:{format:"YYYY-MM-DD HH:mm:ss Z"}},{id:"rolconnlimit",type:"int",group:m("Definition"),label:m("Connection limit"),cell:"integer",min:-1,mode:["properties","edit","create"],disabled:"readonly"},{id:"rolcanlogin",label:m("Can login?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:m("Privileges"),disabled:"readonly"},{id:"rolsuper",label:m("Superuser?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:m("Privileges"),control:b.SwitchControl.extend({onChange:function e(){b.SwitchControl.prototype.onChange.apply(this,arguments);this.model.set("rolcatupdate",this.model.get("rolsuper"));this.model.set("rolcreaterole",this.model.get("rolsuper"));this.model.set("rolcreatedb",this.model.get("rolsuper"))}}),disabled:"readonly"},{id:"rolcreaterole",label:m("Create roles?"),group:m("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"description",label:m("Comments"),type:"multiline",group:null,mode:["properties","edit","create"],disabled:"readonly"},{id:"rolcreatedb",label:m("Create databases?"),group:m("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"rolcatupdate",label:m("Update catalog?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",max_version:90400,group:m("Privileges"),disabled:function e(t){return t.get("read_only")||!t.get("rolsuper")}},{id:"rolinherit",group:m("Privileges"),label:m("Inherit rights from the parent roles?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",disabled:"readonly"},{id:"rolreplication",group:m("Privileges"),label:m("Can initiate streaming replication and backups?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",min_version:90100,disabled:"readonly"},{id:"rolmembership",label:m("Roles"),group:m("Membership"),type:"collection",cell:"string",disabled:"readonly",mode:["properties","edit","create"],control:l,model:n.Node.Model.extend({keys:["role"],idAttribute:"role",defaults:{role:undefined,admin:false},validate:function e(){return null}}),filter:function e(t){return this.model.isNew()||this.model.get("rolname")!=t.label},helpMessage:function e(t){if(t.has("read_only")&&t.get("read_only")==false){return m("Select the checkbox for roles to include WITH ADMIN OPTION.")}else{return m("Roles shown with a check mark have the WITH ADMIN OPTION set.")}}},{id:"variables",label:"",type:"collection",group:m("Parameters"),hasDatabase:true,url:"variables",model:n.Node.VariableModel.extend({keys:["name","database"]}),control:"variable-collection",mode:["edit","create"],canAdd:true,canDelete:true,disabled:"readonly"},{id:"seclabels",label:m("Security labels"),model:r,editable:false,type:"collection",group:m("Security"),mode:["edit","create"],min_version:90200,disabled:"readonly",canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection"}],readonly:function e(t){if(!t.has("read_only")){var i=this.node_info.server.user;t.set("read_only",!(i.is_superuser||i.can_create_role))}return t.get("read_only")},validate:function e(){var t={},i,n=this.get("seclabels");if(h.isUndefined(this.get("rolname"))||String(this.get("rolname")).replace(/^\s+|\s+$/g,"")==""){t["name"]=m("Name cannot be empty.");i=i||t["name"]}if(n){var a;for(var r=0;r<n.models.length&&!a;r++){a=n.models[r].validate.apply(n.models[r]);if(a){t["seclabels"]=a;i=i||a}}}this.errorModel.clear().set(t);if(h.size(t)){this.trigger("on-status",{msg:i});return i}return null}})})}return n.Nodes["role"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(10),i(6),i(7)],a=function(a,e,o,r,t,i,n,s,l){if(!n.Nodes["coll-cast"]){i.Browser.Nodes["coll-cast"]=i.Browser.Collection.extend({node:"cast",label:a("Casts"),type:"coll-cast",columns:["name","description"]})}if(!n.Nodes["cast"]){i.Browser.Nodes["cast"]=i.Browser.Node.extend({parent_type:"database",type:"cast",sqlAlterHelp:"sql-altercast.html",sqlCreateHelp:"sql-createcast.html",dialogHelp:e("help.static",{filename:"cast_dialog.html"}),canDrop:true,canDropCascade:true,label:a("Cast"),hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;n.add_menus([{name:"create_cast_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"},enable:n.Nodes["database"].is_conn_allow},{name:"create_cast_on_coll",node:"coll-cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}},{name:"create_cast",node:"cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}}])},model:i.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,encoding:"UTF8",srctyp:undefined,trgtyp:undefined,proname:undefined,castcontext:undefined,syscast:undefined,description:undefined},schema:[{id:"name",label:a("Name"),cell:"string",editable:false,type:"text",disabled:true,cellHeaderClasses:"width_percent_50"},{id:"oid",label:a("OID"),cell:"string",editable:false,type:"text",disabled:true,mode:["properties"]},{id:"srctyp",label:a("Source type"),url:"get_type",type:"text",group:a("Definition"),disabled:function e(t){return!t.isNew()},mode:["create"],transform:function e(t){r.each(t,function(e){e["image"]="icon-cast"});return t},control:l.NodeAjaxOptionsControl.extend({onChange:function e(){l.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this.model.get("srctyp");var i=this.model.get("trgtyp");if(t!=undefined&&t!=""&&i!=undefined&&i!="")this.model.set("name",t+"->"+i);else this.model.unset("name")}})},{id:"srctyp",label:a("Source type"),type:"text",group:a("Definition"),disabled:true,mode:["properties","edit"]},{id:"trgtyp",label:a("Target type"),url:"get_type",type:"text",group:a("Definition"),disabled:function e(t){return!t.isNew()},mode:["create"],transform:function e(t){r.each(t,function(e){e["image"]="icon-cast"});return t},control:l.NodeAjaxOptionsControl.extend({onChange:function e(){l.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this.model.get("srctyp");var i=this.model.get("trgtyp");if(t!=undefined&&t!=""&&i!=undefined&&i!="")this.model.set("name",t+"->"+i);else this.model.unset("name")}})},{id:"trgtyp",label:a("Target type"),type:"text",group:a("Definition"),disabled:true,mode:["properties","edit"]},{id:"proname",label:a("Function"),deps:["srctyp","trgtyp"],type:"text",disabled:function e(t){return!t.isNew()},group:a("Definition"),mode:["create"],control:"node-ajax-options",options:function e(t){var i=t.model.get("srctyp");var n=t.model.get("trgtyp");var a=[];if(i!=undefined&&i!=""&&n!=undefined&&n!=""){var r=t.field.get("schema_node"),l=r.generate_url.apply(r,[null,"get_functions",t.field.get("node_data"),false,t.field.get("node_info")]);o.ajax({type:"POST",timeout:3e4,url:l,cache:false,async:false,data:{srctyp:i,trgtyp:n}}).done(function(e){a=e.data;return a}).fail(function(e,t,i){s.pgRespErrorNotify(e,i)})}return a}},{id:"proname",label:a("Function"),type:"text",group:a("Definition"),disabled:true,mode:["properties","edit"]},{id:"castcontext",label:a("Context"),options:{onText:"IMPLICIT",offText:"EXPLICIT",width:"90"},editable:false,type:"string",group:a("Definition"),mode:["create"],control:l.SwitchControl.extend({getValueFromDOM:function e(){return this.$input.prop("checked")?"IMPLICIT":"EXPLICIT"}})},{id:"castcontext",label:a("Context"),disabled:true,options:[{label:"IMPLICIT",value:"IMPLICIT"},{label:"EXPLICIT",value:"EXPLICIT"},{label:"ASSIGNMENT",value:"ASSIGNMENT"}],editable:false,type:"select2",group:a("Definition"),mode:["properties","edit"]},{id:"syscast",label:a("System cast?"),cell:"switch",type:"switch",mode:["properties"],disabled:true},{id:"description",label:a("Comment"),type:"multiline",cellHeaderClasses:"width_percent_50"}],validate:function e(){var t=this.get("srctyp"),i=this.get("trgtyp"),n;if(r.isUndefined(t)||r.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){n=a("Source type must be selected.");this.errorModel.set("srctyp",n);return n}else{this.errorModel.unset("srctyp")}if(r.isUndefined(i)||r.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){n=a("Target type must be selected.");this.errorModel.set("trgtyp",n);return n}else{this.errorModel.unset("trgtyp")}this.trigger("on-status-clear");return null}})})}return n.Nodes["coll-cast"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(10),i(6),i(7),i(35),i(16)],a=function(p,d,f,m,c,e,g,h,b){if(!g.Nodes["coll-tablespace"]){g.Nodes["coll-tablespace"]=g.Collection.extend({node:"tablespace",label:p("Tablespaces"),type:"coll-tablespace",columns:["name","spcuser","description"],hasStatistics:true,statsPrettifyFields:[p("Size")],canDrop:true,canDropCascade:false})}if(!g.Nodes["tablespace"]){g.Nodes["tablespace"]=g.Node.extend({parent_type:"server",type:"tablespace",sqlAlterHelp:"sql-altertablespace.html",sqlCreateHelp:"sql-createtablespace.html",dialogHelp:d("help.static",{filename:"tablespace_dialog.html"}),label:p("Tablespace"),hasSQL:true,canDrop:true,hasDepends:true,hasStatistics:true,statsPrettifyFields:[p("Size")],Init:function e(){if(this.initialized)return;this.initialized=true;g.add_menus([{name:"create_tablespace_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:p("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace_on_coll",node:"coll-tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:p("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:p("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"move_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"move_objects",category:"move_tablespace",priority:5,label:p("Move objects to..."),icon:"fa fa-exchange",data:{action:"create"},enable:"can_move_objects"}])},can_create_tablespace:function e(t,i){var n=this.getTreeNodeHierarchy(i),a=n["server"];return a.connected&&a.user.is_superuser},can_move_objects:function e(t,i){var n=this.getTreeNodeHierarchy(i),a=n["server"];return a.connected&&a.user.is_superuser&&a.version>=90400},callbacks:{move_objects:function e(t){var i=t||{},n=this,a=g.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined,o=n.generate_url(r,"move_objects",l,true),s=n.generate_url(r,"move_objects_sql",l,true);if(!l)return false;var u=c.Model.extend({idAttribute:"id",defaults:{new_tblspc:undefined,obj_type:"all",user:undefined},schema:[{id:"tblspc",label:p("New tablespace"),type:"text",disabled:false,control:"node-list-by-name",node:"tablespace",select2:{allowClear:false},filter:function e(t){return t&&t.label!=l.label}},{id:"obj_type",label:p("Object type"),type:"text",disabled:false,control:"select2",select2:{allowClear:false,width:"100%"},options:[{label:p("All"),value:"all"},{label:p("Tables"),value:"tables"},{label:p("Indexes"),value:"indexes"},{label:p("Materialized views"),value:"materialized_views"}]},{id:"user",label:p("Object owner"),type:"text",disabled:false,control:"node-list-by-name",node:"role",select2:{allowClear:false}},{id:"sqltab",label:p("SQL"),group:p("SQL"),type:"text",disabled:false,control:b.SqlTabControl.extend({initialize:function e(){b.SqlTabControl.prototype.initialize.apply(this,arguments)},onTabChange:function e(t){if(this.dialog&&t.shown==this.tabIndex){var i=this,n=i.model.toJSON();n.old_tblspc=l.label;f.ajax({url:s,type:"GET",cache:false,data:n,dataType:"json",contentType:"application/json"}).done(function(e){i.sqlCtrl.clearHistory();i.sqlCtrl.setValue(e.data);i.sqlCtrl.refresh()}).fail(function(){i.model.trigger("pgadmin-view:msql:error")}).always(function(){i.model.trigger("pgadmin-view:msql:fetched")})}}})}],validate:function e(){return null}});if(!h.move_objects_dlg){h.dialog("move_objects_dlg",function e(){return{main:function e(){var t=p("Move objects to another tablespace");this.set("title",t)},build:function e(){h.pgDialogBuild.apply(this)},setup:function e(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:p("Users"),url:d("help.static",{filename:"move_objects.html"})}},{text:p("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:p("OK"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],options:{padding:!1,overflow:!1,modal:false,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false}}},hooks:{onclose:function e(){if(this.view){this.view.remove({data:true,internal:true,silent:true})}}},prepare:function e(){var t=this,i=f("<div class='move_objects'></div>");this.__internal.buttons[2].element.disabled=true;var n=g.tree,a=n.selected(),r=a&&a.length==1?n.itemData(a):undefined,l=r&&g.Nodes[r._type];if(!r)return;var o=l.getTreeNodeHierarchy.apply(l,[a]);var s=new u({},{node_info:o}),d=b.generateViewSchema(o,s,"create",l,o.server,true);var c=this.view=new b.Dialog({el:i,model:s,schema:d});f(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties");c.render();this.elements.content.appendChild(i.get(0));this.view.model.on("change",function(){if(!m.isUndefined(this.get("tblspc"))&&this.get("tblspc")!==""){this.errorModel.clear();t.__internal.buttons[2].element.disabled=false}else{t.__internal.buttons[2].element.disabled=true;this.errorModel.set("tblspc",p("Please select tablespace"))}})},callback:function e(t){if(t.button.element.name=="dialog_help"){t.cancel=true;g.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);return}if(t.button.text===p("OK")){var i=this,n=this.view.model.toJSON();n.old_tblspc=l.label;t.cancel=true;h.confirm(p("Move objects..."),p("Are you sure you wish to move the objects from %(old_tablespace)s to %(new_tablespace)s?",{old_tablespace:n.old_tblspc,new_tablespace:n.tblspc}),function(){f.ajax({url:o,method:"PUT",data:{data:JSON.stringify(n)}}).done(function(e){if(e.success){h.success(e.info);i.close()}else{h.error(e.errormsg)}}).fail(function(e,t,i){h.pgRespErrorNotify(e,i)})},function(){})}}}})}h.move_objects_dlg(true).resizeTo(g.stdW.md,g.stdH.md)}},model:g.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,owner:undefined,comment:undefined,spclocation:undefined,spcoptions:[],spcacl:[],seclabels:[]},initialize:function e(t,i){var n=m.size(t)===0;if(n){var a=g.serverInfo[i.node_info.server._id].user;this.set({spcuser:a.name},{silent:true})}g.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:p("Name"),cell:"string",type:"text"},{id:"oid",label:p("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"spclocation",label:p("Location"),cell:"string",group:p("Definition"),type:"text",mode:["properties","edit","create"],disabled:function e(t){return!t.isNew()}},{id:"spcuser",label:p("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:false}},{id:"acl",label:p("Privileges"),type:"text",group:p("Security"),mode:["properties"],disabled:true},{id:"description",label:p("Comment"),cell:"string",type:"multiline"},{id:"spcoptions",label:"",type:"collection",group:p("Parameters"),control:"variable-collection",model:g.Node.VariableModel,mode:["edit","create"],canAdd:true,canEdit:false,canDelete:true},{id:"spcacl",label:p("Privileges"),type:"collection",group:p("Security"),control:"unique-col-collection",model:g.Node.PrivilegeRoleModel.extend({privileges:["C"]}),mode:["edit","create"],canAdd:true,canDelete:true,uniqueCol:["grantee"],columns:["grantee","grantor","privileges"]},{id:"seclabels",label:p("Security labels"),model:g.SecLabelModel,editable:false,type:"collection",group:p("Security"),mode:["edit","create"],min_version:90200,canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection"}],validate:function e(){var t;if(m.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=p("Name cannot be empty.");this.errorModel.set("name",t)}else if(this.isNew()&&(m.isUndefined(this.get("spclocation"))||String(this.get("spclocation")).replace(/^\s+|\s+$/g,"")=="")){t=p("Location cannot be empty.");this.errorModel.set("spclocation",t);this.errorModel.unset("name")}else{this.errorModel.unset("name");this.errorModel.unset("spclocation")}return null}})})}return g.Nodes["coll-tablespace"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(1),i(5),i(7)],a=function(r,e,l,t){if(!t.Nodes["coll-resource_group"]){t.Nodes["coll-resource_group"]=t.Collection.extend({node:"resource_group",label:r("Resource Groups"),type:"coll-resource_group",columns:["name","cpu_rate_limit","dirty_rate_limit"],canDrop:true,canDropCascade:false})}if(!t.Nodes["resource_group"]){t.Nodes["resource_group"]=t.Node.extend({parent_type:"server",type:"resource_group",dialogHelp:e("help.static",{filename:"resource_group_dialog.html"}),label:r("Resource Group"),hasSQL:true,canDrop:true,Init:function e(){if(this.initialized){return}this.initialized=true;t.add_menus([{name:"create_resourcegroup_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"},enable:function e(t,i){var n=this.getTreeNodeHierarchy(i),a=n["server"];return a.connected&&t.server_type==="ppas"&&t.version>=90400}},{name:"create_resource_group_on_coll",node:"coll-resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}},{name:"create_resource_group",node:"resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}}])},model:t.Node.Model.extend({idAttribute:"oid",defaults:{oid:undefined,name:undefined,cpu_rate_limit:0,dirty_rate_limit:0},schema:[{id:"oid",label:r("OID"),type:"text",editable:false,disabled:true,mode:["properties"]},{id:"name",label:r("Name"),cell:"string",type:"text"},{id:"cpu_rate_limit",label:r("CPU rate limit (percentage)"),cell:"string",type:"numeric",min:0,max:16777216},{id:"dirty_rate_limit",label:r("Dirty rate limit (KB)"),cell:"string",type:"numeric",min:0,max:16777216}],validate:function e(){var t,i=this.get("name");if(l.isUndefined(i)||l.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){t=r("Name cannot be empty.");this.errorModel.set("name",t);return t}else{this.errorModel.unset("name")}var n=this.get("cpu_rate_limit");if(l.isUndefined(n)||l.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){t=r("CPU rate limit cannot be empty.");this.errorModel.set("cpu_rate_limit",t);return t}else{this.errorModel.unset("cpu_rate_limit")}var a=this.get("dirty_rate_limit");if(l.isUndefined(a)||l.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==""){t=r("Dirty rate limit cannot be empty.");this.errorModel.set("dirty_rate_limit",t);return t}else{this.errorModel.unset("dirty_rate_limit")}return null}})})}return t.Nodes["coll-resource_group"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(7)],a=function(i,e,t,r,n,l,o,a){if(!o.Nodes["coll-event_trigger"]){l.Browser.Nodes["coll-event_trigger"]=l.Browser.Collection.extend({node:"event_trigger",label:i("Event Trigger"),type:"coll-event_trigger",columns:["name","eventowner","comment"],canDrop:true,canDropCascade:false})}if(!o.Nodes["event_trigger"]){l.Browser.Nodes["event_trigger"]=l.Browser.Node.extend({parent_type:"database",type:"event_trigger",sqlAlterHelp:"sql-altereventtrigger.html",sqlCreateHelp:"sql-createeventtrigger.html",dialogHelp:e("help.static",{filename:"event_trigger_dialog.html"}),label:i("Event Trigger"),hasSQL:true,hasDepends:true,canDrop:true,Init:function e(){if(this.initialized)return;this.initialized=true;o.add_menus([{name:"create_event_trigger_on_coll",node:"coll-event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"},enable:o.Nodes["database"].is_conn_allow}])},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:undefined,name:undefined,eventowner:undefined,comment:undefined,enabled:"O",eventfuncoid:undefined,eventfunname:undefined,eventname:"DDL_COMMAND_START",when:undefined,xmin:undefined,source:undefined,language:undefined},initialize:function e(t,i){var n=r.size(t)===0;if(n){var a=o.serverInfo[i.node_info.server._id].user;this.set({eventowner:a.name},{silent:true})}l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("Name"),cell:"string",type:"text"},{id:"oid",label:i("OID"),cell:"string",type:"text",mode:["properties"]},{id:"eventowner",label:i("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:a.NodeListByNameControl},{id:"comment",label:i("Comment"),type:"multiline"},{id:"enabled",label:i("Enabled?"),type:"radio",group:i("Definition"),mode:["properties","edit","create"],options:[{label:"Enable",value:"O"},{label:"Disable",value:"D"},{label:"Replica",value:"R"},{label:"Always",value:"A"}]},{id:"eventfunname",label:i("Trigger function"),type:"text",control:"node-ajax-options",group:i("Definition"),url:"fopts",cache_node:"trigger_function"},{id:"eventname",label:i("Events"),type:"radio",group:i("Definition"),cell:"string",options:[{label:"DDL COMMAND START",value:"DDL_COMMAND_START"},{label:"DDL COMMAND END",value:"DDL_COMMAND_END"},{label:"SQL DROP",value:"SQL_DROP"}]},{id:"when",label:i("When"),cell:"string",type:"text",group:i("Definition"),control:a.SqlFieldControl,extraClasses:["custom_height_css_class"]},{id:"seclabels",label:i("Security labels"),model:o.SecLabelModel,editable:false,type:"collection",group:i("Security"),mode:["edit","create"],min_version:90200,canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection"}],validate:function e(){var t=undefined;this.errorModel.clear();if(r.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=i("Event trigger name cannot be empty.");this.errorModel.set("name",t);return t}if(r.isUndefined(this.get("eventowner"))||String(this.get("eventowner")).replace(/^\s+|\s+$/g,"")==""){t=i("Event trigger owner cannot be empty.");this.errorModel.set("eventowner",t);return t}if(r.isUndefined(this.get("enabled"))){t=i("Event trigger enabled status cannot be empty.");this.errorModel.set("enabled",t);return t}if(r.isUndefined(this.get("eventfunname"))||String(this.get("eventfunname")).replace(/^\s+|\s+$/g,"")==""){t=i("Event trigger function cannot be empty.");this.errorModel.set("eventfunname",t);return t}if(r.isUndefined(this.get("eventname"))){t=i("Event trigger event cannot be empty.");this.errorModel.set("eventname",t);return t}return null}})})}return o.Nodes["coll-event_trigger"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(7)],a=function(a,e,t,l,i,n,r,o){if(!r.Nodes["coll-extension"]){n.Browser.Nodes["coll-extension"]=n.Browser.Collection.extend({node:"extension",label:a("Extension"),type:"coll-extension",columns:["name","owner","comment"]})}if(!r.Nodes["extension"]){n.Browser.Nodes["extension"]=n.Browser.Node.extend({parent_type:"database",type:"extension",sqlAlterHelp:"sql-alterextension.html",sqlCreateHelp:"sql-createextension.html",dialogHelp:e("help.static",{filename:"extension_dialog.html"}),hasSQL:true,hasDepends:true,canDrop:true,canDropCascade:true,label:a("Extension"),Init:function e(){if(this.initialized)return;this.initialized=true;r.add_menus([{name:"create_extension_on_coll",node:"coll-extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"},enable:r.Nodes["database"].is_conn_allow}])},model:n.Browser.Node.Model.extend({idAttribute:"eid",schema:[{id:"name",label:a("Name"),first_empty:true,type:"text",mode:["properties","create","edit"],visible:true,url:"avails",disabled:function e(t){return!t.isNew()},transform:function e(t,i){var n=[],a=i||this,r=a.model.get("name");if(!a.model.isNew()){n.push({label:r,value:r})}else{if(t&&l.isArray(t)){l.each(t,function(e){if(e.installed_version===null)n.push({label:e.name,value:JSON.stringify(e)})})}}return n},control:o.NodeAjaxOptionsControl.extend({getValueFromDOM:function e(){var t=this.formatter.toRaw(l.unescape(this.$el.find("select").val()),this.model);if(t===""){return null}else if(typeof t==="string"){t=JSON.parse(t)}return t.name},onChange:function e(){o.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this.$el.find("select").val();if(t.trim()!=""){var i=this.formatter.toRaw(t,this.model);if(typeof i==="string")i=JSON.parse(i);this.model.set({version:"",relocatable:!l.isNull(i.relocatable[0])&&!l.isUndefined(i.relocatable[0])?i.relocatable[0]:""})}else{this.model.set({version:"",relocatable:true,schema:""})}}})},{id:"eid",label:a("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"owner",label:a("Owner"),control:"node-list-by-name",mode:["properties"],node:"role",cell:"string",cache_level:"server"},{id:"schema",label:a("Schema"),type:"text",control:"node-list-by-name",group:a("Definition"),mode:["properties","create","edit"],deps:["relocatable"],node:"schema",first_empty:true,disabled:function e(t){return t.has("relocatable")?!t.get("relocatable"):false}},{id:"relocatable",label:a("Relocatable?"),cell:"switch",group:a("Definition"),type:"switch",mode:["properties"]},{id:"version",label:a("Version"),cell:"string",mode:["properties","create","edit"],group:a("Definition"),control:"node-ajax-options",url:"avails",first_empty:true,transform:function e(t,i){var n=[],a=i||this,r=a.model.get("name");l.each(t,function(e){if(e.name==r){if(e.version&&l.isArray(e.version)){l.each(e.version,function(e){n.push({label:e,value:e})})}}});return n}},{id:"comment",label:a("Comment"),cell:"string",type:"multiline",disabled:true}],validate:function e(){var t={},i,n=this.get("name");if(l.isUndefined(n)||l.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){t["name"]=a("Name cannot be empty.");i=i||t["name"];this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}return null}})})}return r.Nodes["coll-extension"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(7),i(16)],a=function(a,e,t,o,i,n,r,l){if(!r.Nodes["coll-language"]){r.Nodes["coll-language"]=r.Collection.extend({node:"language",label:a("Languages"),type:"coll-language",columns:["name","lanowner","description"]})}if(!r.Nodes["language"]){r.Nodes["language"]=r.Node.extend({parent_type:"database",type:"language",sqlAlterHelp:"sql-alterlanguage.html",sqlCreateHelp:"sql-createlanguage.html",dialogHelp:e("help.static",{filename:"language_dialog.html"}),label:a("Language"),hasSQL:true,canDrop:true,canDropCascade:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;r.add_menus([{name:"create_language_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"},enable:r.Nodes["database"].is_conn_allow},{name:"create_language_on_coll",node:"coll-language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}},{name:"create_language",node:"language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}}])},model:r.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,lanowner:undefined,comment:undefined,lanacl:[],seclabels:[],trusted:true,lanproc:undefined,laninl:undefined,lanval:undefined,is_template:false,template_list:[]},initialize:function e(t,i){var n=o.size(t)===0;if(n){var a=r.serverInfo[i.node_info.server._id].user;this.set({lanowner:a.name},{silent:true})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:a("Name"),type:"text",control:"node-ajax-options",mode:["properties","create","edit"],url:"get_templates",select2:{allowClear:false,tags:true,multiple:false},transform:function e(t,i){var n=[],a=i||this,r=a.model.get("name");if(!a.model.isNew()){n.push({label:r,value:r})}else{var l=[];if(t&&o.isArray(t)){o.each(t,function(e){n.push({label:e.tmplname,value:e.tmplname});l.push(e.tmplname)})}this.model.set({template_list:l})}return n}},{id:"oid",label:a("OID"),cell:"string",mode:["properties"],type:"text",disabled:true},{id:"lanowner",label:a("Owner"),type:"text",control:l.NodeListByNameControl,node:"role",mode:["edit","properties","create"],select2:{allowClear:false}},{id:"acl",label:a("Privileges"),type:"text",group:a("Security"),mode:["properties"],disabled:true},{id:"description",label:a("Comment"),cell:"string",type:"multiline"},{id:"trusted",label:a("Trusted?"),type:"switch",group:a("Definition"),mode:["edit","properties","create"],deps:["name"],disabled:function e(t){if(t.isNew()){if(t.get("template_list").indexOf(t.get("name"))==-1){t.set({is_template:false});return false}else t.set({is_template:true})}return true}},{id:"lanproc",label:a("Handler function"),type:"text",control:"node-ajax-options",group:a("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:false,transform:function e(t){var i=[];if(t&&o.isArray(t)){o.each(t,function(e){if(e.prop_type=="handler"){i.push({label:e.label,value:e.label})}})}return i},disabled:function e(t){if(t.isNew()){if(t.get("template_list").indexOf(t.get("name"))==-1)return false}return true}},{id:"laninl",label:a("Inline function"),type:"text",control:"node-ajax-options",group:a("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:false,transform:function e(t){var i=[];if(t&&o.isArray(t)){o.each(t,function(e){if(e.prop_type=="inline"){i.push({label:e.label,value:e.label})}})}return i},disabled:function e(t){if(t.isNew()){if(t.get("template_list").indexOf(t.get("name"))==-1)return false}return true}},{id:"lanval",label:a("Validator function"),type:"text",control:"node-ajax-options",group:a("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],transform:function e(t){var i=[];if(t&&o.isArray(t)){o.each(t,function(e){if(e.prop_type=="validator"){i.push({label:e.label,value:e.label})}})}return i},disabled:function e(t){if(t.isNew()){if(t.get("template_list").indexOf(t.get("name"))==-1)return false}return true}},{id:"lanacl",label:a("Privileges"),type:"collection",group:a("Security"),control:"unique-col-collection",mode:["edit","create"],model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),canAdd:true,canDelete:true,uniqueCol:["grantee"]},{id:"seclabels",label:a("Security labels"),mode:["edit","create"],model:r.SecLabelModel,editable:false,type:"collection",group:a("Security"),min_version:90200,canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection"}],validate:function e(){var t=this.get("name"),i;if(o.isUndefined(t)||o.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){i=a("Name cannot be empty.");this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}if(!this.get("is_template")){var n=this.get("lanproc");if(o.isUndefined(n)||o.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){i=a("Handler function cannot be empty.");this.errorModel.set("lanproc",i);return i}else{this.errorModel.unset("lanproc")}}return null}})})}return r.Nodes["coll-language"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(7),i(16)],a=function(n,e,t,r,i,a,l,o){var s=l.Node.Model.extend({idAttribute:"fdwoption",defaults:{fdwoption:undefined,fdwvalue:undefined},schema:[{id:"fdwoption",label:n("Option"),type:"text",cellHeaderClasses:"width_percent_50",editable:true},{id:"fdwvalue",label:n("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:true}],validate:function e(){if(r.isUndefined(this.get("fdwoption"))||r.isNull(this.get("fdwoption"))||String(this.get("fdwoption")).replace(/^\s+|\s+$/g,"")==""){var t="Please enter an option name";this.errorModel.set("fdwoption",t);return t}else{this.errorModel.unset("fdwoption")}return null}});if(!l.Nodes["coll-foreign_data_wrapper"]){l.Nodes["coll-foreign_data_wrapper"]=l.Collection.extend({node:"foreign_data_wrapper",label:n("Foreign Data Wrappers"),type:"coll-foreign_data_wrapper",columns:["name","fdwowner","description"]})}if(!l.Nodes["foreign_data_wrapper"]){l.Nodes["foreign_data_wrapper"]=l.Node.extend({parent_type:"database",type:"foreign_data_wrapper",sqlAlterHelp:"sql-alterforeigndatawrapper.html",sqlCreateHelp:"sql-createforeigndatawrapper.html",dialogHelp:e("help.static",{filename:"foreign_data_wrapper_dialog.html"}),label:n("Foreign Data Wrapper"),hasSQL:true,hasDepends:true,canDrop:true,canDropCascade:true,Init:function e(){if(this.initialized)return;this.initialized=true;l.add_menus([{name:"create_foreign_data_wrapper_on_coll",node:"coll-foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"},enable:l.Nodes["database"].is_conn_allow}])},model:l.Node.Model.extend({idAttribute:"fdwoid",defaults:{name:undefined,fdwowner:undefined,comment:undefined,fdwvalue:undefined,fdwhan:undefined,fdwoption:undefined,fdwacl:[]},initialize:function e(t,i){var n=r.size(t)===0;if(n){var a=l.serverInfo[i.node_info.server._id].user;this.set({fdwowner:a.name},{silent:true})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:n("Name"),cell:"string",type:"text",disabled:function e(){return this.mode=="edit"&&this.node_info.server.version<90200}},{id:"fdwoid",label:n("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"fdwowner",label:n("Owner"),type:"text",control:o.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:false}},{id:"fdwhan",label:n("Handler"),type:"text",control:"node-ajax-options",group:n("Definition"),mode:["edit","create","properties"],url:"get_handlers"},{id:"description",label:n("Comment"),cell:"string",type:"multiline"},{id:"fdwoptions",label:n("Options"),type:"collection",group:n("Options"),model:s,control:"unique-col-collection",mode:["edit","create"],canAdd:true,canDelete:true,uniqueCol:["fdwoption"],columns:["fdwoption","fdwvalue"]},{id:"fdwvalue",label:n("Validator"),type:"text",control:"node-ajax-options",group:n("Definition"),mode:["edit","create","properties"],url:"get_validators"},{id:"security",label:n("Security"),type:"group"},{id:"fdwacl",label:n("Privileges"),type:"collection",group:"security",mode:["edit","create"],canAdd:true,canDelete:true,uniqueCol:["grantee"],model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection"},{id:"acl",label:n("Privileges"),type:"text",group:n("Security"),mode:["properties"],disabled:true}],validate:function e(){var t=this.get("name");if(r.isUndefined(t)||r.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){var i=n("Name cannot be empty.");this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}return null}})})}return l.Nodes["foreign_data_wrapper"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(0),i(1),i(8),i(3),i(5),i(6),i(7),i(16)],a=function(n,e,r,t,l,o,i){var a=l.Browser.Node.Model.extend({idAttribute:"fsrvoption",defaults:{fsrvoption:undefined,fsrvvalue:undefined},schema:[{id:"fsrvoption",label:n("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:true},{id:"fsrvvalue",label:n("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:true}],validate:function e(){if(r.isUndefined(this.get("fsrvoption"))||r.isNull(this.get("fsrvoption"))||String(this.get("fsrvoption")).replace(/^\s+|\s+$/g,"")==""){var t="Please enter an option name";this.errorModel.set("fsrvoption",t);return t}else{this.errorModel.unset("fsrvoption")}return null}});if(!o.Nodes["coll-foreign_server"]){l.Browser.Nodes["coll-foreign_server"]=l.Browser.Collection.extend({node:"foreign_server",label:n("Foreign Servers"),type:"coll-foreign_server",columns:["name","fsrvowner","description"]})}if(!o.Nodes["foreign_server"]){l.Browser.Nodes["foreign_server"]=l.Browser.Node.extend({parent_type:"foreign_data_wrapper",type:"foreign_server",sqlAlterHelp:"sql-alterforeignserver.html",sqlCreateHelp:"sql-createforeignserver.html",label:n("Foreign Server"),hasSQL:true,hasDepends:true,canDrop:true,canDropCascade:true,Init:function e(){if(this.initialized)return;this.initialized=true;o.add_menus([{name:"create_foreign_server_on_coll",node:"coll-foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}}])},model:l.Browser.Node.Model.extend({idAttribute:"fsrvid",defaults:{name:undefined,fsrvtype:undefined,fsrvversion:undefined,fsrvvalue:undefined,fsrvoptions:[],fsrvowner:undefined,description:undefined,fsrvacl:[]},initialize:function e(t,i){var n=r.size(t)===0;if(n){var a=o.serverInfo[i.node_info.server._id].user;this.set({fsrvowner:a.name},{silent:true})}l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:n("Name"),cell:"string",type:"text",disabled:function e(){return this.mode=="edit"&&this.node_info.server.version<90200}},{id:"fsrvid",label:n("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"fsrvowner",label:n("Owner"),type:"text",control:i.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:false}},{id:"fsrvtype",label:n("Type"),cell:"string",group:n("Definition"),type:"text",mode:["edit","create","properties"],disabled:function e(t){return!t.isNew()}},{id:"fsrvversion",label:n("Version"),cell:"string",group:n("Definition"),type:"text"},{id:"description",label:n("Comment"),cell:"string",type:"multiline"},{id:"fsrvoptions",label:n("Options"),type:"collection",group:n("Options"),model:a,control:"unique-col-collection",mode:["edit","create"],canAdd:true,canDelete:true,uniqueCol:["fsrvoption"],columns:["fsrvoption","fsrvvalue"]},o.SecurityGroupSchema,{id:"fsrvacl",label:n("Privileges"),type:"collection",group:"security",model:l.Browser.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection",mode:["edit","create"],canAdd:true,canDelete:true,uniqueCol:["grantee"]},{id:"acl",label:n("Privileges"),type:"text",group:n("Security"),mode:["properties"],disabled:true}],validate:function e(){var t=this.get("name");if(r.isUndefined(t)||r.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){var i=n("Name cannot be empty.");this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}return null}})})}return o.Nodes["coll-foreign_server"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(7)],a=function(n,e,t,r,i,l,o,a){var s=l.Browser.Node.Model.extend({idAttribute:"umoption",defaults:{umoption:undefined,umvalue:undefined},schema:[{id:"umoption",label:n("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:true},{id:"umvalue",label:n("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:true}],validate:function e(){if(r.isUndefined(this.get("umoption"))||r.isNull(this.get("umoption"))||String(this.get("umoption")).replace(/^\s+|\s+$/g,"")==""){var t="Please enter an option name";this.errorModel.set("umoption",t);return t}else{this.errorModel.unset("umoption")}return null}});if(!o.Nodes["coll-user_mapping"]){l.Browser.Nodes["coll-user_mapping"]=l.Browser.Collection.extend({node:"user_mapping",label:n("User Mappings"),type:"coll-user_mapping",columns:["name"]})}if(!o.Nodes["user_mapping"]){l.Browser.Nodes["user_mapping"]=l.Browser.Node.extend({parent_type:"foreign_server",type:"user_mapping",sqlAlterHelp:"sql-alterusermapping.html",sqlCreateHelp:"sql-createusermapping.html",dialogHelp:e("help.static",{filename:"user_mapping_dialog.html"}),label:n("User Mapping"),hasSQL:true,hasDepends:true,canDrop:true,canDropCascade:true,Init:function e(){if(this.initialized)return;this.initialized=true;o.add_menus([{name:"create_user_mapping_on_coll",node:"coll-user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}}])},model:l.Browser.Node.Model.extend({idAttribute:"um_oid",defaults:{name:undefined,um_options:[]},initialize:function e(t,i){var n=r.size(t)===0;if(n){var a=o.serverInfo[i.node_info.server._id].user;this.set({name:a.name},{silent:true})}l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:n("User"),type:"text",control:a.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:false},disabled:function e(t){return!t.isNew()},transform:function e(){var t=this,i=t.field.get("schema_node");var n=a.NodeListByNameControl.prototype.defaults.transform.apply(this,arguments);n.unshift({label:"CURRENT_USER",value:"CURRENT_USER",image:"icon-"+i.type},{label:"PUBLIC",value:"PUBLIC",image:"icon-"+i.type});return n}},{id:"um_oid",label:n("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"umoptions",label:n("Options"),type:"collection",group:n("Options"),model:s,control:"unique-col-collection",mode:["create","edit"],canAdd:true,canDelete:true,uniqueCol:["umoption"]}],validate:function e(){var t=this.get("name");if(r.isUndefined(t)||r.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){var i=n("Name cannot be empty.");this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}return null}})})}return o.Nodes["coll-user_mapping"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(12),i(7),i(16)],a=function(i,e,d,c,t,r,u,l){u.VacuumCollectionControl=u.Control.extend({grid_columns:undefined,initialize:function e(){u.Control.prototype.initialize.apply(this,arguments);var t=this,i=this.model,n=t.field.get("url");if(n&&i.isNew()){var a=t.field.get("node"),r=t.field.get("node_data"),l=t.field.get("node_info"),o=a.generate_url.apply(a,[null,n,r,false,l]),s;i.trigger("pgadmin-view:fetching",i,t.field);d.ajax({async:false,url:o}).done(function(e){s=e}).fail(function(){i.trigger("pgadmin-view:fetch:error",i,t.field)});i.trigger("pgadmin-view:fetched",i,t.field);if(s&&c.isArray(s)){i.get(t.field.get("name")).reset(s,{silent:true})}}},render:function e(){var t=this,i=t.field.attributes;if(t.grid){t.grid.remove();delete t.grid;t.grid=undefined}t.$el.empty();var n=c.template(['<div class="subnode-header">','  <label class="control-label col-sm-4"><%-label%></label>',"</div>"].join("\n")),a=d('<div class="pgadmin-control-group backgrid form-group col-12 object subnode"></div>').append(n(i));var r=t.grid=new l.Grid({columns:t.grid_columns,collection:t.model.get(t.field.get("name")),className:"backgrid table table-bordered table-noouter-border table-hover"});t.$el.addClass("mb-0");t.$el.append(d(a).append(r.render().$el));return t}});u.cellFunction=function(e){var t=e.get("column_type");switch(t){case"integer":return l.IntegerCell;case"number":return l.NumberCell;case"string":return l.StringCell;default:return l.Cell}};u.VacuumTableModel=r.Node.Model.extend({defaults:{name:undefined,setting:undefined,label:undefined,value:undefined,column_type:undefined},toJSON:function e(){var t=r.Node.Model.prototype.toJSON.apply(this);delete t.label;delete t.setting;delete t.column_type;return t}});u.VacuumSettingsSchema=[{id:"spacer_ctrl",group:i("Table"),mode:["edit","create"],type:"spacer"},{id:"autovacuum_custom",label:i("Custom auto-vacuum?"),group:i("Table"),mode:["edit","create"],type:"switch",disabled:function e(t){if(t.top&&t.top.get("is_partitioned")){setTimeout(function(){t.set("autovacuum_custom",false)},10);return true}if(!t.top.inSchema.apply(this,[t])){return false}return true}},{id:"autovacuum_enabled",label:i("Enabled?"),group:i("Table"),mode:["edit","create"],type:"switch",deps:["autovacuum_custom"],disabled:function e(t){if(!t.top.inSchema.apply(this,[t])&&t.get("autovacuum_custom")==true){if(!c.isUndefined(t.get("reloptions"))&&c.isNull(t.get("reloptions"))){setTimeout(function(){t.set("autovacuum_enabled",true)},10)}return false}setTimeout(function(){t.set("autovacuum_enabled",false)},10);return true},control:u.SwitchControl.extend({onChange:function e(){u.SwitchControl.prototype.onChange.apply(this,arguments);var t=this.model;if(!t.get("autovacuum_enabled")&&!c.isUndefined(t.get("reloptions"))&&c.isNull(t.get("reloptions"))){setTimeout(function(){t.set("autovacuum_custom",false)},10)}}})},{id:"vacuum_table",label:"",model:u.VacuumTableModel,editable:false,type:"collection",canEdit:true,group:i("Table"),mode:["edit","create"],url:"get_table_vacuum",control:u.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:i("Label"),headerCell:l.Extension.CustomHeaderCell,cell:"string",editable:false,cellHeaderClasses:"width_percent_40"},{name:"value",label:i("Value"),cellHeaderClasses:"width_percent_30",cellFunction:u.cellFunction,editable:function e(t){return t.handler.get("autovacuum_enabled")},headerCell:l.Extension.CustomHeaderCell},{name:"setting",label:i("Default"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:u.cellFunction,editable:false}]}),deps:["autovacuum_enabled"]},{id:"spacer_ctrl",group:i("TOAST table"),mode:["edit","create"],type:"spacer"},{id:"toast_autovacuum",label:i("Custom auto-vacuum?"),group:i("TOAST table"),mode:["edit","create"],type:"switch",disabled:function e(t){if(!t.top.inSchema.apply(this,[t])&&t.isNew()){return false}else if(!t.top.inSchema.apply(this,[t])&&(t.get("toast_autovacuum_enabled")===true||t.top.get("hastoasttable")===true)){return false}return true}},{id:"toast_autovacuum_enabled",label:i("Enabled?"),group:i("TOAST table"),mode:["edit","create"],type:"switch",deps:["toast_autovacuum"],disabled:function e(t){if(!t.top.inSchema.apply(this,[t])&&t.get("toast_autovacuum")===true){if(!c.isUndefined(t.get("toast_reloptions"))&&c.isNull(t.get("toast_reloptions"))){setTimeout(function(){t.set("toast_autovacuum_enabled",true)},10)}return false}if(t.isNew()||t.get("hastoasttable")){setTimeout(function(){t.set("toast_autovacuum_enabled",false)},10)}return true},control:u.SwitchControl.extend({onChange:function e(){u.SwitchControl.prototype.onChange.apply(this,arguments);var t=this.model;if(!t.get("toast_autovacuum_enabled")&&!c.isUndefined(t.get("toast_reloptions"))&&c.isNull(t.get("toast_reloptions"))){setTimeout(function(){t.set("toast_autovacuum",false)},10)}}})},{id:"vacuum_toast",label:"",model:u.VacuumTableModel,type:"collection",editable:function e(t){return t.isNew()},canEdit:true,group:i("TOAST table"),mode:["properties","edit","create"],url:"get_toast_table_vacuum",control:u.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:i("Label"),headerCell:l.Extension.CustomHeaderCell,cell:"string",editable:false,cellHeaderClasses:"width_percent_40"},{name:"value",label:i("Value"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:u.cellFunction,editable:function e(t){return t.handler.get("toast_autovacuum_enabled")}},{name:"setting",label:i("Default"),cellHeaderClasses:"width_percent_30",headerCell:l.Extension.CustomHeaderCell,cellFunction:u.cellFunction,editable:false}]}),deps:["toast_autovacuum_enabled"]}];if(!r.Nodes["coll-schema"]){r.Nodes["coll-schema"]=r.Collection.extend({node:"schema",label:i("Schemas"),type:"coll-schema",columns:["name","namespaceowner","description"]})}if(!r.Nodes["schema"]){r.Nodes["schema"]=r.Node.extend({parent_type:"database",type:"schema",sqlAlterHelp:"sql-alterschema.html",sqlCreateHelp:"sql-createschema.html",dialogHelp:e("help.static",{filename:"schema_dialog.html"}),label:i("Schema"),hasSQL:true,canDrop:true,canDropCascade:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;r.add_menus([{name:"create_schema_on_coll",node:"coll-schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"},enable:"can_create_schema"}])},can_create_schema:function e(t){return r.Nodes["database"].is_conn_allow.call(this,t)},model:r.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,namespaceowner:undefined,description:undefined,is_system_obj:undefined},initialize:function e(t,i){var n=c.size(t)===0;if(n){var a=r.serverInfo[i.node_info.server._id].user;this.set({namespaceowner:a.name},{silent:true})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("Name"),cell:"string",type:"text"},{id:"oid",label:i("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"namespaceowner",label:i("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:false}},{id:"is_sys_object",label:i("System schema?"),cell:"switch",type:"switch",mode:["properties"],disabled:true},{id:"description",label:i("Comment"),cell:"string",type:"multiline"},{id:"acl",label:i("Privileges"),type:"text",group:i("Security"),mode:["properties"],disabled:true},{id:"tblacl",label:i("Default TABLE privileges"),type:"text",group:i("Security"),mode:["properties"],disabled:true},{id:"seqacl",label:i("Default SEQUENCE privileges"),type:"text",group:i("Security"),mode:["properties"],disabled:true},{id:"funcacl",label:i("Default FUNCTION privileges"),group:i("Security"),type:"text",mode:["properties"],disabled:true},{id:"typeacl",label:i("Default TYPE privileges"),type:"text",group:i("Security"),mode:["properties"],disabled:true,min_version:90200,visible:function e(){return this.version_compatible}},{id:"nspacl",label:i("Privileges"),model:r.Node.PrivilegeRoleModel.extend({privileges:["C","U"]}),uniqueCol:["grantee","grantor"],editable:false,type:"collection",group:i("Security"),mode:["edit","create"],canAdd:true,canDelete:true,control:"unique-col-collection"},{id:"seclabels",label:i("Security labels"),model:r.SecLabelModel,editable:false,type:"collection",group:i("Security"),mode:["edit","create"],min_version:90200,canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection"},{type:"nested",control:"tab",group:i("Default privileges"),mode:["create","edit"],schema:[{id:"deftblacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:"",editable:false,type:"collection",group:i("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:"",editable:false,type:"collection",group:i("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:"",editable:false,type:"collection",group:i("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:"",editable:false,type:"collection",group:i("Types"),mode:["edit","create"],control:"unique-col-collection",canAdd:true,canDelete:true,uniqueCol:["grantee","grantor"],min_version:90200}]}],validate:function e(){var t=null;this.errorModel.clear();if(c.isUndefined(this.get("name"))||c.isNull(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=i("Name cannot be empty.");this.errorModel.set("name",t);return t}else if(c.isUndefined(this.get("namespaceowner"))||c.isNull(this.get("namespaceowner"))||String(this.get("namespaceowner")).replace(/^\s+|\s+$/g,"")==""){t=i("Owner cannot be empty.");this.errorModel.set("namespaceowner",t);return t}return null}})});r.tableChildTreeNodeHierarchy=function(e){return this.getTreeNodeHierarchy(e)}}l.Extension.TableChildSwitchCell=l.Extension.SwitchCell.extend({initialize:function e(){l.Extension.SwitchCell.prototype.initialize.apply(this,arguments);l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){var t=this.model,i=this.column,n=this.column.get("editable"),a=this.$el.find("input[type=checkbox]").first(),r=i.get("name"),l;l=c.isFunction(n)?!!n.apply(i,[t]):!!n;if(l){this.$el.addClass("editable");a.bootstrapToggle("disabled",false)}else{this.$el.removeClass("editable");a.bootstrapToggle("disabled",true);setTimeout(function(){t.set(r,false)},10)}this.delegateEvents();return this},remove:l.Extension.DependentCell.prototype.remove});return r.Nodes["schema"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(0),i(1),i(3),i(5),i(7)],a=function(e,t,r,i,l){if(!l.Nodes["coll-catalog"]){l.Nodes["coll-catalog"]=l.Collection.extend({node:"catalog",label:e("Catalogs"),type:"coll-catalog",columns:["name","namespaceowner","description"],canDrop:false,canDropCascade:false})}if(!l.Nodes["catalog"]){l.Nodes["catalog"]=l.Node.extend({parent_type:"database",type:"catalog",label:e("Catalog"),hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true},model:l.Node.Model.extend({defaults:{name:undefined,namespaceowner:undefined,nspacl:undefined,description:undefined,securitylabel:[]},initialize:function e(t,i){var n=r.size(t)===0;if(n){var a=l.serverInfo[i.node_info.server._id].user;this.set({namespaceowner:a.name},{silent:true})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:true},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text",disabled:true},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",disabled:true},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"],disabled:true},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"seclabels",label:e("Security labels"),model:l.SecLabelModel,editable:false,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection"}],validate:function e(){return null}})})}return l.Nodes["catalog"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(0),i(1),i(8),i(3),i(5),i(7)],a=function(e,t,i,n,a,r){if(!r.Nodes["coll-catalog_object"]){a.Browser.Nodes["coll-catalog_object"]=a.Browser.Collection.extend({node:"catalog_object",label:e("Catalog Objects"),type:"coll-catalog_object",columns:["name","owner","description"],canDrop:false,canDropCascade:false})}if(!r.Nodes["catalog_object"]){a.Browser.Nodes["catalog_object"]=a.Browser.Node.extend({parent_type:"catalog",type:"catalog_object",label:e("Catalog Object"),hasSQL:false,hasScriptTypes:[],hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true},model:a.Browser.Node.Model.extend({defaults:{name:undefined,namespaceowner:undefined,nspacl:undefined,description:undefined},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:true},{id:"oid",label:e("OID"),cell:"string",type:"text",disabled:true},{id:"owner",label:e("Owner"),cell:"string",type:"text",disabled:true},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:true}]})})}return r.Nodes["catalog_object"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(13),i(11),i(7)],a=function(d,e,t,c,i,l,o,n,a){if(!o.Nodes["coll-collation"]){l.Browser.Nodes["coll-collation"]=l.Browser.Collection.extend({node:"collation",label:d("Collations"),type:"coll-collation",columns:["name","owner","description"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:a.isTreeItemOfChildOfSchema})}if(!o.Nodes["collation"]){l.Browser.Nodes["collation"]=n.SchemaChildNode.extend({type:"collation",sqlAlterHelp:"sql-altercollation.html",sqlCreateHelp:"sql-createcollation.html",dialogHelp:e("help.static",{filename:"collation_dialog.html"}),label:d("Collation"),collection_type:"coll-collation",hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;o.add_menus([{name:"create_collation_on_coll",node:"coll-collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:true},enable:"canCreate"},{name:"create_collation",node:"collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:true},enable:"canCreate"},{name:"create_collation",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:false},enable:"canCreate"}])},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,owner:undefined,lc_type:undefined,lc_collate:undefined,description:undefined},initialize:function e(t,i){var n=c.size(t)===0;if(n){var a=o.serverInfo[i.node_info.server._id].user;var r=i.node_info.schema;this.set({owner:a.name},{silent:true});this.set({schema:r._label},{silent:true})}l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:d("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:d("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:d("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema",control:"node-list-by-name",node:"role"},{id:"schema",label:d("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"inSchema",filter:function e(t){if(t&&t.label.match(/^pg_/)){return false}return true},control:"node-list-by-name",cache_node:"database",cached_level:"database"},{id:"copy_collation",label:d("Copy collation"),cell:"string",control:"node-ajax-options",type:"text",mode:["create","edit"],group:d("Definition"),url:"get_collations",disabled:"inSchemaWithModelCheck",deps:["locale","lc_collate","lc_type"]},{id:"locale",label:d("Locale"),cell:"string",type:"text",mode:["create","edit"],group:d("Definition"),disabled:"inSchemaWithModelCheck",deps:["lc_collate","lc_type","copy_collation"]},{id:"lc_collate",label:d("LC_COLLATE"),cell:"string",type:"text",mode:["properties","create","edit"],group:d("Definition"),deps:["locale","copy_collation"],disabled:"inSchemaWithModelCheck"},{id:"lc_type",label:d("LC_TYPE"),cell:"string",type:"text",mode:["properties","create","edit"],group:d("Definition"),disabled:"inSchemaWithModelCheck",deps:["locale","copy_collation"]},{id:"description",label:d("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function e(){var t={},i=undefined,n=this.changed,a=false,r=false,l=false,o=false,s=this.toJSON();this.errorModel.clear();if(c.has(n,s.name)&&c.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){i=d("Name cannot be empty.");this.errorModel.set("name",i)}if(c.has(n,s.locale)&&(c.isUndefined(this.get("locale"))||String(this.get("locale")).replace(/^\s+|\s+$/g,"")=="")){a=true}if(c.has(n,s.lc_collate)&&(c.isUndefined(this.get("lc_collate"))||String(this.get("lc_collate")).replace(/^\s+|\s+$/g,"")=="")){l=true}if(c.has(n,s.lc_type)&&(c.isUndefined(this.get("lc_type"))||String(this.get("lc_type")).replace(/^\s+|\s+$/g,"")=="")){r=true}if(c.has(n,s.copy_collation)&&(c.isUndefined(this.get("copy_collation"))||String(this.get("copy_collation")).replace(/^\s+|\s+$/g,"")=="")){o=true}if(a&&(l||r)&&o){i=d("Definition incomplete. Please provide Locale OR Copy Collation OR LC_TYPE/LC_COLLATE.");t["locale"]=i}return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()&&this.name=="copy_collation"){if(t.get("locale"))return true;if(t.get("lc_collate")||t.get("lc_type"))return true;return false}if(t.isNew()&&(this.name=="lc_collate"||this.name=="lc_type")){if(t.get("locale"))return true;if(t.get("copy_collation"))return true;return false}if(t.isNew()&&this.name=="locale"){if(t.get("lc_collate")||t.get("lc_type"))return true;if(t.get("copy_collation"))return true;return false}if(t.isNew()){return false}else{return true}}return true}})})}return o.Nodes["collation"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(6),i(12),i(13),i(11),i(7)],a=function(n,e,t,l,i,a,o,r,s,d,c){if(!o.Nodes["coll-domain"]){o.Nodes["coll-domain"]=o.Collection.extend({node:"domain",label:n("Domains"),type:"coll-domain",columns:["name","owner","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema})}var u=o.Node.Model.extend({idAttribute:"conoid",initialize:function e(t){if(!l.size(t)===0){this.convalidated_default=this.get("convalidated")}o.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:undefined,conname:undefined,consrc:undefined,convalidated:true},convalidated_default:true,schema:[{id:"conoid",type:"text",cell:"string",visible:false},{id:"conname",label:n("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_40",editable:function e(t){if(l.isUndefined(t.isNew)){return true}if(!t.isNew()){var i=this.get("node_info").server;if(i.version<90200){return false}}return true}},{id:"consrc",label:n("Check"),type:"multiline",cell:s.Extension.TextareaCell,group:n("Definition"),cellHeaderClasses:"width_percent_60",editable:function e(t){return l.isUndefined(t.isNew)?true:t.isNew()}},{id:"convalidated",label:n("Validate?"),type:"switch",cell:"boolean",group:n("Definition"),editable:function e(t){var i=this.get("node_info").server;if(i.version<90200){return false}if(l.isUndefined(t.isNew)){return true}if(!t.isNew()){if(t.get("convalidated")&&t.convalidated_default){return false}return true}return true}}],toJSON:i.Model.prototype.toJSON,validate:function e(){return null}});if(!o.Nodes["domain"]){o.Nodes["domain"]=d.SchemaChildNode.extend({type:"domain",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-createdomain.html",dialogHelp:e("help.static",{filename:"domain_dialog.html"}),label:n("Domain"),collection_type:"coll-domain",hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;o.add_menus([{name:"create_domain_on_coll",node:"coll-domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:true},enable:"canCreate"},{name:"create_domain",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:true},enable:"canCreate"},{name:"create_domain",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:false},enable:"canCreate"}])},model:o.Node.Model.extend({idAttribute:"oid",initialize:function e(t,i){var n=l.size(t)===0;if(n){var a=i.node_info.schema.label;this.set({basensp:a},{silent:true});var r=o.serverInfo[i.node_info.server._id].user;this.set({owner:r.name},{silent:true})}o.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:undefined,oid:undefined,owner:undefined,basensp:undefined,description:undefined,basetype:undefined,typlen:undefined,precision:undefined,typdefault:undefined,typnotnull:undefined,sysdomain:undefined,collname:undefined,constraints:[],seclabels:[]},type_options:undefined,schema:[{id:"name",label:n("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:n("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:n("Owner"),cell:"string",control:r.NodeListByNameControl,node:"role",type:"text",mode:["edit","create","properties"]},{id:"basensp",label:n("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"sysdomain",label:n("System domain?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:n("Comment"),cell:"string",type:"multiline"},{id:"basetype",label:n("Base type"),cell:"string",control:"node-ajax-options",type:"text",url:"get_types",mode:["properties","create","edit"],group:n("Definition"),first_empty:true,cache_node:"type",disabled:function e(t){return!t.isNew()},transform:function e(t){this.model.type_options=t;return t}},{id:"typlen",label:n("Length"),cell:"string",type:"text",group:n("Definition"),deps:["basetype"],disabled:function e(t){if(!t.isNew()){return true}var i=t.get("basetype");if(t.type_options){l.each(t.type_options,function(e){if(i==e.value){if(e.length){t.set("is_tlength",true,{silent:true});t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true})}}})}return!t.get("is_tlength")}},{id:"precision",label:n("Precision"),cell:"string",type:"text",group:n("Definition"),deps:["basetype"],disabled:function e(t){if(!t.isNew()){return true}var i=t.get("basetype");if(t.type_options){l.each(t.type_options,function(e){if(i==e.value){if(e.precision){t.set("is_precision",true,{silent:true});t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true})}}})}return!t.get("is_precision")}},{id:"typdefault",label:n("Default"),cell:"string",type:"text",group:n("Definition"),placeholder:"Enter an expression or a value."},{id:"typnotnull",label:n("Not NULL?"),cell:"boolean",type:"switch",group:n("Definition")},{id:"collname",label:n("Collation"),cell:"string",control:"node-ajax-options",type:"text",url:"get_collations",group:n("Definition"),cache_level:"database",cache_node:"schema",disabled:function e(t){return!t.isNew()}},{id:"constraints",label:n("Constraints"),cell:"string",type:"collection",group:n("Constraints"),mode:["edit","create"],model:u,canAdd:true,canDelete:true,canEdit:false,columns:["conname","consrc","convalidated"]},o.SecurityGroupSchema,{id:"seclabels",label:n("Security labels"),model:o.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function e(){var t={},i;if(l.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t["name"]=n("Name cannot be empty.");i=i||t["name"]}if(l.isUndefined(this.get("basetype"))||String(this.get("basetype")).replace(/^\s+|\s+$/g,"")==""){t["basetype"]=n("Base Type cannot be empty.");i=i||t["basetype"]}this.errorModel.clear().set(t);return i}}),isDisabled:function e(t){if(!t.isNew()){var i=this.node_info.server;if(i.version<90200){return false}}return true}})}return o.Nodes["domain"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(11),i(7)],a=function(n,e,t,a,i,r,l,o){if(!l.Nodes["coll-domain_constraints"]){r.Browser.Nodes["coll-domain_constraints"]=r.Browser.Collection.extend({node:"domain_constraints",label:n("Domain Constraints"),type:"coll-domain_constraints",columns:["name","description"],canDrop:o.isTreeItemOfChildOfSchema,canDropCascade:false})}if(!l.Nodes["domain_constraints"]){r.Browser.Nodes["domain_constraints"]=l.Node.extend({type:"domain_constraints",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-alterdomain.html",dialogHelp:e("help.static",{filename:"domain_constraint_dialog.html"}),label:n("Domain Constraints"),collection_type:"coll-domain_constraints",hasSQL:true,hasDepends:true,parent_type:["domain"],Init:function e(){if(this.initialized)return;this.initialized=true;l.add_menus([{name:"create_domain_on_coll",node:"coll-domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:n("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:true},enable:"canCreate"},{name:"create_domain_constraints",node:"domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:n("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:true},enable:"canCreate"},{name:"create_domain_constraints",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:n("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:false},enable:"canCreate"}])},canDrop:o.isTreeItemOfChildOfSchema,model:r.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,description:undefined,consrc:undefined,connoinherit:undefined,convalidated:true},schema:[{id:"name",label:n("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:n("OID"),cell:"string",type:"text",mode:["properties"]},{id:"description",label:n("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],min_version:90500},{id:"consrc",label:n("Check"),type:"multiline",cel:"string",group:n("Definition"),mode:["properties","create","edit"],disabled:function e(t){return!t.isNew()}},{id:"connoinherit",label:n("No inherit?"),type:"switch",cell:"boolean",group:n("Definition"),mode:["properties","create","edit"],disabled:"isDisabled",visible:false},{id:"convalidated",label:n("Validate?"),type:"switch",cell:"boolean",group:n("Definition"),min_version:90200,disabled:function e(t){if(!t.isNew()){var i=this.node_info.server;if(i.version<90200){return true}else if(t.get("convalidated")){return true}return false}return false},mode:["properties","create","edit"]}],validate:function e(){var t={},i;if(a.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t["name"]=n("Name cannot be empty.");i=i||t["name"]}if(a.isUndefined(this.get("consrc"))||String(this.get("consrc")).replace(/^\s+|\s+$/g,"")==""){t["consrc"]=n("Check cannot be empty.");i=i||t["consrc"]}this.errorModel.clear().set(t);if(a.size(t)){this.trigger("on-status",{msg:i});return i}return null},isDisabled:function e(t){if(!t.isNew()){var i=this.node_info.server;if(i.version<90200){return true}}return false}})})}return l.Nodes["domain"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(6),i(12),i(13),i(11),i(7)],a=function(n,e,u,f,m,t,p,i,a,r,l){if(!p.Nodes["coll-foreign_table"]){p.Nodes["coll-foreign_table"]=p.Collection.extend({node:"foreign_table",label:n("Foreign Tables"),type:"coll-foreign_table",columns:["name","owner","description"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})}var o=p.Node.Model.extend({idAttribute:"option",defaults:{option:undefined,value:undefined},schema:[{id:"option",label:n("Option"),type:"text",editable:true,cellHeaderClasses:"width_percent_30"},{id:"value",label:n("Value"),type:"text",editable:true,cellHeaderClasses:"width_percent_50"}],validate:function e(){if(f.isUndefined(this.get("value"))||f.isNull(this.get("value"))||String(this.get("value")).replace(/^\s+|\s+$/g,"")==""){var t="Please enter a value.";this.errorModel.set("value",t);return t}else{this.errorModel.unset("value")}return null}});var s=p.Node.Model.extend({idAttribute:"attnum",defaults:{attname:undefined,datatype:undefined,typlen:undefined,precision:undefined,typdefault:undefined,attnotnull:undefined,collname:undefined,attnum:undefined,inheritedfrom:undefined,inheritedid:undefined,attstattarget:undefined,coloptions:[]},type_options:undefined,schema:[{id:"attname",label:n("Name"),cell:"string",type:"text",editable:"is_editable_column",cellHeaderClasses:"width_percent_40"},{id:"datatype",label:n("Data type"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_types",editable:"is_editable_column",cellHeaderClasses:"width_percent_0",group:n("Definition"),transform:function e(t,i){i.model.type_options=t;return t}},{id:"typlen",label:n("Length"),cell:"string",group:n("Definition"),type:"int",deps:["datatype"],disabled:function e(t){var i=t.get("typlen");if(!(f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom")))){if(!f.isUndefined(i)){setTimeout(function(){t.set("typlen",undefined)},10)}return true}var n=t.get("datatype"),a=false;if(t.type_options){t.set("is_tlength",false,{silent:true});f.each(t.type_options,function(e){if(n==e.value){if(e.length){a=true;t.set("is_tlength",true,{silent:true});t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true})}}});if(!a&&!f.isUndefined(i)){setTimeout(function(){t.set("typlen",undefined)},10)}return!t.get("is_tlength")}if(!a&&!f.isUndefined(i)){setTimeout(function(){t.set("typlen",undefined)},10)}return true},cellHeaderClasses:"width_percent_10"},{id:"precision",label:n("Precision"),type:"int",deps:["datatype"],cell:"string",group:n("Definition"),disabled:function e(t){var i=t.get("precision");if(!(f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom")))){if(!f.isUndefined(i)){setTimeout(function(){t.set("precision",undefined)},10)}return true}var n=t.get("datatype"),a=false;if(t.type_options){t.set("is_precision",false,{silent:true});f.each(t.type_options,function(e){if(n==e.value){if(e.precision){a=true;t.set("is_precision",true,{silent:true});t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true})}}});if(!a&&!f.isUndefined(i)){setTimeout(function(){t.set("precision",undefined)},10)}return!t.get("is_precision")}if(!a&&!f.isUndefined(i)){setTimeout(function(){t.set("precision",undefined)},10)}return true},cellHeaderClasses:"width_percent_10"},{id:"typdefault",label:n("Default"),type:"text",cell:"string",min_version:90300,group:n("Definition"),placeholder:"Enter an expression or a value.",cellHeaderClasses:"width_percent_10",editable:function e(t){if(!(f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom")))){return false}if(this.get("node_info").server.version<90300){return false}return true}},{id:"attnotnull",label:n("Not NULL?"),cell:"boolean",type:"switch",editable:"is_editable_column",cellHeaderClasses:"width_percent_10",group:n("Definition")},{id:"attstattarget",label:n("Statistics"),min_version:90200,cell:"integer",type:"int",group:n("Definition"),editable:function e(t){if(f.isUndefined(t.isNew)||t.isNew()){return false}if(this.get("node_info").server.version<90200){return false}return f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom"))?true:false},cellHeaderClasses:"width_percent_10"},{id:"collname",label:n("Collation"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_collations",min_version:90300,editable:function e(t){if(!f.isUndefined(t.isNew)&&!t.isNew()){return false}return f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom"))?true:false},cellHeaderClasses:"width_percent_20",group:n("Definition")},{id:"attnum",cell:"string",type:"text",visible:false},{id:"inheritedfrom",label:n("Inherited From"),cell:"string",type:"text",visible:false,mode:["properties","edit"],cellHeaderClasses:"width_percent_10"},{id:"coloptions",label:n("Options"),cell:"string",type:"collection",group:n("Options"),mode:["edit","create"],model:o,canAdd:true,canDelete:true,canEdit:false,control:i.UniqueColCollectionControl,uniqueCol:["option"],min_version:90200}],validate:function e(){var t=null;if(f.isUndefined(this.get("attname"))||String(this.get("attname")).replace(/^\s+|\s+$/g,"")==""){t=n("Column Name cannot be empty.");this.errorModel.set("attname",t)}else{this.errorModel.unset("attname")}if(f.isUndefined(this.get("datatype"))||String(this.get("datatype")).replace(/^\s+|\s+$/g,"")==""){t=n("Column Datatype cannot be empty.");this.errorModel.set("datatype",t)}else{this.errorModel.unset("datatype")}return t},is_editable_column:function e(t){return f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom"))?true:false},toJSON:m.Model.prototype.toJSON});var d=i.NodeAjaxOptionsControl.extend({onChange:function e(){var t=this.model,i=this.field.get("name").split("."),n=i.shift(),a=i.join("."),r=this.getValueFromDOM(),l={},o=t.get("columns"),s=t.get(n);if(this.model.errorModel instanceof m.Model){if(f.isEmpty(a)){this.model.errorModel.unset(n)}else{var d=this.model.errorModel.get(n);if(d){this.keyPathSetter(d,a,null);this.model.errorModel.set(n,d)}}}var c=this;if(typeof s=="string"){s=JSON.parse(s)}if(f.size(r)<f.size(s)){var u=f.difference(s,r);var p=o.where({inheritedid:parseInt(u[0])});o.remove(p)}else{f.each(r,function(e){var t=o.where({inheritedid:parseInt(e)});if(t&&t.length<=0){var i=c.fetchColumns(e);o.add(i)}})}l[n]=f.isEmpty(a)?r:f.clone(t.get(n))||{};this.stopListening(this.model,"change:"+n,this.render);t.set(l);this.listenTo(this.model,"change:"+n,this.render)},fetchColumns:function e(t){var i=this,n="get_columns",a=i.model.top||i.model;if(n){var r=this.field.get("schema_node"),l=this.field.get("node_info"),o=r.generate_url.apply(r,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||false,l]),s=this.field.get("cache_level")||r.type,d=this.field.get("cache_node");d=d&&p.Nodes["cache_node"]||r;a.trigger("pgadmin:view:fetching",a,i.field);var c={attrelid:t};u.ajax({async:false,url:o,data:c}).done(function(e){c=d.cache(n,l,s,e.data)}).fail(function(){a.trigger("pgadmin:view:fetch:error",a,i.field)});a.trigger("pgadmin:view:fetched",a,i.field);c=c&&c.data||[];return c}}});var c=p.Node.Model.extend({idAttribute:"conoid",initialize:function e(t){var i=f.size(t)===0;if(!i){this.convalidated_default=this.get("convalidated")}p.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:undefined,conname:undefined,consrc:undefined,connoinherit:undefined,convalidated:true,conislocal:undefined},convalidated_default:true,schema:[{id:"conoid",type:"text",cell:"string",visible:false},{id:"conname",label:n("Name"),type:"text",cell:"string",editable:"is_editable",cellHeaderClasses:"width_percent_30"},{id:"consrc",label:n("Check"),type:"multiline",editable:"is_editable",cell:a.Extension.TextareaCell,cellHeaderClasses:"width_percent_30"},{id:"connoinherit",label:n("No inherit?"),type:"switch",cell:"boolean",editable:"is_editable",cellHeaderClasses:"width_percent_20"},{id:"convalidated",label:n("Validate?"),type:"switch",cell:"boolean",cellHeaderClasses:"width_percent_20",editable:function e(t){if(f.isUndefined(t.isNew)){return true}if(!t.isNew()){if(t.get("convalidated")&&t.convalidated_default){return false}return true}return true}}],validate:function e(){var t={},i;if(f.isUndefined(this.get("conname"))||String(this.get("conname")).replace(/^\s+|\s+$/g,"")==""){t["conname"]=n("Constraint Name cannot be empty.");i=i||t["conname"]}if(f.isUndefined(this.get("consrc"))||String(this.get("consrc")).replace(/^\s+|\s+$/g,"")==""){t["consrc"]=n("Constraint Check cannot be empty.");i=i||t["consrc"]}this.errorModel.clear().set(t);return i},is_editable:function e(t){return f.isUndefined(t.isNew)?true:t.isNew()},toJSON:m.Model.prototype.toJSON});var g=p.Node.Model.extend({defaults:{option:undefined,value:undefined},schema:[{id:"option",label:n("Option"),cell:"string",type:"text",editable:true,cellHeaderClasses:"width_percent_50"},{id:"value",label:n("Value"),cell:"string",type:"text",editable:true,cellHeaderClasses:"width_percent_50"}],validate:function e(){},toJSON:m.Model.prototype.toJSON});if(!p.Nodes["foreign_table"]){p.Nodes["foreign_table"]=r.SchemaChildNode.extend({type:"foreign_table",sqlAlterHelp:"sql-alterforeigntable.html",sqlCreateHelp:"sql-createforeigntable.html",dialogHelp:e("help.static",{filename:"foreign_table_dialog.html"}),label:n("Foreign Table"),collection_type:"coll-foreign_table",hasSQL:true,hasDepends:true,hasScriptTypes:["create","select","insert","update","delete"],parent_type:["schema"],Init:function e(){if(this.initialized)return;this.initialized=true;p.add_menus([{name:"create_foreign_table_on_coll",node:"coll-foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:true},enable:"canCreate"},{name:"create_foreign_table",node:"foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:true},enable:"canCreate"},{name:"create_foreign_table",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:false},enable:"canCreate"}])},model:p.Node.Model.extend({idAttribute:"oid",initialize:function e(t,i){var n=f.size(t)===0;if(n){var a=i.node_info.schema._label,r=p.serverInfo[i.node_info.server._id].user;this.set({basensp:a,owner:r.name},{silent:true})}p.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:undefined,oid:undefined,owner:undefined,basensp:undefined,description:undefined,ftsrvname:undefined,strftoptions:undefined,inherits:[],columns:[],constraints:[],ftoptions:[],relacl:[],stracl:[],seclabels:[]},schema:[{id:"name",label:n("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:n("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:n("Owner"),cell:"string",control:i.NodeListByNameControl,node:"role",type:"text",select2:{allowClear:false}},{id:"basensp",label:n("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"description",label:n("Comment"),cell:"string",type:"multiline"},{id:"ftsrvname",label:n("Foreign server"),cell:"string",control:"node-ajax-options",type:"text",group:n("Definition"),url:"get_foreign_servers",disabled:function e(t){return!t.isNew()},cache_node:"database"},{id:"inherits",label:n("Inherits"),group:n("Definition"),type:"array",min_version:90500,control:d,url:"get_tables",select2:{multiple:true},cache_level:"database",transform:function e(t){if(this.field.get("mode")=="edit"){var i=this.model.get("oid");var n=f.findWhere(t,{id:i});if(n){t=f.reject(t,n)}}return t}},{id:"columns",label:n("Columns"),cell:"string",type:"collection",group:n("Columns"),mode:["edit","create"],model:s,canAdd:true,canDelete:true,canEdit:true,columns:["attname","datatype","inheritedfrom"],canDeleteRow:function e(t){return f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom"))?true:false},canEditRow:function e(t){return f.isUndefined(t.get("inheritedid"))||f.isNull(t.get("inheritedid"))||f.isUndefined(t.get("inheritedfrom"))||f.isNull(t.get("inheritedfrom"))?true:false}},{id:"constraints",label:n("Constraints"),cell:"string",type:"collection",group:n("Constraints"),mode:["edit","create"],model:c,canAdd:true,canDelete:true,columns:["conname","consrc","connoinherit","convalidated"],canEdit:function e(t){if(t instanceof m.Model){if(t instanceof c){return t.isNew()}}return true},min_version:90500,canDeleteRow:function e(t){return t.get("conislocal")==true||f.isUndefined(t.get("conislocal"))?true:false}},{id:"strftoptions",label:n("Options"),cell:"string",type:"text",group:n("Definition"),mode:["properties"]},{id:"ftoptions",label:n("Options"),cell:"string",type:"collection",group:n("Options"),mode:["edit","create"],model:g,canAdd:true,canDelete:true,canEdit:false,control:"unique-col-collection",uniqueCol:["option"]},{id:"relacl",label:n("Privileges"),cell:"string",type:"text",group:n("Security"),mode:["properties"],min_version:90200},p.SecurityGroupSchema,{id:"acl",label:n("Privileges"),model:t.Browser.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),uniqueCol:["grantee","grantor"],editable:false,type:"collection",group:"security",mode:["edit","create"],canAdd:true,canDelete:true,control:"unique-col-collection",min_version:90200},{id:"seclabels",label:n("Security labels"),model:p.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:true,canEdit:false,canDelete:true,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function e(){var t={},i=null;if(f.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t["name"]=n("Name cannot be empty.");i=i||t["name"]}if(f.isUndefined(this.get("basensp"))||String(this.get("basensp")).replace(/^\s+|\s+$/g,"")==""){t["basensp"]=n("Schema cannot be empty.");i=i||t["basensp"]}if(f.isUndefined(this.get("ftsrvname"))||String(this.get("ftsrvname")).replace(/^\s+|\s+$/g,"")==""){t["ftsrvname"]=n("Foreign server cannot be empty.");i=i||t["ftsrvname"]}this.errorModel.clear().set(t);return i}})})}return p.Nodes["foreign_table"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(6),i(12),i(13),i(11),i(7)],a=function(o,e,u,p,s,f,r,m,d,t,i){var n=f.Browser.Node.Model.extend({defaults:{token:undefined,dictname:undefined},keys:["token"],schema:[{id:"token",label:o("Token"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:false,cell:"string",url:"tokens"},{id:"dictname",label:o("Dictionaries"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:true,cell:d.Extension.MultiSelectAjaxCell,url:"dictionaries"}],validate:function e(){var t;this.errorModel.clear();var i=this.get("token");var n=this.get("dictname");if(p.isNull(i)||p.isUndefined(i)||String(i).replace(/^\s+|\s+$/g,"")==""){t=o("Token cannot be empty.");this.errorModel.set("token",t);return t}if(p.isNull(n)||p.isUndefined(n)||String(n).replace(/^\s+|\s+$/g,"")==""){t=o("Dictionary name cannot be empty.");this.errorModel.set("dictname",t);return t}return null}});var a=m.TokenControl=m.UniqueColCollectionControl.extend({initialize:function e(){m.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var t=this,i=[{id:"token",label:"",type:"text",url:"tokens",node:"fts_configuration",canAdd:true,url_with_id:true,control:m.NodeAjaxOptionsControl.extend({formatter:m.NodeAjaxOptionsControl.prototype.formatter,initialize:function e(){m.NodeAjaxOptionsControl.prototype.initialize.apply(this,arguments);var t=this,i=t.field.get("url")||t.defaults.url,n=t.model.top||t.model;if(i){var a=this.field.get("schema_node"),r=this.field.get("node_info"),l=a.generate_url.apply(a,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||false,r]),o=this.field.get("cache_level")||a.type,s=this.field.get("cache_node");s=s&&f.Browser.Nodes[s]||a;var d=s.cache(i,r,o);if(this.field.get("version_compatible")&&(p.isUndefined(d)||p.isNull(d))){n.trigger("pgadmin:view:fetching",n,t.field);u.ajax({async:false,url:l}).done(function(e){d=s.cache(i,r,o,e.data)}).fail(function(){n.trigger("pgadmin:view:fetch:error",n,t.field)});n.trigger("pgadmin:view:fetched",n,t.field)}d=d&&d.data||[];var c=this.field.get("transform")||t.defaults.transform;if(c&&p.isFunction(c)){t.field.set("options",c.bind(t,d))}else{t.field.set("options",d)}}}}),select2:{allowClear:true,width:"style",placeholder:o("Select token")},first_empty:true,disabled:function e(){return p.isUndefined(t.model.get("oid"))}}],n={token:null},a=["token","dictname"];t.headerData=new(s.Model.extend({defaults:n,schema:i}))({});var r=m.generateViewSchema(t.field.get("node_info"),t.headerData,"create",t.field.get("schema_node"),t.field.get("node_data")),l=[];p.each(r,function(e){l=l.concat(e.fields)});t.headerFields=new m.Fields(l);t.gridSchema=m.generateGridColumnsFromModel(t.field.get("node_info"),t.field.get("model"),"edit",a,t.field.get("schema_node"));t.controls=[];t.listenTo(t.headerData,"change",t.headerDataChanged);t.listenTo(t.headerData,"select2",t.headerDataChanged);t.listenTo(t.collection,"add",t.onAddorRemoveTokens);t.listenTo(t.collection,"remove",t.onAddorRemoveTokens)},generateHeader:function e(t){var i=['<div class="subnode-header-form">',' <div class="container-fluid">','  <div class="row">','   <div class="col-3">','    <label class="control-label"><%-token_label%></label>',"   </div>",'   <div class="col-6" header="token"></div>','   <div class="col-2">','     <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>',"   </div>","  </div>"," </div>","</div>"].join("\n");p.extend(t,{token_label:o("Tokens")});var n=this,a=p.template(i),r=u(a(t)),l=this.controls;n.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:n.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el);t.$el.find(".control-label").remove();l.push(t)});if(t.mode=="properties"){r.find("button.add").remove()}if(t.mode=="create"){r.find("button.add").attr("disabled",true)}n.$header=r;return r},events:p.extend({},m.UniqueColCollectionControl.prototype.events,{"click button.add":"addTokens"}),showGridControl:function e(t){var i=this,n=p.template("<div class='subnode-header'></div>"),a=u("<div></div>",{class:"pgadmin-control-group backgrid form-group col-12 object subnode"}).append(n({label:t.label}));a.append(i.generateHeader(t));var r=p.clone(this.gridSchema.columns);if(t.disabled==false&&t.canDelete){r.unshift({name:"pg-backform-delete",label:"",cell:d.Extension.DeleteCell,editable:false,cell_priority:-1})}if(i.grid){i.grid.remove();i.grid.null}var l=i.grid=new d.Grid({columns:r,collection:i.collection,className:"backgrid table-bordered"});i.$grid=l.render().$el;a.append(i.$grid);setTimeout(function(){i.headerData.set({token:i.$header.find('div[header="token"] select').val()},{silent:true})},10);return a},headerDataChanged:function e(){var t=this,i=this.headerData.toJSON(),n=p.isEmpty(i)||p.isUndefined(i);if(!t.$header){return}t.$header.find("button.add").prop("disabled",n)},addTokens:function e(t){t.preventDefault();var i=this,n=i.headerData.get("token");if(!n||n==""){return false}var a=i.model.get(i.field.get("name")),r=new(i.field.get("model"))(i.headerData.toJSON(),{silent:true,top:i.model.top,collection:a,handler:a}),l=["token"],o=-1;i.collection.each(function(i){p.each(l,function(e){var t=i.get(e);if(t==n){o=a.indexOf(i)}})});if(o==-1){a.add(r);o=a.indexOf(r)}i.$grid.find(".new").removeClass("new");var s=i.grid.body.rows[o].$el;s.addClass("new");u(s).pgMakeVisible("backform-tab");return false},onAddorRemoveTokens:function e(){var t=this;setTimeout(function(){t.collection.trigger("pgadmin:tokens:updated",t.collection);t.headerDataChanged()},10)},remove:function e(){this.stopListening(this.headerData,"change",this.headerDataChanged);this.listenTo(this.headerData,"select2",this.headerDataChanged);this.listenTo(this.collection,"remove",this.onAddorRemoveTokens);p.each(this.controls,function(e){e.remove()});a.__super__.remove.apply(this,arguments);delete this.headerData}});if(!r.Nodes["coll-fts_configuration"]){f.Browser.Nodes["coll-fts_configuration"]=f.Browser.Collection.extend({node:"fts_configuration",label:o("FTS Configurations"),type:"coll-fts_configuration",columns:["name","description"],canDrop:i.isTreeItemOfChildOfSchema,canDropCascade:i.isTreeItemOfChildOfSchema})}if(!r.Nodes["fts_configuration"]){f.Browser.Nodes["fts_configuration"]=t.SchemaChildNode.extend({type:"fts_configuration",sqlAlterHelp:"sql-altertsconfig.html",sqlCreateHelp:"sql-createtsconfig.html",dialogHelp:e("help.static",{filename:"fts_configuration_dialog.html"}),label:o("FTS Configuration"),hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;r.add_menus([{name:"create_fts_configuration_on_schema",node:"schema",module:this,category:"create",priority:4,applies:["object","context"],callback:"show_obj_properties",label:o("FTS Configuration..."),icon:"wcTabIcon icon-fts_configuration",data:{action:"create"},enable:"canCreate"},{name:"create_fts_configuration_on_coll",module:this,priority:4,node:"coll-fts_configuration",applies:["object","context"],callback:"show_obj_properties",category:"create",label:o("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"},{name:"create_fts_configuration",node:"fts_configuration",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"}])},model:f.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,owner:undefined,description:undefined,schema:undefined,prsname:undefined,copy_config:undefined,tokens:undefined},initialize:function e(t,i){var n=p.size(t)===0;f.Browser.Node.Model.prototype.initialize.apply(this,arguments);if(n){var a=r.serverInfo[i.node_info.server._id].user;this.set({owner:a.name,schema:i.node_info.schema._id},{silent:true})}},schema:[{id:"name",label:o("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:o("OID"),cell:"string",editable:false,type:"text",disabled:true,mode:["properties"]},{id:"owner",label:o("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:m.NodeListByNameControl,select2:{allowClear:false}},{id:"schema",label:o("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:o("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsname",label:o("Parser"),type:"text",url:"parsers",first_empty:true,group:o("Definition"),control:"node-ajax-options",deps:["copy_config"],disabled:function e(t){var i=t.get("copy_config");return t.isNew()&&(p.isNull(i)||p.isUndefined(i)||i==="")?false:true}},{id:"copy_config",label:o("Copy config"),type:"text",mode:["create"],group:o("Definition"),control:"node-ajax-options",url:"copyConfig",deps:["prsname"],disabled:function e(t){var i=t.get("prsname");return t.isNew()&&(p.isNull(i)||p.isUndefined(i)||i==="")?false:true}},{id:"tokens",label:o("Tokens"),type:"collection",group:o("Tokens"),control:a,model:n,columns:["token","dictionary"],uniqueCol:["token"],mode:["create","edit"],canAdd:true,canEdit:false,canDelete:true}],validate:function e(){var t;var i=this.get("name");var n=this.get("prsname");var a=!(n===""||p.isUndefined(n)||p.isNull(n))?this.get("prsname"):this.get("copy_config");var r=this.get("schema");this.errorModel.clear();this.trigger("on-status-clear");if(p.isUndefined(i)||p.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){t=o("Name must be specified.");this.errorModel.set("name",t);return t}else if(p.isUndefined(a)||p.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==""){t=o("Select parser or configuration to copy.");this.errorModel.set("parser",t);return t}else if(p.isUndefined(r)||p.isNull(r)||String(r).replace(/^\s+|\s+$/g,"")==""){t=o("Schema must be selected.");this.errorModel.set("schema",t);return t}return null}})})}return r.Nodes["coll-fts_configuration"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(13),i(11),i(7)],a=function(r,e,t,l,i,o,s,n,a,d){var c=o.Browser.Node.Model.extend({defaults:{options:undefined,value:undefined},schema:[{id:"option",label:r("Option"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:true},{id:"value",label:r("Value"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:true}],validate:function e(){this.errorModel.clear();var t;if(l.isUndefined(this.get("option"))||String(this.get("option")).replace(/^\s+|\s+$/g,"")==""){t=r("Option cannot be empty.");this.errorModel.set("option",t);return t}if(l.isUndefined(this.get("value"))||String(this.get("value")).replace(/^\s+|\s+$/g,"")==""){t=r("Value cannot be empty.");this.errorModel.set("value",t);return t}return t}});if(!s.Nodes["coll-fts_dictionary"]){o.Browser.Nodes["coll-fts_dictionary"]=o.Browser.Collection.extend({node:"fts_dictionary",label:r("FTS Dictionaries"),type:"coll-fts_dictionary",columns:["name","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})}if(!s.Nodes["fts_dictionary"]){o.Browser.Nodes["fts_dictionary"]=a.SchemaChildNode.extend({type:"fts_dictionary",sqlAlterHelp:"sql-altertsdictionary.html",sqlCreateHelp:"sql-createtsdictionary.html",dialogHelp:e("help.static",{filename:"fts_dictionary_dialog.html"}),label:r("FTS Dictionary"),hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;s.add_menus([{name:"create_fts_dictionary_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"},{name:"create_fts_dictionary_on_coll",node:"coll-fts_dictionary",module:this,applies:["object","context"],priority:4,callback:"show_obj_properties",category:"create",label:r("FTS Dictionary..."),data:{action:"create"},icon:"wcTabIcon icon-fts_dictionary",enable:"canCreate"},{name:"create_fts_dictionary",node:"fts_dictionary",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"}])},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,owner:undefined,description:undefined,schema:undefined,template:undefined,options:undefined},initialize:function e(t,i){var n=l.size(t)===0;o.Browser.Node.Model.prototype.initialize.apply(this,arguments);if(n){var a=s.serverInfo[i.node_info.server._id].user;this.set({owner:a.name,schema:i.node_info.schema._id},{silent:true})}},schema:[{id:"name",label:r("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:r("OID"),cell:"string",editable:false,type:"text",disabled:true,mode:["properties"]},{id:"owner",label:r("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:n.NodeListByNameControl},{id:"schema",label:r("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",cache_node:"database",control:"node-list-by-id"},{id:"description",label:r("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"template",label:r("Template"),type:"text",disabled:function e(t){return!t.isNew()},url:"fetch_templates",group:r("Definition"),control:"node-ajax-options",cache_node:"fts_template"},{id:"options",label:r("Option"),type:"collection",group:r("Options"),control:"unique-col-collection",model:c,columns:["option","value"],uniqueCol:["option"],mode:["edit","create"],canAdd:true,canEdit:false,canDelete:true}],validate:function e(){var t=this.get("name"),i=this.get("template"),n=this.get("schema"),a;if(l.isUndefined(t)||l.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){a=r("Name must be specified.");this.errorModel.set("name",a);return a}else if(l.isUndefined(i)||l.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){a=r("Template must be selected.");this.errorModel.set("template",a);return a}else if(l.isUndefined(n)||l.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){a=r("Schema must be selected.");this.errorModel.set("schema",a);return a}else this.errorModel.clear();this.trigger("on-status-clear");return null}})})}return s.Nodes["fts_dictionary"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(13),i(11),i(7)],a=function(s,e,t,d,a,i,n,r){if(!i.Nodes["coll-fts_parser"]){a.Browser.Nodes["coll-fts_parser"]=a.Browser.Collection.extend({node:"fts_parser",label:s("FTS Parsers"),type:"coll-fts_parser",columns:["name","description"],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})}if(!i.Nodes["fts_parser"]){a.Browser.Nodes["fts_parser"]=n.SchemaChildNode.extend({type:"fts_parser",sqlAlterHelp:"sql-altertsparser.html",sqlCreateHelp:"sql-createtsparser.html",dialogHelp:e("help.static",{filename:"fts_parser_dialog.html"}),label:s("FTS Parser"),hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;i.add_menus([{name:"create_fts_parser_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"},{name:"create_fts_parser_on_coll",node:"coll-fts_parser",applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},module:this,enable:"canCreate"},{name:"create_fts_parser",node:"fts_parser",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"}])},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,description:undefined,schema:undefined,prsstart:undefined,prstoken:undefined,prsend:undefined,prslextype:undefined,prsheadline:undefined},initialize:function e(t,i){var n=d.size(t)===0;a.Browser.Node.Model.prototype.initialize.apply(this,arguments);if(n){this.set("schema",i.node_info.schema._id)}},schema:[{id:"name",label:s("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:s("OID"),cell:"string",editable:false,type:"text",disabled:true,mode:["properties"]},{id:"schema",label:s("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:s("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsstart",label:s("Start function"),type:"text",disabled:function e(t){return!t.isNew()},control:"node-ajax-options",url:"start_functions",group:s("Definition"),cache_level:"database",cache_node:"schema"},{id:"prstoken",label:s("Get next token function"),type:"text",disabled:function e(t){return!t.isNew()},control:"node-ajax-options",url:"token_functions",group:s("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsend",label:s("End function"),type:"text",disabled:function e(t){return!t.isNew()},control:"node-ajax-options",url:"end_functions",group:s("Definition"),cache_level:"database",cache_node:"schema"},{id:"prslextype",label:s("Lextypes function"),type:"text",disabled:function e(t){return!t.isNew()},control:"node-ajax-options",url:"lextype_functions",group:s("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsheadline",label:s("Headline function"),type:"text",disabled:function e(t){return!t.isNew()},control:"node-ajax-options",url:"headline_functions",group:s("Definition"),cache_level:"database",cache_node:"schema"}],validate:function e(){var t=this.get("name"),i=this.get("prsstart"),n=this.get("prstoken"),a=this.get("prsend"),r=this.get("prslextype"),l=this.get("schema"),o;if(d.isUndefined(t)||d.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){o=s("Name must be specified.");this.errorModel.set("name",o);return o}else if(d.isUndefined(i)||d.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){o=s("Start function must be selected.");this.errorModel.set("prsstart",o);return o}else if(d.isUndefined(n)||d.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){o=s("Get next token function must be selected.");this.errorModel.set("prstoken",o);return o}else if(d.isUndefined(a)||d.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==""){o=s("End function must be selected.");this.errorModel.set("prsend",o);return o}else if(d.isUndefined(r)||d.isNull(r)||String(r).replace(/^\s+|\s+$/g,"")==""){o=s("Lextype function must be selected.");this.errorModel.set("prslextype",o);return o}else if(d.isUndefined(l)||d.isNull(l)||String(l).replace(/^\s+|\s+$/g,"")==""){o=s("Schema must be selected.");this.errorModel.set("schema",o);return o}else this.errorModel.clear();this.trigger("on-status-clear");return null}})})}return i.Nodes["coll-fts_parser"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(13),i(11),i(7)],a=function(r,e,t,l,a,i,n,o){if(!i.Nodes["coll-fts_template"]){a.Browser.Nodes["coll-fts_template"]=a.Browser.Collection.extend({node:"fts_template",label:r("FTS Templates"),type:"coll-fts_template",columns:["name","description"],canDrop:o.isTreeItemOfChildOfSchema,canDropCascade:o.isTreeItemOfChildOfSchema})}if(!i.Nodes["fts_template"]){a.Browser.Nodes["fts_template"]=n.SchemaChildNode.extend({type:"fts_template",sqlAlterHelp:"sql-altertstemplate.html",sqlCreateHelp:"sql-createtstemplate.html",dialogHelp:e("help.static",{filename:"fts_template_dialog.html"}),label:r("FTS Template"),hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;i.add_menus([{name:"create_fts_template_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template_on_coll",node:"coll-fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template",node:"fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"}])},model:a.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,description:undefined,schema:undefined,tmplinit:undefined,tmpllexize:undefined},initialize:function e(t,i){var n=l.size(t)===0;a.Browser.Node.Model.prototype.initialize.apply(this,arguments);if(n){this.set("schema",i.node_info.schema._id)}},schema:[{id:"name",label:r("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:r("OID"),cell:"string",editable:false,type:"text",disabled:true,mode:["properties"]},{id:"schema",label:r("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:r("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"tmplinit",label:r("Init function"),group:r("Definition"),type:"text",disabled:function e(t){return!t.isNew()},control:"node-ajax-options",url:"get_init",cache_level:"database",cache_node:"schema"},{id:"tmpllexize",label:r("Lexize function"),group:r("Definition"),type:"text",disabled:function e(t){return!t.isNew()},control:"node-ajax-options",url:"get_lexize",cache_level:"database",cache_node:"schema"}],validate:function e(){var t=this.get("name"),i=this.get("tmpllexize"),n=this.get("schema"),a;if(l.isUndefined(t)||l.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){a=r("Name must be specified.");this.errorModel.set("name",a);return a}else if(l.isUndefined(i)||l.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){a=r("Lexize function must be selected.");this.errorModel.set("tmpllexize",a);return a}else if(l.isUndefined(n)||l.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){a=r("Schema must be selected.");this.errorModel.set("schema",a);return a}else this.errorModel.clear();this.trigger("on-status-clear");return null}})})}return i.Nodes["fts_template"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(17),i(60),i(13),i(11),i(7),i(16)],a=function(l,e,t,o,i,n,a,r,s,d,c){if(!a.Nodes["coll-procedure"]){n.Browser.Nodes["coll-procedure"]=n.Browser.Collection.extend({node:"procedure",label:l("Procedures"),type:"coll-procedure",columns:["name","funcowner","description"],hasStatistics:true,canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema})}if(!a.Nodes["procedure"]){n.Browser.Nodes["procedure"]=d.SchemaChildNode.extend({type:"procedure",sqlAlterHelp:"sql-alterprocedure.html",sqlCreateHelp:"sql-createprocedure.html",dialogHelp:e("help.static",{filename:"procedure_dialog.html"}),label:l("Procedure"),collection_type:"coll-procedure",hasSQL:true,hasDepends:true,hasStatistics:true,hasScriptTypes:["create","exec"],width:a.stdW.md+"px",Init:function e(){if(this.proc_initialized)return;this.proc_initialized=true;a.add_menus([{name:"create_procedure_on_coll",node:"coll-procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:false},enable:"canCreateProc"},{name:"create_procedure",node:"procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:true},enable:"canCreateProc"},{name:"create_procedure",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:l("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:true},enable:"canCreateProc"}])},canCreateProc:function e(t,i){var n=this.getTreeNodeHierarchy.apply(this,[i]);if("catalog"in n)return false;return"server"in n&&(n["server"].server_type=="ppas"||n["server"].server_type=="pg"&&n["server"].version>=11e4)},model:s.model.extend({defaults:o.extend({},s.model.prototype.defaults,{lanname:"edbspl"}),canVarAdd:function e(){var t=this.node_info.server;if(t.version<90500){return false}else{return true}},isVisible:function e(){if(this.name=="sysfunc"){return false}else if(this.name=="sysproc"){return true}return false},isDisabled:function e(t){if(this.node_info&&"catalog"in this.node_info){return true}switch(this.name){case"provolatile":case"proisstrict":case"procost":case"proleakproof":if(this.node_info.server.version<90500||this.node_info.server.server_type!="ppas"||t.get("lanname")!="edbspl"){setTimeout(function(){t.set("provolatile",undefined);t.set("proisstrict",undefined);t.set("procost",undefined);t.set("proleakproof",undefined)},10);return true}else{return false}case"variables":case"prosecdef":return this.node_info.server.version<90500;case"prorows":var i=this.node_info.server;return!(i.version>=90500&&t.get("proretset")==true);case"funcowner":case"proargs":return true;case"proparallel":if(this.node_info.server.version<90600||this.node_info.server.server_type!="ppas"||t.get("lanname")!="edbspl"){setTimeout(function(){t.set("proparallel",undefined)},10);return true}else{return false}case"lanname":return this.node_info.server.version<11e4;default:return false}},validate:function e(){var t={},i,n=this.get("seclabels");if(o.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t["name"]=l("Name cannot be empty.");i=i||t["name"]}if(o.isUndefined(this.get("pronamespace"))||String(this.get("pronamespace")).replace(/^\s+|\s+$/g,"")==""){t["pronamespace"]=l("Schema cannot be empty.");i=i||t["pronamespace"]}if(o.isUndefined(this.get("lanname"))||String(this.get("lanname")).replace(/^\s+|\s+$/g,"")==""){t["lanname"]=l("Language cannot be empty.");i=i||t["lanname"]}if(String(this.get("lanname"))=="c"){if(o.isUndefined(this.get("probin"))||String(this.get("probin")).replace(/^\s+|\s+$/g,"")==""){t["probin"]=l("Object File cannot be empty.");i=i||t["probin"]}if(o.isUndefined(this.get("prosrc_c"))||String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,"")==""){t["prosrc_c"]=l("Link Symbol cannot be empty.");i=i||t["prosrc_c"]}}else{if(o.isUndefined(this.get("prosrc"))||String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")==""){t["prosrc"]=l("Code cannot be empty.");i=i||t["prosrc"]}}if(n){var a;for(var r=0;r<n.models.length&&!a;r++){a=n.models[r].validate.apply(n.models[r]);if(a){t["seclabels"]=a;i=i||a}}}this.errorModel.clear().set(t);return null}})})}return a.Nodes["procedure"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(61),i(7),i(16)],a=function(e,t,i,n,a,r,l){if(!r.Nodes["coll-edbproc"]){a.Browser.Nodes["coll-edbproc"]=a.Browser.Collection.extend({node:"edbproc",label:e("Procedures"),type:"coll-edbproc",columns:["name","funcowner","description"],hasStatistics:true,canDrop:false,canDropCascade:false})}if(!r.Nodes["edbproc"]){a.Browser.Nodes["edbproc"]=r.Node.extend({type:"edbproc",dialogHelp:t("help.static",{filename:"edbproc_dialog.html"}),label:e("Procedure"),collection_type:"coll-edbproc",hasDepends:true,canEdit:false,hasSQL:true,hasScriptTypes:[],parent_type:["package"],Init:function e(){if(this.proc_initialized)return;this.proc_initialized=true},canDrop:false,canDropCascade:false,model:l.model.extend({defaults:n.extend({},l.model.prototype.defaults,{lanname:"edbspl"}),isVisible:function e(){if(this.name=="sysfunc"){return false}else if(this.name=="sysproc"){return true}return false},validate:function e(){return null}})})}return r.Nodes["edbproc"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(7),i(16)],a=function(e,t,i,n,a,r){if(!r.Nodes["coll-edbvar"]){r.Nodes["coll-edbvar"]=r.Collection.extend({node:"edbvar",label:e("Variables"),type:"coll-edbvar",columns:["name","funcowner","description"],canDrop:false,canDropCascade:false})}if(!r.Nodes["edbvar"]){r.Nodes["edbvar"]=r.Node.extend({type:"edbvar",dialogHelp:t("help.static",{filename:"edbvar_dialog.html"}),label:e("Function"),collection_type:"coll-edbvar",canEdit:false,hasSQL:true,hasScriptTypes:[],parent_type:["package"],Init:function e(){if(this.initialized)return;this.initialized=true},canDrop:false,canDropCascade:false,model:r.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,datatype:undefined,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"],disabled:true},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"datatype",label:e("Data type"),cell:"string",type:"text",disabled:true},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"],disabled:true}],validate:function e(){return null}})})}return r.Nodes["edbvar"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(13),i(11),i(7),i(16)],a=function(o,e,t,s,i,l,n,a,r){if(!l.Nodes["coll-trigger_function"]){l.Nodes["coll-trigger_function"]=l.Collection.extend({node:"trigger_function",label:o("Trigger functions"),type:"coll-trigger_function",columns:["name","funcowner","description"],hasStatistics:true,canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})}if(!l.Nodes["trigger_function"]){l.Nodes["trigger_function"]=a.SchemaChildNode.extend({type:"trigger_function",sqlAlterHelp:"plpgsql-trigger.html",sqlCreateHelp:"plpgsql-trigger.html",dialogHelp:e("help.static",{filename:"trigger_function_dialog.html"}),label:o("Trigger function"),collection_type:"coll-trigger_function",hasSQL:true,hasDepends:true,hasStatistics:true,Init:function e(){if(this.initialized)return;this.initialized=true;l.add_menus([{name:"create_trigger_function_on_coll",node:"coll-trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:true},enable:"canCreate"},{name:"create_trigger_function",node:"trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:true},enable:"canCreate"},{name:"create_trigger_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:false},enable:"canCreate"}])},model:l.Node.Model.extend({idAttribute:"oid",initialize:function e(t,i){var n=s.size(t)===0;if(n){var a=i.node_info.schema._id;this.set({pronamespace:a},{silent:true});var r=l.serverInfo[i.node_info.server._id].user;this.set({funcowner:r.name},{silent:true})}l.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:undefined,oid:undefined,xmin:undefined,funcowner:undefined,pronamespace:undefined,description:undefined,pronargs:undefined,proargs:undefined,proargtypenames:undefined,prorettypename:"trigger",lanname:"plpgsql",provolatile:undefined,proretset:undefined,proisstrict:undefined,prosecdef:undefined,proiswindow:undefined,procost:undefined,prorows:undefined,proleakproof:undefined,args:[],prosrc:undefined,prosrc_c:undefined,probin:"$libdir/",options:[],variables:[],proacl:undefined,seclabels:[],acl:[],sysfunc:undefined,sysproc:undefined},schema:[{id:"name",label:o("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:o("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:o("Owner"),cell:"string",control:n.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:o("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:o("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:o("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:o("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:o("Argument count"),cell:"string",type:"text",group:o("Definition"),mode:["properties"]},{id:"proargs",label:o("Arguments"),cell:"string",type:"text",group:o("Definition"),mode:["properties","edit"],disabled:"isDisabled"},{id:"proargtypenames",label:o("Signature arguments"),cell:"string",type:"text",group:o("Definition"),mode:["properties"],disabled:"isDisabled"},{id:"prorettypename",label:o("Return type"),cell:"string",control:"select2",type:"text",group:o("Definition"),disabled:"isDisabled",first_empty:true,select2:{width:"100%",allowClear:false},mode:["create"],visible:"isVisible",options:[{label:o("trigger"),value:"trigger"},{label:o("event_trigger"),value:"event_trigger"}]},{id:"prorettypename",label:o("Return type"),cell:"string",type:"text",group:o("Definition"),mode:["properties","edit"],disabled:"isDisabled",visible:"isVisible"},{id:"lanname",label:o("Language"),cell:"string",control:"node-ajax-options",type:"text",group:o("Definition"),url:"get_languages",disabled:"isDisabled",transform:function e(t){return s.reject(t,function(e){return e.label=="sql"||e.label=="edbspl"})},select2:{allowClear:false}},{id:"prosrc",label:o("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:o("Definition"),deps:["lanname"],control:n.SqlFieldControl,extraClasses:["custom_height_css_class"],visible:function e(t){if(t.get("lanname")=="c"){return false}return true},disabled:"isDisabled"},{id:"probin",label:o("Object file"),cell:"string",type:"text",group:o("Definition"),deps:["lanname"],visible:function e(t){if(t.get("lanname")=="c"){return true}return false},disabled:"isDisabled"},{id:"prosrc_c",label:o("Link symbol"),cell:"string",type:"text",group:o("Definition"),deps:["lanname"],visible:function e(t){if(t.get("lanname")=="c"){return true}return false},disabled:"isDisabled"},{id:"provolatile",label:o("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:o("Options"),options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:false}},{id:"proretset",label:o("Returns a set?"),type:"switch",group:o("Options"),disabled:"isDisabled",visible:"isVisible"},{id:"proisstrict",label:o("Strict?"),type:"switch",disabled:"isDisabled",group:o("Options")},{id:"prosecdef",label:o("Security of definer?"),group:o("Options"),cell:"boolean",type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:o("Window?"),group:o("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"procost",label:o("Estimated cost"),type:"text",group:o("Options"),disabled:"isDisabled"},{id:"prorows",label:o("Estimated rows"),type:"text",group:o("Options"),disabled:"isDisabled",deps:["proretset"],visible:"isVisible"},{id:"proleakproof",label:o("Leak proof?"),group:o("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled"},l.SecurityGroupSchema,{id:"proacl",label:o("Privileges"),mode:["properties"],group:o("Security"),type:"text"},{id:"variables",label:"",type:"collection",group:o("Parameters"),control:"variable-collection",model:l.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:false,canDelete:true,disabled:"isDisabled"},{id:"acl",label:o("Privileges"),editable:false,type:"collection",group:"security",mode:["edit","create"],model:l.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],disabled:"isDisabled",canAdd:true,canDelete:true,control:"unique-col-collection"},{id:"seclabels",label:o("Security labels"),canEdit:true,model:l.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canDelete:true,control:"unique-col-collection",canAdd:true,uniqueCol:["provider"],disabled:"isDisabled"}],validate:function e(t){var i={},n,a=this.get("seclabels");if(t&&t.length==0){this.errorModel.clear();return null}if(s.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){i["name"]=o("Name cannot be empty.");n=n||i["name"]}if(s.isUndefined(this.get("funcowner"))||String(this.get("funcowner")).replace(/^\s+|\s+$/g,"")==""){i["funcowner"]=o("Owner cannot be empty.");n=n||i["funcowner"]}if(s.isUndefined(this.get("pronamespace"))||String(this.get("pronamespace")).replace(/^\s+|\s+$/g,"")==""){i["pronamespace"]=o("Schema cannot be empty.");n=n||i["pronamespace"]}if(s.isUndefined(this.get("prorettypename"))||String(this.get("prorettypename")).replace(/^\s+|\s+$/g,"")==""){i["prorettypename"]=o("Return type cannot be empty.");n=n||i["prorettypename"]}if(s.isUndefined(this.get("lanname"))||String(this.get("lanname")).replace(/^\s+|\s+$/g,"")==""){i["lanname"]=o("Language cannot be empty.");n=n||i["lanname"]}if(String(this.get("lanname"))=="c"){if(s.isUndefined(this.get("probin"))||String(this.get("probin")).replace(/^\s+|\s+$/g,"")==""){i["probin"]=o("Object File cannot be empty.");n=n||i["probin"]}if(s.isUndefined(this.get("prosrc_c"))||String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,"")==""){i["prosrc_c"]=o("Link Symbol cannot be empty.");n=n||i["prosrc_c"]}}else{if(s.isUndefined(this.get("prosrc"))||String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")==""){i["prosrc"]=o("Code cannot be empty.");n=n||i["prosrc"]}}if(a){var r;for(var l=0;l<a.models.length&&!r;l++){r=a.models[l].validate.apply(a.models[l]);if(r){i["seclabels"]=r;n=n||r}}}this.errorModel.clear().set(i);if(s.size(i)){this.trigger("on-status",{msg:n});return n}return null},isVisible:function e(){if(this.name=="sysproc"){return false}return true},isDisabled:function e(t){if(this.node_info&&"catalog"in this.node_info){return true}switch(this.name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!t.isNew();case"prorows":if(t.get("proretset")==true){return false}return true;default:return false}},canVarAdd:function e(){return!(this.node_info&&"catalog"in this.node_info)}})})}return l.Nodes["trigger_function"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(13),i(11),i(7)],a=function(i,e,t,r,l,o,n,a,s){if(!o.Nodes["coll-package"]){o.Nodes["coll-package"]=o.Collection.extend({node:"package",label:i("Packages"),type:"coll-package",columns:["name","owner","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})}if(!o.Nodes["package"]){o.Nodes["package"]=a.SchemaChildNode.extend({type:"package",dialogHelp:e("help.static",{filename:"package_dialog.html"}),label:i("Package"),collection_type:"coll-package",hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;o.add_menus([{name:"create_package_on_coll",node:"coll-package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:true},enable:"canCreate"},{name:"create_package",node:"package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:true},enable:"canCreate"},{name:"create_package",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:true},enable:"canCreate"}])},canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=this.getTreeNodeHierarchy(i),r=a["server"];if(r&&r.server_type==="pg")return false;if(a["catalog"]!=undefined)return false;return true},model:o.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,owner:undefined,is_sys_object:undefined,description:undefined,pkgheadsrc:undefined,pkgbodysrc:undefined,acl:undefined,pkgacl:[]},initialize:function e(t,i){if(r.size(t)===0){var n=o.serverInfo[i.node_info.server._id].user;var a=i.node_info.schema;this.set({owner:n.name,schema:a._label},{silent:true})}l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function e(t){return!t.isNew()}},{id:"oid",label:i("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:i("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:true,editable:false,visible:function e(t){return!t.isNew()}},{id:"schema",label:i("Schema"),type:"text",node:"schema",control:"node-list-by-name",disabled:function e(t){return!t.isNew()},filter:function e(t){if(t&&t.label.match(/^pg_/)){return false}return true},cache_node:"database",cache_level:"database"},{id:"is_sys_object",label:i("System package?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:i("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"pkgheadsrc",label:i("Header"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Code"),control:n.SqlFieldControl},{id:"pkgbodysrc",label:i("Body"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Code"),control:n.SqlFieldControl},{id:"acl",label:i("Privileges"),type:"text",group:i("Security"),mode:["properties"]},{id:"pkgacl",label:i("Privileges"),type:"collection",model:o.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],editable:false,group:i("Security"),mode:["edit","create"],canAdd:true,canDelete:true,control:"unique-col-collection"}],validate:function e(){var t=undefined;this.errorModel.clear();if(r.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=i("Name cannot be empty.");this.errorModel.set("name",t);return t}if(r.isUndefined(this.get("pkgheadsrc"))||String(this.get("pkgheadsrc")).replace(/^\s+|\s+$/g,"")==""){t=i("Header cannot be empty.");this.errorModel.set("pkgheadsrc",t);return t}return null}})})}return o.Nodes["package"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(13),i(11),i(7)],a=function(s,e,t,d,i,n,l,a,r,o){if(!l.Nodes["coll-sequence"]){l.Nodes["coll-sequence"]=l.Collection.extend({node:"sequence",label:s("Sequences"),type:"coll-sequence",columns:["name","seqowner","comment"],hasStatistics:true,canDrop:o.isTreeItemOfChildOfSchema,canDropCascade:o.isTreeItemOfChildOfSchema})}if(!l.Nodes["sequence"]){l.Nodes["sequence"]=r.SchemaChildNode.extend({type:"sequence",sqlAlterHelp:"sql-altersequence.html",sqlCreateHelp:"sql-createsequence.html",dialogHelp:e("help.static",{filename:"sequence_dialog.html"}),label:s("Sequence"),collection_type:"coll-sequence",hasSQL:true,hasDepends:true,hasStatistics:true,Init:function e(){if(this.initialized)return;this.initialized=true;l.add_menus([{name:"create_sequence_on_coll",node:"coll-sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:true},enable:"canCreate"},{name:"create_sequence",node:"sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:true},enable:"canCreate"},{name:"create_sequence",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:false},enable:"canCreate"}])},model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,seqowner:undefined,schema:undefined,comment:undefined,increment:undefined,start:undefined,current_value:undefined,minimum:undefined,maximum:undefined,cache:undefined,cycled:undefined,relacl:[],securities:[]},initialize:function e(t,i){var n=d.size(t)===0;if(n){var a=l.serverInfo[i.node_info.server._id].user;var r=i.node_info.schema;this.set({seqowner:a.name},{silent:true});this.set({schema:r._label},{silent:true})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:s("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:s("OID"),cell:"string",type:"text",mode:["properties"]},{id:"seqowner",label:s("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],node:"role",control:a.NodeListByNameControl},{id:"schema",label:s("Schema"),cell:"string",control:"node-list-by-name",node:"schema",type:"text",mode:["create","edit"],filter:function e(t){if(t&&t.label.match(/^pg_/)){return false}return true},cache_node:"database",cache_level:"database"},{id:"comment",label:s("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"current_value",label:s("Current value"),type:"int",mode:["properties","edit"],group:s("Definition")},{id:"increment",label:s("Increment"),type:"int",mode:["properties","create","edit"],group:s("Definition"),min:1},{id:"start",label:s("Start"),type:"int",mode:["properties","create"],group:s("Definition"),disabled:function e(t){return!t.isNew()}},{id:"minimum",label:s("Minimum"),type:"int",mode:["properties","create","edit"],group:s("Definition")},{id:"maximum",label:s("Maximum"),type:"int",mode:["properties","create","edit"],group:s("Definition")},{id:"cache",label:s("Cache"),type:"int",mode:["properties","create","edit"],group:s("Definition"),min:1},{id:"cycled",label:s("Cycled"),type:"switch",mode:["properties","create","edit"],group:s("Definition")},l.SecurityGroupSchema,{id:"acl",label:s("Privileges"),type:"text",group:s("Security"),mode:["properties"],disabled:true},{id:"relacl",label:s("Privileges"),group:"security",model:l.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),uniqueCol:["grantee","grantor"],mode:["edit","create"],editable:false,type:"collection",canAdd:true,canDelete:true,control:"unique-col-collection"},{id:"securities",label:s("Security labels"),canAdd:true,model:l.SecLabelModel,editable:false,type:"collection",canEdit:false,group:"security",mode:["edit","create"],canDelete:true,control:"unique-col-collection",min_version:90200,uniqueCol:["provider"]}],validate:function e(){var t=undefined,i=this.get("minimum"),n=this.get("maximum"),a=this.get("start");if(d.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=s("Name cannot be empty.");this.errorModel.set("name",t);return t}else{this.errorModel.unset("name")}if(d.isUndefined(this.get("seqowner"))||String(this.get("seqowner")).replace(/^\s+|\s+$/g,"")==""){t=s("Owner cannot be empty.");this.errorModel.set("seqowner",t);return t}else{this.errorModel.unset("seqowner")}if(d.isUndefined(this.get("schema"))||String(this.get("schema")).replace(/^\s+|\s+$/g,"")==""){t=s("Schema cannot be empty.");this.errorModel.set("schema",t);return t}else{this.errorModel.unset("schema")}if(!this.isNew()){if(d.isUndefined(this.get("current_value"))||String(this.get("current_value")).replace(/^\s+|\s+$/g,"")==""){t=s("Current value cannot be empty.");this.errorModel.set("current_value",t);return t}else{this.errorModel.unset("current_value")}if(d.isUndefined(this.get("increment"))||String(this.get("increment")).replace(/^\s+|\s+$/g,"")==""){t=s("Increment value cannot be empty.");this.errorModel.set("increment",t);return t}else{this.errorModel.unset("increment")}if(d.isUndefined(this.get("minimum"))||String(this.get("minimum")).replace(/^\s+|\s+$/g,"")==""){t=s("Minimum value cannot be empty.");this.errorModel.set("minimum",t);return t}else{this.errorModel.unset("minimum")}if(d.isUndefined(this.get("maximum"))||String(this.get("maximum")).replace(/^\s+|\s+$/g,"")==""){t=s("Maximum value cannot be empty.");this.errorModel.set("maximum",t);return t}else{this.errorModel.unset("maximum")}if(d.isUndefined(this.get("cache"))||String(this.get("cache")).replace(/^\s+|\s+$/g,"")==""){t=s("Cache value cannot be empty.");this.errorModel.set("cache",t);return t}else{this.errorModel.unset("cache")}}var r=s("Minimum value must be less than maximum value."),l=s("Start value cannot be less than minimum value."),o=s("Start value cannot be greater than maximum value.");if(d.isEmpty(i)||d.isEmpty(n))return null;if(i==0&&n==0||parseInt(i,10)>=parseInt(n,10)){this.errorModel.set("minimum",r);return r}else{this.errorModel.unset("minimum")}if(a&&i&&parseInt(a)<parseInt(i)){this.errorModel.set("start",l);return l}else{this.errorModel.unset("start")}if(a&&n&&parseInt(a)>parseInt(n)){this.errorModel.set("start",o);return o}else{this.errorModel.unset("start")}return null}})})}return l.Nodes["sequence"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(10),i(13),i(11),i(7)],a=function(i,e,o,l,t,s,d,c,n,a){if(!d.Nodes["coll-synonym"]){s.Browser.Nodes["coll-synonym"]=s.Browser.Collection.extend({node:"synonym",label:i("Synonyms"),type:"coll-synonym",columns:["name","owner","is_public_synonym"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:a.isTreeItemOfChildOfSchema})}if(!d.Nodes["synonym"]){s.Browser.Nodes["synonym"]=n.SchemaChildNode.extend({type:"synonym",dialogHelp:e("help.static",{filename:"synonym_dialog.html"}),label:i("Synonym"),collection_type:"coll-synonym",hasSQL:true,hasDepends:true,parent_type:["schema","catalog"],Init:function e(){if(this.initialized)return;this.initialized=true;d.add_menus([{name:"create_synonym_on_coll",node:"coll-synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:true},enable:"canCreate"},{name:"create_synonym",node:"synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:true},enable:"canCreate"},{name:"create_synonym",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:true},enable:"canCreate"}])},model:s.Browser.Node.Model.extend({isNew:function e(){return!this.fetchFromServer},idAttribute:"name",initialize:function e(t,i){var n=l.size(t)===0;if(n){var a=d.serverInfo[i.node_info.server._id].user;var r=i.node_info.schema;this.set({owner:a.name,synobjschema:r._label,schema:r._label,targettype:"r"},{silent:true})}else{this.fetchFromServer=true}s.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"owner",label:i("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:true,control:"node-list-by-name",node:"role",visible:false},{id:"schema",label:i("Schema"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:function e(t){return!t.isNew()},node:"schema",control:"node-list-by-name",cache_node:"database",cache_level:"database"},{id:"targettype",label:i("Target type"),cell:"string",disabled:"inSchema",group:i("Definition"),select2:{width:"50%",allowClear:false},options:function e(){return[{label:i("Function"),value:"f"},{label:i("Package"),value:"P"},{label:i("Procedure"),value:"p"},{label:i("Public Synonym"),value:"s"},{label:i("Sequence"),value:"S"},{label:i("Table"),value:"r"},{label:i("View"),value:"v"}]},control:"select2"},{id:"synobjschema",label:i("Target schema"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Definition"),deps:["targettype"],select2:{allowClear:false},control:"node-list-by-name",node:"schema",filter:function e(t){var i=["pg_catalog","sys","dbo","pgagent","information_schema","dbms_job_procedure"];return t&&l.indexOf(i,t.label)==-1},disabled:function e(t){if(!t.inSchema.apply(this,[t])){var i=t.get("targettype")=="s";if(i){t.set("synobjschema","public",{silent:true});return true}else{return false}}return true}},{id:"synobjname",label:i("Target object"),cell:"string",type:"text",disabled:"inSchema",group:i("Definition"),deps:["targettype","synobjschema"],control:"node-ajax-options",options:function e(t){var i=t.model.get("targettype");var n=t.model.get("synobjschema");var a=[];var r=t.field.get("schema_node"),l=r.generate_url.apply(r,[null,"get_target_objects",t.field.get("node_data"),false,t.field.get("node_info")]);o.ajax({type:"GET",timeout:3e4,url:l,cache:false,async:false,data:{trgTyp:i,trgSchema:n}}).done(function(e){a=e.data;return a}).fail(function(e,t,i){c.pgRespErrorNotify(e,i)});return a}},{id:"is_public_synonym",label:i("Public synonym?"),disabled:true,type:"switch",mode:["properties"],cell:"switch",options:{onText:i("Yes"),offText:i("No"),onColor:"success",offColor:"primary",size:"mini"}}],validate:function e(){var t=undefined;this.errorModel.clear();if(l.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=i("Name cannot be empty.");this.errorModel.set("name",t)}else if(l.isUndefined(this.get("synobjschema"))||String(this.get("synobjschema")).replace(/^\s+|\s+$/g,"")==""){t=i("Target schema cannot be empty.");this.errorModel.set("synobjschema",t)}else if(l.isUndefined(this.get("synobjname"))||String(this.get("synobjname")).replace(/^\s+|\s+$/g,"")==""){t=i("Target object cannot be empty.");this.errorModel.set("synobjname",t)}return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return true}}return true}}),canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=this.getTreeNodeHierarchy(i),r=a["server"];if(r&&r.server_type==="pg")return false;if(a["catalog"]!=undefined)return false;return true}})}return d.Nodes["synonym"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(12),i(13),i(11),i(7)],a=function(i,e,o,s,t,r,n,a,l,d){if(!r.Nodes["coll-type"]){r.Nodes["coll-type"]=r.Collection.extend({node:"type",label:i("Types"),type:"coll-type",columns:["name","typeowner","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})}var c=a.IntegerCell.extend({initialize:function e(){a.NumberCell.prototype.initialize.apply(this,arguments);a.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){this.$el.empty();var t=this.model;var i=this.column;var n=this.column.get("editable");var a=s.isFunction(n)?!!n.apply(i,[t]):!!n;if(a){this.$el.addClass("editable")}else{this.$el.removeClass("editable")}this.delegateEvents();return this},remove:a.Extension.DependentCell.prototype.remove});var u=a.Extension.NodeAjaxOptionsCell.extend({initialize:function e(){a.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments);a.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){var t=this.model,i=this.column,n=this.column.get("editable"),a=this.$el.find("select").first();var r=s.isFunction(n)?!!n.apply(i,[t]):!!n;if(r){this.$el.addClass("editable");a.prop("disabled",false)}else{this.$el.removeClass("editable");a.prop("disabled",true)}this.delegateEvents();return this},remove:a.Extension.DependentCell.prototype.remove});var p=n.CompositeModel=r.Node.Model.extend({idAttribute:"attnum",defaults:{attnum:undefined,member_name:undefined,type:undefined,tlength:undefined,is_tlength:false,precision:undefined,is_precision:false,collation:undefined,min_val:undefined,max_val:undefined},type_options:undefined,subtypes:undefined,schema:[{id:"member_name",label:i("Member Name"),type:"text",disabled:false,editable:true},{id:"type",label:i("Type"),control:"node-ajax-options",type:"text",url:"get_types",disabled:false,node:"type",cache_node:"domain",editable:true,cell:"node-ajax-options",select2:{allowClear:false},transform:function e(t,i){i.model.type_options=t;return t}},{id:"tlength",label:i("Length/precision"),deps:["type"],type:"text",disabled:false,cell:c,editable:function e(t){var i=t.get("type");if(t.type_options){s.each(t.type_options,function(e){if(i==e.value){if(e.length){t.set("is_tlength",true,{silent:true});t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true})}else{t.set("is_tlength",false,{silent:true})}}})}return t.get("is_tlength")}},{id:"precision",label:i("Scale"),deps:["type"],type:"text",disabled:false,cell:c,editable:function e(t){var i=t.get("type");if(t.type_options){s.each(t.type_options,function(e){if(i==e.value){if(e.precision){t.set("is_precision",true,{silent:true});t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true})}else{t.set("is_precision",false,{silent:true})}}})}return t.get("is_precision")}},{id:"collation",label:i("Collation"),cell:u,deps:["type"],select2:{allowClear:false},control:"node-ajax-options",editable:function e(t){var i=t.get("type"),n=false;if(t.type_options){s.each(t.type_options,function(e){if(i==e.value){if(e.is_collatable){n=true}}})}if(n){setTimeout(function(){t.set("collspcname","",{silent:true})},10)}return n},type:"text",disabled:false,url:"get_collations",node:"type"}],validate:function e(){var t=null;this.errorModel.clear();if(s.isUndefined(this.get("member_name"))||s.isNull(this.get("member_name"))||String(this.get("member_name")).replace(/^\s+|\s+$/g,"")==""){t=i("Please specify the value for member name.");this.errorModel.set("member_name",t);return t}else if(s.isUndefined(this.get("type"))||s.isNull(this.get("type"))||String(this.get("type")).replace(/^\s+|\s+$/g,"")==""){t=i("Please specify the type.");this.errorModel.set("type",t);return t}else if(this.get("is_tlength")&&!s.isUndefined(this.get("tlength"))){if(this.get("tlength")<this.get("min_val"))t=i("Length/precision should not be less than %(value)s",{value:this.get("min_val")});if(this.get("tlength")>this.get("max_val"))t=i("Length/precision should not be greater than %(value)s",{value:this.get("max_val")});if(t){this.errorModel.set("tlength",t);return t}}else if(this.get("is_precision")&&!s.isUndefined(this.get("precision"))){if(this.get("precision")<this.get("min_val"))t=i("Scale should not be less than %(value)s",{value:this.get("min_val")});if(this.get("precision")>this.get("max_val"))t=i("Scale should not be greater than %(value)s",{value:this.get("max_val")});if(t){this.errorModel.set("precision",t);return t}}return null}});var f=n.EnumModel=r.Node.Model.extend({defaults:{label:undefined},schema:[{id:"label",label:i("Label"),type:"text",disabled:false,cellHeaderClasses:"width_percent_99",editable:function e(t){return s.isUndefined(t.get("label"))}}],validate:function e(){return null}});if(!r.Nodes["type"]){r.Nodes["type"]=l.SchemaChildNode.extend({type:"type",sqlAlterHelp:"sql-altertype.html",sqlCreateHelp:"sql-createtype.html",dialogHelp:e("help.static",{filename:"type_dialog.html"}),label:i("Type"),collection_type:"coll-type",hasSQL:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;r.add_menus([{name:"create_type_on_coll",node:"coll-type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:true},enable:"canCreate"},{name:"create_type",node:"type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:true},enable:"canCreate"},{name:"create_type",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:i("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:false},enable:"canCreate"}])},ext_funcs:undefined,model:r.Node.Model.extend({defaults:{name:undefined,oid:undefined,is_sys_type:false,typtype:undefined},initialize:function e(t,i){if(s.size(t)===0){var n=r.serverInfo[i.node_info.server._id].user,a=i.node_info.schema;this.set({typeowner:n.name,schema:a._label},{silent:true})}r.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:i("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"schemaCheck"},{id:"oid",label:i("OID"),cell:"string",type:"text",mode:["properties"],disabled:true},{id:"typeowner",label:i("Owner"),cell:"string",control:"node-list-by-name",type:"text",mode:["properties","create","edit"],node:"role",disabled:"inSchema",select2:{allowClear:false}},{id:"schema",label:i("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"schemaCheck",filter:function e(t){if(t&&t.label.match(/^pg_/)){return false}return true},cache_node:"database",cache_level:"database",control:"node-list-by-name",select2:{allowClear:false}},{id:"typtype",label:i("Type"),mode:["create","edit"],disabled:"inSchemaWithModelCheck",group:i("Definition"),select2:{allowClear:false},options:function e(){return[{label:"Composite",value:"c"},{label:"Enumeration",value:"e"},{label:"External",value:"b"},{label:"Range",value:"r"},{label:"Shell",value:"p"}]},control:n.Select2Control.extend({render:function e(){n.Select2Control.prototype.render.apply(this,arguments);if(this.model.isNew()){this.model.set({typtype:"c"})}return this}})},{id:"composite",label:i("Composite Type"),model:p,editable:true,type:"collection",group:i("Definition"),mode:["edit","create"],control:"unique-col-collection",uniqueCol:["member_name"],canAdd:true,canEdit:false,canDelete:true,disabled:"inSchema",deps:["typtype"],visible:function e(t){return t.get("typtype")==="c"}},{id:"enum",label:i("Enumeration type"),model:f,editable:true,type:"collection",group:i("Definition"),mode:["edit","create"],canAdd:true,canEdit:false,canDelete:function e(t){if(t.isNew()){return true}else{return false}},disabled:"inSchema",deps:["typtype"],control:"unique-col-collection",uniqueCol:["label"],visible:function e(t){return t.get("typtype")==="e"}},{type:"nested",control:"plain-fieldset",group:i("Definition"),mode:["edit","create"],visible:function e(t){return t.get("typtype")==="r"},deps:["typtype"],label:"",schema:[{id:"typname",label:i("Subtype"),cell:"string",control:"node-ajax-options",select2:{allowClear:true,placeholder:"",width:"100%"},url:"get_stypes",type:"text",mode:["properties","create","edit"],group:i("Range Type"),disabled:"inSchemaWithModelCheck",transform:function e(t,i){i.model.subtypes=t;return t}},{id:"opcname",label:i("Subtype operator class"),cell:"string",mode:["properties","create","edit"],group:i("Range Type"),disabled:"inSchemaWithModelCheck",deps:["typname"],control:"select",options:function e(){var t=this.model.get("typname"),i=this,n=[];if(!s.isUndefined(t)&&t!=""){var a=this.field.get("schema_node"),r=a.generate_url.apply(a,[null,"get_subopclass",this.field.get("node_data"),false,this.field.get("node_info")]);o.ajax({async:false,url:r,cache:false,data:{typname:t}}).done(function(e){n=e.data}).fail(function(){i.model.trigger("pgadmin:view:fetch:error",i.model,i.field)})}return n}},{id:"collname",label:i("Collation"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Range Type"),deps:["typname"],control:"node-ajax-options",url:"get_collations",select2:{allowClear:true,placeholder:"",width:"100%"},disabled:function e(t){if(this.node_info&&"catalog"in this.node_info){return true}if(!t.isNew()){return true}var i=t.get("typname"),n=undefined;if(!s.isUndefined(i)){s.each(t.subtypes,function(e){if(i===e.label){n=e.is_collate}})}return n?false:true}},{id:"rngcanonical",label:i("Canonical function"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Range Type"),disabled:"inSchemaWithModelCheck",deps:["name","typname"],control:"select",options:function e(){var t=this.model.get("name"),i=this,n=[];if(!s.isUndefined(t)&&t!=""){var a=this.field.get("schema_node"),r=a.generate_url.apply(a,[null,"get_canonical",this.field.get("node_data"),false,this.field.get("node_info")]);o.ajax({async:false,url:r,cache:false,data:{name:t}}).done(function(e){n=e.data}).fail(function(){i.model.trigger("pgadmin:view:fetch:error",i.model,i.field)})}return n}},{id:"rngsubdiff",label:i("Subtype diff function"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Range Type"),disabled:"inSchemaWithModelCheck",deps:["opcname"],control:"select",options:function e(){var t=this.model.get("typname"),i=this.model.get("opcname"),n=this,a=[];if(!s.isUndefined(t)&&t!=""&&!s.isUndefined(i)&&i!=""){var r=this.field.get("schema_node"),l=r.generate_url.apply(r,[null,"get_stypediff",this.field.get("node_data"),false,this.field.get("node_info")]);o.ajax({async:false,url:l,cache:false,data:{typname:t,opcname:i}}).done(function(e){a=e.data}).fail(function(){n.model.trigger("pgadmin:view:fetch:error",n.model,n.field)})}return a}}]},{type:"nested",control:"tab",group:i("Definition"),label:i("External Type"),deps:["typtype"],mode:["create","edit"],tabPanelExtraClasses:"inline-tab-panel-padded",visible:function e(t){return t.get("typtype")==="b"},schema:[{id:"spacer_ctrl",group:i("Required"),mode:["edit","create"],type:"spacer"},{id:"typinput",label:i("Input function"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:true,placeholder:"",width:"100%"}},{id:"typoutput",label:i("Output function"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Required"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:true,placeholder:"",width:"100%"}},{id:"spacer_ctrl_optional_1",group:i("Optional-1"),mode:["edit","create"],type:"spacer"},{id:"typreceive",label:i("Receive function"),cell:"string",type:"text",group:i("Optional-1"),mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:true,placeholder:"",width:"100%"}},{id:"typsend",label:i("Send function"),cell:"string",group:i("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:true,placeholder:"",width:"100%"}},{id:"typmodin",label:i("Typmod in function"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Optional-1"),disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:true,placeholder:"",width:"100%"},transform:function e(t){var i=[{label:"",value:""}];s.each(t,function(e){if(e.cbtype==="typmodin"||e.cbtype==="all"){i.push(e)}});return i}},{id:"typmodout",label:i("Typmod out function"),cell:"string",group:i("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:true,placeholder:"",width:"100%"},transform:function e(t){var i=[{label:"",value:""}];s.each(t,function(e){if(e.cbtype==="typmodout"||e.cbtype==="all"){i.push(e)}});return i}},{id:"typlen",label:i("Internal length"),cell:"integer",group:i("Optional-1"),type:"int",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"variable",label:i("Variable?"),cell:"switch",group:i("Optional-1"),type:"switch",mode:["create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typdefault",label:i("Default?"),cell:"string",group:i("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"},{id:"typanalyze",label:i("Analyze function"),cell:"string",group:i("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:true,placeholder:"",width:"100%"}},{id:"typcategory",label:i("Category type"),cell:"string",group:i("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:true,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"Array types",value:"A"},{label:"Boolean types",value:"B"},{label:"Composite types",value:"C"},{label:"Date/time types",value:"D"},{label:"Enum types",value:"E"},{label:"Geometric types",value:"G"},{label:"Network address types",value:"I"},{label:"Numeric types",value:"N"},{label:"Pseudo-types",value:"P"},{label:"String types",value:"S"},{label:"Timespan types",value:"T"},{label:"User-defined types",value:"U"},{label:"Bit-string types",value:"V"},{label:"unknown type",value:"X"}]},{id:"typispreferred",label:i("Preferred?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:i("Optional-1")},{id:"spacer_ctrl_optional_2",group:i("Optional-2"),mode:["edit","create"],type:"spacer"},{id:"element",label:i("Element type"),cell:"string",control:"node-ajax-options",group:i("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_types"},{id:"typdelim",label:i("Delimiter"),cell:"string",type:"text",mode:["properties","create","edit"],group:i("Optional-2"),disabled:"inSchemaWithModelCheck"},{id:"typalign",label:i("Alignment type"),cell:"string",group:i("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:true,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"char",value:"c"},{label:"int2",value:"s"},{label:"int4",value:"i"},{label:"double",value:"d"}]},{id:"typstorage",label:i("Storage type"),type:"text",mode:["properties","create","edit"],group:i("Optional-2"),cell:"string",disabled:"inSchemaWithModelCheck",control:"select2",select2:{allowClear:true,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"PLAIN",value:"p"},{label:"EXTERNAL",value:"e"},{label:"MAIN",value:"m"},{label:"EXTENDED",value:"x"}]},{id:"typbyval",label:i("Passed by value?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:i("Optional-2")},{id:"is_collatable",label:i("Collatable?"),cell:"switch",min_version:90100,group:i("Optional-2"),type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck"}]},{id:"alias",label:i("Alias"),cell:"string",type:"text",mode:["properties"],disabled:"inSchema"},r.SecurityGroupSchema,{id:"type_acl",label:i("Privileges"),cell:"string",type:"text",mode:["properties"],group:"security",disabled:"inSchema"},{id:"member_list",label:i("Members"),cell:"string",type:"text",mode:["properties"],group:i("Definition"),disabled:"inSchema",visible:function e(t){if(t.get("typtype")==="c"){return true}return false}},{id:"enum_list",label:i("Labels"),cell:"string",type:"text",mode:["properties"],group:i("Definition"),disabled:"inSchema",visible:function e(t){if(t.get("typtype")==="e"){return true}return false}},{id:"is_sys_type",label:i("System type?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{id:"description",label:i("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"typacl",label:i("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:r.Node.PrivilegeRoleModel.extend({privileges:["U"]}),mode:["edit","create"],canDelete:true,uniqueCol:["grantee"],deps:["typtype"],canAdd:function e(t){if(t.get("typtype")==="p"){var i=t.get("typacl");if(i.length>0)i.reset()}return!(t.get("typtype")==="p")}},{id:"seclabels",label:i("Security labels"),model:r.SecLabelModel,editable:false,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canEdit:false,canDelete:true,control:"unique-col-collection",deps:["typtype"],canAdd:function e(t){if(t.get("typtype")==="p"){var i=t.get("seclabels");if(i.length>0)i.reset()}return!(t.get("typtype")==="p")}}],validate:function e(){var t;this.errorModel.clear();if(s.isUndefined(this.get("name"))||s.isNull(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=i("Name cannot be empty.");this.errorModel.set("name",t);return t}if(s.isUndefined(this.get("schema"))||s.isNull(this.get("schema"))||String(this.get("schema")).replace(/^\s+|\s+$/g,"")==""){t=i("Schema cannot be empty.");this.errorModel.set("schema",t);return t}if(s.isUndefined(this.get("typtype"))||s.isNull(this.get("typtype"))||String(this.get("typtype")).replace(/^\s+|\s+$/g,"")==""){t=i("Type cannot be empty.");this.errorModel.set("typtype",t);return t}if(this.get("typtype")=="r"){if(s.isUndefined(this.get("typname"))||s.isNull(this.get("typname"))||String(this.get("typname")).replace(/^\s+|\s+$/g,"")==""){t=i("Subtype name cannot be empty.");this.errorModel.set("typname",t);return t}}if(this.get("typtype")=="b"){if(s.isUndefined(this.get("typinput"))||s.isNull(this.get("typinput"))||String(this.get("typinput")).replace(/^\s+|\s+$/g,"")==""){t=i("Input function cannot be empty.");this.errorModel.set("typinput",t);return t}if(s.isUndefined(this.get("typoutput"))||s.isNull(this.get("typoutput"))||String(this.get("typoutput")).replace(/^\s+|\s+$/g,"")==""){t=i("Output function cannot be empty.");this.errorModel.set("typoutput",t);return t}}return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},schemaCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return t.get("typtype")==="p"}}return true},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return true}}return true},inSchemaWithEditMode:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return true}else{return false}}return true},external_func_combo:function e(t){var i=[];s.each(t,function(e){if(e.cbtype=="all"){i.push(e)}});return i}})})}return r.Nodes["type"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(10),i(6),i(12),i(11),i(7)],a=function(r,e,t,u,i,n,p,l,o,a,s){if(!p.Nodes["coll-index"]){n.Browser.Nodes["coll-index"]=n.Browser.Collection.extend({node:"index",label:r("Indexes"),type:"coll-index",columns:["name","description"],hasStatistics:true,statsPrettifyFields:[r("Size"),r("Index size")],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})}var d=a.Extension.NodeAjaxOptionsCell.extend({initialize:function e(){a.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments);a.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){var t=this.model,i=this.column,n=this.column.get("editable"),a=this.$el.find("select").first();var r=u.isFunction(n)?!!n.apply(i,[t]):!!n;if(r){this.$el.addClass("editable");a.prop("disabled",false)}else{this.$el.removeClass("editable");a.prop("disabled",true)}this.delegateEvents();return this},remove:a.Extension.DependentCell.prototype.remove});var c=n.Browser.Node.Model.extend({defaults:{colname:undefined,collspcname:undefined,op_class:undefined,sort_order:false,nulls:false,is_sort_nulls_applicable:true},schema:[{id:"colname",label:r("Column"),cell:"node-list-by-name",type:"text",disabled:"inSchemaWithModelCheck",editable:function e(t){if(t instanceof i.Collection){return false}return!t.inSchemaWithModelCheck.apply(this,arguments)},control:"node-list-by-name",node:"column"},{id:"collspcname",label:r("Collation"),cell:d,type:"text",disabled:"inSchemaWithModelCheck",editable:function e(t){if(t instanceof i.Collection){return false}return!t.inSchemaWithModelCheck.apply(this,arguments)},control:"node-ajax-options",url:"get_collations",node:"index"},{id:"op_class",label:r("Operator class"),cell:d,tags:true,type:"text",disabled:"checkAccessMethod",editable:function e(t){if(t instanceof i.Collection){return false}else if(t.inSchemaWithModelCheck.apply(this,arguments)){return false}return!t.checkAccessMethod.apply(this,arguments)},control:"node-ajax-options",url:"get_op_class",node:"index",deps:["amname"],transform:function e(t,i){var n=i.model.top.get("amname"),a=t["btree"];if(u.isUndefined(n))return a;u.each(t,function(e,t){if(n===t){a=e}});return a}},{id:"sort_order",label:r("Sort order"),cell:a.Extension.TableChildSwitchCell,type:"switch",editable:function e(t){if(t instanceof i.Collection){return false}else if(t.inSchemaWithModelCheck.apply(this,arguments)){return false}else if(t.top.get("amname")==="btree"){t.set("is_sort_nulls_applicable",true);return true}else{t.set("is_sort_nulls_applicable",false);return false}},deps:["amname"],options:{onText:"DESC",offText:"ASC"}},{id:"nulls",label:r("NULLs"),cell:a.Extension.TableChildSwitchCell,type:"switch",editable:function e(t){if(t instanceof i.Collection){return false}else if(t.inSchemaWithModelCheck.apply(this,arguments)){return false}else if(t.top.get("amname")==="btree"){t.set("is_sort_nulls_applicable",true);return true}else{t.set("is_sort_nulls_applicable",false);return false}},deps:["amname","sort_order"],options:{onText:"FIRST",offText:"LAST"}}],validate:function e(){this.errorModel.clear();if(u.isUndefined(this.get("colname"))||String(this.get("colname")).replace(/^\s+|\s+$/g,"")==""){var t=r("Column Name cannot be empty.");this.errorModel.set("colname",t);return t}},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},inSchemaWithModelCheck:function e(t){if(t.top.node_info&&"schema"in t.top.node_info){if(t.top.isNew()){return false}else{return true}}return true},checkAccessMethod:function e(t){var i=t.top;if(u.isUndefined(i.get("amname"))||u.isNull(i.get("amname"))||String(i.get("amname")).replace(/^\s+|\s+$/g,"")==""||i.get("amname")==="btree"){if(t.get("sort_order")==true&&t.previous("sort_order")==false){setTimeout(function(){t.set("nulls",true)},10)}}else{t.set("is_sort_nulls_applicable",false)}return false}});if(!p.Nodes["index"]){n.Browser.Nodes["index"]=p.Node.extend({parent_type:["table","view","mview","partition"],collection_type:["coll-table","coll-view"],sqlAlterHelp:"sql-alterindex.html",sqlCreateHelp:"sql-createindex.html",dialogHelp:e("help.static",{filename:"index_dialog.html"}),type:"index",label:r("Index"),hasSQL:true,hasDepends:true,hasStatistics:true,width:p.stdW.md+"px",statsPrettifyFields:[r("Size"),r("Index size")],Init:function e(){if(this.initialized)return;this.initialized=true;p.add_menus([{name:"create_index_on_coll",node:"coll-index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:true},enable:"canCreate"},{name:"create_index",node:"index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:true},enable:"canCreate"},{name:"create_index_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:true},enable:"canCreate"},{name:"create_index_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:r("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:true},enable:"canCreate"},{name:"create_index_onMatView",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:r("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:true},enable:"canCreate"}])},canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema,model:n.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,nspname:undefined,tabname:undefined,spcname:undefined,amname:"btree"},schema:[{id:"name",label:r("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:r("OID"),cell:"string",type:"int",disabled:true,mode:["edit","properties"]},{id:"spcname",label:r("Tablespace"),cell:"string",control:"node-list-by-name",node:"tablespace",select2:{allowClear:true},type:"text",mode:["properties","create","edit"],disabled:"inSchema",filter:function e(t){if(t&&t.label.match(/pg_global/)){return false}return true}},{id:"amname",label:r("Access Method"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",url:"get_access_methods",group:r("Definition"),select2:{allowClear:true},control:o.NodeAjaxOptionsControl.extend({onChange:function e(){o.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var n=this,t=n.model.get("amname"),i=n.model.previous("amname");if(t!=i&&n.model.get("columns").length!==0){var a=r("Changing access method will clear columns collection");l.confirm(a,function(){var e=n.model.get("columns"),t=e.length;for(var i=t-1;i>=0;i--){e.remove(e.models[i])}},function(){setTimeout(function(){n.model.set("amname",i)},10)})}}})},{id:"columns_csv",label:r("Columns"),cell:"string",type:"text",disabled:"inSchema",mode:["properties"],group:r("Definition")},{id:"include",label:r("Include columns"),type:"array",group:r("Definition"),editable:false,canDelete:true,canAdd:true,mode:["properties"],disabled:"inSchemaWithModelCheck",visible:function e(t){if(!u.isUndefined(t.node_info)&&!u.isUndefined(t.node_info.server)&&!u.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=11e4)return true;return false},control:o.MultiSelectAjaxControl.extend({defaults:u.extend({},o.NodeListByNameControl.prototype.defaults,{select2:{allowClear:false,width:"style",multiple:true,placeholder:r("Select the column(s)")}})}),transform:function e(t){var i=[];if(t&&u.isArray(t)){u.each(t,function(e){i.push({label:e.label,value:e.label,image:"icon-column"})})}return i},node:"column"},{id:"fillfactor",label:r("Fill factor"),cell:"string",type:"int",disabled:"inSchema",mode:["create","edit","properties"],min:10,max:100,group:r("Definition")},{id:"indisunique",label:r("Unique?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",group:r("Definition")},{id:"indisclustered",label:r("Clustered?"),cell:"string",type:"switch",disabled:"inSchema",group:r("Definition")},{id:"indisvalid",label:r("Valid?"),cell:"string",type:"switch",disabled:true,mode:["properties"],group:r("Definition")},{id:"indisprimary",label:r("Primary?"),cell:"string",type:"switch",disabled:true,mode:["properties"],group:r("Definition")},{id:"is_sys_idx",label:r("System index?"),cell:"string",type:"switch",disabled:true,mode:["properties"]},{id:"isconcurrent",label:r("Concurrent build?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["create","edit"],group:r("Definition")},{id:"indconstraint",label:r("Constraint"),cell:"string",type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit"],control:"sql-field",visible:true,group:r("Definition")},{id:"columns",label:r("Columns"),type:"collection",deps:["amname"],group:r("Definition"),model:c,mode:["edit","create"],canAdd:function e(t){if(t.isNew()){return true}else{return false}},canEdit:false,canDelete:function e(t){if(t.isNew()){return true}else{return false}},control:"unique-col-collection",uniqueCol:["colname"],columns:["colname","op_class","sort_order","nulls","collspcname"]},{id:"include",label:r("Include columns"),type:"array",group:r("Definition"),editable:false,canDelete:true,canAdd:true,mode:["edit","create"],disabled:"inSchemaWithModelCheck",visible:function e(t){if(!u.isUndefined(t.node_info)&&!u.isUndefined(t.node_info.server)&&!u.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=11e4)return true;return false},control:o.MultiSelectAjaxControl.extend({defaults:u.extend({},o.NodeListByNameControl.prototype.defaults,{select2:{allowClear:false,width:"style",multiple:true,placeholder:r("Select the column(s)")}})}),transform:function e(t){var i=[];if(t&&u.isArray(t)){u.each(t,function(e){i.push({label:e.label,value:e.label,image:"icon-column"})})}return i},node:"column"},{id:"description",label:r("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function e(t){var i;if(t&&t.length==0){this.errorModel.clear();return null}else{this.errorModel.clear()}if(u.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){i=r("Name cannot be empty.");this.errorModel.set("name",i);return i}if(u.isUndefined(this.get("spcname"))||String(this.get("spcname")).replace(/^\s+|\s+$/g,"")==""){i=r("Tablespace cannot be empty.");this.errorModel.set("spcname",i);return i}if(u.isUndefined(this.get("amname"))||String(this.get("amname")).replace(/^\s+|\s+$/g,"")==""){i=r("Access method cannot be empty.");this.errorModel.set("amname",i);return i}var n=this.get("columns");if(n&&n.length>0){if(!u.every(n.pluck("colname"))){i=r("You must specify column name.");this.errorModel.set("columns",i);return i}}else if(n){i=r("You must specify at least one column.");this.errorModel.set("columns",i);return i}return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return true}}return true},inSchemaWithColumnCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{if(!u.isUndefined(t.get("attnum"))&&t.get("attnum")>=1){return false}else{return true}}}return true}}),canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=p.tree,r=i,l=t,o=[],s=false,d=false,c=this.getTreeNodeHierarchy(r).server.version;while(r){if(!s&&u.indexOf(["table","partition"],l._type)>-1){s=true;if("is_partitioned"in l&&l.is_partitioned&&c<11e4){d=true}}if(u.indexOf(["schema"],l._type)>-1)return!d;o.push(l._type);r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}if(u.indexOf(o,"catalog")>-1){return false}else{return!d}}})}return p.Nodes["index"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(6),i(10),i(11),i(7)],a=function(s,e,d,l,t,i,c,n,u,a){if(!c.Nodes["coll-trigger"]){i.Browser.Nodes["coll-trigger"]=i.Browser.Collection.extend({node:"trigger",label:s("Triggers"),type:"coll-trigger",columns:["name","description"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:a.isTreeItemOfChildOfSchema})}if(!c.Nodes["trigger"]){i.Browser.Nodes["trigger"]=c.Node.extend({parent_type:["table","view","partition"],collection_type:["coll-table","coll-view"],type:"trigger",label:s("Trigger"),hasSQL:true,hasDepends:true,width:c.stdW.sm+"px",sqlAlterHelp:"sql-altertrigger.html",sqlCreateHelp:"sql-createtrigger.html",dialogHelp:e("help.static",{filename:"trigger_dialog.html"}),Init:function e(){if(this.initialized)return;this.initialized=true;c.add_menus([{name:"create_trigger_on_coll",node:"coll-trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:true},enable:"canCreate"},{name:"create_trigger",node:"trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:true},enable:"canCreate"},{name:"create_trigger_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:true},enable:"canCreate"},{name:"create_trigger_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:true},enable:"canCreate"},{name:"enable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"enable_trigger",category:"connect",priority:3,label:s("Enable trigger"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"disable_trigger",category:"drop",priority:3,label:s("Disable trigger"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"create_trigger_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:true},enable:"canCreate"}])},callbacks:{enable_trigger:function e(t){var i=t||{},n=this,a=c.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;var o=l;d.ajax({url:n.generate_url(r,"enable",l,true),type:"PUT",data:{enable:true},dataType:"json"}).done(function(e){if(e.success==1){u.success(e.info);a.removeIcon(r);o.icon="icon-trigger";a.addIcon(r,{icon:o.icon});a.unload(r);a.setInode(false);a.deselect(r);setTimeout(function(){a.select(r)},10)}}).fail(function(e,t,i){u.pgRespErrorNotify(e,i);a.unload(r)})},disable_trigger:function e(t){var i=t||{},n=this,a=c.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;var o=l;d.ajax({url:n.generate_url(r,"enable",l,true),type:"PUT",data:{enable:false},dataType:"json"}).done(function(e){if(e.success==1){u.success(e.info);a.removeIcon(r);o.icon="icon-trigger-bad";a.addIcon(r,{icon:o.icon});a.unload(r);a.setInode(false);a.deselect(r);setTimeout(function(){a.select(r)},10)}}).fail(function(e,t,i){u.pgRespErrorNotify(e,i,s("Disable trigger failed"));a.unload(r)})}},canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:a.isTreeItemOfChildOfSchema,model:i.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,is_row_trigger:true,fires:"BEFORE"},schema:[{id:"name",label:s("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:s("OID"),cell:"string",type:"int",disabled:true,mode:["properties"]},{id:"is_enable_trigger",label:s("Trigger enabled?"),type:"switch",disabled:"inSchema",mode:["edit","properties"],group:s("Definition")},{id:"is_row_trigger",label:s("Row trigger?"),type:"switch",group:s("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function e(t){if(l.has(t,"node_info")&&l.has(t.node_info,"table")&&l.has(t.node_info.table,"is_partitioned")&&t.node_info.table.is_partitioned&&t.node_info.server.version<11e4){setTimeout(function(){t.set("is_row_trigger",false)},10);return true}var i=t.get("is_constraint_trigger");if(!t.inSchemaWithModelCheck.apply(this,[t])){if(!l.isUndefined(i)&&i===true){setTimeout(function(){t.set("is_row_trigger",true)},10);return true}else{return false}}else{var n=t.get("is_row_trigger");if(!l.isUndefined(n)&&t.node_info["server"]["server_type"]=="ppas"){return false}return true}}},{id:"is_constraint_trigger",label:s("Constraint trigger?"),type:"switch",mode:["create","edit","properties"],group:s("Definition"),disabled:function e(t){if(l.has(t,"node_info")&&l.has(t.node_info,"table")&&l.has(t.node_info.table,"is_partitioned")&&t.node_info.table.is_partitioned||l.indexOf(Object.keys(t.node_info),"view")!=-1){setTimeout(function(){t.set("is_constraint_trigger",false)},10);return true}return t.inSchemaWithModelCheck.apply(this,[t])}},{id:"tgdeferrable",label:s("Deferrable?"),type:"switch",group:s("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function e(t){var i=t.get("is_constraint_trigger");if(!t.inSchemaWithModelCheck.apply(this,[t])){if(!l.isUndefined(i)&&i===true){return false}else{if(t.get("tgdeferrable")){setTimeout(function(){t.set("tgdeferrable",false)},10)}return true}}else{return true}}},{id:"tginitdeferred",label:s("Deferred?"),type:"switch",group:s("Definition"),mode:["create","edit","properties"],deps:["tgdeferrable","is_constraint_trigger"],disabled:function e(t){var i=t.get("tgdeferrable");if(!t.inSchemaWithModelCheck.apply(this,[t])){if(!l.isUndefined(i)&&i){return false}else{if(t.get("tginitdeferred")){setTimeout(function(){t.set("tginitdeferred",false)},10)}return t.get("is_constraint_trigger")?false:true}}else{return true}}},{id:"tfunction",label:s("Trigger function"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],group:s("Definition"),control:"node-ajax-options",url:"get_triggerfunctions",cache_node:"trigger_function"},{id:"tgargs",label:s("Arguments"),cell:"string",group:s("Definition"),type:"text",mode:["create","edit","properties"],deps:["tfunction"],disabled:function e(t){var i=t.get("tfunction"),n=t.node_info["server"]["server_type"];if(!t.inSchemaWithModelCheck.apply(this,[t])){if(n==="ppas"&&!l.isUndefined(i)&&i==="Inline EDB-SPL"){t.set("tgargs",undefined);return true}else{return false}}else{return true}}},{id:"fires",label:s("Fires"),deps:["is_constraint_trigger"],mode:["create","edit","properties"],group:s("Events"),options:function e(t){var i=[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"}],n=[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"},{label:"INSTEAD OF",value:"INSTEAD OF"}];if(l.indexOf(Object.keys(t.model.node_info),"table")!=-1){return i}else{return n}},control:"select2",select2:{allowClear:false,width:"100%"},disabled:function e(t){var i=t.get("is_constraint_trigger");if(!t.inSchemaWithModelCheck.apply(this,[t])){if(!l.isUndefined(i)&&i===true){setTimeout(function(){t.set("fires","AFTER")},10);return true}else{return false}}else{var n=t.get("fires");if(!l.isUndefined(n)&&t.node_info["server"]["server_type"]=="ppas"){return false}return true}}},{type:"nested",control:"fieldset",mode:["create","edit","properties"],label:s("Events"),group:s("Events"),contentClass:"row",schema:[{id:"evnt_insert",label:s("INSERT"),type:"switch",mode:["create","edit","properties"],group:s("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function e(t){var i=t.get("evnt_insert");if(!l.isUndefined(i)&&t.node_info["server"]["server_type"]=="ppas")return false;return t.inSchemaWithModelCheck.apply(this,[t])}},{id:"evnt_update",label:s("UPDATE"),type:"switch",mode:["create","edit","properties"],group:s("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function e(t){var i=t.get("evnt_update");if(!l.isUndefined(i)&&t.node_info["server"]["server_type"]=="ppas")return false;return t.inSchemaWithModelCheck.apply(this,[t])}},{id:"evnt_delete",label:s("DELETE"),type:"switch",mode:["create","edit","properties"],group:s("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function e(t){var i=t.get("evnt_delete");if(!l.isUndefined(i)&&t.node_info["server"]["server_type"]=="ppas")return false;return t.inSchemaWithModelCheck.apply(this,[t])}},{id:"evnt_truncate",label:s("TRUNCATE"),type:"switch",group:s("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function e(t){var i=t.get("is_constraint_trigger"),n=t.get("is_row_trigger"),a=t.node_info["server"]["server_type"];if(!t.inSchemaWithModelCheck.apply(this,[t])){if(a==="ppas"&&!l.isUndefined(i)&&!l.isUndefined(n)&&i===false&&n===false){return false}else{return true}}else{return true}}}]},{id:"whenclause",label:s("When"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],control:"sql-field",visible:true,group:s("Events")},{id:"columns",label:s("Columns"),url:"nodes",control:"node-list-by-name",cache_node:"column",type:"array",select2:{multiple:true},deps:["evnt_update"],node:"column",group:s("Events"),disabled:function e(t){if(this.node_info&&"catalog"in this.node_info){return true}if(!t.isNew()){return true}var i=t.get("evnt_update");if(!l.isUndefined(i)&&i){return false}return true}},{id:"tgoldtable",label:s("Old table"),type:"text",group:s("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"tgnewtable",label:s("New table"),type:"text",group:s("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"prosrc",label:s("Code"),group:s("Code"),type:"text",mode:["create","edit"],deps:["tfunction"],control:"sql-field",visible:true,disabled:function e(t){var i=t.get("tfunction"),n=t.node_info["server"]["server_type"];if(n==="ppas"&&!l.isUndefined(i)&&i==="Inline EDB-SPL")return false;else return true}},{id:"is_sys_trigger",label:s("System trigger?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["properties"]},{id:"description",label:s("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function e(t){var i;this.errorModel.clear();if(t&&t.length==0){return null}if(l.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){i=s("Name cannot be empty.");this.errorModel.set("name",i);return i}if(l.isUndefined(this.get("tfunction"))||String(this.get("tfunction")).replace(/^\s+|\s+$/g,"")==""){i=s("Trigger function cannot be empty.");this.errorModel.set("tfunction",i);return i}if(!this.get("evnt_truncate")&&!this.get("evnt_delete")&&!this.get("evnt_update")&&!this.get("evnt_insert")){i=s("Specify at least one event.");this.errorModel.set("evnt_truncate"," ");this.errorModel.set("evnt_delete"," ");this.errorModel.set("evnt_update"," ");this.errorModel.set("evnt_insert",i);return i}if(!l.isUndefined(this.get("tfunction"))&&this.get("tfunction")==="Inline EDB-SPL"&&(l.isUndefined(this.get("prosrc"))||String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")=="")){i=s("Trigger code cannot be empty.");this.errorModel.set("prosrc",i);return i}return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return true}}return true},inSchemaWithColumnCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{if(!l.isUndefined(t.get("attnum"))&&t.get("attnum")>=1){return false}else{return true}}}return true},disableTransition:function e(t){var i=true,n=null,a=this.name,r=0;if(l.indexOf(Object.keys(t.node_info),"table")==-1||t.node_info.server.version<1e5)return true;if(a=="tgoldtable")n="evnt_delete";else if(a=="tgnewtable")n="evnt_insert";if(t.get("evnt_insert"))r++;if(t.get("evnt_update"))r++;if(t.get("evnt_delete"))r++;if(!t.get("is_constraint_trigger")&&t.get("fires")=="AFTER"&&(t.get("evnt_update")||t.get(n))&&r==1){if(t.get("evnt_update")&&l.size(t.get("columns"))>=1&&t.get("columns")[0]!="")i=true;else i=false}i&&setTimeout(function(){if(t.get(a)){t.set(a,null)}},10);return i}}),canCreate:a.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function e(t,i,n){return t.icon==="icon-trigger-bad"&&this.canCreate.apply(this,[t,i,n])},canCreate_with_trigger_disable:function e(t,i,n){return t.icon==="icon-trigger"&&this.canCreate.apply(this,[t,i,n])}})}return c.Nodes["trigger"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(0),i(1),i(8),i(3),i(5),i(7)],a=function(e,t,i,n,a,r){if(!r.Nodes["coll-catalog_object_column"]){a.Browser.Nodes["coll-catalog_object_column"]=a.Browser.Collection.extend({node:"catalog_object_column",label:e("catalog_object_column"),type:"coll-catalog_object_column",columns:["attname","attnum","cltype","description"],canDrop:false,canDropCascade:false})}if(!r.Nodes["catalog_object_column"]){a.Browser.Nodes["catalog_object_column"]=a.Browser.Node.extend({parent_type:"catalog_object",type:"catalog_object_column",label:e("catalog_object_column"),hasSQL:false,hasScriptTypes:[],hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true},model:a.Browser.Node.Model.extend({defaults:{attname:undefined,attowner:undefined,atttypid:undefined,attnum:undefined,cltype:undefined,collspcname:undefined,attacl:undefined,description:undefined},schema:[{id:"attname",label:e("Column"),cell:"string",type:"text",disabled:true},{id:"attowner",label:e("Owner"),cell:"string",type:"text",disabled:true},{id:"attnum",label:e("Position"),cell:"string",type:"text",disabled:true},{id:"cltype",label:e("Data type"),cell:"string",group:e("Definition"),type:"text",disabled:true},{id:"collspcname",label:e("Collation"),cell:"string",group:e("Definition"),type:"text",disabled:true},{id:"attacl",label:e("Privileges"),cell:"string",group:e("Security"),type:"text",disabled:true},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:true}]})})}return r.Nodes["catalog_object_column"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(13),i(11),i(16),i(62)],a=function(r,e,t,l,i,o,n,a,s){if(!o.Nodes["coll-view"]){o.Nodes["coll-view"]=o.Collection.extend({node:"view",label:r("Views"),type:"coll-view",columns:["name","owner"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})}if(!o.Nodes["view"]){o.Nodes["view"]=a.SchemaChildNode.extend({type:"view",sqlAlterHelp:"sql-alterview.html",sqlCreateHelp:"sql-createview.html",dialogHelp:e("help.static",{filename:"view_dialog.html"}),label:r("View"),hasSQL:true,hasDepends:true,hasScriptTypes:["create","select","insert"],collection_type:"coll-view",Init:function e(){if(this.initialized)return;this.initialized=true;o.add_menus([{name:"create_view_on_coll",node:"coll-view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:r("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:true},enable:"canCreate"},{name:"create_view",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:r("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:true},enable:"canCreate"},{name:"create_view",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:17,label:r("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:false},enable:"canCreate"}])},model:o.Node.Model.extend({idAttribute:"oid",initialize:function e(t,i){if(l.size(t)===0){var n=i.node_info.schema._label||"public",a=o.serverInfo[i.node_info.server._id].user;this.set({schema:n,owner:a.name},{silent:true})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:r("Name"),cell:"string",type:"text",disabled:"notInSchema"},{id:"oid",label:r("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"owner",label:r("Owner"),cell:"string",control:"node-list-by-name",node:"role",disabled:"notInSchema",select2:{allowClear:false}},{id:"schema",label:r("Schema"),cell:"string",first_empty:false,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",disabled:"notInSchema",mode:["create","edit"],select2:{allowClear:false},cache_node:"database"},{id:"system_view",label:r("System view?"),cell:"string",type:"switch",disabled:true,mode:["properties"]},{id:"acl",label:r("Privileges"),mode:["properties"],type:"text",group:r("Security")},{id:"comment",label:r("Comment"),cell:"string",type:"multiline",disabled:"notInSchema"},{id:"security_barrier",label:r("Security barrier?"),type:"switch",min_version:"90200",group:r("Definition"),disabled:"notInSchema"},{id:"check_option",label:r("Check options"),control:"select2",group:r("Definition"),type:"text",min_version:"90400",mode:["properties","create","edit"],select2:{allowClear:false},disabled:"notInSchema",options:[{label:r("No"),value:"no"},{label:r("Local"),value:"local"},{label:r("Cascaded"),value:"cascaded"}]},{id:"definition",label:r("Definition"),cell:"string",type:"text",mode:["create","edit"],group:r("Definition"),control:n.SqlFieldControl,disabled:"notInSchema"},o.SecurityGroupSchema,{id:"datacl",label:r("Privileges"),type:"collection",model:o.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:false,group:"security",mode:["edit","create"],canAdd:true,canDelete:true,control:"unique-col-collection",disabled:"notInSchema"},{id:"seclabels",label:r("Security labels"),model:o.SecLabelModel,editable:false,type:"collection",canEdit:false,group:"security",canDelete:true,mode:["edit","create"],canAdd:true,disabled:"notInSchema",control:"unique-col-collection",uniqueCol:["provider"]}],validate:function e(){var t={},i,n=this.get("name"),a=this.get("definition");if(l.isUndefined(n)||l.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){t["name"]=r("Please specify name.");i=i||t["name"];this.errorModel.set("name",i);return i}else{this.errorModel.unset("name")}if(l.isUndefined(a)||l.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==""){t["definition"]=r("Please enter view definition.");i=i||t["definition"];this.errorModel.set("definition",i);return i}else{this.errorModel.unset("definition")}return null},notInSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false}})})}return o.Nodes["view"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(10),i(5),i(6),i(13),i(11),i(16)],a=function(o,e,s,l,d,c,u,t,i,n){if(!u.Nodes["coll-mview"]){u.Nodes["coll-mview"]=u.Collection.extend({node:"mview",label:o("Materialized Views"),type:"coll-mview",columns:["name","owner"],canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema})}if(!u.Nodes["mview"]){u.Nodes["mview"]=i.SchemaChildNode.extend({type:"mview",sqlAlterHelp:"sql-altermaterializedview.html",sqlCreateHelp:"sql-creatematerializedview.html",dialogHelp:e("help.static",{filename:"materialized_view_dialog.html"}),label:o("Materialized View"),hasSQL:true,hasDepends:true,hasScriptTypes:["create","select"],collection_type:"coll-mview",Init:function e(){if(this.initialized)return;this.initialized=true;d.Browser.add_menu_category("refresh_mview",o("Refresh View"),18,"");u.add_menus([{name:"create_mview_on_coll",node:"coll-mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:true},enable:"canCreate",label:o("Materialized View...")},{name:"create_mview",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:true},enable:"canCreate",label:o("Materialized View...")},{name:"create_mview",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:18,icon:"wcTabIcon icon-mview",data:{action:"create",check:false},enable:"canCreate",label:o("Materialized View...")},{name:"refresh_mview_data",node:"mview",module:this,priority:1,callback:"refresh_mview",category:"refresh_mview",applies:["object","context"],label:o("With data"),data:{concurrent:false,with_data:true},icon:"fa fa-recycle"},{name:"refresh_mview_nodata",node:"mview",callback:"refresh_mview",priority:2,module:this,category:"refresh_mview",applies:["object","context"],label:o("With no data"),data:{concurrent:false,with_data:false},icon:"fa fa-refresh"},{name:"refresh_mview_concurrent",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:true,with_data:true},priority:3,applies:["object","context"],callback:"refresh_mview",label:o("With data (concurrently)"),icon:"fa fa-recycle"},{name:"refresh_mview_concurrent_nodata",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:true,with_data:false},priority:4,applies:["object","context"],callback:"refresh_mview",label:o("With no data (concurrently)"),icon:"fa fa-refresh"}])},model:u.Node.Model.extend({idAttribute:"oid",initialize:function e(t,i){if(l.size(t)===0){var n=i.node_info.schema._label||"public",a=u.serverInfo[i.node_info.server._id].user;this.set({schema:n,owner:a.name},{silent:true})}u.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{spcname:undefined,toast_autovacuum_enabled:false,autovacuum_enabled:false},schema:[{id:"name",label:o("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:o("OID"),cell:"string",type:"text",disabled:true,mode:["properties"]},{id:"owner",label:o("Owner"),cell:"string",control:"node-list-by-name",select2:{allowClear:false},node:"role",disabled:"inSchema"},{id:"schema",label:o("Schema"),cell:"string",first_empty:false,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",mode:["create","edit"],cache_node:"database",disabled:"inSchema",select2:{allowClear:false}},{id:"system_view",label:o("System view?"),cell:"string",type:"switch",disabled:true,mode:["properties"]},u.SecurityGroupSchema,{id:"acl",label:o("Privileges"),mode:["properties"],type:"text",group:o("Security")},{id:"comment",label:o("Comment"),cell:"string",type:"multiline"},{id:"definition",label:"Definition",cell:"string",type:"text",mode:["create","edit"],group:o("Definition"),control:t.SqlFieldControl,extraClasses:["sql_field_width_full"]},{id:"with_data",label:o("With data?"),group:o("Storage"),mode:["edit","create"],type:"switch"},{id:"spcname",label:o("Tablespace"),cell:"string",type:"text",group:o("Storage"),first_empty:false,control:"node-list-by-name",node:"tablespace",select2:{allowClear:false},filter:function e(t){if(t.label=="pg_global")return false;else return true}},{id:"fillfactor",label:o("Fill factor"),group:o("Storage"),mode:["edit","create"],type:"int"},{type:"nested",control:"tab",id:"materialization",label:o("Parameter"),mode:["edit","create"],group:o("Parameter"),schema:t.VacuumSettingsSchema},{id:"datacl",label:o("Privileges"),type:"collection",model:u.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:false,group:"security",canAdd:true,canDelete:true,mode:["edit","create"],control:"unique-col-collection"},{id:"seclabels",label:o("Security labels"),model:u.SecLabelModel,editable:false,type:"collection",canEdit:false,group:"security",canDelete:true,mode:["edit","create"],canAdd:true,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function e(t){var i={},n,a=this.get("name"),r=this.get("definition");if(l.indexOf(t,"autovacuum_enabled")!=-1||l.indexOf(t,"toast_autovacuum_enabled")!=-1)return null;if(l.isUndefined(a)||l.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==""){i["name"]=o("Please specify name.");n=n||i["name"];this.errorModel.set("name",n);return n}else{this.errorModel.unset("name")}if(l.isUndefined(r)||l.isNull(r)||String(r).replace(/^\s+|\s+$/g,"")==""){i["definition"]=o("Please enter view definition.");n=n||i["definition"];this.errorModel.set("definition",n);return n}else{this.errorModel.unset("definition")}return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false}}),refresh_mview:function e(t){var i=t||{},n=this,a=u.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;s.ajax({url:n.generate_url(r,"refresh_data",l,true),type:"PUT",data:{concurrent:t.concurrent,with_data:t.with_data},dataType:"json"}).done(function(e){if(e.success==1){c.success(o("View refreshed successfully"))}else{c.alert(o("Error refreshing view"),e.data.result)}}).fail(function(e,t,i){c.pgRespErrorNotify(e,i,o("Error refreshing view"))})},is_version_supported:function e(t,i){var n=d.Browser.tree,a=i||n.selected(),r=t||(a&&a.length==1?n.itemData(a):undefined),l=this||r&&d.Browser.Nodes[r._type],o=l.getTreeNodeHierarchy.apply(l,[a]),s=o.server.version;return s>=90400}})}return u.Nodes["mview"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(153),i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(10),i(6),i(12),i(154),i(13),i(11),i(7),i(155),i(156),i(63)],a=function(i,s,e,u,h,d,b,_,c,p,t,n,a,r){if(!_.Nodes["coll-table"]){_.Nodes["coll-table"]=_.Collection.extend({node:"table",label:s("Tables"),type:"coll-table",columns:["name","relowner","is_partitioned","description"],hasStatistics:true,statsPrettifyFields:[s("Size"),s("Indexes size"),s("Table size"),s("TOAST table size"),s("Tuple length"),s("Dead tuple length"),s("Free space")],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})}if(!_.Nodes["table"]){_.Nodes["table"]=a.SchemaChildNode.extend({type:"table",label:s("Table"),collection_type:"coll-table",hasSQL:true,hasDepends:true,hasStatistics:true,statsPrettifyFields:[s("Size"),s("Indexes size"),s("Table size"),s("TOAST table size"),s("Tuple length"),s("Dead tuple length"),s("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:e("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create","select","insert","update","delete"],width:"650px",Init:function e(){if(this.initialized)return;this.initialized=true;_.add_menus([{name:"create_table_on_coll",node:"coll-table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:s("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:true},enable:"canCreate"},{name:"create_table",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:s("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:true},enable:"canCreate"},{name:"create_table__on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:false},enable:"canCreate"},{name:"truncate_table",node:"table",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:s("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"table",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:s("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:s("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:s("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"table",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:s("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"count_table_rows",node:"table",module:this,applies:["object","context"],callback:"count_table_rows",category:"Count",priority:2,label:s("Count Rows"),enable:true}]);_.Events.on("pgadmin:browser:node:table:updated",this.onTableUpdated,this);_.Events.on("pgadmin:browser:node:type:cache_cleared",this.handle_cache,this);_.Events.on("pgadmin:browser:node:domain:cache_cleared",this.handle_cache,this)},callbacks:{enable_triggers_on_table:function e(t){i.enableTriggers(_.treeMenu,c,this.generate_url.bind(this),t)},disable_triggers_on_table:function e(t){i.disableTriggers(_.treeMenu,c,this.generate_url.bind(this),t)},truncate_table:function e(t){var i={cascade:false};this.callbacks.truncate.apply(this,[t,i])},truncate_table_cascade:function e(t){var i={cascade:true};this.callbacks.truncate.apply(this,[t,i])},truncate:function e(t,i){var n=t||{},a=this,r=_.tree,l=n.item||r.selected(),o=l&&l.length==1?r.itemData(l):undefined;if(!o)return false;c.confirm(s("Truncate Table"),d(s("Are you sure you want to truncate table %s?")).sprintf(o.label).value(),function(e){if(e){var t=o;u.ajax({url:a.generate_url(l,"truncate",o,true),type:"PUT",data:i,dataType:"json"}).done(function(e){if(e.success==1){c.success(e.info);r.removeIcon(l);t.icon=t.is_partitioned?"icon-partition":"icon-table";r.addIcon(l,{icon:t.icon});r.unload(l);r.setInode(l);r.deselect(l);setTimeout(function(){r.select(l)},10)}}).fail(function(e,t,i){c.pgRespErrorNotify(e,i);r.unload(l)})}},function(){})},reset_table_stats:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;c.confirm(s("Reset statistics"),d(s('Are you sure you want to reset the statistics for table "%s"?')).sprintf(l._label).value(),function(e){if(e){var t=l;u.ajax({url:n.generate_url(r,"reset",l,true),type:"DELETE"}).done(function(e){if(e.success==1){c.success(e.info);a.removeIcon(r);t.icon=t.is_partitioned?"icon-partition":"icon-table";a.addIcon(r,{icon:t.icon});a.unload(r);a.setInode(r);a.deselect(r);setTimeout(function(){a.select(r)},10)}}).fail(function(e,t,i){c.pgRespErrorNotify(e,i);a.unload(r)})}},function(){})},count_table_rows:function e(t){var i=t||{},n=this,a=_.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;u.ajax({url:n.generate_url(r,"count_rows",l,true),type:"GET"}).done(function(e){c.success(e.info);l.rows_cnt=e.data.total_rows;a.unload(r);a.setInode(r);a.deselect(r);setTimeout(function(){a.select(r)},10)}).fail(function(e,t,i){c.pgRespErrorNotify(e,i);a.unload(r)})}},model:_.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,spcoid:undefined,spcname:undefined,relowner:undefined,relacl:undefined,relhasoids:undefined,relhassubclass:undefined,reltuples:undefined,description:undefined,conname:undefined,conkey:undefined,isrepl:undefined,triggercount:undefined,relpersistence:undefined,fillfactor:undefined,reloftype:undefined,typname:undefined,labels:undefined,providers:undefined,is_sys_table:undefined,coll_inherits:[],hastoasttable:true,toast_autovacuum_enabled:false,autovacuum_enabled:false,primary_key:[],partitions:[],partition_type:"range",is_partitioned:false},initialize:function e(t,i){if(h.size(t)===0){var n=_.serverInfo[i.node_info.server._id].user,a=i.node_info.schema;this.set({relowner:n.name,schema:a._label},{silent:true})}_.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:s("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:s("OID"),type:"text",mode:["properties"]},{id:"relowner",label:s("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:false},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:s("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit"],disabled:"inSchema",filter:function e(t){if(t&&t.label.match(/^pg_/)){return false}return true},cache_node:"database",cache_level:"database"},{id:"spcname",label:s("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function e(t){return!(t&&t.label.match(/pg_global/))}},{id:"partition",type:"group",label:s("Partition"),mode:["edit","create"],min_version:1e5,visible:function e(t){if(t.isNew()||t.get("is_partitioned"))return true;return false}},{id:"is_partitioned",label:s("Partitioned table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function e(t){if(!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(!t.isNew())return true;return false}},{id:"description",label:s("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"coll_inherits",label:s("Inherited from table(s)"),url:"get_inherits",type:"array",group:s("Columns"),disabled:"checkInheritance",deps:["typname","is_partitioned"],mode:["create","edit"],select2:{multiple:true,allowClear:true,placeholder:s("Select to inherit from...")},transform:function e(t,i){var n=i||this,a=n.model;a.inherited_tables_list=t;return t},control:p.MultiSelectAjaxControl.extend({onChange:function e(){p.MultiSelectAjaxControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("coll_inherits")||[],n=t.model.previous("coll_inherits")||[];if(!h.isUndefined(i)){var a=undefined,r=undefined;if(i.length>1&&i.length>n.length){a=h.difference(i,n);r=this.get_table_oid(a[0]);this.add_columns(r)}else if(i.length==1){r=this.get_table_oid(i[0]);this.add_columns(r)}if(i.length>0&&i.length<n.length){a=h.difference(n,i);this.remove_columns(a[0])}else if(n.length===1&&i.length<1){a=n[0];this.remove_columns(a)}}},add_columns:function e(t){var i=this,n=i.model.top||i.model,a=undefined,r=n.get("columns");var l={tid:t};a=i.model.fetch_columns_ajax.apply(i,[l]);r.set(a,{merge:false,remove:false})},remove_columns:function e(t){var i=this.get_table_oid(t),n=this.model.get("columns");n.remove(n.where({inheritedid:i}))},get_table_oid:function e(t){var i=undefined;h.each(this.model.inherited_tables_list,function(e){if(e.label===t){i=e.tid}});return i}})},{id:"advanced",label:s("Advanced"),type:"group",visible:n.show_advanced_tab},{id:"coll_inherits",label:s("Inherited from table(s)"),type:"text",group:"advanced",mode:["properties"]},{id:"inherited_tables_cnt",label:s("Inherited tables count"),type:"text",mode:["properties"],group:"advanced",disabled:"inSchema"},{id:"columns",label:s("Columns"),type:"collection",group:s("Columns"),model:_.Nodes["column"].model,subnode:_.Nodes["column"].model,mode:["create","edit"],disabled:function e(t){if(t.isNew()&&t.get("is_partitioned")){setTimeout(function(){var e=t.get("columns");e.remove(e.filter(function(e){if(h.isUndefined(e.get("inheritedfrom")))return false;return true}))},10)}if(this.node_info&&"catalog"in this.node_info){return true}return false},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:true,canDelete:true,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:p.UniqueColCollectionControl.extend({initialize:function e(){p.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var s=this,t=s.model.get(s.field.get("name"));t.on("change:is_primary_key",function(e){var t=s.model.get("primary_key"),i=e.get("name"),n,a;if(e.get("is_primary_key")){if(t.length<1){n=new t.model({},{top:s.model,collection:t,handler:t});t.add(n)}else{n=t.first()}if(h.isUndefined(n.get("oid"))){a=n.get("columns");var r=a.where({column:i});if(r.length==0){var l=new a.model({column:i},{silent:true,top:s.model,collection:t,handler:t});a.add(l)}a.trigger("pgadmin:multicolumn:updated",a)}}else{if(t.length>0){n=t.first();if(!h.isUndefined(n.get("oid"))){return}a=n.get("columns");var o=a.where({column:i});if(o.length>0){a.remove(o);h.each(o,function(e){e.destroy()});if(a.length==0){t.remove(t.first())}}a.trigger("pgadmin:multicolumn:updated",a)}}})},remove:function e(){var t=this.model.get(this.field.get("name"));if(t){t.off("change:is_primary_key")}p.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:false},{type:"nested",control:"tab",group:s("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:"",model:_.Nodes["primary_key"].model,subnode:_.Nodes["primary_key"].model,editable:false,type:"collection",group:s("Primary Key"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function e(t){if(t.get("is_partitioned")&&!h.isUndefined(t.top.node_info)&&!h.isUndefined(t.top.node_info.server)&&!h.isUndefined(t.top.node_info.server.version)&&t.top.node_info.server.version<11e4){setTimeout(function(){var e=t.get("primary_key");e.remove(e.filter(function(){return true}))},10);return false}return true},canAddRow:function e(t){var i=t.get("columns");return t.get("primary_key")&&t.get("primary_key").length<1&&h.some(i.pluck("name"))}},{id:"foreign_key",label:"",model:_.Nodes["foreign_key"].model,subnode:_.Nodes["foreign_key"].model,editable:false,type:"collection",group:s("Foreign Key"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function e(t){if(t.get("is_partitioned")&&!h.isUndefined(t.top.node_info)&&!h.isUndefined(t.top.node_info.server)&&!h.isUndefined(t.top.node_info.server.version)&&t.top.node_info.server.version<11e4){setTimeout(function(){var e=t.get("foreign_key");e.remove(e.filter(function(){return true}))},10);return false}return true},columns:["name","columns"],canAddRow:function e(t){var i=t.get("columns");return h.some(i.pluck("name"))}},{id:"check_constraint",label:"",model:_.Nodes["check_constraint"].model,subnode:_.Nodes["check_constraint"].model,editable:false,type:"collection",group:s("Check"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",canAdd:true,columns:["name","consrc"]},{id:"unique_constraint",label:"",model:_.Nodes["unique_constraint"].model,subnode:_.Nodes["unique_constraint"].model,editable:false,type:"collection",group:s("Unique"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function e(t){if(t.get("is_partitioned")&&!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version<11e4){setTimeout(function(){var e=t.get("unique_constraint");e.remove(e.filter(function(){return true}))},10);return false}return true},canAddRow:function e(t){var i=t.get("columns");return h.some(i.pluck("name"))}},{id:"exclude_constraint",label:"",model:_.Nodes["exclusion_constraint"].model,subnode:_.Nodes["exclusion_constraint"].model,editable:false,type:"collection",group:s("Exclude"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function e(t){if(t.get("is_partitioned")){setTimeout(function(){var e=t.get("exclude_constraint");e.remove(e.filter(function(){return true}))},10);return false}return true},canAddRow:function e(t){var i=t.get("columns");return h.some(i.pluck("name"))}}]},{id:"typname",label:s("Of type"),type:"text",mode:["properties","create","edit"],disabled:"checkOfType",url:"get_oftype",group:s("advanced"),deps:["coll_inherits"],transform:function e(t,i){var n=i||this,a=n.model;a.of_types_tables=t;return t},control:p.NodeAjaxOptionsControl.extend({onChange:function e(){p.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("typname"),n=undefined,a=undefined,r=t.model.get("columns");if(!h.isUndefined(i)&&!h.isNull(i)&&i!==""&&r.length!==0){var l=s("Remove column definitions?"),o=s("Changing 'Of type' will remove column definitions.");c.confirm(l,o,function(){r.remove(r.filter(function(){return true}))},function(){setTimeout(function(){t.model.set("typname",null)},10)})}else if(!h.isUndefined(i)&&i===""){r.remove(r.filter(function(){return true}))}if(!h.isUndefined(i)&&i!==""){a={tname:i};n=t.model.fetch_columns_ajax.apply(t,[a]);r.set(n,{merge:false,remove:false})}}})},{id:"fillfactor",label:s("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:s("advanced")},{id:"relhasoids",label:s("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",group:s("advanced")},{id:"relpersistence",label:s("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:s("advanced")},{id:"conname",label:s("Primary key"),cell:"string",type:"text",mode:["properties"],group:s("advanced"),disabled:"inSchema"},{id:"reltuples",label:s("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:s("advanced"),disabled:"inSchema"},{id:"rows_cnt",label:s("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:s("advanced"),disabled:"inSchema",control:p.InputControl.extend({formatter:{fromRaw:function e(t){var i=b.Browser.tree,n=i.selected(),a=n&&n.length==1?i.itemData(n):undefined;if(a&&a.rows_cnt&&parseInt(a.rows_cnt,10)>0)return a.rows_cnt;else return t},toRaw:function e(t){return t}}})},{id:"relhassubclass",label:s("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:s("advanced"),disabled:"inSchema"},{id:"is_sys_table",label:s("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:s("Like"),group:s("advanced"),schema:[{id:"like_relation",label:s("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:s("Like")},{id:"like_default_value",label:s("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_constraints",label:s("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_indexes",label:s("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_storage",label:s("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_comments",label:s("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")}]},{id:"partition_type",label:s("Partition Type"),editable:false,type:"select2",select2:{allowClear:false},group:"partition",deps:["is_partitioned"],options:function e(){var e=[{label:s("Range"),value:"range"},{label:s("List"),value:"list"}];if(!h.isUndefined(this.node_info)&&!h.isUndefined(this.node_info.server)&&!h.isUndefined(this.node_info.server.version)&&this.node_info.server.version>=11e4){e.push({label:s("Hash"),value:"hash"})}return e},mode:["create"],visible:function e(t){if(!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(!t.isNew()||!t.get("is_partitioned"))return true;return false}},{id:"partition_keys",label:s("Partition Keys"),model:p.PartitionKeyModel,subnode:p.PartitionKeyModel,editable:true,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type","typname"],canEdit:false,canDelete:true,control:"sub-node-collection",canAdd:function e(t){if(t.isNew()&&t.get("is_partitioned"))return true;return false},canAddRow:function e(t){var i=t.get("columns"),n=t.get("typname"),a=false;var r=1e3;if(t.get("partition_type")&&t.get("partition_type")=="list")r=1;if(i.length<=0&&!h.isUndefined(n)&&!h.isNull(n)&&t.of_types_tables.length>0){h.each(t.of_types_tables,function(e){if(e.label==n&&e.oftype_columns.length>0){a=true}})}else if(i.length>0){a=h.some(i.pluck("name"))}return t.get("partition_keys")&&t.get("partition_keys").length<r&&a},visible:function e(t){if(!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(t.get("partition_keys")&&t.get("partition_keys").models.length>0){setTimeout(function(){var e=t.get("partition_keys");e.remove(e.filter(function(){return true}))},10)}}},{id:"partition_scheme",label:s("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function e(t){if(!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(!t.isNew()){this.text=t.get("partition_scheme")}}},{id:"partition_key_note",label:s("Partition Keys"),type:"note",group:"partition",mode:["create"],text:["<ul><li>",s("Partition table supports two types of keys:"),"</li><li>","<strong>",s("Column: "),"</strong>",s("User can select any column from the list of available columns."),"</li><li>","<strong>",s("Expression: "),"</strong>",s("User can specify expression to create partition key."),"</li><li>","<strong>",s("Example: "),"</strong>",s("Let's say, we want to create a partition table based per year for the column 'saledate', having datatype 'date/timestamp', then we need to specify the expression as 'extract(YEAR from saledate)' as partition key."),"</li></ul>"].join(""),visible:function e(t){if(!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false}},{id:"partitions",label:s("Partitions"),model:p.PartitionsModel,subnode:p.PartitionsModel,editable:true,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type","typname"],canEdit:false,canDelete:true,customDeleteTitle:s("Detach Partition"),customDeleteMsg:s("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","is_default","values_from","values_to","values_in","values_modulus","values_remainder"],control:p.SubNodeCollectionControl.extend({row:t.PartitionRow,initialize:function e(){p.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var i=this.field.get("schema_node"),n=this.field.get("node_info");u.ajax({url:i.generate_url.apply(i,[null,"get_attach_tables",this.field.get("node_data"),true,n]),type:"GET",async:false}).done(function(e){if(e.success==1){t.model.table_options=e.data}else{c.alert(s("Error fetching tables to be attached"),e.data.result)}}).fail(function(e,t,i){c.pgRespErrorNotify(e,i)})}}}),canAdd:function e(t){if(t.get("is_partitioned"))return true;return false},visible:function e(t){if(!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(t.isNew()&&t.get("partitions")&&t.get("partitions").models.length>0){setTimeout(function(){var e=t.get("partitions");e.remove(e.filter(function(){return true}))},10)}}},{id:"partition_note",label:s("Partitions"),type:"note",group:"partition",text:["<ul><li>","<strong>",s("Create a table: "),"</strong>",s("User can create multiple partitions while creating new partitioned table. Operation switch is disabled in this scenario."),"</li><li>","<strong>",s("Edit existing table: "),"</strong>",s("User can create/attach/detach multiple partitions. In attach operation user can select table from the list of suitable tables to be attached."),"</li><li>","<strong>",s("Default: "),"</strong>",s("The default partition can store rows that do not fall into any existing partitions range or list."),"</li><li>","<strong>",s("From/To/In input: "),"</strong>",s("From/To/In input: Values for these fields must be quoted with single quote. For more than one partition key values must be comma(,) separated."),"</li><li>","<strong>",s("Example: From/To: "),"</strong>",s("Enabled for range partition. Consider partitioned table with multiple keys of type Integer, then values should be specified like '100','200'."),"</li><li>","<strong>",s("In: "),"</strong>",s("Enabled for list partition. Values must be comma(,) separated and quoted with single quote."),"</li><li>","<strong>",s("Modulus/Remainder: "),"</strong>",s("Enabled for hash partition."),"</li></ul>"].join(""),visible:function e(t){if(!h.isUndefined(t.node_info)&&!h.isUndefined(t.node_info.server)&&!h.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false}},{type:"nested",control:"tab",group:s("Parameters"),mode:["edit","create"],deps:["is_partitioned"],schema:p.VacuumSettingsSchema},{id:"relacl_str",label:s("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:s("Security")},_.SecurityGroupSchema,{id:"relacl",label:s("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:_.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:true,canDelete:true,uniqueCol:["grantee"]},{id:"seclabels",label:s("Security labels"),canEdit:false,model:_.SecLabelModel,editable:false,canAdd:true,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:true,control:"unique-col-collection"},{id:"vacuum_settings_str",label:s("Storage settings"),type:"multiline",group:"advanced",mode:["properties"]}],validate:function e(){var t,i=this.get("name"),n=this.get("schema"),a=this.get("relowner"),r=this.get("is_partitioned"),l=this.get("partition_keys");if(h.isUndefined(i)||h.isNull(i)||String(i).replace(/^\s+|\s+$/g,"")==""){t=s("Table name cannot be empty.");this.errorModel.set("name",t);return t}this.errorModel.unset("name");if(h.isUndefined(n)||h.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){t=s("Table schema cannot be empty.");this.errorModel.set("schema",t);return t}this.errorModel.unset("schema");if(h.isUndefined(a)||h.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==""){t=s("Table owner cannot be empty.");this.errorModel.set("relowner",t);return t}this.errorModel.unset("relowner");if(r&&this.isNew()&&!h.isNull(l)&&l.length<=0){t=s("Please specify at least one key for partitioned table.");this.errorModel.set("partition_keys",t);return t}this.errorModel.unset("partition_keys");return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},isInheritedTable:function e(t){if(!t.inSchema.apply(this,[t])){if(!h.isUndefined(t.get("coll_inherits"))&&t.get("coll_inherits").length!=0||!h.isUndefined(t.get("typname"))&&String(t.get("typname")).replace(/^\s+|\s+$/g,"")!==""){return false}else{return true}}return false},checkInheritance:function e(t){if(t.get("is_partitioned")){setTimeout(function(){t.set("coll_inherits",[])},10);return true}if(!t.inSchema.apply(this,[t])&&(h.isUndefined(t.get("typname"))||h.isNull(t.get("typname"))||String(t.get("typname")).replace(/^\s+|\s+$/g,"")=="")){return false}return true},isLikeDisable:function e(t){if(!t.inSchemaWithModelCheck.apply(this,[t])&&(h.isUndefined(t.get("typname"))||h.isNull(t.get("typname"))||String(t.get("typname")).replace(/^\s+|\s+$/g,"")=="")){return false}return true},check_grid_add_condition:function e(t){var i=true;if(!t.inSchema.apply(this,[t])){if(!h.isUndefined(t.get("typname"))&&!h.isNull(t.get("typname"))&&t.get("typname")!==""){i=false}}return i},check_grid_row_edit_delete:function e(t){var i=true;if(!h.isUndefined(t.get("inheritedfrom"))&&!h.isNull(t.get("inheritedfrom"))&&String(t.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")!==""){i=false}return i},checkOfType:function e(t){if(!t.inSchemaWithModelCheck.apply(this,[t])&&(h.isUndefined(t.get("coll_inherits"))||h.isNull(t.get("coll_inherits"))||String(t.get("coll_inherits")).replace(/^\s+|\s+$/g,"")=="")){return false}return true},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return true}}return true},isTableAutoVacuumEnable:function e(t){if(!t.inSchema.apply(this,[t])&&t.get("autovacuum_enabled")===true){return false}return true},isToastTableAutoVacuumEnable:function e(t){if(!t.inSchemaWithModelCheck.apply(this,[t])&&t.get("toast_autovacuum_enabled")==true){return false}return true},fetch_columns_ajax:function e(t){var i=this,n="get_columns",a=i.model.top||i.model,r=undefined,l=this.field.get("schema_node"),o=this.field.get("node_info"),s=l.generate_url.apply(l,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||false,o]),d=this.field.get("cache_level")||l.type,c=this.field.get("cache_node");c=c&&_.Nodes[c]||l;a.trigger("pgadmin:view:fetching",a,i.field);u.ajax({async:false,url:s,data:t}).done(function(e){r=c.cache(n,o,d,e.data)}).fail(function(){a.trigger("pgadmin:view:fetch:error",a,i.field)});a.trigger("pgadmin:view:fetched",a,i.field);r=r&&r.data||[];return r}}),canCreate_with_trigger_enable:function e(t,i,n){return t.tigger_count>0&&this.canCreate.apply(this,[t,i,n])},canCreate_with_trigger_disable:function e(t,i,n){return t.tigger_count>0&&t.has_enable_triggers>0&&this.canCreate.apply(this,[t,i,n])},onTableUpdated:function e(t,i,n){var a,r;if(n.is_partitioned&&"affected_partitions"in n){var l=n.affected_partitions,o=this,s=[],d=[],c=function e(){if(!d.length)return;var t=d.pop();_.addChildTreeNodes(t.treeHierarchy,t.parent,t.type,t.childrenIDs,e)},u;if("detached"in l&&l.detached.length>0){_.removeChildTreeNodesById(t,"coll-partition",h.map(l.detached,function(e){return parseInt(e.oid)}));u=_.findParentTreeNodeByType(t,"schema");var p=h.groupBy(l.detached,function(e){return parseInt(e.schema_id)});for(a in p){u=_.findSiblingTreeNode(u,a);if(u){r=h.map(p[a],function(e){return parseInt(e.oid)});var f=_.findChildCollectionTreeNode(u,"coll-table");if(f){d.push({parent:f,type:"table",treeHierarchy:b.Browser.Nodes.schema.getTreeNodeHierarchy(u),childrenIDs:h.clone(r)})}}}}if("attached"in l&&l.attached.length>0){u=_.findParentTreeNodeByType(t,"schema");var m=h.groupBy(l.attached,function(e){return parseInt(e.schema_id)});for(a in m){u=_.findSiblingTreeNode(u,a);if(u){r=h.map(m[a],function(e){return parseInt(e.oid)});_.removeChildTreeNodesById(u,"coll-table",r)}s=s.concat(r)}}if("created"in l&&l.created.length>0){h.each(l.created,function(e){s.push(e.oid)})}if(s.length){var g=_.findChildCollectionTreeNode(t,"coll-partition");if(g){d.push({parent:g,type:"partition",treeHierarchy:o.getTreeNodeHierarchy(t),childrenIDs:s})}}c()}},handle_cache:function e(){this.clear_cache.apply(this,null)}})}return _.Nodes["table"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.disableTriggers=a;t.enableTriggers=r;var l=n(i(24));function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,i,n){return o(e,t,i,n,{enable:"false"})}function r(e,t,i,n){return o(e,t,i,n,{enable:"true"})}function o(i,n,e,t,a){var r=s(t,i);if(!r||r.getData()===null||r.getData()===undefined)return false;l.default.put(e(r.getHtmlIdentifier(),"set_trigger",r.getData(),true),a).then(function(e){if(e.data.success===1){n.success(e.data.info);r.reload(i)}}).catch(function(e){try{var t=e.response.data;if(t.success===0){n.error(t.errormsg)}}catch(e){console.warn(e.stack||e)}r.unload(i)})}function s(e,t){var i=e||{};var n=i.item||t.selected();return t.findNodeByDomElement(n)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.show_advanced_tab=l;var n=a(i(1));function a(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}function r(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&e.node_info.server.server_type==="gpdb"}function l(e){if(r(e)){return false}return true}},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(6),i(12),i(11),i(7)],a=function(d,e,t,c,i,n,s,a,r,l){if(!s.Nodes["coll-column"]){s.Nodes["coll-column"]=s.Collection.extend({node:"column",label:d("Columns"),type:"coll-column",columns:["name","atttypid","description"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema})}var o=a.VariablesModel=s.Node.Model.extend({idAttribute:"name",defaults:{name:null,value:null},schema:[{id:"name",label:d("Name"),cell:"select2",type:"text",disabled:false,node:"column",options:[["n_distinct","n_distinct"],["n_distinct_inherited","n_distinct_inherited"]],select2:{placeholder:"Select variable"},cellHeaderClasses:"width_percent_50"},{id:"value",label:d("Value"),type:"text",disabled:false,cellHeaderClasses:"width_percent_50"}],validate:function e(){if(c.isUndefined(this.get("value"))||c.isNull(this.get("value"))||String(this.get("value")).replace(/^\s+|\s+$/g,"")==""){var t=d("Please provide input for variable.");this.errorModel.set("value",t);return t}else{this.errorModel.unset("value")}return null}});var u=r.Extension.IntegerDepCell=r.IntegerCell.extend({initialize:function e(){r.NumberCell.prototype.initialize.apply(this,arguments);r.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){this.$el.empty();var t=this.model,i=this.column,n=this.column.get("editable"),a=c.isFunction(n)?!!n.apply(i,[t]):!!n;if(a){this.$el.addClass("editable")}else{this.$el.removeClass("editable")}this.delegateEvents();return this},render:function e(){r.NumberCell.prototype.render.apply(this,arguments);var t=this.model,i=this.column,n=this.column.get("editable"),a=c.isFunction(n)?!!n.apply(i,[t]):!!n;if(a){this.$el.addClass("editable")}else{this.$el.removeClass("editable")}return this},remove:r.Extension.DependentCell.prototype.remove});if(!s.Nodes["column"]){s.Nodes["column"]=s.Node.extend({parent_type:["table","view","mview"],collection_type:["coll-table","coll-view","coll-mview"],type:"column",label:d("Column"),hasSQL:true,sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-altertable.html",dialogHelp:e("help.static",{filename:"column_dialog.html"}),canDrop:function e(t,i){var n=s.treeMenu.findNodeByDomElement(i);if(!n)return false;return n.anyParent(function(e){return e.getData()._type==="table"&&!e.anyParent(function(e){return e.getData()._type==="catalog"})})},hasDepends:true,hasStatistics:true,Init:function e(){if(this.initialized)return;this.initialized=true;s.add_menus([{name:"create_column_on_coll",node:"coll-column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:true},enable:"canCreate"},{name:"create_column",node:"column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:true},enable:"canCreate"},{name:"create_column_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:true},enable:"canCreate"},{name:"create_column_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:true},enable:"canCreate"}])},model:s.Node.Model.extend({idAttribute:"attnum",defaults:{name:undefined,attowner:undefined,atttypid:undefined,attnum:undefined,cltype:undefined,collspcname:undefined,attacl:undefined,description:undefined,parent_tbl:undefined,min_val:undefined,max_val:undefined,edit_types:undefined,is_primary_key:false,inheritedfrom:undefined,attstattarget:undefined,attnotnull:false,attlen:null,attprecision:null,attidentity:undefined,seqincrement:undefined,seqstart:undefined,seqmin:undefined,seqmax:undefined,seqcache:undefined,seqcycle:undefined},initialize:function e(t){if(c.size(t)!==0){this.set({old_attidentity:this.get("attidentity")},{silent:true})}s.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:d("Name"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_30",editable:"editable_check_for_table"},{id:"is_primary_key",label:d("Primary key?"),cell:r.Extension.TableChildSwitchCell,type:"switch",deps:["name"],cellHeaderClasses:"width_percent_5",options:{onText:d("Yes"),offText:d("No"),onColor:"success",offColor:"primary"},visible:function e(t){return c.isUndefined(t.top.node_info["table"]||t.top.node_info["view"]||t.top.node_info["mview"])},disabled:function e(t){if(t.top&&(!c.isUndefined(t.top.get("oid"))&&t.top.get("primary_key").length>0&&!c.isUndefined(t.top.get("primary_key").first().get("oid"))||t.top.has("is_partitioned")&&t.top.get("is_partitioned")&&t.top.node_info.server&&t.top.node_info.server.version<11e3)){return true}var i=t.get("name");if(!t.inSchemaWithColumnCheck.apply(this,[t])&&(c.isUndefined(i)||c.isNull(i)||i=="")){return true}return false},editable:function e(t){if(t instanceof i.Collection){return true}if(t.top&&!c.isUndefined(t.top.get("oid"))&&t.top.get("primary_key").length>0&&!c.isUndefined(t.top.get("primary_key").first().get("oid"))){return false}if(t.top&&!c.isUndefined(t.top.get("is_partitioned"))&&t.top.get("is_partitioned")&&t.top.node_info.server&&t.top.node_info.server.version<11e3){setTimeout(function(){t.set("is_primary_key",false)},10);return false}if(!t.inSchemaWithColumnCheck.apply(this,[t])){return true}return false}},{id:"attnum",label:d("Position"),cell:"string",type:"text",disabled:"notInSchema",mode:["properties"]},{id:"cltype",label:d("Data type"),cell:r.Extension.NodeAjaxOptionsCell,type:"text",disabled:"inSchemaWithColumnCheck",control:"node-ajax-options",url:"get_types",node:"table",cellHeaderClasses:"width_percent_30",first_empty:true,select2:{allowClear:false},group:d("Definition"),cache_node:"table",transform:function e(t,i){var n=i||this,a=n.model;n.model.datatypes=t;var r=a.get("edit_types"),l=[];if(!c.isUndefined(a.top)&&!a.top.isNew()){c.each(t,function(e){if(c.indexOf(r,e.value)!=-1){l.push(e)}});return l.length>0?l:t}if(a.isNew()){return t}else{c.each(t,function(e){if(c.indexOf(r,e.value)!=-1){l.push(e)}});return l}},editable:"editable_check_for_table"},{id:"inheritedfrom",label:d("Inherited from table"),type:"text",disabled:true,editable:false,cellHeaderClasses:"width_percent_10",visible:function e(t){return c.isUndefined(t.top.node_info["table"]||t.top.node_info["view"]||t.top.node_info["mview"])}},{id:"attlen",label:d("Length"),cell:u,deps:["cltype"],type:"int",group:d("Definition"),cellHeaderClasses:"width_percent_20",disabled:function e(t){var i=t.get("cltype"),n=true;c.each(t.datatypes,function(e){if(i==e.value){if(e.length){t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true});n=false}}});n&&setTimeout(function(){if(t.get("attlen")){t.set("attlen",null)}},10);return n},editable:function e(t){if(!c.isUndefined(t.get("inheritedfrom"))){return false}if(!t.datatypes){return true}var i=t.get("cltype"),n=false;c.each(t.datatypes,function(e){if(i==e.value){if(e.length){t.set("min_val",e.min_val,{silent:true});t.set("max_val",e.max_val,{silent:true});n=true}}});!n&&setTimeout(function(){if(t.get("attlen")){t.set("attlen",null,{silent:true})}},10);return n}},{id:"attprecision",label:d("Precision"),cell:u,deps:["cltype"],type:"int",group:d("Definition"),cellHeaderClasses:"width_percent_20",disabled:function e(t){var i=t.get("cltype"),n=true;c.each(t.datatypes,function(e){if(i==e.value){if(e.precision){t.set("min_val",0,{silent:true});t.set("max_val",e.max_val,{silent:true});n=false}}});n&&setTimeout(function(){if(t.get("attprecision")){t.set("attprecision",null)}},10);return n},editable:function e(t){if(!c.isUndefined(t.get("inheritedfrom"))){return false}if(!t.datatypes){return true}var i=t.get("cltype"),n=false;c.each(t.datatypes,function(e){if(i==e.value){if(e.precision){t.set("min_val",0,{silent:true});t.set("max_val",e.max_val,{silent:true});n=true}}});!n&&setTimeout(function(){if(t.get("attprecision")){t.set("attprecision",null)}},10);return n}},{id:"collspcname",label:d("Collation"),cell:"string",type:"text",control:"node-ajax-options",url:"get_collations",group:d("Definition"),node:"collation",deps:["cltype"],disabled:function e(t){var i=t.get("cltype"),n=true;c.each(t.datatypes,function(e){if(i==e.value){if(e.is_collatable){n=false}}});if(n){setTimeout(function(){if(t.get("collspcname")&&t.get("collspcname")!==""){t.set("collspcname","")}},10)}return n}},{id:"defval",label:d("Default"),cell:"string",type:"text",group:d("Definition"),deps:["cltype"],disabled:function e(t){if(!t.inSchemaWithModelCheck.apply(this,[t])){var i=t.get("cltype");return i=="serial"||i=="bigserial"||i=="smallserial"}}},{id:"attnotnull",label:d("Not NULL?"),cell:"switch",type:"switch",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_20",group:d("Definition"),editable:"editable_check_for_table",options:{onText:d("Yes"),offText:d("No"),onColor:"success",offColor:"primary"}},{type:"nested",control:"fieldset",label:d("Identity"),group:d("Definition"),schema:[{id:"attidentity",label:d("Identity"),control:"select2",cell:"select2",select2:{placeholder:"Select identity",allowClear:true,width:"100%"},min_version:1e5,group:d("Identity"),options:[{label:d("ALWAYS"),value:"a"},{label:d("BY DEFAULT"),value:"d"}]},{id:"seqincrement",label:d("Increment"),type:"int",mode:["properties","create","edit"],group:d("Identity"),min:1,deps:["attidentity"],disabled:"isIdentityColumn"},{id:"seqstart",label:d("Start"),type:"int",mode:["properties","create"],group:d("Identity"),disabled:function e(t){if(!t.isNew())return true;var i=t.get("attidentity");if(!c.isUndefined(i)&&!c.isNull(i)&&!c.isEmpty(i))return false;return true},deps:["attidentity"]},{id:"seqmin",label:d("Minimum"),type:"int",mode:["properties","create","edit"],group:d("Identity"),deps:["attidentity"],disabled:"isIdentityColumn"},{id:"seqmax",label:d("Maximum"),type:"int",mode:["properties","create","edit"],group:d("Identity"),deps:["attidentity"],disabled:"isIdentityColumn"},{id:"seqcache",label:d("Cache"),type:"int",mode:["properties","create","edit"],group:d("Identity"),min:1,deps:["attidentity"],disabled:"isIdentityColumn"},{id:"seqcycle",label:d("Cycled"),type:"switch",mode:["properties","create","edit"],group:d("Identity"),deps:["attidentity"],disabled:"isIdentityColumn"}]},{id:"attstattarget",label:d("Statistics"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",mode:["properties","edit"],group:d("Definition")},{id:"attstorage",label:d("Storage"),group:d("Definition"),type:"text",mode:["properties","edit"],cell:"string",disabled:"inSchemaWithColumnCheck",first_empty:true,control:"select2",select2:{placeholder:"Select storage",allowClear:false,width:"100%"},options:[{label:"PLAIN",value:"p"},{label:"MAIN",value:"m"},{label:"EXTERNAL",value:"e"},{label:"EXTENDED",value:"x"}]},{id:"is_pk",label:d("Primary key?"),type:"switch",disabled:true,mode:["properties"],group:d("Definition")},{id:"is_fk",label:d("Foreign key?"),type:"switch",disabled:true,mode:["properties"],group:d("Definition")},{id:"is_inherited",label:d("Inherited?"),type:"switch",disabled:true,mode:["properties"],group:d("Definition")},{id:"tbls_inherited",label:d("Inherited from table(s)"),type:"text",disabled:true,mode:["properties"],deps:["is_inherited"],group:d("Definition"),visible:function e(t){if(!c.isUndefined(t.get("is_inherited"))&&t.get("is_inherited")){return true}else{return false}}},{id:"is_sys_column",label:d("System column?"),cell:"string",type:"switch",disabled:true,mode:["properties"]},{id:"description",label:d("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"notInSchema"},{id:"attoptions",label:d("Variables"),type:"collection",group:d("Variables"),control:"unique-col-collection",model:o,uniqueCol:["name"],mode:["edit","create"],canAdd:true,canEdit:false,canDelete:true},s.SecurityGroupSchema,{id:"attacl",label:d("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:s.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),mode:["edit"],canAdd:true,canDelete:true,uniqueCol:["grantee"]},{id:"seclabels",label:d("Security labels"),canAdd:true,model:s.SecLabelModel,group:"security",mode:["edit","create"],editable:false,type:"collection",min_version:90100,canEdit:false,canDelete:true,control:"unique-col-collection"}],validate:function e(t){var i=undefined;if(t&&t.length==0){this.errorModel.clear();return null}else{this.errorModel.clear()}if(c.isUndefined(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){i=d("Column name cannot be empty.");this.errorModel.set("name",i);return i}if(c.isUndefined(this.get("cltype"))||String(this.get("cltype")).replace(/^\s+|\s+$/g,"")==""){i=d("Column type cannot be empty.");this.errorModel.set("cltype",i);return i}if(!c.isUndefined(this.get("cltype"))&&!c.isUndefined(this.get("attlen"))&&!c.isNull(this.get("attlen"))&&this.get("attlen")!==""){if(this.get("attlen")<this.get("min_val"))i=d("Length should not be less than: ")+this.get("min_val");if(this.get("attlen")>this.get("max_val"))i=d("Length should not be greater than: ")+this.get("max_val");if(i){this.errorModel.set("attlen",i);return i}}if(!c.isUndefined(this.get("cltype"))&&!c.isUndefined(this.get("attprecision"))&&!c.isNull(this.get("attprecision"))&&this.get("attprecision")!==""){if(this.get("attprecision")<this.get("min_val"))i=d("Precision should not be less than: ")+this.get("min_val");if(this.get("attprecision")>this.get("max_val"))i=d("Precision should not be greater than: ")+this.get("max_val");if(i){this.errorModel.set("attprecision",i);return i}}var n=this.get("seqmin"),a=this.get("seqmax"),r=this.get("seqstart");if(!this.isNew()&&(this.get("old_attidentity")=="a"||this.get("old_attidentity")=="d")&&(this.get("attidentity")=="a"||this.get("attidentity")=="d")){if(c.isUndefined(this.get("seqincrement"))||String(this.get("seqincrement")).replace(/^\s+|\s+$/g,"")==""){i=d("Increment value cannot be empty.");this.errorModel.set("seqincrement",i);return i}else{this.errorModel.unset("seqincrement")}if(c.isUndefined(this.get("seqmin"))||String(this.get("seqmin")).replace(/^\s+|\s+$/g,"")==""){i=d("Minimum value cannot be empty.");this.errorModel.set("seqmin",i);return i}else{this.errorModel.unset("seqmin")}if(c.isUndefined(this.get("seqmax"))||String(this.get("seqmax")).replace(/^\s+|\s+$/g,"")==""){i=d("Maximum value cannot be empty.");this.errorModel.set("seqmax",i);return i}else{this.errorModel.unset("seqmax")}if(c.isUndefined(this.get("seqcache"))||String(this.get("seqcache")).replace(/^\s+|\s+$/g,"")==""){i=d("Cache value cannot be empty.");this.errorModel.set("seqcache",i);return i}else{this.errorModel.unset("seqcache")}}var l=d("Minimum value must be less than maximum value."),o=d("Start value cannot be less than minimum value."),s=d("Start value cannot be greater than maximum value.");if(c.isEmpty(n)||c.isEmpty(a))return null;if(n==0&&a==0||parseInt(n,10)>=parseInt(a,10)){this.errorModel.set("seqmin",l);return l}else{this.errorModel.unset("seqmin")}if(r&&n&&parseInt(r)<parseInt(n)){this.errorModel.set("seqstart",o);return o}else{this.errorModel.unset("seqstart")}if(r&&a&&parseInt(r)>parseInt(a)){this.errorModel.set("seqstart",s);return s}else{this.errorModel.unset("seqstart")}return null},isIdentityColumn:function e(t){var i=t.get("attidentity");if(!c.isUndefined(i)&&!c.isNull(i)&&!c.isEmpty(i))return false;return true},notInSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return true}}return true},inSchemaWithColumnCheck:function e(t){var i=this.node_info||t.node_info||t.top.node_info;if(i&&("view"in i||"mview"in i)){if(this&&c.has(this,"name")&&this.name!="defval"){return true}}if(i&&"schema"in i){if(!c.isUndefined(t.get("inheritedfrom"))){return true}if(t.isNew()){return false}if(!c.isUndefined(t.get("attnum"))&&t.get("attnum")>0){return false}else{return true}}return true},editable_check_for_table:function e(t){if(t instanceof i.Collection){return!t.model.prototype.inSchemaWithColumnCheck.apply(this,[t.top])}else{return!t.inSchemaWithColumnCheck.apply(this,[t])}}}),canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=s.tree,r=i,l=t,o=[];while(r){if(c.indexOf(["schema"],l._type)>-1){return true}else if(c.indexOf(["view","coll-view","mview","coll-mview"],l._type)>-1){o.push(l._type);break}o.push(l._type);r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}if(c.indexOf(o,"catalog")>-1||c.indexOf(o,"coll-view")>-1||c.indexOf(o,"coll-mview")>-1||c.indexOf(o,"mview")>-1||c.indexOf(o,"view")>-1){return false}else{return true}}})}return s.Nodes["column"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(0),i(1),i(3),i(5),i(7),i(157),i(158),i(159),i(160),i(161)],a=function(e,t,i,n,a){if(!a.Nodes["coll-constraints"]){n.Browser.Nodes["coll-constraints"]=n.Browser.Collection.extend({node:"constraints",label:e("Constraints"),type:"coll-constraints",columns:["name","comment"],canDrop:false,canDropCascade:false})}if(!a.Nodes["constraints"]){n.Browser.Nodes["constraints"]=a.Node.extend({type:"constraints",label:e("Constraints"),collection_type:"coll-constraints",parent_type:["table","partition"],Init:function e(){if(this.initialized)return;this.initialized=true;a.add_menus([])},model:n.Browser.Node.Model.extend({defaults:{name:undefined,oid:undefined,comment:undefined},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("Oid"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"]}]})})}return a.Nodes["constraints"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(12),i(7)],a=function(a,e,t,u,i,p,n,r){if(!p.Nodes["unique_constraint"]){i.Browser.Nodes["unique_constraint"]=p.Node.extend({type:"unique_constraint",label:a("Unique constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"unique_constraint_dialog.html"}),hasSQL:true,hasDepends:true,hasStatistics:true,statsPrettifyFields:[a("Index size")],parent_type:["table","partition"],canDrop:true,canDropCascade:true,Init:function e(){if(this.initialized)return;this.initialized=true;p.add_menus([{name:"create_unique_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Unique constraint"),icon:"wcTabIcon icon-unique_constraint",data:{action:"create",check:true},enable:"canCreate"}])},canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=p.tree,r=i,l=t,o=[],s=false,d=false,c=this.getTreeNodeHierarchy(r).server.version;while(r){if(!s&&(l._type=="table"||l._type=="partition")){s=true;if("is_partitioned"in l&&l.is_partitioned&&c<11e4){d=true}}if(u.indexOf(["schema"],l._type)>-1){return!d}o.push(l._type);r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}if(u.indexOf(o,"catalog")>-1){return false}else{return!d}},model:i.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,comment:undefined,spcname:undefined,index:undefined,fillfactor:undefined,condeferrable:undefined,condeferred:undefined,columns:[],include:[]},schema:[{id:"name",label:a("Name"),type:"text",mode:["properties","create","edit"],editable:true,cellHeaderClasses:"width_percent_40"},{id:"oid",label:a("OID"),cell:"string",type:"text",mode:["properties"],editable:false,cellHeaderClasses:"width_percent_20"},{id:"comment",label:a("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function e(t){var i=t.get("name");if(!(i&&i!="")){setTimeout(function(){if(t.get("comment")&&t.get("comment")!==""){t.set("comment",null)}},10);return true}else{return false}}},{id:"columns",label:a("Columns"),type:"collection",group:a("Definition"),editable:false,cell:r.StringCell.extend({initialize:function e(){r.StringCell.prototype.initialize.apply(this,arguments);var t=this,i=this.model.get("columns");if(u.isUndefined(t.model.get("oid"))){var n=t.model.top.get("columns");t.listenTo(n,"remove",t.removeColumn);t.listenTo(n,"change:name",t.resetColOptions)}i.on("pgadmin:multicolumn:updated",function(){t.render.apply(t)});t.listenTo(i,"add",t.render);t.listenTo(i,"remove",t.render)},removeColumn:function e(t){var i=this,n=i.model.get("columns").where({column:t.get("name")});i.model.get("columns").remove(n);setTimeout(function(){i.render()},10);var a="unique_constraint";setTimeout(function(){var e=i.model.top.get(a),t=[];e.each(function(e){if(e.get("columns").length==0){t.push(e)}});e.remove(t)},100)},resetColOptions:function e(t){var i=this,n=i.model.get("columns").where({column:t.previous("name")});if(n.length>0){n[0].set({column:t.get("name")},{silent:true})}setTimeout(function(){i.render()},10)},formatter:{fromRaw:function e(t){return t.pluck("column").toString()},toRaw:function e(t){return t}},render:function e(){return r.StringCell.prototype.render.apply(this,arguments)},remove:function e(){var t=this.model.top.get("columns"),i=this.model.get("columns");if(i){i.off("pgadmin:multicolumn:updated")}this.stopListening(t,"remove",self.removeColumn);this.stopListening(t,"change:name",self.resetColOptions);r.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:true,canAdd:true,control:n.MultiSelectAjaxControl.extend({defaults:u.extend({},n.NodeListByNameControl.prototype.defaults,{select2:{multiple:true,allowClear:true,width:"style",placeholder:a("Select the column(s)")}}),keyPathAccessor:function e(t,i){var n=t;if(u.isArray(n)){return u.map(n,function(e){return e["column"]})}i=i.split(".");for(var a=0;a<i.length;a++){if(u.isNull(n))return null;if(u.isEmpty(i[a]))continue;if(!u.isUndefined(n[i[a]]))n=n[i[a]]}return u.isObject(n)&&!u.isArray(n)?null:n},initialize:function e(){var t=this;if(this.model.handler){n.Select2Control.prototype.initialize.apply(this,arguments);if(u.isUndefined(t.model.get("oid"))){var i=t.model.top.get("columns");t.listenTo(i,"remove",t.resetColOptions);t.listenTo(i,"change:name",t.resetColOptions)}t.custom_options()}else{n.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)}t.model.get("columns").on("pgadmin:multicolumn:updated",function(){t.render.apply(t)})},resetColOptions:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},custom_options:function e(){var t=this.model.top.get("columns"),i=[];if(t.length>0){u.each(t.models,function(e){var t=e.get("name");if(!u.isUndefined(t)&&!u.isNull(t)){i.push({label:t,value:t,image:"icon-column"})}})}this.field.set("options",i)},onChange:function e(){var i=this,t=this.model,n=this.field.get("name").split("."),a=n.shift(),r=this.getValueFromDOM(),l=t.get(a),o=[];this.stopListening(this.model,"change:"+a,this.render);l.each(function(e){var t=e.get("column"),i=u.indexOf(r,t);if(i>-1){r.splice(i,1)}else{o.push(t)}});u.each(r,function(e){var t=new(i.field.get("model"))({column:e},{silent:true,top:i.model.top,collection:l,handler:l});l.add(t)});u.each(o,function(e){l.remove(l.where({column:e}))});this.listenTo(this.model,"change:"+a,this.render)},remove:function e(){if(this.model.handler){var t=this,i=t.model.top.get("columns");t.stopListening(i,"remove",t.resetColOptions);t.stopListening(i,"change:name",t.resetColOptions);t.model.get("columns").off("pgadmin:multicolumn:updated");n.Select2Control.prototype.remove.apply(this,arguments)}else{n.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}}),deps:["index"],node:"column",model:p.Node.Model.extend({defaults:{column:undefined},validate:function e(){return null}}),transform:function e(t){var i=[];if(t&&u.isArray(t)){u.each(t,function(e){i.push({label:e.label,value:e.label,image:"icon-column"})})}return i},select2:{allowClear:false},disabled:function e(t){if(u.has(t,"top")&&!u.isUndefined(t.top)&&!t.top.isNew()){return!u.isUndefined(t.get("oid"))}if(!t.isNew()){return true}var i=t.get("index");if(u.isUndefined(i)||i==""){return false}else{var n=t.get("columns");n.reset();return true}}},{id:"include",label:a("Include columns"),type:"array",group:a("Definition"),editable:false,canDelete:true,canAdd:true,mode:["properties","create","edit"],visible:function e(t){t=t.top;if(!u.isUndefined(t.node_info)&&!u.isUndefined(t.node_info.server)&&!u.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=11e4)return true;return false},control:n.MultiSelectAjaxControl.extend({defaults:u.extend({},n.NodeListByNameControl.prototype.defaults,{select2:{allowClear:false,width:"style",multiple:true,placeholder:a("Select the column(s)")}}),initialize:function e(){var t=this;if(this.model.handler){n.Select2Control.prototype.initialize.apply(this,arguments);if(u.isUndefined(t.model.get("oid"))){var i=t.model.top.get("columns");t.listenTo(i,"remove",t.resetColOptions);t.listenTo(i,"change:name",t.resetColOptions)}t.custom_options()}else{n.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)}},resetColOptions:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},custom_options:function e(){var t=this.model.top.get("columns"),i=[];if(t.length>0){u.each(t.models,function(e){var t=e.get("name");if(!u.isUndefined(t)&&!u.isNull(t)){i.push({label:t,value:t,image:"icon-column"})}})}this.field.set("options",i)}}),deps:["index"],node:"column",disabled:function e(t){if(u.has(t,"top")&&!u.isUndefined(t.top)&&!t.top.isNew()){return!u.isUndefined(t.get("oid"))}if(!t.isNew()){return true}var i=t.get("index");if(u.isUndefined(i)||i==""){return false}else{var n=t.get("columns");n.reset();return true}}},{id:"spcname",label:a("Tablespace"),type:"text",group:a("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:false},filter:function e(t){if(t.label=="pg_global")return false;else return true},disabled:function e(t){t=t.top||t;var i=t.get("index");if(u.isUndefined(i)||i==""){return false}else{setTimeout(function(){t.set("spcname","")},10);return true}}},{id:"index",label:a("Index"),type:"text",group:a("Definition"),control:n.NodeListByNameControl.extend({initialize:function e(){if(u.isUndefined(this.model.top)){n.NodeListByNameControl.prototype.initialize.apply(this,arguments)}else{n.Control.prototype.initialize.apply(this,arguments)}}}),select2:{allowClear:true},node:"index",disabled:function e(t){if(u.has(t,"top")&&!u.isUndefined(t.top)&&!t.top.isNew()){return true}return!t.isNew()},visible:function e(t){return!u.isUndefined(t.top.node_info["table"])}},{id:"fillfactor",label:a("Fill factor"),deps:["index"],type:"int",group:a("Definition"),allowNull:true,disabled:function e(t){var i=t.get("index");if(u.isUndefined(i)||i==""){return false}else{setTimeout(function(){t.set("fillfactor",null)},10);return true}}},{id:"condeferrable",label:a("Deferrable?"),type:"switch",group:a("Definition"),deps:["index"],disabled:function e(t){if(u.has(t,"top")&&!u.isUndefined(t.top)&&!t.top.isNew()){return!u.isUndefined(t.get("oid"))}if(!t.isNew()){return true}var i=t.get("index");if(u.isUndefined(i)||i==""){return false}else{setTimeout(function(){if(t.get("condeferrable"))t.set("condeferrable",false)},10);return true}}},{id:"condeferred",label:a("Deferred?"),type:"switch",group:a("Definition"),deps:["condeferrable"],disabled:function e(t){if(u.has(t,"top")&&!u.isUndefined(t.top)&&!t.top.isNew()){return!u.isUndefined(t.get("oid"))}if(!t.isNew()){return true}if(t.get("condeferrable")==true){return false}else{setTimeout(function(){if(t.get("condeferred"))t.set("condeferred",false)},10);return true}}}],validate:function e(){this.errorModel.clear();if(u.has(this,"top")){this.top.errorModel.clear()}var t=this.get("columns"),i=this.get("index");if((u.isUndefined(i)||String(i).replace(/^\s+|\s+$/g,"")=="")&&(u.isUndefined(t)||u.isNull(t)||t.length<1)){var n=a("Please specify columns for %(node)s",{node:a("Unique constraint")});this.errorModel.set("columns",n);return n}return null}})})}return p.Nodes["unique_constraint"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(10),i(11),i(7)],a=function(n,e,s,d,t,i,c,u,a){if(!c.Nodes["check_constraint"]){i.Browser.Nodes["check_constraint"]=c.Node.extend({type:"check_constraint",label:n("Check"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"check_dialog.html"}),hasSQL:true,hasDepends:true,parent_type:["table","partition"],Init:function e(){if(this.initialized)return;this.initialized=true;c.add_menus([{name:"create_check_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:n("Check..."),icon:"wcTabIcon icon-check_constraint",data:{action:"create",check:true},enable:"canCreate"},{name:"validate_check_constraint",node:"check_constraint",module:this,applies:["object","context"],callback:"validate_check_constraint",category:"validate",priority:4,label:n("Validate check constraint"),icon:"fa fa-link",enable:"is_not_valid",data:{action:"edit",check:true}}])},is_not_valid:function e(t,i,n){if(this.canCreate(t,i,n)){return t&&!t.valid}else{return false}},callbacks:{validate_check_constraint:function e(t){var i=t||{},n=this,a=c.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l){return false}var o=l;s.ajax({url:n.generate_url(r,"validate",l,true),type:"GET"}).done(function(e){if(e.success==1){u.success(e.info);a.removeIcon(r);o.valid=true;o.icon="icon-check_constraint";a.addIcon(r,{icon:o.icon});setTimeout(function(){a.deselect(r)},10);setTimeout(function(){a.select(r)},100)}}).fail(function(e,t,i){u.pgRespErrorNotify(e,i);a.unload(r)});return false}},canDrop:a.isTreeItemOfChildOfSchema,model:i.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,description:undefined,consrc:undefined,connoinherit:undefined,convalidated:true},schema:[{id:"name",label:n("Name"),type:"text",cell:"string",disabled:"isDisabled"},{id:"oid",label:n("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:n("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],deps:["name"],disabled:function e(t){var i=t.get("name");if(!(i&&i!="")){setTimeout(function(){if(t.get("comment")&&t.get("comment")!=="")t.set("comment",null)},10);return true}else{return false}}},{id:"consrc",label:n("Check"),type:"multiline",cell:"string",group:n("Definition"),mode:["properties","create","edit"],disabled:function e(t){return d.has(t,"handler")&&!d.isUndefined(t.handler)&&!d.isUndefined(t.get("oid"))||d.isFunction(t.isNew)&&!t.isNew()},editable:false},{id:"connoinherit",label:n("No inherit?"),type:"switch",cell:"boolean",group:n("Definition"),mode:["properties","create","edit"],min_version:90200,disabled:function e(t){if(d.has(t,"top")&&!d.isUndefined(t.top)&&t.top.get("is_partitioned")||d.has(t,"node_info")&&d.has(t.node_info,"table")&&d.has(t.node_info.table,"is_partitioned")&&t.node_info.table.is_partitioned){setTimeout(function(){t.set("connoinherit",false)},10);return true}return d.has(t,"handler")&&!d.isUndefined(t.handler)&&!d.isUndefined(t.get("oid"))||d.isFunction(t.isNew)&&!t.isNew()}},{id:"convalidated",label:n("Don't validate?"),type:"switch",cell:"boolean",group:n("Definition"),min_version:90200,disabled:function e(t){if(d.isFunction(t.isNew)&&!t.isNew()||d.has(t,"handler")&&!d.isUndefined(t.handler)&&!d.isUndefined(t.get("oid"))){return!t.get("convalidated")}else{return false}},mode:["properties","create","edit"]}],validate:function e(){var t={},i;if(d.isUndefined(this.get("consrc"))||String(this.get("consrc")).replace(/^\s+|\s+$/g,"")==""){t["consrc"]=n("Check cannot be empty.");i=i||t["consrc"]}this.errorModel.clear().set(t);if(d.size(t)){this.trigger("on-status",{msg:i});return i}return null},isDisabled:function e(t){if(d.has(t,"handler")&&!d.isUndefined(t.handler)&&!d.isUndefined(t.get("oid"))||d.isFunction(t.isNew)&&!t.isNew()){var i=(this.node_info||t.top.node_info).server;if(i.version<90200){return true}}return false}}),canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=c.tree,r=i,l=t,o=[];while(r){if(d.indexOf(["schema"],l._type)>-1)return true;o.push(l._type);r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}if(d.indexOf(o,"catalog")>-1){return false}else{return true}}})}return c.Nodes["check_constraint"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(10),i(6),i(12),i(7)],a=function(d,e,c,u,p,i,f,s,m,o){var g=function e(t){if(!t.id){return t.text}var i=c(t.element).data("image");if(!i){return t.text}else{return c('<span><span class="wcTabIcon '+i+'"/>'+t.text+"</span>")}},h=u.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >','    <%=select2.first_empty ? " <option></option>" : ""%>',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n"));var t=f.Node.Model.extend({defaults:{local_column:undefined,references:undefined,referenced:undefined},schema:[{id:"local_column",label:d("Local"),type:"text",editable:false,cellHeaderClasses:"width_percent_50",cell:"string",headerCell:o.Extension.CustomHeaderCell},{id:"referenced",label:d("Referenced"),type:"text",editable:false,cell:"string",cellHeaderClasses:"width_percent_50",headerCell:o.Extension.CustomHeaderCell}]});var n=m.ForeignKeyColumnControl=m.UniqueColCollectionControl.extend({initialize:function e(){m.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var n=this,t="foreign_key",i=[{id:"local_column",label:"",type:"text",node:"column",control:m.NodeListByNameControl.extend({initialize:function e(){if(n.model.handler){m.Select2Control.prototype.initialize.apply(this,arguments);if(u.isUndefined(n.model.get("oid"))){var t=n.model.top.get("columns");this.listenTo(t,"remove",this.removeColumn);this.listenTo(t,"change:name",this.resetColOptions)}this.custom_options()}else{m.NodeListByNameControl.prototype.initialize.apply(this,arguments)}},removeColumn:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},resetColOptions:function e(t){var i=this;if(t.previous("name")==n.headerData.get("local_column")){n.headerData.set({local_column:t.get("name")});n.headerDataChanged()}setTimeout(function(){i.custom_options();i.render.apply(i)},50)},custom_options:function e(){var t=n.model.top.get("columns"),i=[];if(t.length>0){u.each(t.models,function(e){var t=e.get("name");if(!u.isUndefined(t)&&!u.isNull(t)){i.push({label:t,value:t,image:"icon-column"})}})}this.field.set("options",i)},template:h,remove:function e(){if(n.model.handler){var t=n.model.top.get("columns");this.stopListening(t,"remove",this.removeColumn);this.stopListening(t,"change:name",this.resetColOptions);m.Select2Control.prototype.remove.apply(this,arguments)}else{m.NodeListByNameControl.prototype.remove.apply(this,arguments)}}}),select2:{allowClear:false,width:"style",placeholder:d("Select column"),first_empty:!u.isUndefined(n.model.get("oid"))},version_compatible:n.field.get("version_compatible"),disabled:function e(){return!u.isUndefined(n.model.get("oid"))}},{id:"references",label:"",type:"text",cache_level:"server",select2:{allowClear:false,width:"style",placeholder:"Select foreign table"},first_empty:true,control:m.NodeListByNameControl.extend({formatter:m.ControlFormatter,template:h}),url:"all_tables",node:"table",version_compatible:n.field.get("version_compatible"),disabled:function e(){return!u.isUndefined(n.model.get("oid"))},transform:function e(t){var i=[];u.each(t,function(e){i.push({value:e.value,image:"icon-table",label:e.label})});return i}},{id:"referenced",label:"",type:"text",cache_level:"server",transform:function e(t){var i=[];u.each(t,function(e){i.push({value:e.name,image:"icon-column",label:e.name})});return i},control:m.Select2Control.extend({formatter:m.ControlFormatter,template:h,render:function e(){var t=this,i=t.field.get("url")||t.defaults.url,n=t.model,a=n.get("references");n.set(t.field.get("name"),null,{silent:true});if(i&&!u.isUndefined(a)&&!u.isNull(a)&&a!=""){var r=this.field.get("schema_node"),l=this.field.get("node_info"),o=r.generate_url.apply(r,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||false,l]),s=[];if(this.field.get("version_compatible")){n.trigger("pgadmin:view:fetching",n,t.field);c.ajax({async:false,data:{tid:a},url:o}).done(function(e){s=e.data}).fail(function(){n.trigger("pgadmin:view:fetch:error",n,t.field)});n.trigger("pgadmin:view:fetched",n,t.field)}var d=this.field.get("transform")||t.defaults.transform;if(d&&u.isFunction(d)){t.field.set("options",d.bind(t,s))}else{t.field.set("options",s)}}else{t.field.set("options",[])}m.Select2Control.prototype.render.apply(this,arguments);return this}}),url:"get_columns",select2:{allowClear:false,width:"style",placeholder:d("Select column"),templateResult:g,templateSelection:g},deps:["references"],node:"table",version_compatible:n.field.get("version_compatible"),disabled:function e(){return!u.isUndefined(n.model.get("oid"))}}],a={local_column:null,references:null,referenced:null},r=["local_column","references","referenced"];if(!n.model.isNew()&&u.isUndefined(n.model.handler)||u.has(n.model,"handler")&&!u.isUndefined(n.model.handler)&&!u.isUndefined(n.model.get("oid"))){var l=n.collection.first();if(l){a["references"]=l.get("references")}}n.headerData=new(p.Model.extend({defaults:a,schema:i}))({});var o=m.generateViewSchema(n.field.get("node_info"),n.headerData,"create",t,n.field.get("node_data")),s=[];u.each(o,function(e){s=s.concat(e.fields)});n.headerFields=new m.Fields(s);n.gridSchema=m.generateGridColumnsFromModel(n.field.get("node_info"),n.field.get("model"),"edit",r,n.field.get("schema_node"));n.controls=[];n.listenTo(n.headerData,"change",n.headerDataChanged);n.listenTo(n.headerData,"select2",n.headerDataChanged);n.listenTo(n.collection,"add",n.onAddorRemoveColumns);n.listenTo(n.collection,"remove",n.onAddorRemoveColumns)},generateHeader:function e(t){var i=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-md-6" header="local_column"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-references_label%></label>',"   </div>",'   <div class="col-md-6" header="references"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-referenced_label%></label>',"   </div>",'   <div class="col-md-6" header="referenced"></div>',"  </div>"," </div>","</div>"].join("\n");u.extend(t,{column_label:d("Local column"),references_label:d("References"),referenced_label:d("Referencing")});var n=this,a=u.template(i),r=c(a(t)),l=this.controls;this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:n.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el);l.push(t)});if(t.mode=="properties"){r.html("")}n.$header=r;return r},events:u.extend({},m.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function e(t){var i=this,n=u.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+u("Add new row")+'"></button>',"</div>"].join("\n")),a=c("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append(t.mode!=="properties"?n({label:t.label,canAdd:t.canAdd}):"");if(i.grid){i.grid.remove()}a.append(i.generateHeader(t));var r=u.clone(this.gridSchema);if(t.disabled==false&&t.canDelete){r.columns.unshift({name:"pg-backform-delete",label:"",cell:o.Extension.DeleteCell,editable:false,cell_priority:-1})}var l=i.grid=new o.Grid({columns:r.columns,collection:i.collection,className:"backgrid table-bordered table-noouter-border table-hover"});i.$grid=l.render().$el;a.append(i.$grid);setTimeout(function(){i.headerData.set({local_column:i.$header.find('div[header="local_column"] select option:first').val(),referenced:i.$header.find('div[header="referenced"] select option:first').val(),references:i.$header.find('div[header="references"] select option:first').val()},{silent:true})},10);if(t.mode==="properties")a.find(".subnode-header-form").removeClass("subnode-header-form");i.$gridBody=a;return a},headerDataChanged:function e(){var t=this,i,n=this.headerData.toJSON(),a=false,r=["local_column","referenced"];if(!t.$header){return}if(t.control_data.canAdd){t.collection.each(function(t){if(!a){u.each(r,function(e){if(!a){i=t.get(e);a=(u.isUndefined(i)||u.isNull(i))&&(u.isUndefined(n[e])||u.isNull(n[e]))||i==n[e]}})}})}else{a=true}t.$gridBody.find("button.add").prop("disabled",a)},addColumns:function e(t){t.preventDefault();var i=this,n=i.headerData.get("local_column"),a=i.headerData.get("referenced");if(!n||n==""||!a||a==""){return false}var r=new(i.field.get("model"))(i.headerData.toJSON()),l=i.model.get(i.field.get("name"));l.add(r);var o=l.indexOf(r);if(o>-1){i.$grid.find(".new").removeClass("new");var s=i.grid.body.rows[o].$el;s.addClass("new");c(s).pgMakeVisible("backform-tab")}else{}return false},onAddorRemoveColumns:function e(){var t=this;setTimeout(function(){if(t.collection.length>0){t.$header.find('div[header="references"] select').prop("disabled",true)}else{t.$header.find('div[header="references"] select').prop("disabled",false)}t.collection.trigger("pgadmin:columns:updated",t.collection);t.headerDataChanged();if(!u.has(t.model,"handler")||u.has(t.model,"handler")&&u.isUndefined(t.model.handler)||u.has(t.model,"handler")&&!u.isUndefined(t.model.handler)&&!u.isUndefined(t.model.handler.get("oid"))){t.getCoveringIndex()}},10)},getCoveringIndex:function e(){var t=this,i="get_coveringindex",n=t.model,a=[],r=null;t.collection.each(function(e){a.push(e.get("local_column"))});if(a.length>0){var l=this.field.get("schema_node"),o=this.field.get("node_info"),s=l.generate_url.apply(l,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||false,o]);if(this.field.get("version_compatible")){n.trigger("pgadmin:view:fetching",n,t.field);c.ajax({async:false,data:{cols:JSON.stringify(a)},url:s}).done(function(e){r=e.data}).fail(function(){n.trigger("pgadmin:view:fetch:error",n,t.field)});n.trigger("pgadmin:view:fetched",n,t.field)}}if(r){n.set("hasindex",true);n.set("autoindex",false);n.set("coveringindex",r)}else{n.set("coveringindex",null);n.set("autoindex",true);n.set("hasindex",false)}},remove:function e(){this.stopListening(this.headerData,"change",this.headerDataChanged);this.listenTo(this.headerData,"select2",this.headerDataChanged);this.listenTo(this.collection,"remove",this.onRemoveVariable);u.each(this.controls,function(e){e.remove()});n.__super__.remove.apply(this,arguments);delete this.headerData}});if(!f.Nodes["foreign_key"]){i.Browser.Nodes["foreign_key"]=f.Node.extend({type:"foreign_key",label:d("Foreign key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"foreign_key_dialog.html"}),hasSQL:true,parent_type:["table","partition"],canDrop:true,canDropCascade:true,hasDepends:true,Init:function e(){if(this.initialized)return;this.initialized=true;f.add_menus([{name:"create_foreign_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:d("Foreign key..."),icon:"wcTabIcon icon-foreign_key",data:{action:"create",check:true},enable:"canCreate"},{name:"validate_foreign_key",node:"foreign_key",module:this,applies:["object","context"],callback:"validate_foreign_key",category:"validate",priority:4,label:d("Validate foreign key"),icon:"fa fa-link",enable:"is_not_valid"}])},is_not_valid:function e(t){return t&&!t.valid},callbacks:{validate_foreign_key:function e(t){var i=t||{},n=this,a=f.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l){return false}var o=l;c.ajax({url:n.generate_url(r,"validate",l,true),type:"GET"}).done(function(e){if(e.success==1){s.success(e.info);a.removeIcon(r);o.valid=true;o.icon="icon-foreign_key";a.addIcon(r,{icon:o.icon});setTimeout(function(){a.deselect(r)},10);setTimeout(function(){a.select(r)},100)}}).fail(function(e,t,i){s.pgRespErrorNotify(e,i);a.unload(r)});return false}},model:i.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,comment:undefined,condeferrable:undefined,condeferred:undefined,confmatchtype:undefined,convalidated:undefined,columns:undefined,confupdtype:"a",confdeltype:"a",autoindex:true,coveringindex:undefined,hasindex:undefined},toJSON:function e(){var t=i.Browser.Node.Model.prototype.toJSON.apply(this,arguments);delete t.hasindex;return t},schema:[{id:"name",label:d("Name"),type:"text",mode:["properties","create","edit"],editable:true,headerCell:o.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50"},{id:"oid",label:d("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:d("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function e(t){var i=t.get("name");if(!(i&&i!="")){setTimeout(function(){if(t.get("comment")&&t.get("comment")!=="")t.set("comment",null)},10);return true}else{return false}}},{id:"condeferrable",label:d("Deferrable?"),type:"switch",group:d("Definition"),disabled:function e(t){if(u.has(t,"handler")&&!u.isUndefined(t.handler)){return!u.isUndefined(t.get("oid"))}return!t.isNew()}},{id:"condeferred",label:d("Deferred?"),type:"switch",group:d("Definition"),deps:["condeferrable"],disabled:function e(t){if(u.has(t,"handler")&&!u.isUndefined(t.handler)){return!u.isUndefined(t.get("oid"))}else if(!t.isNew()){return true}if(t.get("condeferrable")==true){return false}else{setTimeout(function(){if(t.get("condeferred"))t.set("condeferred",false)},10);return true}}},{id:"confmatchtype",label:d("Match type"),type:"switch",group:d("Definition"),options:{onText:"FULL",offText:"SIMPLE",width:"80"},disabled:function e(t){if(u.has(t,"handler")&&!u.isUndefined(t.handler)){return!u.isUndefined(t.get("oid"))}return!t.isNew()}},{id:"convalidated",label:d("Validated?"),type:"switch",group:d("Definition"),options:{onText:d("Yes"),offText:d("No")},disabled:function e(t){if(u.has(t,"handler")&&!u.isUndefined(t.handler)){return!(u.isUndefined(t.get("oid"))||t.get("convalidated"))}return!(t.isNew()||t.get("convalidated"))}},{id:"autoindex",label:d("Auto FK index?"),type:"switch",group:d("Definition"),deps:["name","hasindex"],options:{onText:d("Yes"),offText:d("No")},disabled:function e(a){var r=a.get("coveringindex"),t=a.get("autoindex"),i=function e(){var t=a.get("name"),i="fki_"+a.previous("name");if(a.get("hasindex")){return true}else if(a.get("autoindex")&&!u.isUndefined(t)&&!u.isNull(t)&&t!=""&&(u.isUndefined(r)||u.isNull(r)||r==""||r==i)){var n="fki_"+t;a.set("coveringindex",n);return false}else{return false}};if(u.has(a,"handler")&&!u.isUndefined(a.handler)){if(u.isUndefined(a.get("oid"))&&u.isUndefined(a.handler.get("oid"))){setTimeout(function(){if(a.get("autoindex"))a.set("autoindex",false)},10);return true}else{return i()}}else{if(!a.isNew()&&t&&!u.isUndefined(r)&&!u.isNull(r)&&r!=""&&a.get("hasindex")){return true}else{return i()}}}},{id:"coveringindex",label:d("Covering index"),type:"text",mode:["properties","create","edit"],group:d("Definition"),deps:["autoindex","hasindex"],disabled:function e(i){var t=i.get("coveringindex"),n=function e(){if(i.get("hasindex")){return true}else if(!i.get("autoindex")){setTimeout(function(){i.set("coveringindex",null)});return true}else{setTimeout(function(){var e=i.get("name"),t="fki_"+e;if(i.get("autoindex")&&!u.isUndefined(e)&&!u.isNull(e)&&e!=""){i.set("coveringindex",t)}});return false}};if(u.has(i,"handler")&&!u.isUndefined(i.handler)){if(u.isUndefined(i.get("oid"))&&u.isUndefined(i.handler.get("oid"))){return true}else{return n()}}else if(!i.isNew()&&i.get("autoindex")&&!u.isUndefined(t)&&u.isNull(t)&&t==""){return true}return n()}},{id:"columns",label:d("Columns"),type:"collection",group:d("Columns"),node:"foreign_key",editable:false,headerCell:o.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50",cell:o.StringCell.extend({initialize:function e(){o.StringCell.prototype.initialize.apply(this,arguments);var t=this,i=this.model.get("columns");if(u.isUndefined(t.model.get("oid"))){var n=t.model.top.get("columns");t.listenTo(n,"remove",t.removeColumn);t.listenTo(n,"change:name",t.resetColOptions)}t.model.get("columns").on("pgadmin:columns:updated",function(){t.render.apply(t)});t.listenTo(i,"add",t.render);t.listenTo(i,"remove",t.render)},removeColumn:function e(t){var i=this,n=i.model.get("columns").where({local_column:t.get("name")});i.model.get("columns").remove(n);setTimeout(function(){i.render()},10);setTimeout(function(){var e=i.model.top.get("foreign_key");var t=[];e.each(function(e){if(e.get("columns").length==0){t.push(e)}});e.remove(t)},100)},resetColOptions:function e(t){var i=this,n=i.model.get("columns").where({local_column:t.previous("name")});if(n.length>0){n[0].set({local_column:t.get("name")})}setTimeout(function(){i.render()},10)},formatter:{fromRaw:function e(t){var i=[],n=[];if(t.length>0){t.each(function(e){i.push(e.get("local_column"));n.push(e.get("referenced"))});return"("+i.join(", ")+") -> ("+n.join(", ")+")"}return""},toRaw:function e(t){return t}},render:function e(){return o.StringCell.prototype.render.apply(this,arguments)},remove:function e(){var t=this.model.top.get("columns");this.stopListening(t,"remove",self.removeColumn);this.stopListening(t,"change:name",self.resetColOptions);o.StringCell.prototype.remove.apply(this,arguments)}}),canAdd:function e(t){return t.isNew()},canDelete:true,control:n,model:t,disabled:function e(t){if(u.has(t,"handler")&&!u.isUndefined(t.handler)){return!u.isUndefined(t.get("oid"))}return!t.isNew()}},{id:"confupdtype",label:d("On update"),type:"select2",group:d("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:false},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function e(t){if(u.has(t,"handler")&&!u.isUndefined(t.handler)){return!u.isUndefined(t.get("oid"))}return!t.isNew()}},{id:"confdeltype",label:d("On delete"),type:"select2",group:d("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:false},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],disabled:function e(t){if(u.has(t,"handler")&&!u.isUndefined(t.handler)){return!u.isUndefined(t.get("oid"))}return!t.isNew()}}],validate:function e(){var t=this.get("columns"),i;this.errorModel.clear();if(u.isUndefined(t)||u.isNull(t)||t.length<1){i=d("Please specify columns for Foreign key.");this.errorModel.set("columns",i);return i}var n=this.get("coveringindex"),a=this.get("autoindex");if(a&&(u.isUndefined(n)||u.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")=="")){i=d("Please specify covering index name.");this.errorModel.set("coveringindex",i);return i}return null}}),canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=f.tree,r=i,l=t,o=[],s=false,d=false,c=this.getTreeNodeHierarchy(r).server.version;while(r){if(!s&&(l._type=="table"||l._type=="partition")){s=true;if("is_partitioned"in l&&l.is_partitioned&&c<11e4){d=true}}if(u.indexOf(["schema"],l._type)>-1)return!d;o.push(l._type);r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}if(u.indexOf(o,"catalog")>-1){return false}else{return!d}}})}return f.Nodes["foreign_key"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(3),i(5),i(17),i(6),i(12),i(7)],a=function(o,e,u,c,d,t,p,l,f,m){var i=p.Node.Model.extend({defaults:{column:undefined,oper_class:undefined,order:false,nulls_order:false,operator:undefined,col_type:undefined,is_sort_nulls_applicable:true},toJSON:function e(){var t=p.Node.Model.prototype.toJSON.apply(this,arguments);delete t.col_type;return t},schema:[{id:"column",label:o("Column"),type:"text",editable:false,cell:"string"},{id:"oper_class",label:o("Operator class"),type:"text",node:"table",url:"get_oper_class",first_empty:true,editable:function e(t){if(t instanceof d.Collection){return true}else if(c.has(t.collection,"handler")&&!c.isUndefined(t.collection.handler)&&!c.isUndefined(t.collection.handler.get("oid"))){return false}else if(c.has(t.collection,"handler")&&!c.isUndefined(t.collection.handler)&&!c.isUndefined(t.collection.handler.get("amname"))&&t.collection.handler.get("amname")!="btree"){return false}return true},select2:{allowClear:true,width:"style",tags:true,placeholder:o("Select the operator class")},cell:m.Extension.Select2Cell.extend({initialize:function e(){m.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var t=this,i=t.column.get("url")||t.defaults.url,n=t.model,a=t.model.collection.handler.get("amname");if(i&&(a=="btree"||c.isUndefined(a)||c.isNull(a)||a=="")){setTimeout(function(){n.set("order",true);n.set("nulls_order",true)},10);var r=this.column.get("schema_node"),l=n.top||n,o=this.column.get("node_info"),s=r.generate_url.apply(r,[null,i,this.column.get("node_data"),this.column.get("url_with_id")||false,o]),d=[];a="btree";if(this.column.get("version_compatible")){l.trigger("pgadmin:view:fetching",n,t.column);u.ajax({async:false,data:{indextype:a},url:s}).done(function(e){d=e.data;t.column.set("options",d)}).fail(function(){l.trigger("pgadmin:view:fetch:error",n,t.column)});l.trigger("pgadmin:view:fetched",n,t.column)}}else{t.column.set("options",[])}}})},{id:"order",label:o("DESC"),type:"switch",options:{onText:"ASC",offText:"DESC"},editable:function e(t){if(t instanceof d.Collection){return true}else if(c.has(t.collection,"handler")&&!c.isUndefined(t.collection.handler)&&!c.isUndefined(t.collection.handler.get("oid"))){return false}else if(t.top.get("amname")==="btree"){t.set("is_sort_nulls_applicable",true);return true}else{t.set("is_sort_nulls_applicable",false);return false}}},{id:"nulls_order",label:o("NULLs order"),type:"switch",options:{onText:"FIRST",offText:"LAST"},editable:function e(t){if(t instanceof d.Collection){return true}else if(c.has(t.collection,"handler")&&!c.isUndefined(t.collection.handler)&&!c.isUndefined(t.collection.handler.get("oid"))){return false}else if(t.top.get("amname")==="btree"){t.set("is_sort_nulls_applicable",true);return true}else{t.set("is_sort_nulls_applicable",false);return false}}},{id:"operator",label:o("Operator"),type:"text",node:"table",url:"get_operator",editable:function e(t){if(t instanceof d.Collection){return true}if(c.has(t.collection,"handler")&&!c.isUndefined(t.collection.handler)&&!c.isUndefined(t.collection.handler.get("oid"))){return false}return true},select2:{allowClear:false,width:"style"},cell:m.Extension.Select2Cell.extend({initialize:function e(){m.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var t=this,i=t.column.get("url")||t.defaults.url,n=t.model,a=t.model.get("col_type");t.column.set("options",[]);if(i&&!c.isUndefined(a)&&!c.isNull(a)&&a!=""){var r=this.column.get("schema_node"),l=n.top||n,o=this.column.get("node_info"),s=r.generate_url.apply(r,[null,i,this.column.get("node_data"),this.column.get("url_with_id")||false,o]),d=[];if(this.column.get("version_compatible")){l.trigger("pgadmin:view:fetching",n,t.column);u.ajax({async:false,data:{col_type:a},url:s}).done(function(e){d=e.data;t.column.set("options",d)}).fail(function(){l.trigger("pgadmin:view:fetch:error",n,t.column)});l.trigger("pgadmin:view:fetched",n,t.column)}}}})}],validate:function e(){this.errorModel.clear();var t=this.get("operator"),i=this.get("column");if(c.isUndefined(t)||c.isNull(t)){var n=o("Please specify operator for column: ")+i;this.errorModel.set("operator",n);return n}return null}});var n=f.ExclusionConstraintColumnControl=f.UniqueColCollectionControl.extend({initialize:function e(){f.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var s=this,t="exclusion_constraint",i=[{id:"column",label:"",type:"text",node:"column",control:f.NodeListByNameControl.extend({initialize:function e(){if(s.model.handler){f.Select2Control.prototype.initialize.apply(this,arguments);if(c.isUndefined(s.model.get("oid"))){var t=s.model.top.get("columns");this.listenTo(t,"remove",this.removeColumn);this.listenTo(t,"change:name",this.resetColOptions);this.listenTo(t,"change:cltype",this.resetColOptions)}this.custom_options()}else{f.NodeListByNameControl.prototype.initialize.apply(this,arguments)}},removeColumn:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},resetColOptions:function e(t){var i=this;if(t.previous("name")==s.headerData.get("column")){s.headerData.set({column:t.get("name")});s.headerDataChanged()}setTimeout(function(){i.custom_options();i.render.apply(i)},50)},custom_options:function e(){var t=s.model.top.get("columns"),i=[],n=[];if(t.length>0){c.each(t.models,function(e){var t=e.get("name");if(!c.isUndefined(t)&&!c.isNull(t)){i.push({label:t,value:t,image:"icon-column"});n.push({name:t,type:e.get("cltype")})}})}this.field.set("options",i);s.field.set("col_types",n)},remove:function e(){if(s.model.handler){var t=s.model.top.get("columns");this.stopListening(t,"remove",this.removeColumn);this.stopListening(t,"change:name",this.resetColOptions);this.stopListening(t,"change:cltype",this.resetColOptions);f.Select2Control.prototype.remove.apply(this,arguments)}else{f.NodeListByNameControl.prototype.remove.apply(this,arguments)}},template:c.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n"))}),transform:function e(t){var n=this,a=n.field.get("schema_node"),r=[],l=[],o=n.field.get("filter")||function(){return true};o=o.bind(n);c.each(t,function(e){if(o(e)){var t=c.isFunction(a["node_label"])?a["node_label"].apply(a,[e,n.model,n]):e.label,i=c.isFunction(a["node_image"])?a["node_image"].apply(a,[e,n.model,n]):a["node_image"]||"icon-"+a.type;r.push({value:e.label,image:i,label:t});l.push({name:e.label,type:e.datatype})}});s.field.set("col_types",l);return r},canAdd:function e(t){return!(c.has(t,"handler")&&!c.isUndefined(t.handler)&&!c.isUndefined(t.get("oid"))||c.isFunction(t.isNew)&&!t.isNew())},select2:{allowClear:false,width:"style",placeholder:"Select column"},first_empty:!s.model.isNew(),disabled:function e(){return!c.isUndefined(s.model.get("oid"))}}],n={column:null},a=["column","oper_class","order","nulls_order","operator"];s.headerData=new(d.Model.extend({defaults:n,schema:i}))({});var r=f.generateViewSchema(s.field.get("node_info"),s.headerData,"create",t,s.field.get("node_data")),l=[];c.each(r,function(e){l=l.concat(e.fields)});s.headerFields=new f.Fields(l);s.gridSchema=f.generateGridColumnsFromModel(s.field.get("node_info"),s.field.get("model"),"edit",a,s.field.get("schema_node"));s.controls=[];s.listenTo(s.headerData,"change",s.headerDataChanged);s.listenTo(s.headerData,"select2",s.headerDataChanged);s.listenTo(s.collection,"add",s.onAddorRemoveColumns);s.listenTo(s.collection,"remove",s.onAddorRemoveColumns)},generateHeader:function e(t){var i=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-4" header="column"></div>',"  </div>"," </div>","</div>"].join("\n");c.extend(t,{column_label:o("Column")});var n=this,a=c.template(i),r=u(a(t)),l=this.controls;this.headerFields.each(function(e){var t=new(e.get("control"))({field:e,model:n.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el);l.push(t)});if(t.mode=="properties"){r.html("")}n.$header=r;return r},events:c.extend({},f.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function e(t){var i=this,n=c.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+c("Add new row")+'"></button>',"</div>"].join("\n")),a=u("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append(t.mode!=="properties"?n({label:t.label,canAdd:t.canAdd}):"");a.append(i.generateHeader(t));var r=c.clone(this.gridSchema.columns);if(t.disabled==false&&t.canDelete){r.unshift({name:"pg-backform-delete",label:"",cell:m.Extension.DeleteCell,editable:false,cell_priority:-1})}if(i.grid){i.grid.remove();i.grid.null}var l=i.grid=new m.Grid({columns:r,collection:i.collection,className:"backgrid table-bordered table-noouter-border table-hover"});i.$grid=l.render().$el;a.append(i.$grid);setTimeout(function(){i.headerData.set({column:i.$header.find('div[header="column"] select').val()},{silent:true})},10);if(t.mode==="properties")a.find(".subnode-header-form").removeClass("subnode-header-form");i.$gridBody=a;return a},headerDataChanged:function e(){var t=this,i,n=this.headerData.toJSON(),a=false,r=["column"];if(!t.$header){return}if(t.control_data.canAdd){t.collection.each(function(t){if(!a){c.each(r,function(e){if(!a){i=t.get(e);a=(c.isUndefined(i)||c.isNull(i))&&(c.isUndefined(n[e])||c.isNull(n[e]))||i==n[e]}})}})}else{a=true}t.$gridBody.find("button.add").prop("disabled",a)},addColumns:function e(t){t.preventDefault();var i=this,n=i.headerData.get("column");if(!n||n==""){return false}var a=i.model.get(i.field.get("name")),r=new(i.field.get("model"))(i.headerData.toJSON(),{silent:true,top:i.model.top,collection:a,handler:a}),l=i.field.get("col_types")||[];for(var o=0;o<l.length;o++){var s=l[o];if(s["name"]==r.get("column")){r.set({col_type:s["type"]});break}}a.add(r);var d=a.indexOf(r);if(d>-1){i.$grid.find(".new").removeClass("new");var c=i.grid.body.rows[d].$el;c.addClass("new");u(c).pgMakeVisible("backform-tab")}else{}return false},onAddorRemoveColumns:function e(){var t=this;setTimeout(function(){t.collection.trigger("pgadmin:columns:updated",t.collection);t.headerDataChanged()},10)},remove:function e(){this.stopListening(this.headerData,"change",this.headerDataChanged);this.listenTo(this.headerData,"select2",this.headerDataChanged);this.listenTo(this.collection,"remove",this.onAddorRemoveColumns);c.each(this.controls,function(e){e.remove()});n.__super__.remove.apply(this,arguments);delete this.headerData}});if(!p.Nodes["exclusion_constraint"]){t.Browser.Nodes["exclusion_constraint"]=p.Node.extend({type:"exclusion_constraint",label:o("Exclusion constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"exclusion_constraint_dialog.html"}),hasSQL:true,parent_type:["table","partition"],canDrop:true,canDropCascade:true,hasDepends:true,hasStatistics:true,statsPrettifyFields:[o("Index size")],Init:function e(){if(this.initialized)return;this.initialized=true;p.add_menus([{name:"create_exclusion_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Exclusion constraint..."),icon:"wcTabIcon icon-exclusion_constraint",data:{action:"create",check:true},enable:"canCreate"}])},is_not_valid:function e(t){return t&&!t.valid},model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,comment:undefined,spcname:undefined,amname:"gist",fillfactor:undefined,condeferrable:undefined,condeferred:undefined,columns:[],include:[]},schema:[{id:"name",label:o("Name"),type:"text",mode:["properties","create","edit"],editable:true},{id:"oid",label:o("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:o("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function e(t){var i=t.get("name");if(!(i&&i!="")){setTimeout(function(){if(t.get("comment")&&t.get("comment")!=="")t.set("comment",null)},10);return true}else{return false}}},{id:"spcname",label:o("Tablespace"),type:"text",group:o("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:false},filter:function e(t){if(t.label=="pg_global")return false;else return true}},{id:"amname",label:o("Access method"),type:"text",group:o("Definition"),url:"get_access_methods",node:"table",control:f.NodeAjaxOptionsControl.extend({onChange:function e(){f.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("amname"),n=t.model.previous("amname"),a=t.model.get("columns");if(a.length>0&&i!=n){var r=o("Changing access method will clear columns collection");l.confirm(r,function(){a.each(function(e){a.remove(e)});setTimeout(function(){a.trigger("pgadmin:columns:updated",a)},10)},function(){setTimeout(function(){t.model.set("amname",n)},10)})}}}),select2:{allowClear:true},disabled:function e(t){return c.has(t,"handler")&&!c.isUndefined(t.handler)&&!c.isUndefined(t.get("oid"))||c.isFunction(t.isNew)&&!t.isNew()}},{id:"fillfactor",label:o("Fill factor"),type:"int",group:o("Definition"),allowNull:true},{id:"condeferrable",label:o("Deferrable?"),type:"switch",group:o("Definition"),deps:["index"],disabled:function e(t){return c.has(t,"handler")&&!c.isUndefined(t.handler)&&!c.isUndefined(t.get("oid"))||c.isFunction(t.isNew)&&!t.isNew()}},{id:"condeferred",label:o("Deferred?"),type:"switch",group:o("Definition"),deps:["condeferrable"],disabled:function e(t){if(c.has(t,"handler")&&!c.isUndefined(t.handler)&&!c.isUndefined(t.get("oid"))||c.isFunction(t.isNew)&&!t.isNew()){return true}if(t.get("condeferrable")==true){return false}else{setTimeout(function(){if(t.get("condeferred"))t.set("condeferred",false)},10);return true}}},{id:"indconstraint",label:o("Constraint"),cell:"string",type:"multiline",mode:["create","edit","properties"],editable:false,group:o("Definition"),disabled:function e(t){return c.has(t,"handler")&&!c.isUndefined(t.handler)&&!c.isUndefined(t.get("oid"))||c.isFunction(t.isNew)&&!t.isNew()}},{id:"columns",label:o("Columns"),type:"collection",group:o("Columns"),deps:["amname"],canDelete:true,editable:false,canAdd:function e(t){return!(c.has(t,"handler")&&!c.isUndefined(t.handler)&&!c.isUndefined(t.get("oid"))||c.isFunction(t.isNew)&&!t.isNew())},control:n,model:i,disabled:function e(t){return c.has(t,"handler")&&!c.isUndefined(t.handler)&&!c.isUndefined(t.get("oid"))||c.isFunction(t.isNew)&&!t.isNew()},cell:m.StringCell.extend({initialize:function e(){m.StringCell.prototype.initialize.apply(this,arguments);var t=this;if(c.isUndefined(t.model.get("oid"))){var i=t.model.top.get("columns");t.listenTo(i,"remove",t.removeColumn);t.listenTo(i,"change:name",t.resetColOptions);t.listenTo(i,"change:cltype",t.removeColumnWithType)}this.model.get("columns").on("pgadmin:columns:updated",function(){t.render.apply(t)})},removeColumnWithType:function e(t){var i=this,n=i.model.get("columns"),a=n.where({col_type:t.previous("cltype")});n.remove(a);setTimeout(function(){i.render()},10);setTimeout(function(){var e=i.model.top.get("exclude_constraint");var t=[];e.each(function(e){if(e.get("columns").length==0){t.push(e)}});e.remove(t)},100)},removeColumn:function e(t){var i=this,n=i.model.get("columns").where({column:t.get("name")});i.model.get("columns").remove(n);setTimeout(function(){i.render()},10);setTimeout(function(){var e=i.model.top.get("exclude_constraint");var t=[];e.each(function(e){if(e.get("columns").length==0){t.push(e)}});e.remove(t)},100)},resetColOptions:function e(t){var i=this,n=i.model.get("columns").where({column:t.previous("name")});if(n.length>0){n[0].set({column:t.get("name")})}setTimeout(function(){i.render()},10)},formatter:{fromRaw:function e(t){return t.pluck("column").toString()},toRaw:function e(t){return t}},render:function e(){return m.StringCell.prototype.render.apply(this,arguments)},remove:function e(){var t=this.model.top.get("columns"),i=this.model.get("columns");if(i){i.off("pgadmin:columns:updated")}this.stopListening(t,"remove",self.removeColumn);this.stopListening(t,"change:name",self.resetColOptions);this.stopListening(t,"change:cltype",self.removeColumnWithType);m.StringCell.prototype.remove.apply(this,arguments)}})},{id:"include",label:o("Include columns"),type:"array",group:o("Columns"),editable:false,canDelete:true,canAdd:true,mode:["properties","create","edit"],visible:function e(t){t=t.top;if(!c.isUndefined(t.node_info)&&!c.isUndefined(t.node_info.server)&&!c.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=11e4)return true;return false},control:f.MultiSelectAjaxControl.extend({defaults:c.extend({},f.NodeListByNameControl.prototype.defaults,{select2:{allowClear:false,width:"style",multiple:true,placeholder:o("Select the column(s)")}}),initialize:function e(){var t=this;if(this.model.handler){f.Select2Control.prototype.initialize.apply(this,arguments);if(c.isUndefined(t.model.get("oid"))){var i=t.model.top.get("columns");t.listenTo(i,"remove",t.resetColOptions);t.listenTo(i,"change:name",t.resetColOptions)}t.custom_options()}else{f.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)}},resetColOptions:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},custom_options:function e(){var t=this.model.top.get("columns"),i=[];if(t.length>0){c.each(t.models,function(e){var t=e.get("name");if(!c.isUndefined(t)&&!c.isNull(t)){i.push({label:t,value:t,image:"icon-column"})}})}this.field.set("options",i)}}),deps:["index"],node:"column",disabled:function e(t){if(c.has(t,"top")&&!c.isUndefined(t.top)&&!t.top.isNew()){return!c.isUndefined(t.get("oid"))}if(!t.isNew()){return true}var i=t.get("index");if(c.isUndefined(i)||i==""){return false}else{var n=t.get("columns");n.reset();return true}}}],validate:function e(){this.errorModel.clear();var t=this.get("columns"),i=this.get("name"),n;if(c.isUndefined(i)||c.isNull(i)||i.length<1){n=o("Please specify name for exclusion constraint.");this.errorModel.set("name",n);return n}else if(c.isUndefined(t)||c.isNull(t)||t.length<1){n=o("Please specify columns for exclusion constraint.");this.errorModel.set("columns",n);return n}return null}}),canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=p.tree,r=i,l=t,o=[],s=false,d=false;while(r){if(!s&&(l._type=="table"||l._type=="partition")){s=true;if("is_partitioned"in l&&l.is_partitioned){d=true}}if(c.indexOf(["schema"],l._type)>-1)return!d;o.push(l._type);r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}if(c.indexOf(o,"catalog")>-1){return false}else{return!d}}})}return p.Nodes["exclusion_constraint"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(3),i(5),i(6),i(12),i(7)],a=function(a,e,f,m,t,g,n,r){if(!g.Nodes["primary_key"]){t.Browser.Nodes["primary_key"]=g.Node.extend({type:"primary_key",label:a("Primary key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:e("help.static",{filename:"primary_key_dialog.html"}),hasSQL:true,hasDepends:true,hasStatistics:true,statsPrettifyFields:[a("Index size")],parent_type:["table","partition"],canDrop:true,canDropCascade:true,Init:function e(){if(this.initialized)return;this.initialized=true;g.add_menus([{name:"create_primary_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:a("Primary key"),icon:"wcTabIcon icon-primary_key",data:{action:"create",check:true},enable:"canCreate"}])},canCreate:function e(t,i,n){if(n&&n.check==false)return true;var a=g.tree,r=i,l=t,o=[],s=false,d=false,c=this.getTreeNodeHierarchy(r).server.version;while(r){if(!s&&(l._type=="table"||l._type=="partition")){s=true;if("is_partitioned"in l&&l.is_partitioned&&c<11e4){d=true}}if(m.indexOf(["schema"],l._type)>-1){if(d){return false}var u=a.children(arguments[1],false),p=false;m.each(u,function(e){n=g.tree.itemData(f(e));if(!p&&n._type=="primary_key"){p=true}});return!p}o.push(l._type);r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}if(m.indexOf(o,"catalog")>-1){return false}else{return!d}},model:t.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:undefined,oid:undefined,comment:undefined,spcname:undefined,index:undefined,fillfactor:undefined,condeferrable:undefined,condeferred:undefined,columns:[],include:[]},schema:[{id:"name",label:a("Name"),type:"text",mode:["properties","create","edit"],editable:true,cellHeaderClasses:"width_percent_40"},{id:"oid",label:a("OID"),cell:"string",type:"text",mode:["properties"],editable:false,cellHeaderClasses:"width_percent_20"},{id:"comment",label:a("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function e(t){var i=t.get("name");if(!(i&&i!="")){setTimeout(function(){if(t.get("comment")&&t.get("comment")!==""){t.set("comment",null)}},10);return true}else{return false}}},{id:"columns",label:a("Columns"),type:"collection",group:a("Definition"),editable:false,cell:r.StringCell.extend({initialize:function e(){r.StringCell.prototype.initialize.apply(this,arguments);var t=this,i=this.model.get("columns");if(m.isUndefined(t.model.get("oid"))){var n=t.model.top.get("columns");t.listenTo(n,"remove",t.removeColumn);t.listenTo(n,"change:name",t.resetColOptions)}i.on("pgadmin:multicolumn:updated",function(){t.render.apply(t)});t.listenTo(i,"add",t.render);t.listenTo(i,"remove",t.render)},removeColumn:function e(t){var i=this,n=i.model.get("columns").where({column:t.get("name")});i.model.get("columns").remove(n);setTimeout(function(){i.render()},10);var a="primary_key";setTimeout(function(){var e=i.model.top.get(a),t=[];e.each(function(e){if(e.get("columns").length==0){t.push(e)}});e.remove(t)},100)},resetColOptions:function e(t){var i=this,n=i.model.get("columns").where({column:t.previous("name")});if(n.length>0){n[0].set({column:t.get("name")},{silent:true})}setTimeout(function(){i.render()},10)},formatter:{fromRaw:function e(t){return t.pluck("column").toString()},toRaw:function e(t){return t}},render:function e(){return r.StringCell.prototype.render.apply(this,arguments)},remove:function e(){var t=this.model.top.get("columns"),i=this.model.get("columns");if(i){i.off("pgadmin:multicolumn:updated")}this.stopListening(t,"remove",self.removeColumn);this.stopListening(t,"change:name",self.resetColOptions);r.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:true,canAdd:true,control:n.MultiSelectAjaxControl.extend({defaults:m.extend({},n.NodeListByNameControl.prototype.defaults,{select2:{multiple:true,allowClear:true,width:"style",placeholder:a("Select the column(s)")}}),keyPathAccessor:function e(t,i){var n=t;if(m.isArray(n)){return m.map(n,function(e){return e["column"]})}i=i.split(".");for(var a=0;a<i.length;a++){if(m.isNull(n))return null;if(m.isEmpty(i[a]))continue;if(!m.isUndefined(n[i[a]]))n=n[i[a]]}return m.isObject(n)&&!m.isArray(n)?null:n},initialize:function e(){var t=this;if(this.model.handler){n.Select2Control.prototype.initialize.apply(this,arguments);if(m.isUndefined(t.model.get("oid"))){var i=t.model.top.get("columns");t.listenTo(i,"remove",t.resetColOptions);t.listenTo(i,"change:name",t.resetColOptions)}t.custom_options()}else{n.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)}t.model.get("columns").on("pgadmin:multicolumn:updated",function(){t.render.apply(t)})},resetColOptions:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},custom_options:function e(){var t=this.model.top.get("columns"),i=[];if(t.length>0){m.each(t.models,function(e){var t=e.get("name");if(!m.isUndefined(t)&&!m.isNull(t)){i.push({label:t,value:t,image:"icon-column"})}})}this.field.set("options",i)},onChange:function e(){var i=this,t=this.model,n=this.field.get("name").split("."),a=n.shift(),r=this.getValueFromDOM(),l=t.get(a),o=[];this.stopListening(this.model,"change:"+a,this.render);l.each(function(e){var t=e.get("column"),i=m.indexOf(r,t);if(i>-1){r.splice(i,1)}else{o.push(t)}});m.each(r,function(e){var t=new(i.field.get("model"))({column:e},{silent:true,top:i.model.top,collection:l,handler:l});l.add(t)});m.each(o,function(e){l.remove(l.where({column:e}))});this.listenTo(this.model,"change:"+a,this.render)},remove:function e(){if(this.model.handler){var t=this,i=t.model.top.get("columns");t.stopListening(i,"remove",t.resetColOptions);t.stopListening(i,"change:name",t.resetColOptions);t.model.get("columns").off("pgadmin:multicolumn:updated");n.Select2Control.prototype.remove.apply(this,arguments)}else{n.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}}),deps:["index"],node:"column",model:g.Node.Model.extend({defaults:{column:undefined},validate:function e(){return null}}),transform:function e(t){var i=[];if(t&&m.isArray(t)){m.each(t,function(e){i.push({label:e.label,value:e.label,image:"icon-column"})})}return i},select2:{allowClear:false},disabled:function e(t){if(m.has(t,"top")&&!m.isUndefined(t.top)&&!t.top.isNew()){return!m.isUndefined(t.get("oid"))}if(!t.isNew()){return true}var i=t.get("index");if(m.isUndefined(i)||i==""){return false}else{var n=t.get("columns");n.reset();return true}}},{id:"include",label:a("Include columns"),type:"array",group:a("Definition"),editable:false,canDelete:true,canAdd:true,mode:["properties","create","edit"],visible:function e(t){t=t.top;if(!m.isUndefined(t.node_info)&&!m.isUndefined(t.node_info.server)&&!m.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=11e4)return true;return false},control:n.MultiSelectAjaxControl.extend({defaults:m.extend({},n.NodeListByNameControl.prototype.defaults,{select2:{allowClear:false,width:"style",multiple:true,placeholder:a("Select the column(s)")}}),initialize:function e(){var t=this;if(this.model.handler){n.Select2Control.prototype.initialize.apply(this,arguments);if(m.isUndefined(t.model.get("oid"))){var i=t.model.top.get("columns");t.listenTo(i,"remove",t.resetColOptions);t.listenTo(i,"change:name",t.resetColOptions)}t.custom_options()}else{n.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)}},resetColOptions:function e(){var t=this;setTimeout(function(){t.custom_options();t.render.apply(t)},50)},custom_options:function e(){var t=this.model.top.get("columns"),i=[];if(t.length>0){m.each(t.models,function(e){var t=e.get("name");if(!m.isUndefined(t)&&!m.isNull(t)){i.push({label:t,value:t,image:"icon-column"})}})}this.field.set("options",i)}}),deps:["index"],node:"column",disabled:function e(t){if(m.has(t,"top")&&!m.isUndefined(t.top)&&!t.top.isNew()){return!m.isUndefined(t.get("oid"))}if(!t.isNew()){return true}var i=t.get("index");if(m.isUndefined(i)||i==""){return false}else{var n=t.get("columns");n.reset();return true}}},{id:"spcname",label:a("Tablespace"),type:"text",group:a("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:false},filter:function e(t){if(t.label=="pg_global")return false;else return true},disabled:function e(t){t=t.top||t;var i=t.get("index");if(m.isUndefined(i)||i==""){return false}else{setTimeout(function(){t.set("spcname","")},10);return true}}},{id:"index",label:a("Index"),type:"text",group:a("Definition"),control:n.NodeListByNameControl.extend({initialize:function e(){if(m.isUndefined(this.model.top)){n.NodeListByNameControl.prototype.initialize.apply(this,arguments)}else{n.Control.prototype.initialize.apply(this,arguments)}}}),select2:{allowClear:true},node:"index",disabled:function e(t){if(m.has(t,"top")&&!m.isUndefined(t.top)&&!t.top.isNew()){return true}return!t.isNew()},visible:function e(t){return!m.isUndefined(t.top.node_info["table"])}},{id:"fillfactor",label:a("Fill factor"),deps:["index"],type:"int",group:a("Definition"),allowNull:true,disabled:function e(t){var i=t.get("index");if(m.isUndefined(i)||i==""){return false}else{setTimeout(function(){t.set("fillfactor",null)},10);return true}}},{id:"condeferrable",label:a("Deferrable?"),type:"switch",group:a("Definition"),deps:["index"],disabled:function e(t){if(m.has(t,"top")&&!m.isUndefined(t.top)&&!t.top.isNew()){return!m.isUndefined(t.get("oid"))}if(!t.isNew()){return true}var i=t.get("index");if(m.isUndefined(i)||i==""){return false}else{setTimeout(function(){if(t.get("condeferrable"))t.set("condeferrable",false)},10);return true}}},{id:"condeferred",label:a("Deferred?"),type:"switch",group:a("Definition"),deps:["condeferrable"],disabled:function e(t){if(m.has(t,"top")&&!m.isUndefined(t.top)&&!t.top.isNew()){return!m.isUndefined(t.get("oid"))}if(!t.isNew()){return true}if(t.get("condeferrable")==true){return false}else{setTimeout(function(){if(t.get("condeferred"))t.set("condeferred",false)},10);return true}}}],validate:function e(){this.errorModel.clear();if(m.has(this,"top")){this.top.errorModel.clear()}var t=this.get("columns"),i=this.get("index");if((m.isUndefined(i)||String(i).replace(/^\s+|\s+$/g,"")=="")&&(m.isUndefined(t)||m.isNull(t)||t.length<1)){var n=a("Please specify columns for %(node)s",{node:a("Primary key")});this.errorModel.set("columns",n);return n}return null}})})}return g.Nodes["primary_key"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(10),i(6),i(12),i(11),i(7),i(63)],a=function(s,e,u,d,c,t,p,f,o,i,n){if(!p.Nodes["coll-partition"]){t.Browser.Nodes["coll-partition"]=t.Browser.Collection.extend({node:"partition",label:s("Partitions"),type:"coll-partition",columns:["name","schema","partition_value","is_partitioned","description"],canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema})}if(!p.Nodes["partition"]){t.Browser.Nodes["partition"]=p.Node.extend({parent_type:"table",collection_type:"coll-partition",type:"partition",label:s("Partition"),hasSQL:true,hasDepends:true,hasStatistics:true,statsPrettifyFields:[s("Size"),s("Indexes size"),s("Table size"),s("TOAST table size"),s("Tuple length"),s("Dead tuple length"),s("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:e("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create"],height:"95%",width:"85%",Init:function e(){if(this.initialized)return;this.initialized=true;p.add_menus([{name:"truncate_table",node:"partition",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:s("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"partition",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:s("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:s("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:s("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"partition",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:s("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"detach_partition",node:"partition",module:this,applies:["object","context"],callback:"detach_partition",priority:2,label:s("Detach Partition"),icon:"fa fa-remove"}])},generate_url:function e(t,i,n,a,r){if(d.indexOf(["stats","statistics","dependency","dependent","reset","get_relations","get_oftype","get_attach_tables"],i)==-1){return p.Node.generate_url.apply(this,arguments)}if(i=="statistics"){i="stats"}r=d.isUndefined(t)||d.isNull(t)?r||{}:this.getTreeNodeHierarchy(t);return c("table/%s/%s/%s/%s/%s/%s").sprintf(encodeURIComponent(i),encodeURIComponent(r["server_group"]._id),encodeURIComponent(r["server"]._id),encodeURIComponent(r["database"]._id),encodeURIComponent(r["partition"].schema_id),encodeURIComponent(r["partition"]._id)).value()},canDrop:n.isTreeItemOfChildOfSchema,canDropCascade:n.isTreeItemOfChildOfSchema,callbacks:{enable_triggers_on_table:function e(t){var i={enable:true};this.callbacks.set_triggers.apply(this,[t,i])},disable_triggers_on_table:function e(t){var i={enable:false};this.callbacks.set_triggers.apply(this,[t,i])},set_triggers:function e(t,i){var n=t||{},a=this,r=p.tree,l=n.item||r.selected(),o=l&&l.length==1?r.itemData(l):undefined;if(!o)return false;u.ajax({url:a.generate_url(l,"set_trigger",o,true),type:"PUT",data:i,dataType:"json"}).done(function(e){if(e.success==1){f.success(e.info);r.unload(l);r.setInode(l);r.deselect(l);setTimeout(function(){r.select(l)},10)}}).fail(function(e,t,i){f.pgRespErrorNotify(e,i);r.unload(l)})},truncate_table:function e(t){var i={cascade:false};this.callbacks.truncate.apply(this,[t,i])},truncate_table_cascade:function e(t){var i={cascade:true};this.callbacks.truncate.apply(this,[t,i])},truncate:function e(t,i){var n=t||{},a=this,r=p.tree,l=n.item||r.selected(),o=l&&l.length==1?r.itemData(l):undefined;if(!o)return false;f.confirm(s("Truncate Table"),c(s("Are you sure you want to truncate table %s?")).sprintf(o.label).value(),function(e){if(e){var t=o;u.ajax({url:a.generate_url(l,"truncate",o,true),type:"PUT",data:i,dataType:"json"}).done(function(e){if(e.success==1){f.success(e.info);r.removeIcon(l);t.icon="icon-partition";r.addIcon(l,{icon:t.icon});r.unload(l);r.setInode(l);r.deselect(l);setTimeout(function(){r.select(l)},10)}}).fail(function(e,t,i){f.pgRespErrorNotify(e,i);r.unload(l)})}},function(){})},reset_table_stats:function e(t){var i=t||{},n=this,a=p.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;f.confirm(s("Reset statistics"),c(s('Are you sure you want to reset the statistics for table "%s"?')).sprintf(l._label).value(),function(e){if(e){var t=l;u.ajax({url:n.generate_url(r,"reset",l,true),type:"DELETE"}).done(function(e){if(e.success==1){f.success(e.info);a.removeIcon(r);t.icon="icon-partition";a.addIcon(r,{icon:t.icon});a.unload(r);a.setInode(r);a.deselect(r);setTimeout(function(){a.select(r)},10)}}).fail(function(e,t,i){f.pgRespErrorNotify(e,i);a.unload(r)})}},function(){})},detach_partition:function e(t){var i=t||{},n=this,a=p.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;f.confirm(s("Detach Partition"),c(s("Are you sure you want to detach the partition %s?")).sprintf(l._label).value(),function(e){if(e){u.ajax({url:n.generate_url(r,"detach",l,true),type:"PUT"}).done(function(e){if(e.success==1){f.success(e.info);var t=a.next(r);if(!t||!t.length){t=a.prev(r);if(!t||!t.length){t=a.parent(r);a.setInode(t,true)}}a.remove(r);if(t.length){a.select(t)}}}).fail(function(e,t,i){f.pgRespErrorNotify(e,i)})}},function(){})}},model:p.Node.Model.extend({defaults:{name:undefined,oid:undefined,spcoid:undefined,spcname:undefined,relowner:undefined,relacl:undefined,relhasoids:undefined,relhassubclass:undefined,reltuples:undefined,description:undefined,conname:undefined,conkey:undefined,isrepl:undefined,triggercount:undefined,relpersistence:undefined,fillfactor:undefined,reloftype:undefined,typname:undefined,labels:undefined,providers:undefined,is_sys_table:undefined,coll_inherits:[],hastoasttable:true,toast_autovacuum_enabled:false,autovacuum_enabled:false,primary_key:[],partitions:[],partition_type:"range",is_partitioned:false,partition_value:undefined},initialize:function e(t,i){if(d.size(t)===0){var n=p.serverInfo[i.node_info.server._id].user,a=i.node_info.schema;this.set({relowner:n.name,schema:a._label},{silent:true})}p.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:s("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:s("OID"),type:"text",mode:["properties"]},{id:"relowner",label:s("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:false},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:s("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit","properties"],disabled:"inSchema",filter:function e(t){if(t&&t.label.match(/^pg_/)){return false}return true},cache_node:"database",cache_level:"database"},{id:"spcname",label:s("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function e(t){return!(t&&t.label.match(/pg_global/))}},{id:"partition",type:"group",label:s("Partition"),mode:["edit","create"],min_version:1e5,visible:function e(t){if(t.isNew()||t.get("is_partitioned"))return true;return false}},{id:"is_partitioned",label:s("Partitioned table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function e(t){if(!d.isUndefined(t.node_info)&&!d.isUndefined(t.node_info.server)&&!d.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(!t.isNew())return true;return false}},{id:"description",label:s("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"partition_value",label:s("Partition Scheme"),type:"text",visible:false},{id:"coll_inherits",label:s("Inherited from table(s)"),type:"text",group:s("Advanced"),mode:["properties"]},{id:"Columns",type:"group",label:s("Columns"),mode:["edit","create"],min_version:1e5,visible:function e(){return false}},{id:"columns",label:s("Columns"),type:"collection",group:s("Columns"),model:p.Nodes["column"].model,subnode:p.Nodes["column"].model,mode:["create","edit"],disabled:function e(t){if(t.isNew()&&t.get("is_partitioned")){setTimeout(function(){var e=t.get("columns");e.remove(e.filter(function(e){if(d.isUndefined(e.get("inheritedfrom")))return false;return true}))},10)}if(this.node_info&&"catalog"in this.node_info){return true}return false},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:true,canDelete:true,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:o.UniqueColCollectionControl.extend({initialize:function e(){o.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var s=this,t=s.model.get(s.field.get("name"));t.on("change:is_primary_key",function(e){var t=s.model.get("primary_key"),i=e.get("name"),n,a;if(e.get("is_primary_key")){if(t.length<1){n=new t.model({},{top:s.model,collection:t,handler:t});t.add(n)}else{n=t.first()}if(d.isUndefined(n.get("oid"))){a=n.get("columns");var r=a.where({column:i});if(r.length==0){var l=new a.model({column:i},{silent:true,top:s.model,collection:t,handler:t});a.add(l)}a.trigger("pgadmin:multicolumn:updated",a)}}else{if(t.length>0){n=t.first();if(!d.isUndefined(n.get("oid"))){return}a=n.get("columns");var o=a.where({column:i});if(o.length>0){a.remove(o);d.each(o,function(e){e.destroy()});if(a.length==0){setTimeout(function(){t.remove(t.first())},10)}}a.trigger("pgadmin:multicolumn:updated",a)}}})},remove:function e(){var t=this.model.get(this.field.get("name"));if(t){t.off("change:is_primary_key")}o.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:false},{id:"inherited_tables_cnt",label:s("Inherited tables count"),type:"text",mode:["properties"],group:s("Advanced"),disabled:"inSchema"},{type:"nested",control:"tab",group:s("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:s("Primary key"),model:p.Nodes["primary_key"].model,subnode:p.Nodes["primary_key"].model,editable:false,type:"collection",group:s("Primary Key"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function e(t){if(t.get("is_partitioned")){setTimeout(function(){var e=t.get("primary_key");e.remove(e.filter(function(){return true}))},10);return false}return true},canAddRow:function e(t){var i=t.get("columns");return t.get("primary_key")&&t.get("primary_key").length<1&&d.some(i.pluck("name"))}},{id:"foreign_key",label:s("Foreign key"),model:p.Nodes["foreign_key"].model,subnode:p.Nodes["foreign_key"].model,editable:false,type:"collection",group:s("Foreign Key"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function e(t){if(t.get("is_partitioned")){setTimeout(function(){var e=t.get("foreign_key");e.remove(e.filter(function(){return true}))},10);return false}return true},columns:["name","columns"],canAddRow:function e(t){var i=t.get("columns");return d.some(i.pluck("name"))}},{id:"check_constraint",label:s("Check constraint"),model:p.Nodes["check_constraint"].model,subnode:p.Nodes["check_constraint"].model,editable:false,type:"collection",group:s("Check"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",canAdd:true,columns:["name","consrc"]},{id:"unique_constraint",label:s("Unique Constraint"),model:p.Nodes["unique_constraint"].model,subnode:p.Nodes["unique_constraint"].model,editable:false,type:"collection",group:s("Unique"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function e(t){if(t.get("is_partitioned")){setTimeout(function(){var e=t.get("unique_constraint");e.remove(e.filter(function(){return true}))},10);return false}return true},canAddRow:function e(t){var i=t.get("columns");return d.some(i.pluck("name"))}},{id:"exclude_constraint",label:s("Exclude constraint"),model:p.Nodes["exclusion_constraint"].model,subnode:p.Nodes["exclusion_constraint"].model,editable:false,type:"collection",group:s("Exclude"),mode:["edit","create"],canEdit:true,canDelete:true,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function e(t){if(t.get("is_partitioned")){setTimeout(function(){var e=t.get("exclude_constraint");e.remove(e.filter(function(){return true}))},10);return false}return true},canAddRow:function e(t){var i=t.get("columns");return d.some(i.pluck("name"))}}]},{id:"typname",label:s("Of type"),type:"text",mode:["properties","create","edit"],group:s("Advanced"),disabled:"checkOfType",url:"get_oftype",deps:["coll_inherits","is_partitioned"],transform:function e(t,i){var n=i||this,a=n.model;a.of_types_tables=t;return t},control:o.NodeAjaxOptionsControl.extend({onChange:function e(){o.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("typname"),n=undefined,a=undefined,r=t.model.get("columns");if(!d.isUndefined(i)&&i!==""&&r.length!==0){var l=s("Changing of table type will clear columns collection.");f.confirm(l,function(e){if(e){r.reset()}else{return this}})}else if(!d.isUndefined(i)&&i===""){r.reset()}if(!d.isUndefined(i)&&i!==""){a={tname:i};n=t.model.fetch_columns_ajax.apply(t,[a]);r.set(n,{merge:false,remove:false})}}})},{id:"fillfactor",label:s("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,disabled:"inSchema",group:s("Advanced")},{id:"relhasoids",label:s("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",group:s("Advanced")},{id:"relpersistence",label:s("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:s("Advanced")},{id:"conname",label:s("Primary key"),cell:"string",type:"text",mode:["properties"],group:s("Advanced"),disabled:"inSchema"},{id:"reltuples",label:s("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:s("Advanced"),disabled:"inSchema"},{id:"rows_cnt",label:s("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:s("Advanced"),disabled:"inSchema"},{id:"relhassubclass",label:s("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:s("Advanced"),disabled:"inSchema"},{id:"is_sys_table",label:s("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:s("Like"),group:s("Advanced"),schema:[{id:"like_relation",label:s("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:s("Like")},{id:"like_default_value",label:s("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_constraints",label:s("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_indexes",label:s("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_storage",label:s("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")},{id:"like_comments",label:s("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:s("Like")}]},{id:"partition_type",label:s("Partition Type"),editable:false,type:"select2",select2:{allowClear:false},group:"partition",deps:["is_partitioned"],options:[{label:s("Range"),value:"range"},{label:s("List"),value:"list"}],mode:["create"],visible:function e(t){if(!d.isUndefined(t.node_info)&&!d.isUndefined(t.node_info.server)&&!d.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(!t.isNew()||!t.get("is_partitioned"))return true;return false}},{id:"partition_keys",label:s("Partition Keys"),model:o.PartitionKeyModel,subnode:o.PartitionKeyModel,editable:true,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type"],canEdit:false,canDelete:true,control:"sub-node-collection",canAdd:function e(t){if(t.isNew()&&t.get("is_partitioned"))return true;return false},canAddRow:function e(t){var i=t.get("columns");var n=1e3;if(t.get("partition_type")&&t.get("partition_type")=="list")n=1;return t.get("partition_keys")&&t.get("partition_keys").length<n&&d.some(i.pluck("name"))},visible:function e(t){if(!d.isUndefined(t.node_info)&&!d.isUndefined(t.node_info.server)&&!d.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(t.get("partition_keys")&&t.get("partition_keys").models.length>0){setTimeout(function(){var e=t.get("partition_keys");e.remove(e.filter(function(){return true}))},10)}}},{id:"partition_scheme",label:s("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function e(t){if(!d.isUndefined(t.node_info)&&!d.isUndefined(t.node_info.server)&&!d.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(!t.isNew()){this.text=t.get("partition_scheme")}}},{id:"partitions",label:s("Partitions"),model:o.PartitionsModel,subnode:o.PartitionsModel,editable:true,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type"],canEdit:false,canDelete:true,customDeleteTitle:s("Detach Partition"),customDeleteMsg:s("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","values_from","values_to","values_in"],control:o.SubNodeCollectionControl.extend({row:i.PartitionRow,initialize:function e(){o.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var i=this.field.get("schema_node"),n=this.field.get("node_info");u.ajax({url:i.generate_url.apply(i,[null,"get_attach_tables",this.field.get("node_data"),true,n]),type:"GET",async:false}).done(function(e){if(e.success==1){t.model.table_options=e.data}else{f.alert(s("Error fetching tables to be attached"),e.data.result)}}).fail(function(e,t,i){f.pgRespErrorNotify(e,i,s("Error fetching tables to be attached"))})}}}),canAdd:function e(t){if(t.get("is_partitioned"))return true;return false},visible:function e(t){if(!d.isUndefined(t.node_info)&&!d.isUndefined(t.node_info.server)&&!d.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false},disabled:function e(t){if(t.isNew()&&t.get("partitions")&&t.get("partitions").models.length>0){setTimeout(function(){var e=t.get("partitions");e.remove(e.filter(function(){return true}))},10)}}},{id:"partition_note",label:s("Partition"),type:"note",group:"partition",text:s("The control above is used to Create/Attach/Detach partitions.<br>"+"<ul><li>Create Mode: User will be able to create N number of partitions. Mode switch control is disabled in this scenario.</li>"+"<li>Edit Mode: User will be able to create/attach/detach N number of partitions. "+"In attach mode there will be list of suitable tables to be attached.</li></ul>"),visible:function e(t){if(!d.isUndefined(t.node_info)&&!d.isUndefined(t.node_info.server)&&!d.isUndefined(t.node_info.server.version)&&t.node_info.server.version>=1e5)return true;return false}},{type:"nested",control:"tab",group:s("Parameter"),mode:["edit","create"],deps:["is_partitioned"],schema:o.VacuumSettingsSchema},{id:"relacl_str",label:s("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:s("Security")},p.SecurityGroupSchema,{id:"relacl",label:s("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:p.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:true,canDelete:true,uniqueCol:["grantee"]},{id:"seclabels",label:s("Security labels"),canEdit:false,model:p.SecLabelModel,editable:false,canAdd:true,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:true,control:"unique-col-collection"},{id:"vacuum_settings_str",label:s("Storage settings"),type:"multiline",group:s("Advanced"),mode:["properties"]}],validate:function e(t){var i,n=this.get("name"),a=this.get("schema"),r=this.get("relowner"),l=this.get("is_partitioned"),o=this.get("partition_keys");if(t&&(t.length==0||d.indexOf(t,"autovacuum_enabled")!=-1||d.indexOf(t,"toast_autovacuum_enabled")!=-1)){return null}this.errorModel.clear();if(d.isUndefined(n)||d.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")==""){i=s("Table name cannot be empty.");this.errorModel.set("name",i);return i}else if(d.isUndefined(a)||d.isNull(a)||String(a).replace(/^\s+|\s+$/g,"")==""){i=s("Table schema cannot be empty.");this.errorModel.set("schema",i);return i}else if(d.isUndefined(r)||d.isNull(r)||String(r).replace(/^\s+|\s+$/g,"")==""){i=s("Table owner cannot be empty.");this.errorModel.set("relowner",i);return i}else if(l&&this.isNew()&&!d.isNull(o)&&o.length<=0){i=s("Please specify at least one key for partitioned table.");this.errorModel.set("partition_keys",i);return i}return null},inSchema:function e(){if(this.node_info&&"catalog"in this.node_info){return true}return false},isInheritedTable:function e(t){if(!t.inSchema.apply(this,[t])){if(!d.isUndefined(t.get("coll_inherits"))&&t.get("coll_inherits").length!=0||!d.isUndefined(t.get("typname"))&&String(t.get("typname")).replace(/^\s+|\s+$/g,"")!==""){return false}else{return true}}return false},checkInheritance:function e(t){if(t.get("is_partitioned")){setTimeout(function(){t.set("coll_inherits",[])},10);return true}if(!t.inSchema.apply(this,[t])&&(d.isUndefined(t.get("typname"))||d.isNull(t.get("typname"))||String(t.get("typname")).replace(/^\s+|\s+$/g,"")=="")){return false}return true},isLikeDisable:function e(t){if(!t.inSchemaWithModelCheck.apply(this,[t])&&(d.isUndefined(t.get("typname"))||d.isNull(t.get("typname"))||String(t.get("typname")).replace(/^\s+|\s+$/g,"")=="")){return false}return true},check_grid_add_condition:function e(t){var i=true;if(!t.inSchema.apply(this,[t])){if(!d.isUndefined(t.get("typname"))&&!d.isNull(t.get("typname"))&&t.get("typname")!==""){i=false}}return i},check_grid_row_edit_delete:function e(t){var i=true;if(!d.isUndefined(t.get("inheritedfrom"))&&!d.isNull(t.get("inheritedfrom"))&&String(t.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")!==""){i=false}return i},checkOfType:function e(t){if(t.get("is_partitioned")){setTimeout(function(){t.set("typname",undefined)},10);return true}if(!t.inSchemaWithModelCheck.apply(this,[t])&&(d.isUndefined(t.get("coll_inherits"))||d.isNull(t.get("coll_inherits"))||String(t.get("coll_inherits")).replace(/^\s+|\s+$/g,"")=="")){return false}return true},inSchemaWithModelCheck:function e(t){if(this.node_info&&"schema"in this.node_info){if(t.isNew()){return false}else{return true}}return true},isTableAutoVacuumEnable:function e(t){if(!t.inSchema.apply(this,[t])&&t.get("autovacuum_enabled")===true){return false}return true},isToastTableAutoVacuumEnable:function e(t){if(!t.inSchemaWithModelCheck.apply(this,[t])&&t.get("toast_autovacuum_enabled")==true){return false}return true},fetch_columns_ajax:function e(t){var i=this,n="get_columns",a=i.model.top||i.model,r=undefined,l=this.field.get("schema_node"),o=this.field.get("node_info"),s=l.generate_url.apply(l,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||false,o]),d=this.field.get("cache_level")||l.type,c=this.field.get("cache_node");c=c&&p.Nodes["cache_node"]||l;a.trigger("pgadmin:view:fetching",a,i.field);u.ajax({async:false,url:s,data:t}).done(function(e){r=c.cache(n,o,d,e.data)}).fail(function(){a.trigger("pgadmin:view:fetch:error",a,i.field)});a.trigger("pgadmin:view:fetched",a,i.field);r=r&&r.data||[];return r}}),canCreate:n.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function e(t,i,n){if(this.canCreate.apply(this,[t,i,n])){if(t.tigger_count>0){return true}else{return false}}},canCreate_with_trigger_disable:function e(t,i,n){if(this.canCreate.apply(this,[t,i,n])){if(t.tigger_count>0&&t.has_enable_triggers>0){return true}else{return false}}}})}return p.Nodes["partition"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.showDataGrid=r;t.retrieveNameSpaceName=p;t.generateDatagridTitle=h;var c=n(i(2));var a=n(i(4));var u=i(27);function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,i,n,a){var r=t.treeMenu.findNodeByDomElement(a);if(r===undefined||!r.getData()){i.alert((0,c.default)("Data Grid Error"),(0,c.default)("No object selected."));return}var l=u.getTreeNodeHierarchyFromIdentifier.call(t,a);if(m(l)||!g(l)){return}var o=p(l);var s=f(n,r.getData(),l);var d=h(l,o,r.getData());e.create_transaction(s,null,"false",l.server.server_type,"",d,"")}function p(e){if(e.schema!==undefined){return e.schema.label}else if(e.view!==undefined){return e.view.label}else if(e.catalog!==undefined){return e.catalog.label}return""}function f(e,t,i){var n={cmd_type:e.mnuid,obj_type:t._type,sgid:i.server_group._id,sid:i.server._id,did:i.database._id,obj_id:t._id};return(0,a.default)("datagrid.initialize_datagrid",n)}function m(e){return e.server===undefined||e.database===undefined}function g(e){return e.schema!==undefined||e.view!==undefined||e.catalog!==undefined}function h(e,t,i){return"".concat(t,".").concat(i.label)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getPanelTitle=n;var a=i(27);function r(e){return e.database?e.database.label:e.server.db}function l(e){return e.server===undefined}function n(e){var t=e.treeMenu.selected();var i=a.getTreeNodeHierarchyFromIdentifier.call(e,t);if(l(i)){return}var n=r(i);return"".concat(n,"/").concat(i.server.user.name,"@").concat(i.server.label)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.showQueryTool=l;var u=a(i(2));var n=a(i(4));var p=i(27);function a(e){return e&&e.__esModule?e:{default:e}}function r(e){return e.database}function f(e){var t="datagrid.initialize_query_tool";var i={sgid:e.server_group._id,sid:e.server._id};if(r(e)){i["did"]=e.database._id;t="datagrid.initialize_query_tool_with_did"}return(0,n.default)(t,i)}function m(e){return e.server===undefined}function l(e,t,i,n,a,r){var l=n||"";var o=r||"";var s=t.treeMenu.findNodeByDomElement(a);if(s===undefined){i.alert((0,u.default)("Query Tool Error"),(0,u.default)("No object selected."));return}var d=p.getTreeNodeHierarchyFromIdentifier.call(t,a);if(m(d)){return}var c=f(d);e.create_transaction(c,null,"true",d.server.server_type,l,o,"",false)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(i,e,a){"use strict";(function(n){var r=e(a(2));var l=e(a(4));var o=e(a(0));var t=e(a(10));var s=e(a(3));var d=a(55);function e(e){return e&&e.__esModule?e:{default:e}}i.exports=t.default.dialog("fileSelectionDlg",function(){return{main:function e(t){var i=this;if(n.isUndefined(t["dialog_title"])){t["dialog_title"]="Select file"}i.dialog_type=t["dialog_type"];this.set("title",t["dialog_title"]);this.params=JSON.stringify(t);this.elements.dialog.style.minWidth="630px";this.show()},settings:{label:undefined},settingUpdated:function e(t,i,n){switch(t){case"message":this.setMessage(n);break;case"label":if(this.__internal.buttons[0].element){this.__internal.buttons[0].element.innerHTML=n}break;default:break}},prepare:function e(){var t=this;t.$container.find(".storage_content").remove();t.$container.append("<div class='storage_content'></div>");var i=t.$container.find(".storage_content");i.empty();(0,o.default)(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties");o.default.get((0,l.default)("file_manager.index"),function(e){i.append(e)});var n=(0,d.getTransId)(t.params);var a;if(n.readyState==4){a=JSON.parse(n.responseText)}t.trans_id=a.data.fileTransId;setTimeout(function(){(0,o.default)(t.$container.find(".file_manager")).on("enter-key",function(){(0,o.default)((0,o.default)(t.elements.footer).find(".file_manager_ok")).trigger("click")})},200);t.__internal.buttons[1].element.disabled=true},setup:function e(){return{buttons:[{text:(0,r.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:(0,r.default)("Select"),key:13,className:"btn btn-primary fa fa-file file_manager_ok pg-alertify-button disabled"}],focus:{element:0},options:{closableByDimmer:false,maximizable:false,closable:false,movable:true,padding:!1,overflow:!1,model:0,resizable:true,pinnable:false,modal:false,autoReset:false}}},callback:function e(t){var i;if(t.button.text==(0,r.default)("Select")){var n=(0,o.default)(".storage_dialog #uploader .input-path").val(),a={path:(0,o.default)(".currentpath").val()};s.default.Browser.Events.trigger("pgadmin-storage:finish_btn:"+this.dialog_type,n);i=(0,o.default)(this.elements.body).find(".storage_content");(0,o.default)(i).find("*").off();i.remove();(0,d.removeTransId)(this.trans_id);(0,d.set_last_traversed_dir)(a,this.trans_id)}else if(t.button.text==(0,r.default)("Cancel")){i=(0,o.default)(this.elements.body).find(".storage_content");(0,o.default)(i).find("*").off();i.remove();(0,d.removeTransId)(this.trans_id);s.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:"+this.dialog_type)}},build:function e(){this.$container=(0,o.default)('<div class="storage_dialog file_selection_dlg"></div>');this.elements.content.appendChild(this.$container.get(0));t.default.pgDialogBuild.apply(this)},hooks:{onshow:function e(){}}}})}).call(this,a(1))},function(t,e,i){"use strict";(function(o){var s=e(i(2));var l=e(i(4));var d=e(i(0));var a=e(i(10));var c=e(i(3));var u=i(55);function e(e){return e&&e.__esModule?e:{default:e}}t.exports=a.default.dialog("createModeDlg",function(){return{setup:function e(){return{buttons:[{text:(0,s.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-times file_manager_create_cancel pg-alertify-button"},{text:(0,s.default)("Create"),key:13,className:"btn btn-primary fa fa-file file_manager_create file_manager_ok pg-alertify-button disabled"}],focus:{element:0},options:{closableByDimmer:false,maximizable:false,closable:false,movable:true,padding:!1,overflow:!1,model:0,resizable:true,pinnable:false,modal:false,autoReset:false}}},replace_file:function e(){var t=(0,d.default)(".replace_file .btn_yes"),i=(0,d.default)(".replace_file .btn_no");(0,d.default)(".storage_dialog #uploader .input-path").attr("disabled",true);(0,d.default)(".file_manager_ok").addClass("disabled");(0,d.default)(".replace_file, .fm_dimmer").show();t.on("click",function(){(0,d.default)(".replace_file, .fm_dimmer").hide();t.off();i.off();var e=(0,d.default)(".storage_dialog #uploader .input-path").val();c.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",e);(0,d.default)(".file_manager_create_cancel").trigger("click");(0,d.default)(".storage_dialog #uploader .input-path").attr("disabled",false);(0,d.default)(".file_manager_ok").removeClass("disabled")});i.on("click",function(){(0,d.default)(".replace_file, .fm_dimmer").hide();t.off();i.off();(0,d.default)(".storage_dialog #uploader .input-path").attr("disabled",false);(0,d.default)(".file_manager_ok").removeClass("disabled")})},is_file_exist:function e(){var t=(0,d.default)(".storage_dialog #uploader .input-path").val(),i=t.substr(0,t.lastIndexOf("/")+1),n=t.substr(t.lastIndexOf("/")+1),a=false;var r={path:i,name:n,mode:"is_file_exist"};d.default.ajax({type:"POST",data:JSON.stringify(r),url:(0,l.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/x-download; charset=utf-8",async:false}).done(function(e){var t=e.data.result;if(t["Code"]===1){a=true}else{a=false}});return a},check_permission:function e(t){var i=false,n={path:t,mode:"permission"};d.default.ajax({type:"POST",data:JSON.stringify(n),url:(0,l.default)("file_manager.filemanager",{trans_id:this.trans_id}),dataType:"json",contentType:"application/json; charset=utf-8",async:false}).done(function(e){var t=e.data.result;if(t.Code===1){i=true}else{(0,d.default)(".file_manager_ok").addClass("disabled");a.default.error(t.Error)}}).fail(function(){(0,d.default)(".file_manager_ok").addClass("disabled");a.default.error((0,s.default)("Error occurred while checking access permission."))});return i},callback:function e(t){if(t.button.text==(0,s.default)("Create")){var i=(0,d.default)(".storage_dialog #uploader .input-path").val(),n={path:(0,d.default)(".currentpath").val()},a,r="/",l=(0,d.default)(".allowed_file_types select").val();if((0,d.default)(".file_manager").attr("data-platform")==="win32"){r="\\"}if((!i.includes(".")||i.split(".").pop().includes(r))&&l!="*"){i=i+"."+l;(0,d.default)(".storage_dialog #uploader .input-path").val(i)}if(!this.check_permission(i)){t.cancel=true;return}if(!o.isUndefined(i)&&i!==""&&this.is_file_exist()){this.replace_file();t.cancel=true}else{c.default.Browser.Events.trigger("pgadmin-storage:finish_btn:create_file",i);a=(0,d.default)(this.elements.body).find(".storage_content");(0,d.default)(a).find("*").off();a.remove();(0,u.removeTransId)(this.trans_id)}(0,u.set_last_traversed_dir)(n,this.trans_id)}else if(t.button.text==(0,s.default)("Cancel")){a=(0,d.default)(this.elements.body).find(".storage_content");(0,d.default)(a).find("*").off();a.remove();(0,u.removeTransId)(this.trans_id);c.default.Browser.Events.trigger("pgadmin-storage:cancel_btn:create_file")}}}},true,"fileSelectionDlg")}).call(this,i(1))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Dialog=void 0;var s=r(i(2));var l=i(100);var a=i(305);var d=r(i(6));var n=i(27);function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function u(e,t,i){if(t)o(e.prototype,t);if(i)o(e,i);return e}var p=function(){function o(e,t,i,n,a,r){var l=arguments.length>6&&arguments[6]!==undefined?arguments[6]:d.default;c(this,o);this.errorAlertTitle=e;this.alertify=a;this.pgBrowser=i;this.jquery=n;this.dialogModel=r;this.backform=l;this.dialogContainerSelector=t}u(o,[{key:"retrieveAncestorOfTypeServer",value:function e(t){var i=null;var n=t||this.pgBrowser.treeMenu.selected();var a=this.pgBrowser.treeMenu.findNodeByDomElement(n);if(a){var r;var l=a.ancestorNode(function(e){r=e.getData();return r._type==="database"});var o=function e(t){r=t.getData();return r._type==="server"};if(l!==null){if(r._label.indexOf("=")>=0){this.alertify.alert((0,s.default)(this.errorAlertTitle),(0,s.default)("Databases with = symbols in the name cannot be backed up or restored using this utility."))}else{if(l.hasParent(o))i=r}}else{if(a.anyFamilyMember(o))i=r}}if(i===null){this.alertify.alert((0,s.default)(this.errorAlertTitle),(0,s.default)("Please select server or child node from the browser tree."))}return i}},{key:"hasBinariesConfiguration",value:function e(t){var i="paths";var n="pg_bin_dir";var a=(0,s.default)("Please configure the PostgreSQL Binary Path in the Preferences dialog.");if(t.type&&t.type==="ppas"||t.server_type==="ppas"){n="ppas_bin_dir";a=(0,s.default)("Please configure the EDB Advanced Server Binary Path in the Preferences dialog.")}var r=this.pgBrowser.get_preference(i,n);if(r){if(!r.value){this.alertify.alert((0,s.default)("Configuration required"),a);return false}}else{this.alertify.alert((0,s.default)(this.errorAlertTitle),(0,l.sprintf)((0,s.default)("Failed to load preference %s of module %s"),n,i));return false}return true}},{key:"dialogName",value:function e(){return undefined}},{key:"createOrGetDialog",value:function e(t,i){var n=this.dialogName(i);if(!this.alertify[n]){var a=this;this.alertify.dialog(n,function e(){return a.dialogFactory(t,i)})}return this.alertify[n]}},{key:"dialogFactory",value:function e(t,i){var n=new a.DialogFactory(this.pgBrowser,this.jquery,this.alertify,this.dialogModel,this.backform,this.dialogContainerSelector);return n.create(t,i)}},{key:"canExecuteOnCurrentDatabase",value:function e(t){var i=n.getTreeNodeHierarchyFromIdentifier.apply(this.pgBrowser,[t]);if(i.database&&i.database._label.indexOf("=")>=0){this.alertify.alert((0,s.default)(this.errorAlertTitle),(0,s.default)("Databases with = symbols in the name cannot be backed up or restored using this utility."));return false}return true}}]);return o}();t.Dialog=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DialogWrapper=void 0;var a=l(i(18));var r=n(i(0));function n(e){return e&&e.__esModule?e:{default:e}}function l(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function d(e,t,i){if(t)o(e.prototype,t);if(i)o(e,i);return e}var c=function(){function o(e,t,i,n,a,r,l){s(this,o);this.hooks={onclose:function e(){if(this.view){this.view.remove({data:true,internal:true,silent:true})}}};this.dialogContainerSelector=e;this.dialogTitle=t;this.jquery=i;this.pgBrowser=n;this.alertify=a;this.dialogModel=r;this.backform=l}d(o,[{key:"build",value:function e(){this.alertify.pgDialogBuild.apply(this)}},{key:"wasHelpButtonPressed",value:function e(t){return t.button.element.name==="dialog_help"||t.button.element.name==="object_help"}},{key:"getSelectedNodeData",value:function e(t){if(!this.isNodeSelected(t)){return undefined}var i=t.getData();if(i){return i}return undefined}},{key:"focusOnDialog",value:function e(t){var i=(0,r.default)(t.elements.body).find(".backform-tab");i.attr("tabindex",-1);this.pgBrowser.keyboardNavigation.getDialogTabNavigator((0,r.default)(t.elements.dialog));var n=i.find(".tab-content:first > .tab-pane.active:first");a.findAndSetFocus(n);(0,r.default)(t.elements.footer).on("keydown","button",function(e){if(e.keyCode==9&&(0,r.default)(this).nextAll("button:not([disabled])").length==0){a.findAndSetFocus((0,r.default)(t.elements.body).find(".tab-content div.active"));return false}})}},{key:"isNodeSelected",value:function e(t){return t}}]);return o}();t.DialogWrapper=c},,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n,a;!(n=[i(170),i(3),i(218),i(104)],a=function(e,t){var i=function e(t){for(var i in t){var n=t[i];if(n.init&&typeof n.init=="function"){n.init()}else if(n.Init&&typeof n.Init=="function"){n.Init()}}};i(t);i(t.Browser);i(t.Tools);t.Browser.create_menus()}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;var r=r||{};r.about=i(219);var r=r||{};r.preferences=i(269);var r=r||{};r.file_manager=i(195);var r=r||{};r.settings=i(301);var r=r||{};r.tools=r.tools||{};r.tools.backup=i(302);var r=r||{};r.tools=r.tools||{};r.tools.restore=i(308);var r=r||{};r.tools=r.tools||{};r.tools.grant_wizard=i(311);var r=r||{};r.tools=r.tools||{};r.tools.maintenance=i(314);var r=r||{};r.tools=r.tools||{};r.tools.import_export=i(316);var r=r||{};r.tools=r.tools||{};r.tools.debugger=r.tools.debugger||{};r.tools.debugger.controller=i(317);var r=r||{};r.tools=r.tools||{};r.tools.debugger=r.tools.debugger||{};r.tools.debugger.direct=i(101);var r=r||{};r.node=r.node||{};r.node.pga_job=i(318);!(n=[i(5),i(321)],a=function(e){e.init()}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(0),i(17),i(3),i(8),i(2),i(4)],a=function(t,i,n,a,r,l){n=n||window.pgAdmin||{};if(n.About)return;n.About={about_show:function e(){if(!i.aboutDialog){i.dialog("aboutDialog",function e(){return{main:function e(t,i){this.set("title",t);this.message=i},setup:function e(){return{buttons:[{text:r("OK"),key:27,className:"btn btn-primary fa fa-lg fa-check pg-alertify-button"}],options:{modal:false,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false}}},build:function e(){i.pgDialogBuild.apply(this)},prepare:function e(){this.setContent(this.message)}}})}t.get(l("about.index"),function(e){i.aboutDialog(a(r("About %s")).sprintf(n.Browser.utils.app_name).value(),e).resizeTo(n.Browser.stdW.md,n.Browser.stdH.md)})}};return n.About}.apply(t,n),a!==undefined&&(e.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(10),i(3),i(6),i(5),i(42),i(82)],a=function(u,p,f,m,g,h,t,b,_,v){if(t.Preferences)return t.Preferences;t.Preferences={init:function e(){if(this.initialized)return;this.initialized=true;h.dialog("preferencesDlg",function(){var t,r=[],l=f("<div class='preferences_dialog d-flex flex-row'></div>");var e=g.Model.extend({idAttribute:"id",defaults:{id:undefined,value:undefined}});var i={},o=this.preferences=new(g.Collection.extend({model:e,url:p("preferences.index"),updateAll:function e(){for(var t in i){this.get(t).save()}return true}}))(null);o.on("reset",function(){i={}});o.on("change",function(e){var t=e.get("id");if(!(t in i)){i[t]=e._previousAttributes.value}else if(m.isEqual(e.get("value"),i[t])){delete i[t]}});var s=function e(t){var a=l.find(".preferences_content");if(r){m.each(r,function(e){if("$sel"in e){if(e.$sel.data("select2").isOpen())e.$sel.data("select2").close()}e.remove()})}a.empty();r=[];m.each(t,function(e){var t=o.get(e.id);t.errorModel=new g.Model;var i=new b.Field(m.extend({},e,{id:"value",name:"value"})),n=new(i.get("control"))({field:i,model:t});a.append(n.render().$el);r.push(n)})};var n=function e(){if(!t)return;try{t.aciTree("destroy")}catch(e){console.warn(e.stack||e)}t.off("acitree",a);o.reset();if(r){m.each(r,function(e){e.remove()})}r=[];l.empty()},d=function e(t,i){var n=i?t.itemData(i):null;if(n&&n.preferences){t.select(i);return}i=t.first(i);e(t,i)},c=function e(t){switch(t.type){case"text":return"input";case"boolean":t.options={onText:u("True"),offText:u("False"),onColor:"success",offColor:"primary",size:"mini"};return"switch";case"node":t.options={onText:u("Show"),offText:u("Hide"),onColor:"success",offColor:"primary",size:"mini",width:"56"};return"switch";case"integer":return"numeric";case"numeric":return"numeric";case"date":return"datepicker";case"datetime":return"datetimepicker";case"options":var i=[],n=false;m.each(t.options,function(e){if("label"in e&&"value"in e){i.push({label:e.label,value:e.value});if(e.value==t.value)n=true}else{i.push({label:e,value:e});if(e==t.value)n=true}});if(t.select2&&t.select2.tags==true&&t.value&&n==false){i.push({label:t.value,value:t.value})}t.options=i;return"select2";case"multiline":return"textarea";case"switch":return"switch";case"keyboardshortcut":return"keyboardShortcut";case"radioModern":return"radioModern";default:if(console&&console.warn){console.warn("Hmm.. We don't know how to render this type - ''"+t.type+"' of control.")}return"input"}},a=function e(t,i,n,a){n=n||i.selected();var r=n?i.itemData(n):null;switch(a){case"selected":if(!r)return true;if(r.preferences){l.find(".preferences_content");s(r.preferences);return true}else{d(i,n)}break;case"added":if(!r)return true;if(r.preferences&&m.isArray(r.preferences)){m.each(r.preferences,function(e){o.add({id:e.id,value:e.value,category_id:r.id,mid:r.mid,name:e.name});if(!e.control){e.control=c(e)}if(e.help_str){e.helpMessage=e.help_str}})}r.sortable=false;break;case"loaded":setTimeout(function(){d(i,null)},300);break}return true};return{main:function e(){n();l.append("<div class='pg-el-sm-3 preferences_tree aciTree'></div>").append("<div class='pg-el-sm-9 preferences_content'>"+u("Category is not selected.")+"</div>");t=l.find(".preferences_tree");t.on("acitree",a);t.aciTree({selectable:true,expand:true,ajax:{url:p("preferences.index")},animateRoot:true,unanimated:false,show:{duration:75},hide:{duration:75},view:{duration:75}});v.modifyAcitreeAnimation(_,t.aciTree("api"));this.show()},setup:function e(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:u("Preferences"),url:p("help.static",{filename:"preferences.html"})}},{text:u("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:u("Save"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],focus:{element:0},options:{padding:!1,overflow:!1,title:u("Preferences"),closableByDimmer:false,modal:false,pinnable:false}}},callback:function e(t){if(t.button.element.name=="dialog_help"){t.cancel=true;_.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);return}if(t.button.text==u("Save")){o.updateAll();var n={};m.each(i,function(e,t){var i=_.get_preference_for_id(Number(t));if(!n[i.module]){n[i.module]=true}});_.cache_preferences(n)}},build:function e(){this.elements.content.appendChild(l.get(0));h.pgDialogBuild.apply(this)},hooks:{onshow:function e(){}}}})},show:function e(){h.preferencesDlg(true).resizeTo(t.Browser.stdW.lg,t.Browser.stdH.lg)}};return t.Preferences}.apply(t,n),a!==undefined&&(e.exports=a))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";var n,a;!(n=[i(0),i(10),i(3),i(2),i(4),i(6)],a=function(t,i,e,n,a){e=e||window.pgAdmin||{};if(e.Settings)return e.Settings;e.Settings={init:function e(){if(this.initialized)return;this.initialized=true},show:function e(){i.confirm(n("Reset layout"),n("Are you sure you want to reset the current layout? This will cause the application to reload and any un-saved data will be lost."),function(){var e=t('<div id="reloading-indicator"></div>');t("body").append(e);t.ajax({url:a("settings.reset_layout"),type:"DELETE",async:false}).done(function(){t(window).off("unload");window.onbeforeunload=null;location.reload(true)}).fail(function(){console.warn("Something went wrong on server while resetting layout.")})},function(){})}};return e.Settings}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(10),i(9),i(12),i(6),i(5),i(18),i(303),i(304),i(56)],a=function(n,e,a,l,t,r,i,o,s,d,c,u,p,f){if(d.Backup){return d.Backup}var m=i.Model.extend({idAttribute:"id",defaults:{file:undefined,role:undefined,dqoute:false,verbose:true,type:undefined},schema:[{id:"file",label:n("Filename"),type:"text",disabled:false,control:s.FileControl,dialog_type:"create_file",supp_types:["*","sql","backup"]},{id:"role",label:n("Role name"),control:"node-list-by-name",node:"role",select2:{allowClear:false}},{type:"nested",control:"fieldset",label:n("Miscellaneous"),contentClass:"row",schema:[{id:"verbose",label:n("Verbose messages"),type:"switch",disabled:false,group:n("Miscellaneous")},{id:"dqoute",label:n("Force double quote on identifiers"),type:"switch",disabled:false,group:n("Miscellaneous"),controlLabelClassName:"control-label pg-el-sm-6 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-6 pg-el-12"}]},{id:"globals_note",label:n("Note"),text:n("Only objects global to the entire database will be backed up, in PLAIN format"),type:"note"},{}],validate:function e(){return null}});var g=i.Model.extend({idAttribute:"id",defaults:{file:undefined,role:undefined,format:"custom",verbose:true,blobs:true,encoding:undefined,schemas:[],tables:[],database:undefined},schema:[{id:"file",label:n("Filename"),type:"text",disabled:false,control:s.FileControl.extend({render:function e(){var t=this.model.toJSON();if(t.format=="directory"){this.field.attributes.dialog_type="select_folder"}else{this.field.attributes.dialog_type="create_file"}s.InputControl.prototype.render.apply(this,arguments);return this}}),dialog_type:"create_file",supp_types:["*","sql","backup"],deps:["format"]},{id:"format",label:n("Format"),type:"text",disabled:false,control:"select2",select2:{allowClear:false,width:"100%"},options:[{label:n("Custom"),value:"custom"},{label:n("Tar"),value:"tar"},{label:n("Plain"),value:"plain"},{label:n("Directory"),value:"directory"}],visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server"){setTimeout(function(){t.set("format","plain")},10);return false}return true}},{id:"ratio",label:n("Compression ratio"),type:"int",min:0,max:9,disabled:false,visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server")return false;return true}},{id:"encoding",label:n("Encoding"),type:"text",disabled:false,node:"database",control:"node-ajax-options",url:"get_encodings",visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server"){var i=d.tree,n=i.selected(),a=n&&n.length==1?i.itemData(n):undefined;return a.version>=11e4}return true}},{id:"no_of_jobs",label:n("Number of jobs"),type:"int",deps:["format"],disabled:function e(t){return!(t.get("format")==="Directory")},visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server")return false;return true}},{id:"role",label:n("Role name"),control:"node-list-by-name",node:"role",select2:{allowClear:false}},{id:"server_note",label:n("Note"),text:n("The backup format will be PLAIN"),type:"note",visible:function e(t){return t.get("type")==="server"}},{type:"nested",control:"fieldset",label:n("Sections"),group:n("Dump options"),contentClass:"row",schema:[{id:"pre_data",label:n("Pre-data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Sections"),deps:["only_data","only_schema"],disabled:function e(t){return t.get("only_data")||t.get("only_schema")}},{id:"data",label:n("Data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Sections"),deps:["only_data","only_schema"],disabled:function e(t){return t.get("only_data")||t.get("only_schema")}},{id:"post_data",label:n("Post-data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Sections"),deps:["only_data","only_schema"],disabled:function e(t){return t.get("only_data")||t.get("only_schema")}}],visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server")return false;return true}},{type:"nested",control:"fieldset",label:n("Type of objects"),group:n("Dump options"),contentClass:"row",schema:[{id:"only_data",label:n("Only data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Type of objects"),deps:["pre_data","data","post_data","only_schema"],disabled:function e(t){return t.get("pre_data")||t.get("data")||t.get("post_data")||t.get("only_schema")}},{id:"only_schema",label:n("Only schema"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Type of objects"),deps:["pre_data","data","post_data","only_data"],disabled:function e(t){return t.get("pre_data")||t.get("data")||t.get("post_data")||t.get("only_data")}},{id:"blobs",label:n("Blobs"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Type of objects"),visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server"){setTimeout(function(){t.set("blobs",false)},10);return false}return true}}]},{type:"nested",control:"fieldset",label:n("Do not save"),group:n("Dump options"),contentClass:"row",schema:[{id:"dns_owner",label:n("Owner"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save")},{id:"dns_privilege",label:n("Privilege"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save")},{id:"dns_tablespace",label:n("Tablespace"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save")},{id:"dns_unlogged_tbl_data",label:n("Unlogged table data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save")},{id:"no_comments",label:n("Comments"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save"),visible:function e(){var t=d.tree,i=t.selected(),n=i&&i.length==1?t.itemData(i):undefined,a=d.Nodes[n._type].getTreeNodeHierarchy(i)["server"];return a.version>=11e4}}]},{type:"nested",control:"fieldset",label:n("Queries"),group:n("Dump options"),contentClass:"row",schema:[{id:"use_column_inserts",label:n("Use Column Inserts"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Queries")},{id:"use_insert_commands",label:n("Use Insert Commands"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Queries")},{id:"include_create_database",label:n("Include CREATE DATABASE statement"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Queries"),visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server")return false;return true}},{id:"include_drop_database",label:n("Include DROP DATABASE statement"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Queries"),deps:["only_data"],disabled:function e(t){if(t.get("only_data")){setTimeout(function(){t.set("include_drop_database",false)},10);return true}return false}},{id:"load_via_partition_root",label:n("Load Via Partition Root"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Queries"),visible:function e(t){if(!l.isUndefined(t.get("type"))&&t.get("type")==="server")return false;var i=d.tree,n=i.selected(),a=n&&n.length==1?i.itemData(n):undefined,r=d.Nodes[a._type].getTreeNodeHierarchy(n)["server"];return r.version>=11e4}}]},{type:"nested",control:"fieldset",label:n("Disable"),group:n("Dump options"),contentClass:"row",schema:[{id:"disable_trigger",label:n("Trigger"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Disable"),deps:["only_data"],disabled:function e(t){return!t.get("only_data")}},{id:"disable_quoting",label:n("$ quoting"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Disable")}]},{type:"nested",control:"fieldset",label:n("Miscellaneous"),group:n("Dump options"),contentClass:"row",schema:[{id:"with_oids",label:n("With OID(s)"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",deps:["use_column_inserts","use_insert_commands"],group:n("Miscellaneous"),disabled:function e(t){if(t.get("use_column_inserts")||t.get("use_insert_commands")){setTimeout(function(){t.set("with_oids",false)},10);return true}return false}},{id:"verbose",label:n("Verbose messages"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Miscellaneous")},{id:"dqoute",label:n("Force double quote on identifiers"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Miscellaneous")},{id:"use_set_session_auth",label:n("Use SET SESSION AUTHORIZATION"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Miscellaneous")}]}],validate:function e(){return null}});d.Backup={init:function e(){if(this.initialized)return;this.initialized=true;var t=[{name:"backup_global",module:this,applies:["tools"],callback:"start_backup_global",priority:12,label:n("Backup Globals..."),icon:"fa fa-floppy-o",enable:u.menuEnabledServer},{name:"backup_server",module:this,applies:["tools"],callback:"start_backup_server",priority:12,label:n("Backup Server..."),icon:"fa fa-floppy-o",enable:u.menuEnabledServer},{name:"backup_global_ctx",module:this,node:"server",applies:["context"],callback:"start_backup_global",priority:12,label:n("Backup Globals..."),icon:"fa fa-floppy-o",enable:u.menuEnabledServer},{name:"backup_server_ctx",module:this,node:"server",applies:["context"],callback:"start_backup_server",priority:12,label:n("Backup Server..."),icon:"fa fa-floppy-o",enable:u.menuEnabledServer},{name:"backup_object",module:this,applies:["tools"],callback:"backup_objects",priority:11,label:n("Backup..."),icon:"fa fa-floppy-o",enable:f.enabled.bind(null,d.treeMenu,u.backupSupportedNodes)}];for(var i=0;i<u.backupSupportedNodes.length;i++){t.push({name:"backup_"+u.backupSupportedNodes[i],node:u.backupSupportedNodes[i],module:this,applies:["context"],callback:"backup_objects",priority:11,label:n("Backup..."),icon:"fa fa-floppy-o",enable:f.enabled.bind(null,d.treeMenu,u.backupSupportedNodes)})}d.add_menus(t);return this},start_backup_global:function e(t,i){var n=new p.BackupDialog(d,a,r,m);n.draw(t,i,{globals:true},d.stdW.md,d.stdH.md)},start_backup_server:function e(t,i){var n=new p.BackupDialog(d,a,r,g);n.draw(t,i,{server:true},d.stdW.md,d.stdH.md)},backup_objects:function e(t,i){var n=new p.BackupDialog(d,a,r,g);n.draw(t,i,null,d.stdW.md,d.stdH.md)}};return d.Backup}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.menuEnabledServer=l;t.backupSupportedNodes=void 0;var n=i(49);var a=["database","schema","table","partition"];t.backupSupportedNodes=a;function r(e){return"server"===e._type&&e.connected}function l(e){return(0,n.isValidTreeNodeData)(e)&&r(e)}},function(e,b,_){"use strict";(function(i){Object.defineProperty(b,"__esModule",{value:true});b.BackupDialog=void 0;var u=t(_(2));var r=t(_(6));var e=_(198);var n=t(_(4));var p=t(_(24));function t(e){return e&&e.__esModule?e:{default:e}}function a(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){a=function e(t){return typeof t}}else{a=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return a(e)}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function s(e,t,i){if(t)o(e.prototype,t);if(i)o(e,i);return e}function d(e,t){if(t&&(a(t)==="object"||typeof t==="function")){return t}return c(e)}function c(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function f(e){f=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return f(e)}function m(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)g(e,t)}function g(e,t){g=Object.setPrototypeOf||function e(t,i){t.__proto__=i;return t};return g(e,t)}var h=function(e){m(c,e);function c(e,t,i,n){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:r.default;l(this,c);return d(this,f(c).call(this,"Backup Error","<div class='backup_dialog'></div>",e,t,i,n,a))}s(c,[{key:"url_for_utility_exists",value:function e(t,i){return(0,n.default)("backup.utility_exists",{sid:t,backup_obj_type:i==null?"objects":"servers"})}},{key:"draw",value:function e(t,n,a){var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var l=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var i=this.retrieveAncestorOfTypeServer(n);if(!i){return}if(!this.hasBinariesConfiguration(i)){return}var o=i._type=="database"?i._pid:i._id;var s=this.url_for_utility_exists(o,a);var d=this;p.default.get(s).then(function(e){if(!e.data.success){d.alertify.alert((0,u.default)("Utility not found"),e.data.errormsg);return}var t=c.typeOfDialog(a);if(!d.canExecuteOnCurrentDatabase(n)){return}var i=d.createOrGetDialog(c.dialogTitle(t),t);i(true).resizeTo(r,l)}).catch(function(){d.alertify.alert((0,u.default)("Utility not found"),(0,u.default)("Failed to fetch Utility information"));return})}},{key:"dialogName",value:function e(t){if(t==="backup_objects"){return t}return"BackupDialog_"+t}}],[{key:"typeOfDialog",value:function e(t){if(t===null){return"backup_objects"}var e="server";if(!i.isUndefined(t["globals"])&&t["globals"]){e="globals"}return e}},{key:"dialogTitle",value:function e(t){if(t==="backup_objects"){return null}return t==="globals"?(0,u.default)("Backup Globals..."):(0,u.default)("Backup Server...")}}]);return c}(e.Dialog);b.BackupDialog=h}).call(this,_(1))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DialogFactory=void 0;var n=r(i(306));var a=i(307);function r(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};if(n.get||n.set){Object.defineProperty(t,i,n)}else{t[i]=e[i]}}}}t.default=e;return t}}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function s(e,t,i){if(t)l(e.prototype,t);if(i)l(e,i);return e}var d=function(){function l(e,t,i,n,a,r){o(this,l);this.pgBrowser=e;this.jquery=t;this.alertify=i;this.dialogModel=n;this.backform=a;this.dialogContainerSelector=r}s(l,[{key:"create",value:function e(t,i){if(i==="restore"){return this.createRestoreDialog(t,i)}else{return this.createBackupDialog(t,i)}}},{key:"createRestoreDialog",value:function e(t,i){return new a.RestoreDialogWrapper(this.dialogContainerSelector,t,i,this.jquery,this.pgBrowser,this.alertify,this.dialogModel,this.backform)}},{key:"createBackupDialog",value:function e(t,i){return new n.BackupDialogWrapper(this.dialogContainerSelector,t,i,this.jquery,this.pgBrowser,this.alertify,this.dialogModel,this.backform)}}]);return l}();t.DialogFactory=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BackupDialogWrapper=void 0;var c=i(27);var u=r(i(24));var p=r(i(2));var f=r(i(4));var a=r(i(1));var n=i(199);function r(e){return e&&e.__esModule?e:{default:e}}function l(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){l=function e(t){return typeof t}}else{l=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return l(e)}function m(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function s(e,t,i){if(t)o(e.prototype,t);if(i)o(e,i);return e}function g(e,t){if(t&&(l(t)==="object"||typeof t==="function")){return t}return d(e)}function d(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function h(e){h=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return h(e)}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_(e,t)}function _(e,t){_=Object.setPrototypeOf||function e(t,i){t.__proto__=i;return t};return _(e,t)}var v=function(e){b(d,e);function d(e,t,i,n,a,r,l,o){var s;m(this,d);s=g(this,h(d).call(this,e,t,n,a,r,l,o));s.typeOfDialog=i;return s}s(d,[{key:"main",value:function e(t){this.set("title",t)}},{key:"setup",value:function e(){return{buttons:[{text:"",className:"btn btn-secondary pull-left fa fa-info pg-alertify-icon-button",attrs:{name:"object_help",type:"button",url:"backup.html",label:(0,p.default)("Backup")}},{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,p.default)("Backup"),url:(0,f.default)("help.static",{filename:"backup_dialog.html"})}},{text:(0,p.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button","data-btn-name":"cancel"},{text:(0,p.default)("Backup"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button","data-btn-name":"backup"}],options:{title:this.dialogTitle,padding:!1,overflow:!1,model:0,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false,modal:false}}}},{key:"prepare",value:function e(){this.disableBackupButton();var t=this.jquery(this.dialogContainerSelector);var i=this.getSelectedNode();var n=this.getSelectedNodeData(i);if(!n){return}var a=this.pgBrowser.Nodes[n._type];if(this.dialogTitle===null){var r="Backup (".concat(a.label,": ").concat(n.label,")");this.main(r)}var l=(0,c.getTreeNodeHierarchyFromElement)(this.pgBrowser,i);var o=this.createDialog(a,l,this.typeOfDialog,t);this.addAlertifyClassToBackupNodeChildNodes();o.render();this.elements.content.appendChild(t.get(0));this.focusOnDialog(this);this.setListenersForFilenameChanges()}},{key:"callback",value:function e(t){var i=this.getSelectedNode();var n=this.getSelectedNodeData(i);var a=n&&this.pgBrowser.Nodes[n._type];if(this.wasHelpButtonPressed(t)){t.cancel=true;this.pgBrowser.showHelp(t.button.element.name,t.button.element.getAttribute("url"),a,i.getHtmlIdentifier());return}if(this.wasBackupButtonPressed(t)){if(!n)return;var r=this.retrieveServerIdentifier(a,i);var l=this;var o="backup.create_server_job";if(this.typeOfDialog==="backup_objects"){o="backup.create_object_job"}var s=(0,f.default)(o,{sid:r});var d=(0,c.getTreeNodeHierarchyFromElement)(this.pgBrowser,i);this.setExtraParameters(i,d);u.default.post(s,this.view.model.toJSON()).then(function(e){if(e.data.success){l.alertify.success((0,p.default)("Backup job created."),5);l.pgBrowser.Events.trigger("pgadmin-bgprocess:created",l)}else{l.alertify.alert((0,p.default)("Backup job creation failed."),e.data.errormsg)}}).catch(function(e){try{var t=e.response.data;l.alertify.alert((0,p.default)("Backup job failed."),t.errormsg)}catch(e){console.warn(e.stack||e)}})}}},{key:"addAlertifyClassToBackupNodeChildNodes",value:function e(){this.jquery(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties")}},{key:"getSelectedNode",value:function e(){var t=this.pgBrowser.treeMenu;var i=t.selected();if(i){return t.findNodeByDomElement(i)}else{return undefined}}},{key:"disableBackupButton",value:function e(){this.__internal.buttons[3].element.disabled=true}},{key:"enableBackupButton",value:function e(){this.__internal.buttons[3].element.disabled=false}},{key:"createDialog",value:function e(t,i,n,a){var r={};if(n!=="backup_objects"){r["type"]=n}var l=new this.dialogModel(r,{node_info:i});var o=this.backform.generateViewSchema(i,l,"create",t,i.server,true);return this.view=new this.backform.Dialog({el:a,model:l,schema:o})}},{key:"retrieveServerIdentifier",value:function e(t,i){var n=(0,c.getTreeNodeHierarchyFromElement)(this.pgBrowser,i);return n.server._id}},{key:"setListenersForFilenameChanges",value:function e(){var t=this;this.view.model.on("change",function(){if(!a.default.isUndefined(this.get("file"))&&this.get("file")!==""){this.errorModel.clear();t.enableBackupButton()}else{t.disableBackupButton();this.errorModel.set("file",(0,p.default)("Please provide a filename"))}})}},{key:"setExtraParameters",value:function e(t,i){if(this.typeOfDialog==="backup_objects"){this.view.model.set("database",i.database._label);var n=t.getData();if(n._type==="schema"){this.view.model.set("schemas",[n._label])}if(n._type==="table"){this.view.model.set("tables",[[i.schema._label,n._label]])}if(a.default.isEmpty(this.view.model.get("ratio"))){this.view.model.unset("ratio")}}}},{key:"wasBackupButtonPressed",value:function e(t){return t.button["data-btn-name"]==="backup"}}]);return d}(n.DialogWrapper);t.BackupDialogWrapper=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RestoreDialogWrapper=void 0;var c=i(27);var u=r(i(24));var n=r(i(1));var p=r(i(2));var f=r(i(4));var a=i(199);function r(e){return e&&e.__esModule?e:{default:e}}function l(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){l=function e(t){return typeof t}}else{l=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return l(e)}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function m(e,t,i){if(t)o(e.prototype,t);if(i)o(e,i);return e}function g(e,t){if(t&&(l(t)==="object"||typeof t==="function")){return t}return s(e)}function s(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function h(e){h=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return h(e)}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_(e,t)}function _(e,t){_=Object.setPrototypeOf||function e(t,i){t.__proto__=i;return t};return _(e,t)}var v=function(e){b(s,e);function s(e,t,i,n,a,r,l,o){d(this,s);return g(this,h(s).call(this,e,t,n,a,r,l,o))}m(s,[{key:"main",value:function e(t,i,n,a){this.set("title",t);this.setting("pg_node",a);this.setting("pg_item",i);this.setting("pg_item_data",n)}},{key:"setup",value:function e(){return{buttons:[{text:"",className:"btn btn-secondary pull-left fa fa-info pg-alertify-icon-button",attrs:{name:"object_help",type:"button",url:"backup.html",label:(0,p.default)("Restore")}},{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:(0,p.default)("Restore"),url:(0,f.default)("help.static",{filename:"restore_dialog.html"})}},{text:(0,p.default)("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button",restore:false,"data-btn-name":"cancel"},{text:(0,p.default)("Restore"),key:13,className:"btn btn-primary fa fa-upload pg-alertify-button",restore:true,"data-btn-name":"restore"}],options:{title:this.dialogTitle,padding:!1,overflow:!1,model:0,resizable:true,maximizable:true,pinnable:false,closableByDimmer:false,modal:false}}}},{key:"prepare",value:function e(){this.disableRestoreButton();var t=this.jquery(this.dialogContainerSelector);var i=this.getSelectedNode();var n=this.getSelectedNodeData(i);if(!n){return}var a=this.pgBrowser.Nodes[n._type];var r=(0,c.getTreeNodeHierarchyFromElement)(this.pgBrowser,i);var l=this.createDialog(a,r,t);this.addAlertifyClassToRestoreNodeChildNodes();l.render();this.elements.content.appendChild(t.get(0));this.focusOnDialog(this);this.setListenersForFilenameChanges()}},{key:"callback",value:function e(t){var i=this.getSelectedNode();var n=this.getSelectedNodeData(i);var a=n&&this.pgBrowser.Nodes[n._type];if(this.wasHelpButtonPressed(t)){t.cancel=true;this.pgBrowser.showHelp(t.button.element.name,t.button.element.getAttribute("url"),a,i.getHtmlIdentifier());return}if(this.wasRestoreButtonPressed(t)){if(!n)return;var r=this.retrieveServerIdentifier(a,i);var l=this;var o="restore.create_job";var s=(0,f.default)(o,{sid:r});var d=(0,c.getTreeNodeHierarchyFromElement)(this.pgBrowser,i);this.setExtraParameters(i,d);u.default.post(s,this.view.model.toJSON()).then(function(e){if(e.data.success){l.alertify.success((0,p.default)("Restore job created."),5);l.pgBrowser.Events.trigger("pgadmin-bgprocess:created",l)}else{l.alertify.alert((0,p.default)("Restore job creation failed."),e.data.errormsg)}}).catch(function(e){try{var t=e.response.data;l.alertify.alert((0,p.default)("Restore job failed."),t.errormsg)}catch(e){console.warn(e.stack||e)}})}}},{key:"addAlertifyClassToRestoreNodeChildNodes",value:function e(){this.jquery(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties")}},{key:"getSelectedNode",value:function e(){var t=this.pgBrowser.treeMenu;var i=t.selected();if(i){return t.findNodeByDomElement(i)}else{return undefined}}},{key:"disableRestoreButton",value:function e(){this.__internal.buttons[3].element.disabled=true}},{key:"enableRestoreButton",value:function e(){this.__internal.buttons[3].element.disabled=false}},{key:"createDialog",value:function e(t,i,n){var a=new this.dialogModel({node_data:t},{node_info:i});var r=this.backform.generateViewSchema(i,a,"create",t,i.server,true);return this.view=new this.backform.Dialog({el:n,model:a,schema:r})}},{key:"retrieveServerIdentifier",value:function e(t,i){var n=(0,c.getTreeNodeHierarchyFromElement)(this.pgBrowser,i);return n.server._id}},{key:"setListenersForFilenameChanges",value:function e(){var t=this;this.view.model.on("change",function(){if(!n.default.isUndefined(this.get("file"))&&this.get("file")!==""){this.errorModel.clear();t.enableRestoreButton()}else{t.disableRestoreButton();this.errorModel.set("file",(0,p.default)("Please provide a filename"))}})}},{key:"setExtraParameters",value:function e(t,i){this.view.model.set("database",i.database._label);if(!this.view.model.get("custom")){var n=t.getData();switch(n._type){case"schema":this.view.model.set("schemas",[n._label]);break;case"table":this.view.model.set("schemas",[i.schema._label]);this.view.model.set("tables",[n._label]);break;case"function":this.view.model.set("schemas",[i.schema._label]);this.view.model.set("functions",[n._label]);break;case"index":this.view.model.set("schemas",[i.schema._label]);this.view.model.set("indexes",[n._label]);break;case"trigger":this.view.model.set("schemas",[i.schema._label]);this.view.model.set("triggers",[n._label]);break;case"trigger_func":this.view.model.set("schemas",[i.schema._label]);this.view.model.set("trigger_funcs",[n._label]);break}}}},{key:"wasRestoreButtonPressed",value:function e(t){return t.button["data-btn-name"]==="restore"}}]);return s}(a.DialogWrapper);t.RestoreDialogWrapper=v},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(8),i(10),i(5),i(12),i(6),i(18),i(309),i(56),i(310)],a=function(n,e,a,t,r,i,l,o,s,d,c,u,p,f){if(o.Restore){return o.Restore}var m=r.Model.extend({idAttribute:"id",defaults:{custom:false,file:undefined,role:undefined,format:"custom",verbose:true,blobs:true,encoding:undefined,database:undefined,schemas:undefined,tables:undefined,functions:undefined,triggers:undefined,trigger_funcs:undefined,indexes:undefined},initialize:function e(t){var i=t.node_data.type;if(i){if(i==="function"||i==="index"||i==="trigger"){this.set({only_schema:true},{silent:true})}if(i==="table"){this.set({only_data:true},{silent:true})}if(i==="function"||i==="trigger_function"){this.set({clean:true},{silent:true})}}r.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"format",label:n("Format"),type:"text",disabled:false,control:"select2",select2:{allowClear:false,width:"100%"},options:[{label:n("Custom or tar"),value:"custom"},{label:n("Directory"),value:"directory"}]},{id:"file",label:n("Filename"),type:"text",disabled:false,control:d.FileControl.extend({render:function e(){var t=this.model.toJSON();if(t.format=="directory"){this.field.attributes.dialog_type="select_folder"}else{this.field.attributes.dialog_type="select_file"}d.InputControl.prototype.render.apply(this,arguments);return this}}),dialog_type:"select_file",supp_types:["*","backup","sql","patch"],deps:["format"]},{id:"no_of_jobs",label:n("Number of jobs"),type:"int"},{id:"role",label:n("Role name"),control:"node-list-by-name",node:"role",select2:{allowClear:false}},{type:"nested",control:"fieldset",label:n("Sections"),group:n("Restore options"),contentClass:"row",schema:[{id:"pre_data",label:n("Pre-data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Sections"),deps:["only_data","only_schema"],disabled:function e(t){return this.node.type!=="function"&&this.node.type!=="table"&&this.node.type!=="trigger"&&this.node.type!=="trigger_function"&&(t.get("only_data")||t.get("only_schema"))}},{id:"data",label:n("Data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Sections"),deps:["only_data","only_schema"],disabled:function e(t){return this.node.type!=="function"&&this.node.type!=="table"&&this.node.type!=="trigger"&&this.node.type!=="trigger_function"&&(t.get("only_data")||t.get("only_schema"))}},{id:"post_data",label:n("Post-data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Sections"),deps:["only_data","only_schema"],disabled:function e(t){return this.node.type!=="function"&&this.node.type!=="table"&&this.node.type!=="trigger"&&this.node.type!=="trigger_function"&&(t.get("only_data")||t.get("only_schema"))}}]},{type:"nested",control:"fieldset",label:n("Type of objects"),group:n("Restore options"),contentClass:"row",schema:[{id:"only_data",label:n("Only data"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Type of objects"),deps:["pre_data","data","post_data","only_schema"],disabled:function e(t){return this.node.type!=="database"&&this.node.type!=="schema"||t.get("pre_data")||t.get("data")||t.get("post_data")||t.get("only_schema")}},{id:"only_schema",label:n("Only schema"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Type of objects"),deps:["pre_data","data","post_data","only_data"],disabled:function e(t){return this.node.type!=="database"&&this.node.type!=="schema"||t.get("pre_data")||t.get("data")||t.get("post_data")||t.get("only_data")}}]},{type:"nested",control:"fieldset",label:n("Do not save"),group:n("Restore options"),contentClass:"row",schema:[{id:"dns_owner",label:n("Owner"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save")},{id:"dns_privilege",label:n("Privilege"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save")},{id:"dns_tablespace",label:n("Tablespace"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save")},{id:"no_comments",label:n("Comments"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Do not save"),visible:function e(){var t=o.tree,i=t.selected(),n=i&&i.length==1?t.itemData(i):undefined,a=o.Nodes[n._type].getTreeNodeHierarchy(i)["server"];return a.version>=11e4}}]},{type:"nested",control:"fieldset",label:n("Queries"),group:n("Restore options"),contentClass:"row",schema:[{id:"include_create_database",label:n("Include CREATE DATABASE statement"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Queries")},{id:"clean",label:n("Clean before restore"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Queries"),disabled:function e(){return this.node.type==="function"||this.node.type==="trigger_function"}},{id:"single_transaction",label:n("Single transaction"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Queries")}]},{type:"nested",control:"fieldset",label:n("Disable"),group:n("Restore options"),contentClass:"row",schema:[{id:"disable_trigger",label:n("Trigger"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",group:n("Disable")},{id:"no_data_fail_table",label:n("No data for Failed Tables"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Disable")}]},{type:"nested",control:"fieldset",label:n("Miscellaneous / Behavior"),group:n("Restore options"),contentClass:"row",schema:[{id:"verbose",label:n("Verbose messages"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Miscellaneous / Behavior")},{id:"use_set_session_auth",label:n("Use SET SESSION AUTHORIZATION"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Miscellaneous / Behavior")},{id:"exit_on_error",label:n("Exit on error"),type:"switch",extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:false,group:n("Miscellaneous / Behavior")}]}],validate:function e(){return null}});o.Restore={init:function e(){if(this.initialized)return;this.initialized=true;var t=[{name:"restore_object",module:this,applies:["tools"],callback:"restore_objects",priority:13,label:n("Restore..."),icon:"fa fa-upload",enable:p.enabled.bind(null,o.treeMenu,u.restoreSupportedNodes)}];for(var i=0;i<u.restoreSupportedNodes.length;i++){t.push({name:"restore_"+u.restoreSupportedNodes[i],node:u.restoreSupportedNodes[i],module:this,applies:["context"],callback:"restore_objects",priority:13,label:n("Restore..."),icon:"fa fa-upload",enable:p.enabled.bind(null,o.treeMenu,u.restoreSupportedNodes)})}o.add_menus(t);return this},restore_objects:function e(t,i){var n=new f.RestoreDialog(o,a,l,m);n.draw(t,i,o.stdW.md,o.stdH.md)}};return o.Restore}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.restoreSupportedNodes=void 0;var n=["database","schema","table","function","trigger","index","partition"];t.restoreSupportedNodes=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RestoreDialog=void 0;var c=r(i(2));var u=i(100);var l=r(i(6));var n=i(198);var a=r(i(4));var p=r(i(24));function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){o=function e(t){return typeof t}}else{o=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return o(e)}function s(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function f(e,t,i){if(t)d(e.prototype,t);if(i)d(e,i);return e}function m(e,t){if(t&&(o(t)==="object"||typeof t==="function")){return t}return g(e)}function g(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function h(e){h=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return h(e)}function b(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_(e,t)}function _(e,t){_=Object.setPrototypeOf||function e(t,i){t.__proto__=i;return t};return _(e,t)}var v=function(e){b(r,e);function r(e,t,i,n){var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:l.default;s(this,r);return m(this,h(r).call(this,"Restore Error","<div class='restore_dialog'></div>",e,t,i,n,a))}f(r,[{key:"url_for_utility_exists",value:function e(t){return(0,a.default)("restore.utility_exists",{sid:t})}},{key:"draw",value:function e(t,l,o,s){var i=this.retrieveAncestorOfTypeServer(l);if(!i){return}if(!this.hasBinariesConfiguration(i)){return}var n=i._type=="database"?i._pid:i._id;var a=this.url_for_utility_exists(n);var d=this;p.default.get(a).then(function(e){if(!e.data.success){d.alertify.alert((0,c.default)("Utility not found"),e.data.errormsg);return}if(!d.canExecuteOnCurrentDatabase(l)){return}var t=l||d.pgBrowser.treeMenu.selected();var i=d.pgBrowser.treeMenu.findNodeByDomElement(t);var n=i.getData();var a=d.pgBrowser.Nodes[n._type];if(!a)return;var r=(0,u.sprintf)((0,c.default)("Restore (%s: %s)"),a.label,n.label);d.createOrGetDialog(r,"restore");d.alertify.pg_restore(r,t,n,a).resizeTo(o,s)}).catch(function(){d.alertify.alert((0,c.default)("Utility not found"),(0,c.default)("Failed to fetch Utility information"));return})}},{key:"dialogName",value:function e(){return"pg_restore"}}]);return r}(n.Dialog);t.RestoreDialog=v},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(9),i(10),i(12),i(6),i(5),i(26),i(312),i(56),i(81),i(66),i(16),i(313)],a=function(j,M,O,E,P,I,U,A,q,z,n,a){if(q.GrantWizard){return q.GrantWizard}var B=z.Model.extend({defaults:{selected:false,icon:"icon-unknown",name:undefined,name_with_args:undefined,nspname:undefined,proargs:undefined,object_type:undefined,object_id:undefined},idAttribute:"object_id",toJSON:function e(){var t=z.Model.prototype.toJSON.apply(this);delete t.icon;return t},parse:function e(t){t.object_id=t.name_with_args;if(!E.isUndefined(t.object_type)&&(t.object_type=="Function"||t.object_type=="Trigger Function"||t.object_type=="Procedure"))t.name_with_args=t.name+"("+(typeof t.proargs!="undefined"?t.proargs:"")+")";else t.name_with_args=t.name;return t},validate:function e(){var t={},i,n=this.get("objects").toJSON();if(E.isEmpty(n)){t["selected"]=j("Please select any database object.");i=i||t["selected"];this.errorModel.set("selected",i);return i}else{this.errorModel.unset("selected")}return null}});var L=[{name:"selected",cell:U.Extension.SelectRowCell.extend({render:function e(){this.$el.empty().append('<input type="checkbox" />');this.delegateEvents();var t=this.column.get("name");if(this.model&&this.model.has(t)){if(this.model.get(t)){this.$el.parent().toggleClass("selected",true);this.model.trigger("backgrid:selected",this.model,true)}}return this}}),headerCell:"select-all"},{name:"object_type",label:j("Object Type"),editable:false,cell:U.Cell.extend({render:function e(){U.Cell.prototype.render.apply(this,arguments);this.$el.addClass(this.model.get("icon")).css({"padding-left":"24px"});return this}})},{name:"nspname",label:j("Schema"),cell:"string",editable:false},{name:"name_with_args",label:j("Name"),cell:"string",editable:false}];q.GrantWizard={init:function e(){if(this.initialized)return;this.initialized=true;var t=[{name:"grant_wizard_schema",module:this,applies:["tools"],callback:"start_grant_wizard",priority:14,label:j("Grant Wizard..."),icon:"fa fa-unlock-alt",enable:a.enabled.bind(null,q.treeMenu,n.supportedNodes)}];for(var i=0;i<n.supportedNodes.length;i++){t.push({name:"grant_wizard_schema_context_"+n.supportedNodes[i],node:n.supportedNodes[i],module:this,applies:["context"],callback:"start_grant_wizard",priority:14,label:j("Grant Wizard..."),icon:"fa fa-unlock-alt",enable:a.enabled.bind(null,q.treeMenu,n.supportedNodes)})}q.add_menus(t);return this},start_grant_wizard:function e(){if(!I.wizardDialog){I.dialog("wizardDialog",function e(){var T=O("<div class='wizard_dlg'></div>");return{main:function e(t){this.set("title",t)},setup:function e(){return{options:{frameless:true,resizable:true,autoReset:false,maximizable:false,closable:false,closableByDimmer:false,modal:false,pinnable:false}}},DbPaginator:function e(t){var i=this.paginator=new U.Extension.Paginator({collection:t,windowSize:8});return i},DbObjectFilter:function e(t){var i=this.clientSideFilter=new U.Extension.ClientSideFilter({collection:t,placeholder:E("Search by object type or name"),fields:["object_type","name"],wait:150});return i},updateButtons:function e(t){if(!t)O(".wizard-next").prop("disabled",true);else O(".wizard-next").prop("disabled",false)},onSessionInvalid:function e(t){O(".pg-prop-status-bar .alert-text").html(t);O(".pg-prop-status-bar").css("visibility","visible");this.updateButtons(false);return true},onSessionValidated:function e(t){O(".pg-prop-status-bar .alert-text").empty();O(".pg-prop-status-bar").css("visibility","hidden");this.updateButtons(t)},releaseObjects:function e(){var t=this;if(!E.isUndefined(t.dbObjectFilter)){t.dbObjectFilter.remove();t.dbObjectFilter=undefined}if(!E.isUndefined(t.clientSideFilter)){t.clientSideFilter.remove();t.clientSideFilter=undefined}if(!E.isNull(t.obj_priv)&&!E.isUndefined(t.obj_priv)){t.obj_priv=[];delete t.obj_priv}if(!E.isUndefined(t.dbObjectTypePage)&&!E.isNull(t.dbObjectTypePage)){if(!E.isUndefined(t.dbObjectTypePage.get("model"))&&!E.isNull(t.dbObjectTypePage.get("model"))){t.dbObjectTypePage.get("model").clear();t.dbObjectTypePage.get("view").cleanup();t.dbObjectTypePage=undefined}}if(!E.isUndefined(t.privilegePage)&&!E.isNull(t.privilegePage)){if(!E.isUndefined(t.privilegePage.get("model"))&&!E.isNull(t.privilegePage.get("model"))){t.privilegePage.get("model").clear();t.privilegePage.get("view").cleanup();t.privilegePage=undefined}}if(!E.isUndefined(t.reviewSQLPage)&&!E.isNull(t.reviewSQLPage)){if(!E.isUndefined(t.reviewSQLPage.get("model"))&&!E.isNull(t.reviewSQLPage.get("model"))){t.reviewSQLPage.get("model").clear();t.reviewSQLPage=undefined}}if(!E.isUndefined(t.sqlControl)){t.sqlControl.remove()}if(!E.isNull(t.privModel)&&!E.isUndefined(t.privModel)){t.privModel.clear()}if(!E.isNull(t.coll)&&!E.isUndefined(t.coll)){t.coll.reset();t.coll=undefined}if(!E.isNull(t.wizard)&&!E.isUndefined(t.wizard)){t.wizard.collection.reset();t.wizard.curr_page=undefined}},build:function e(){this.elements.content.appendChild(T.get(0));I.pgDialogBuild.apply(this)},get_json_data:function e(t,i,n){return O.ajax({async:false,url:M("grant_wizard.acl",{sid:encodeURI(i),did:encodeURI(n)}),dataType:"json"})},prepare:function e(){var t=this;T.empty().append("<div class='grant_wizard_container'></div>");var i=O(".grant_wizard_container");var n=q.tree,a=n.selected(),r=this.d=a&&a.length==1?n.itemData(a):undefined,l=this.info=q.Node.getTreeNodeHierarchy(a);var o=l["server_group"]._id,s=l.server._id,d=l.database._id,c=r._id,u=r._type.replace("coll-","").replace("materialized_","");var p=this.get_json_data(o,s,d);var f=JSON.parse(p.responseText);var m=M("grant_wizard.objects",{sid:encodeURI(s),did:encodeURI(d),node_id:encodeURI(c),node_type:encodeURI(u)}),g=M("grant_wizard.apply",{sid:encodeURI(s),did:encodeURI(d)}),h=P.Collection.extend({model:B,url:m}),b=this.coll=new h,_=this;this.msql_url=M("grant_wizard.modified_sql",{sid:encodeURI(s),did:encodeURI(d)});b.comparator=function(e){return e.get("object_type")};b.sort();this.dbObjectFilter=this.DbObjectFilter(b);_.privArray=[];b.on("backgrid:selected",function(e,t){e.set("selected",t);var i=e.get("object_type");switch(i){case"Function":i="function";break;case"Trigger Function":i="function";break;case"Procedure":i="procedure";break;case"Table":i="table";break;case"Sequence":i="sequence";break;case"View":i="table";break;case"Materialized View":i="table";break;default:break}if(t){if(E.indexOf(_.privArray,i)==-1)_.privArray.push(i);y.get("objects").add(e,{silent:true})}else{var n=_.privArray.indexOf(i);if(n!=-1)_.privArray.splice(n,1);y.get("objects").remove(e)}var a=e.validate.call(y);if(a)_.onSessionInvalid.call(_,a);else _.onSessionValidated.call(_,true)});var v=z.Model.extend({defaults:{objects:undefined,acl:undefined},schema:[{id:"objects",label:j("Objects"),model:B,type:"collection",group:j("Objects")},{id:"acl",label:j("Privileges"),model:q.Node.PrivilegeRoleModel,type:"collection",canAdd:true,canDelete:true,control:"unique-col-collection"}],urlRoot:g});var y=new v({},{node_info:l});O(".wizard-progress-bar p").show();var w=function a(){O(".wizard-progress-bar p").removeClass("alert-danger").addClass("alert-info");O(".wizard-progress-bar p").text(j("Please wait while fetching records..."));b.fetch({success:function e(t,i){O(".wizard-progress-bar p").html("");O(".wizard-progress-bar").hide();t.set(i.result,{parse:true});if(i&&i.info&&i.info!==""){O(".pg-prop-status-bar .alert-text").html(i.info);O(".pg-prop-status-bar").css("visibility","visible")}},error:function e(t,i,n){O(".wizard-progress-bar p").removeClass("alert-info").addClass("alert-danger");O(".wizard-progress-bar p").text(j("Unable to fetch the database objects"));I.pgNotifier(n.textStatus,i,j("Unable to fetch the database objects"),function(e){if(e==="CRYPTKEY_SET"){a()}else{O(".wizard-progress-bar p").removeClass("alert-info").addClass("alert-danger");O(".wizard-progress-bar p").text(e)}})},reset:true},this)};w();var x=_.dbObjectTypePage=new q.WizardPage({id:1,page_title:E("Object Selection (step 1 of 3)"),disable_prev:true,disable_next:true,show_description:"",show_progress_bar:E("Please wait while fetching records..."),model:y,view:new function(){var e=this;E.extend(e,{cleanup:function e(){if(this.grid){this.grid.remove();delete this.grid;this.grid=null}if(this.el){O(this.el).remove();delete this.el}},grid:null,render:function e(){var t=O('\n                        <div class="db_objects_container pg-el-xs-12">\n                          <div class="db_objects_header d-flex py-1">\n                            <div>'.concat(E("Please select the objects to grant privileges to from the list below."),'</div>\n                            <div class="db_objects_filter ml-auto">\n                              <div class="input-group">\n                                <div class="input-group-prepend">\n                                  <span class="input-group-text fa fa-search" id="labelSearch"></span>\n                                </div>\n                                <input type="search" class="form-control" id="txtGridSearch" placeholder="Search" aria-label="Search" aria-describedby="labelSearch">\n                              </div>\n                            </div>\n                          </div>\n                          <div class="db_objects_grid"></div>\n                        </div>'));if(this.grid){this.cleanup()}this.grid=new U.Grid({columns:E.clone(L),collection:b,className:"backgrid presentation table table-bordered table-hover object_type_table"});t.find(".db_objects_grid").append(this.grid.render().$el);_.clientSideFilter.setCustomSearchBox(t.find("#txtGridSearch"));this.el=t;y.get("objects").each(function(e){var t=b.get(e.get("object_id"));if(t){b.trigger("backgrid:selected",t,true)}});b.trigger("backgrid:refresh");return this}})},beforeNext:function e(t){var i=this;t.options.disable_next=true;if(!E.isNull(y.get("acl"))&&!E.isUndefined(y.get("acl"))){if(y.get("acl").length>0)t.collection.at(1).set("disable_next",false)}if(i.view){i.view.cleanup();delete i.view;i.view=null}return true}});var C=_.privilegePage=new q.WizardPage({id:2,page_title:E("Privilege Selection (step 2 of 3)"),show_description:E("Please add the required privileges for the selected objects."),disable_next:true,model:y,view:new function(){var e=this;E.extend(e,{render:function e(){var t=[];_.privArray=E.uniq(_.privArray);E.each(_.privArray,function(e){_.obj_priv=t=E.union(t,f[e].acl)});var i=_.privModel;var n=z.Model.extend({defaults:{acl:undefined},schema:[{id:"acl",label:j("Privileges"),model:q.Node.PrivilegeRoleModel.extend({privileges:t}),uniqueCol:["grantee","grantor"],editable:true,type:"collection",canAdd:true,canDelete:true,control:"unique-col-collection"}]});var a={};if(i){a=i.toJSON();var r=a["acl"];if(!E.isUndefined(r)&&r.length>0){for(var l in r){var o=r[l]["privileges"],s=[],d;for(d in o){var c=o[d];if(E.indexOf(t,c["privilege_type"])==-1){s.push(d)}}for(d in s){o.splice(d,1)}}}else{console.warn("Acls are not defined")}}i=_.privModel=new n(a,{node_info:_.info});_.privModel.startNewSession();_.privModel.on("pgadmin-session:valid",_.onSessionValidated.bind(_));_.privModel.on("pgadmin-session:invalid",_.onSessionInvalid.bind(_));var u=A.generateViewSchema(_.info,_.privModel,"create",_.d._type,_.d);var p=new A.Field(u[0].fields[0]);this.privControl=new(p.get("control"))({field:p,model:_.privModel});return{el:this.privControl.render().$el}},cleanup:function e(){if(this.privControl){this.privControl.remove();delete this.privControl;this.privControl=null}}})},beforePrev:function e(t){if(this.view){this.view.cleanup();delete this.view;this.view=null}var i=y.get("objects");if(!E.isUndefined(i)&&!E.isEmpty(i)&&i.length>0){t.collection.at(0).set("disable_next",false);t.collection.at(0).set("show_progress_bar","")}y.trigger("backgrid:refresh",y,false);_.clientSideFilter.render();return true},beforeNext:function e(){return true},onNext:function e(){if(!E.isUndefined(_.privModel)){y.set({acl:_.privModel.get("acl")})}if(this.view){this.view.cleanup();delete this.view;this.view=null}_.wizard.options.disable_finish=false;y.trigger("pgadmin-wizard:nextpage:sql",{node_type:u})}});var N=new A.Field({id:"sqltab",label:E("Sql Tab"),control:A.SqlTabControl.extend({initialize:function e(){A.SqlTabControl.prototype.initialize.apply(this,arguments);this.msql_url=_.msql_url;this.model.on("pgadmin-wizard:nextpage:sql",this.onWizardNextPageChange,this);this.model.on("pgadmin-wizard:prevpage:sql",this.onWizardPrevPageChange,this)},onWizardNextPageChange:function e(){var t=this;O.ajax({url:this.msql_url,type:"GET",cache:false,data:t.model.toJSON(true,"GET"),dataType:"json",contentType:"application/json"}).done(function(e){t.sqlCtrl.clearHistory();t.sqlCtrl.setValue(e.data);t.sqlCtrl.refresh()}).fail(function(){t.model.trigger("pgadmin-view:msql:error")}).always(function(){t.model.trigger("pgadmin-view:msql:fetched")})},remove:function e(){_.sqlControl.unbind();var t=_.sqlControl.sqlCtrl.getWrapperElement();O(t).remove();_.sqlControl.sqlCtrl=undefined}})}),S=_.sqlControl=new(N.get("control"))({field:N,model:y});var k=_.reviewSQLPage=new q.WizardPage({id:3,page_title:E("Final (Review Selection) (step 3 of 3)"),show_description:E("The SQL below will be executed on the "+"database server to grant the selected privileges. "+"Please click on <b>Finish</b> to complete the process."),model:y,view:new function(){var e=S.render().$el;e.addClass("h-100");this.render=function(){return{el:e}}},beforePrev:function e(t){var i=y.get("acl");if(!E.isUndefined(t.collection)&&t.collection.models.length>0){if(!E.isUndefined(i)&&!E.isEmpty(i)&&i.length>0){t.collection.at(1).set("disable_next",false)}else{t.collection.at(1).set("disable_next",true)}return true}}});var D=P.Collection.extend({model:q.WizardPage});this.wizardCollection=new D([x,C,k]);_.wizard=new(q.Wizard.extend({options:{title:E("Grant Wizard"),width:"",height:"",curr_page:0,show_left_panel:false,show_header_cancel_btn:true,show_header_maximize_btn:true,disable_finish:true,dialog_api:t,wizard_help:M("help.static",{filename:"grant_wizard.html"})},onFinish:function e(){var t=y,i=t.toJSON("GET");if(i&&!E.isEmpty(i)&&!E.isUndefined(i.objects)){t.save({},{attrs:i,validate:false,cache:false,success:function e(){_.releaseObjects();_.close()},error:function e(t,i){I.pgNotifier("error",i,j("Error saving properties"));_.releaseObjects();_.close()}})}},onCancel:function e(){_.releaseObjects();_.close()}}))({collection:this.wizardCollection,el:i,model:y});_.wizard.render()}}})}I.wizardDialog(true).resizeTo(q.stdW.lg,q.stdH.lg)}};return q.GrantWizard}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.supportedNodes=void 0;var n=["schema","coll-function","coll-sequence","coll-table","coll-view","coll-procedure","coll-mview","database","coll-trigger_function"];t.supportedNodes=n},function(e,t,i){"use strict";var n,a;!(n=[i(1),i(0),i(9),i(3),i(5),i(2),i(18)],a=function(a,n,e,t,i,r,l){i.WizardPage=e.Model.extend({defaults:{id:undefined,page_title:undefined,view:undefined,html:undefined,image:undefined,disable_prev:false,disable_next:false,disable_cancel:false,show_progress_bar:"",onLoad:function e(){return true},beforeNext:function e(){return true},onNext:function e(){},onBefore:function e(){},beforePrev:function e(){return true}}});i.Wizard=e.View.extend({options:{title:"Wizard",image:"left_panel.png",curr_page:0,disable_next:false,disable_prev:false,disable_finish:false,disable_cancel:false,show_header_cancel_btn:false,show_header_maximize_btn:false,dialog_api:null,height:400,width:650,show_left_panel:true,wizard_help:""},tmpl:a.template('    <div class="pgadmin-wizard" style="height: <%= this.options.height %>px;'+'    width: <%= this.options.width %>px">'+'      <div class="wizard-header wizard-badge">'+'        <div class="d-flex">'+"          <div>"+'              <h3><span id="main-title"><%= this.options.title %></span> -'+'              <span id="step-title"><%= page_title %></span></h3>'+"          </div>"+"          <% if (this.options.show_header_cancel_btn) { %>"+'            <div class="ml-auto">'+'              <button class="ajs-close wizard-cancel-event pull-right"'+'                title="'+r("Close")+'"></button>'+"              <% if (this.options.show_header_maximize_btn) { %>"+'                <button class="ajs-maximize wizard-maximize-event mr-1 pull-right"'+'                  title="'+r("Maximize")+'"></button>'+"              <% } %>"+"            </div>"+"          <% } %>"+"        </div>"+"      </div>"+'      <div class="wizard-content row m-0">'+"        <% if (this.options.show_left_panel) { %>"+'          <div class="col-sm-3 wizard-left-panel">'+'              <img src="<%= this.options.image %>"'+'                alt="'+r("Left panel logo")+'"></div>'+"        <% } %>"+'        <div class="col-sm-<% if (this.options.show_left_panel) { %>9<% }'+'          else { %>12<% } %> wizard-right-panel">'+'          <% if ( typeof show_description !=  "undefined"){ %>'+'            <div class="wizard-description">'+"              <%= show_description %>"+"            </div>"+"          <% } %>"+'          <div class="wizard-progress-bar"><% if (show_progress_bar) { %>'+'            <p class="alert alert-info col-sm-12"><%= show_progress_bar %></p><% } %>'+"          </div>"+'          <div class="wizard-right-panel_content">'+"          </div>"+"        </div>"+"      </div>"+'      <div class="wizard-footer pg-prop-footer">'+'        <div class="pg-prop-status-bar" style="visibility:hidden">'+'          <div class="error-in-footer"> '+'            <div class="d-flex px-2 py-1"> '+'              <div class="pr-2"> '+'                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i> '+"              </div> "+'              <div class="alert-text"></div> '+'              <div class="ml-auto close-error-bar"> '+'                <a class="close-error fa fa-times text-danger"></a> '+"              </div> "+"            </div> "+"          </div> "+"        </div>"+'        <div class="wizard-buttons d-flex">'+"          <div>"+'            <button title = "'+r("Help for this dialog.")+'"'+'              class="btn btn-secondary pull-left wizard-help" <%=this.options.wizard_help ? "" : "disabled" %>>'+'              <span class="fa fa-lg fa-question"></span></button>'+"          </div>"+'          <div class="ml-auto">'+'              <button class="btn btn-secondary wizard-cancel" <%=this.options.disable_cancel ? "disabled" : ""%>>'+'                <i class="fa fa-close"></i>&nbsp;'+r("Cancel")+"</button>"+'              <button class="btn btn-secondary wizard-back" <%=this.options.disable_prev ? "disabled" : ""%>>'+'                <i class="fa fa-backward"></i>&nbsp;'+r("Back")+"</button>"+'              <button class="btn btn-secondary wizard-next" <%=this.options.disable_next ? "disabled" : ""%>>'+"                "+r("Next")+'                &nbsp;<i class="fa fa-forward"></i></button>'+'              <button class="btn btn-primary wizard-finish" <%=this.options.disable_finish ? "disabled" : ""%>>'+'                <i class="fa fa-check"></i>&nbsp;'+r("Finish")+"</button>"+"          </div>"+"        </div>"+"      </div>"+"    </div>"),events:{"click button.wizard-next":"nextPage","click button.wizard-back":"prevPage","click button.wizard-cancel":"onCancel","click button.wizard-cancel-event":"onCancel","click button.wizard-maximize-event":"onMaximize","click button.wizard-finish":"finishWizard","click button.wizard-help":"onDialogHelp","click a.close-error":"closeErrorMsg"},initialize:function e(t){this.options=a.extend({},this.options,t.options);this.currPage=this.collection.at(this.options.curr_page).toJSON()},render:function e(){var t=this,i=this.currPage;this.options.disable_next=this.options.disable_next?true:this.evalASFunc(this.currPage.disable_next);this.options.disable_prev=this.options.disable_prev?true:this.evalASFunc(this.currPage.disable_prev);this.options.disable_cancel=this.currPage.canCancel?true:this.evalASFunc(this.currPage.disable_cancel);if(i.html){i.content=i.html}else if(i.view){i.content=i.view.render().el}n(this.el).html(this.tmpl(i));n(this.el).find(".wizard-right-panel_content").html(i.content);this.onLoad();setTimeout(function(){var e=n(t.el);l.findAndSetFocus(e)},100);return this},nextPage:function e(){if(!this.beforeNext()){return false}var t=this.onNext();if(t){this.currPage=this.collection.get(t).toJSON();this.options.curr_page=this.collection.indexOf(this.collection.get(t))}else if(this.options.curr_page<this.collection.length-1){this.options.curr_page=this.options.curr_page+1;this.currPage=this.collection.at(this.options.curr_page).toJSON()}this.enableDisableNext();this.enableDisablePrev();return this.render()},prevPage:function e(){if(!this.beforePrev()){return false}var t=this.onPrev();if(t){this.currPage=this.collection.get(t).toJSON();this.options.curr_page=this.collection.indexOf(this.collection.get(t))}else if(this.options.curr_page>0){this.options.curr_page=this.options.curr_page-1;this.currPage=this.collection.at(this.options.curr_page).toJSON()}this.enableDisableNext();this.enableDisablePrev();return this.render()},finishWizard:function e(){this.onFinish();this.remove();this.off();delete this.$el;delete this.el;return true},enableDisableNext:function e(t){if(typeof t!="undefined"){this.options.disable_next=t}else if(this.options.curr_page>=this.collection.length-1){this.options.disable_next=true}else{this.options.disable_next=false}},enableDisablePrev:function e(t){if(typeof t!="undefined"){this.options.disable_prev=t}else if(this.options.curr_page<=0){this.options.disable_prev=true}else{this.options.disable_prev=false}},closeErrorMsg:function e(){n(this.el).find(".pg-prop-status-bar .alert-text").empty();n(this.el).find(".pg-prop-status-bar").css("visibility","hidden")},beforeNext:function e(){return this.evalASFunc(this.currPage.beforeNext)},beforePrev:function e(){return this.evalASFunc(this.currPage.beforePrev)},onPrev:function e(){return this.evalASFunc(this.currPage.onPrev)},onNext:function e(){return this.evalASFunc(this.currPage.onNext)},onLoad:function e(){return this.evalASFunc(this.currPage.onLoad)},onFinish:function e(){return true},onCancel:function e(){this.$el.remove();return true},onMaximize:function e(){var t=this.options.dialog_api,i=this.$el.find(".wizard-maximize-event");if(!t)return;if(t.isMaximized()){i.removeClass("ajs-maximized");t.restore()}else{i.addClass("ajs-maximized "+i.attr("class"));t.maximize()}},evalASFunc:function e(t,i){var n=this;i=i||n.currPage;return a.isFunction(t)?t.apply(i,[n]):t},onDialogHelp:function e(){window.open(this.options.wizard_help,"pgadmin_help")}});return i}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(10),i(3),i(5),i(9),i(19),i(22),i(18),i(315),i(56),i(6),i(12),i(35)],a=function(h,b,_,e,v,y,w,x,t,i,C,N,n,a){w=w||window.pgAdmin||{};var r=w.Tools=w.Tools||{};if(w.Tools.maintenance)return w.Tools.maintenance;var S=t.Model.extend({defaults:{op:"VACUUM",vacuum_full:false,vacuum_freeze:false,vacuum_analyze:false,verbose:true},initialize:function e(){var t=arguments[1]["node_info"];if("primary_key"in t||"unique_constraint"in t||"index"in t){this.set("op","REINDEX");this.set("verbose",false)}},schema:[{id:"op",label:h("Maintenance operation"),cell:"string",type:"radioModern",controlsClassName:"pgadmin-controls col-12 col-sm-8",controlLabelClassName:"control-label col-sm-4 col-12",group:h("Options"),value:"VACUUM",options:[{label:"VACUUM",value:"VACUUM"},{label:"ANALYZE",value:"ANALYZE"},{label:"REINDEX",value:"REINDEX"},{label:"CLUSTER",value:"CLUSTER"}]},{type:"nested",control:"fieldset",label:h("Vacuum"),group:h("Options"),contentClass:"row",schema:[{id:"vacuum_full",group:h("Vacuum"),disabled:"isDisabled",type:"switch",extraToggleClasses:"pg-el-sm-4",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",label:h("FULL"),deps:["op"]},{id:"vacuum_freeze",deps:["op"],disabled:"isDisabled",type:"switch",extraToggleClasses:"pg-el-sm-4",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",label:h("FREEZE"),group:h("Vacuum")},{id:"vacuum_analyze",deps:["op"],disabled:"isDisabled",type:"switch",extraToggleClasses:"pg-el-sm-4",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",label:h("ANALYZE"),group:h("Vacuum")}]},{id:"verbose",group:h("Options"),deps:["op"],type:"switch",label:h("Verbose Messages"),disabled:"isDisabled"}],isDisabled:function e(t){var i=this.node_info;switch(this.name){case"vacuum_full":case"vacuum_freeze":case"vacuum_analyze":return t.get("op")!="VACUUM";case"verbose":if("primary_key"in i||"unique_constraint"in i||"index"in i){if(t.get("op")=="REINDEX"){setTimeout(function(){t.set("verbose",false)},10);return true}}return t.get("op")=="REINDEX";default:return false}}});r.maintenance={init:function e(){if(this.initialized)return;this.initialized=true;var t=[{name:"maintenance",module:this,applies:["tools"],callback:"callback_maintenance",priority:10,label:h("Maintenance..."),icon:"fa fa-wrench",enable:a.enabled.bind(null,x.treeMenu,n.maintenanceSupportedNodes)}];for(var i=0;i<n.maintenanceSupportedNodes.length;i++){t.push({name:"maintenance_context_"+n.maintenanceSupportedNodes[i],node:n.maintenanceSupportedNodes[i],module:this,applies:["context"],callback:"callback_maintenance",priority:10,label:h("Maintenance..."),icon:"fa fa-wrench",enable:a.enabled.bind(null,x.treeMenu,n.maintenanceSupportedNodes)})}x.add_menus(t)},callback_maintenance:function e(t,i){var n=i||x.tree.selected(),a=null;while(n){var r=x.tree.itemData(n);if(r._type=="server"){a=r;break}if(x.tree.hasParent(n)){n=_(x.tree.parent(n))}else{y.alert(h("Please select server or child node from tree."));break}}if(!a){return}var l="paths",o="pg_bin_dir",s=h("Please configure the PostgreSQL Binary Path in the Preferences dialog.");if(a.type&&a.type=="ppas"||a.server_type=="ppas"){o="ppas_bin_dir";s=h("Please configure the EDB Advanced Server Binary Path in the Preferences dialog.")}var d=x.get_preference(l,o);if(d){if(!d.value){y.alert(h("Configuration required"),s);return}}else{y.alert(v(h("Failed to load preference %s of module %s")).sprintf(o,l).value());return}var u=this,c=x.tree;n=i||c.selected();var p=n&&n.length==1?c.itemData(n):undefined;if(!p)return;var f=p&&x.Nodes[p._type],m=f.getTreeNodeHierarchy.apply(f,[n]);if(m.database._label.indexOf("=")>=0){y.alert(h("Maintenance error"),h("Maintenance job creation failed. "+"Databases with = symbols in the name cannot be maintained using this utility."));return}if(!y.MaintenanceDialog){y.dialog("MaintenanceDialog",function e(){return{main:function e(t){this.set("title",t)},setup:function e(){return{buttons:[{text:"",className:"btn btn-secondary pull-left fa fa-info pg-alertify-icon-button",attrs:{name:"object_help",type:"button",url:"maintenance.html",label:h("Maintenance")}},{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:h("Maintenance"),url:b("help.static",{filename:"maintenance_dialog.html"})}},{text:h("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button","data-btn-name":"cancel"},{text:h("OK"),key:13,className:"btn btn-primary fa fa-lg fa-check pg-alertify-button","data-btn-name":"ok"}],options:{modal:0,pinnable:false,padding:!1,overflow:!1}}},callback:function e(t){var i=x.tree.selected(),n=i&&i.length==1?x.tree.itemData(i):undefined,a=n&&x.Nodes[n._type];if(t.button.element.name=="dialog_help"||t.button.element.name=="object_help"){t.cancel=true;x.showHelp(t.button.element.name,t.button.element.getAttribute("url"),a,i);return}if(t.button["data-btn-name"]==="ok"){var r=undefined,l=undefined,o=undefined,s=undefined,d=undefined;if(!n)return;var c=a.getTreeNodeHierarchy.apply(a,[i]);if(c.schema!=undefined){r=c.schema._label}if(c.partition!=undefined){l=c.partition._label}else if(c.table!=undefined){l=c.table._label}if(c.primary_key!=undefined){o=c.primary_key._label}else if(c.unique_constraint!=undefined){s=c.unique_constraint._label}else if(c.index!=undefined){d=c.index._label}this.view.model.set({database:c.database._label,schema:r,table:l,primary_key:o,unique_constraint:s,index:d});_.ajax({url:b("maintenance.create_job",{sid:c.server._id,did:c.database._id}),method:"POST",data:{data:JSON.stringify(this.view.model.toJSON())}}).done(function(e){if(e.data&&e.data.status){y.success(e.data.info);x.Events.trigger("pgadmin-bgprocess:created",u)}else{y.alert(h("Maintenance job creation failed."),e.errormsg)}}).fail(function(){y.alert(h("Maintenance job creation failed."))})}},build:function e(){y.pgDialogBuild.apply(this)},hooks:{onclose:function e(){if(this.view){this.view.remove({data:true,internal:true,silent:true})}},onshow:function e(){var t=_(this.elements.body).find(".tab-content:first > .tab-pane.active:first");N.findAndSetFocus(t)}},prepare:function e(){var t=_("<div class='maintenance_dlg'></div>");var i=x.tree,n=i.selected(),a=n&&n.length==1?i.itemData(n):undefined,r=a&&x.Nodes[a._type];if(!a)return;var l=r.getTreeNodeHierarchy.apply(r,[n]);var o=new S({},{node_info:l}),s=C.generateViewSchema(l,o,"create",r,l.server,true);var d=this.view=new C.Dialog({el:t,model:o,schema:s});_(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties");d.render();if(a._type=="primary_key"||a._type=="unique_constraint"||a._type=="index"){var c=t.find(".pgadmin-controls label:lt(2)").removeClass("active").addClass("disabled");var u=c[1].nextElementSibling;_(u).addClass("active")}d.$el.attr("tabindex",-1);this.elements.content.appendChild(t.get(0))}}})}var g=b("maintenance.utility_exists",{sid:a._id});_.ajax({url:g,type:"GET"}).done(function(e){if(!e.success){y.alert(h("Utility not found"),e.errormsg);return}y.MaintenanceDialog(h("Maintenance...")).set("resizable",true).resizeTo(w.Browser.stdW.md,w.Browser.stdH.md)}).fail(function(){y.alert(h("Utility not found"),h("Failed to fetch Utility information"));return})}};return w.Tools.maintenance}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.maintenanceSupportedNodes=void 0;var n=["database","table","primary_key","unique_constraint","index","partition"];t.maintenanceSupportedNodes=n},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(10),i(3),i(5),i(9),i(19),i(22),i(18),i(56),i(6),i(12),i(35)],a=function(g,h,b,_,v,y,w,x,e,t,C,N,i){w=w||window.pgAdmin||{};var n=w.Tools=w.Tools||{};if(w.Tools.import_utility)return w.Tools.import_utility;var S=e.Model.extend({defaults:{is_import:false,filename:undefined,format:"csv",encoding:undefined,oid:undefined,header:undefined,delimiter:"",quote:'"',escape:"'",null_string:undefined,columns:null,icolumns:[],database:undefined,schema:undefined,table:undefined},schema:[{id:"is_import",label:g("Import/Export"),cell:"switch",type:"switch",group:g("Options"),options:{onText:g("Import"),offText:g("Export"),width:"65"}},{type:"nested",control:"fieldset",label:g("File Info"),group:g("Options"),schema:[{id:"filename",label:g("Filename"),deps:["is_import"],type:"text",control:C.FileControl,group:g("File Info"),dialog_type:"select_file",supp_types:["csv","txt","*"],visible:"importing"},{id:"filename",label:g("Filename"),deps:["is_import"],type:"text",control:C.FileControl,group:g("File Info"),dialog_type:"create_file",supp_types:["csv","txt","*"],visible:"exporting"},{id:"format",label:g("Format"),cell:"string",control:"select2",group:g("File Info"),options:[{label:"binary",value:"binary"},{label:"csv",value:"csv"},{label:"text",value:"text"}],disabled:"isDisabled",select2:{allowClear:false,width:"100%"}},{id:"encoding",label:g("Encoding"),cell:"string",control:"node-ajax-options",node:"database",url:"get_encodings",first_empty:true,group:g("File Info")}]},{id:"columns",label:g("Columns to import"),cell:"string",deps:["is_import"],type:"array",first_empty:false,control:C.NodeListByNameControl.extend({initialize:function e(){C.NodeListByNameControl.prototype.initialize.apply(this,arguments);var t=this,i=t.field.get("options"),n=[];if(_.isFunction(i)){try{var a=i.apply(t);for(var r in a){n.push(a[r]["value"])}}catch(e){i=[];console.warn(e.stack||e)}}else{for(r in i){n.push(i[r]["value"])}}t.model.set("columns",n)}}),transform:function e(t){var n=this,a=n.field.get("schema_node"),r=[];_.each(t,function(e){if("_id"in e&&e._id>0){var t=_.isFunction(a["node_label"])?a["node_label"].apply(a,[e,n.model,n]):e.label,i=_.isFunction(a["node_image"])?a["node_image"].apply(a,[e,n.model,n]):a["node_image"]||"icon-"+a.type;r.push({value:e.label,image:i,label:t})}});return r},node:"column",url:"nodes",group:g("Columns"),select2:{multiple:true,allowClear:false,placeholder:g("Columns for importing..."),first_empty:false,preserveSelectionOrder:true},visible:"importing",helpMessage:g("An optional list of columns to be copied. If no column list is specified, all columns of the table will be copied.")},{id:"columns",label:g("Columns to export"),cell:"string",deps:["is_import"],type:"array",control:"node-list-by-name",first_empty:false,node:"column",url:"nodes",group:g("Columns"),select2:{multiple:true,allowClear:true,placeholder:g("Colums for exporting..."),preserveSelectionOrder:true},visible:"exporting",transform:function e(t){var n=this,a=n.field.get("schema_node"),r=[];_.each(t,function(e){var t=_.isFunction(a["node_label"])?a["node_label"].apply(a,[e,n.model,n]):e.label,i=_.isFunction(a["node_image"])?a["node_image"].apply(a,[e,n.model,n]):a["node_image"]||"icon-"+a.type;r.push({value:e.label,image:i,label:t})});return r},helpMessage:g("An optional list of columns to be copied. If no column list is specified, all columns of the table will be copied.")},{id:"null_string",label:g("NULL Strings"),cell:"string",type:"text",group:g("Columns"),disabled:"isDisabled",deps:["format"],helpMessage:g("Specifies the string that represents a null value. The default is \\N (backslash-N) in text format, and an unquoted empty string in CSV format. You might prefer an empty string even in text format for cases where you don't want to distinguish nulls from empty strings. This option is not allowed when using binary format.")},{id:"icolumns",label:g("Not null columns"),cell:"string",control:"node-list-by-name",node:"column",group:g("Columns"),deps:["format","is_import"],disabled:"isDisabled",type:"array",first_empty:false,select2:{multiple:true,allowClear:true,first_empty:true,placeholder:g("Not null columns...")},helpMessage:g("Do not match the specified column values against the null string. In the default case where the null string is empty, this means that empty values will be read as zero-length strings rather than nulls, even when they are not quoted. This option is allowed only in import, and only when using CSV format.")},{type:"nested",control:"fieldset",label:g("Miscellaneous"),group:g("Options"),schema:[{id:"oid",label:g("OID"),cell:"string",type:"switch",group:g("Miscellaneous")},{id:"header",label:g("Header"),cell:"string",type:"switch",group:g("Miscellaneous"),deps:["format"],disabled:"isDisabled"},{id:"delimiter",label:g("Delimiter"),cell:"string",first_empty:true,type:"text",control:"node-ajax-options",group:g("Miscellaneous"),disabled:"isDisabled",deps:["format"],options:[{label:";",value:";"},{label:",",value:","},{label:"|",value:"|"},{label:"[tab]",value:"[tab]"}],select2:{tags:true,allowClear:false,width:"100%",placeholder:g("Select from list...")},helpMessage:g("Specifies the character that separates columns within each row (line) of the file. The default is a tab character in text format, a comma in CSV format. This must be a single one-byte character. This option is not allowed when using binary format.")},{id:"quote",label:g("Quote"),cell:"string",first_empty:true,deps:["format"],type:"text",control:"node-ajax-options",group:g("Miscellaneous"),disabled:"isDisabled",options:[{label:'"',value:'"'},{label:"'",value:"'"}],select2:{tags:true,allowClear:false,width:"100%",placeholder:g("Select from list...")},helpMessage:g("Specifies the quoting character to be used when a data value is quoted. The default is double-quote. This must be a single one-byte character. This option is allowed only when using CSV format.")},{id:"escape",label:g("Escape"),cell:"string",first_empty:true,deps:["format"],type:"text",control:"node-ajax-options",group:g("Miscellaneous"),disabled:"isDisabled",options:[{label:'"',value:'"'},{label:"'",value:"'"}],select2:{tags:true,allowClear:false,width:"100%",placeholder:g("Select from list...")},helpMessage:g("Specifies the character that should appear before a data character that matches the QUOTE value. The default is the same as the QUOTE value (so that the quoting character is doubled if it appears in the data). This must be a single one-byte character. This option is allowed only when using CSV format.")}]}],isDisabled:function e(t){switch(this.name){case"quote":case"escape":case"header":return t.get("format")!="csv";case"icolumns":return t.get("format")!="csv"||!t.get("is_import");case"null_string":case"delimiter":return t.get("format")=="binary";default:return false}},importing:function e(t){return t.get("is_import")},exporting:function e(t){return!t.importing.apply(this,arguments)}});n.import_utility={init:function e(){if(this.initialized)return;this.initialized=true;x.add_menus([{name:"import",node:"table",module:this,applies:["tools","context"],callback:"callback_import_export",category:"import",priority:10,label:g("Import/Export..."),icon:"fa fa-shopping-cart",enable:i.enabled.bind(null,x.treeMenu,["table"])}])},callback_import_export:function e(t,i){var n=i||x.tree.selected(),a=null;while(n){var r=x.tree.itemData(n);if(r._type=="server"){a=r;break}if(x.tree.hasParent(n)){n=b(x.tree.parent(n))}else{y.alert(g("Please select server or child node from tree."));break}}if(!a){return}var l="paths",o="pg_bin_dir",s=g("Please configure the PostgreSQL Binary Path in the Preferences dialog.");if(a.type&&a.type=="ppas"||a.server_type=="ppas"){o="ppas_bin_dir";s=g("Please configure the EDB Advanced Server Binary Path in the Preferences dialog.")}var d=x.get_preference(l,o);if(d){if(!d.value){y.alert(g("Configuration required"),s);return}}else{y.alert(v(g("Failed to load preference %s of module %s")).sprintf(o,l).value());return}var c=x.tree;n=i||c.selected();var u=n&&n.length==1?c.itemData(n):undefined,p=u&&x.Nodes[u._type];if(!u)return;var f=p.getTreeNodeHierarchy.apply(p,[n]);if(!y.ImportDialog){y.dialog("ImportDialog",function e(){return{main:function e(t,i,n,a){this.set("title",t);this.setting("pg_node",i);this.setting("pg_item",n);this.setting("pg_item_data",a)},build:function e(){y.pgDialogBuild.apply(this)},setup:function e(){return{buttons:[{text:g("Cancel"),key:27,"data-btn-name":"cancel",className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:g("OK"),key:13,disable:true,"data-btn-name":"ok",className:"btn btn-primary fa fa-lg fa-check pg-alertify-button"}],options:{modal:true,padding:!1,overflow:!1}}},settings:{pg_node:null,pg_item:null,pg_item_data:null},callback:function e(t){if(t.button["data-btn-name"]==="ok"){var i=this.settings["pg_node"],n=this.settings["pg_item"],a=i.getTreeNodeHierarchy.apply(i,[n]);this.view.model.set({database:a.database._label,schema:a.schema._label,table:a.table._label});var r=this;b.ajax({url:h("import_export.create_job",{sid:a.server._id}),method:"POST",data:{data:JSON.stringify(this.view.model.toJSON())}}).done(function(e){if(e.success){y.success(g("Import/export job created."),5);x.Events.trigger("pgadmin-bgprocess:created",r)}else{y.alert(g("Import/export job creation failed."),e.errormsg)}}).fail(function(e){try{var t=JSON.parse(e.responseText);y.alert(g("Import/export job failed."),t.errormsg)}catch(e){console.warn(e.stack||e)}})}},hooks:{onclose:function e(){if(this.view){this.view.remove({data:true,internal:true,silent:true})}},onupdate:function e(t,i,n){switch(t){case"resizable":if(n){this.elements.content.removeAttribute("style")}else{this.elements.content.style.minHeight="inherit"}break}},onshow:function e(){var t=b(this.elements.body).find(".tab-content:first > .tab-pane.active:first");N.findAndSetFocus(t)}},prepare:function e(){var t=this;this.__internal.buttons[1].element.disabled=true;var i=b("<div class='import_dlg'></div>"),n=this.settings.pg_node,a=this.settings.pg_item,r=n.getTreeNodeHierarchy.apply(n,[a]),l=new S({},{node_info:r}),o=C.generateViewSchema(r,l,"create",p,r.server,true),s=this.view=new C.Dialog({el:i,model:l,schema:o});b(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties");s.render();this.elements.content.appendChild(i.get(0));this.view.model.on("change",function(){if(!_.isUndefined(this.get("filename"))&&this.get("filename")!==""){this.errorModel.clear();if(!_.isUndefined(this.get("delimiter"))&&!_.isNull(this.get("delimiter"))){this.errorModel.clear();if(!_.isUndefined(this.get("quote"))&&this.get("quote")!==""&&this.get("quote").length==1){this.errorModel.clear();if(!_.isUndefined(this.get("escape"))&&this.get("escape")!==""&&this.get("escape").length==1){this.errorModel.clear();t.__internal.buttons[1].element.disabled=false}else{t.__internal.buttons[1].element.disabled=true;this.errorModel.set("escape",g("Escape should contain only one character"))}}else{t.__internal.buttons[1].element.disabled=true;this.errorModel.set("quote",g("Quote should contain only one character"))}}else{t.__internal.buttons[1].element.disabled=true;this.errorModel.set("delimiter",g("Delimiter should contain only one character"))}}else{t.__internal.buttons[1].element.disabled=true;this.errorModel.set("filename",g("Please provide filename"))}});s.$el.attr("tabindex",-1);setTimeout(function(){x.keyboardNavigation.getDialogTabNavigator(b(t.elements.dialog))},200)}}})}var m=h("import_export.utility_exists",{sid:a._id});b.ajax({url:m,type:"GET"}).done(function(e){if(!e.success){y.alert(g("Utility not found"),e.errormsg);return}y.ImportDialog(v(g("Import/Export data - table '%s'")).sprintf(f.table.label).value(),p,n,u).set("resizable",true).resizeTo(w.Browser.stdW.md,w.Browser.stdH.lg)}).fail(function(){y.alert(g("Utility not found"),g("Failed to fetch Utility information"));return})}};return w.Tools.import_utility}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(17),i(3),i(5),i(9),i(12),i(15),i(6),i(83),i(84),i(21),i(194)],a=function(u,p,f,o,s,m,e,g,t,i,n,a,h,b){var r=e.Tools=e.Tools||{},_=window.wcDocker;if(e.Tools.Debugger)return e.Tools.Debugger;r.Debugger={init:function e(){if(this.initialized)return;this.initialized=true;g.add_menus([{name:"direct_debugger",node:"function",module:this,applies:["object","context"],callback:"get_function_information",category:u("Debugging"),priority:10,label:u("Debug"),data:{object:"function"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"global_debugger",node:"function",module:this,applies:["object","context"],callback:"check_func_debuggable",category:u("Debugging"),priority:10,label:u("Set breakpoint"),data:{object:"function",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"procedure_direct_debugger",node:"procedure",module:this,applies:["object","context"],callback:"get_function_information",category:u("Debugging"),priority:10,label:u("Debug"),data:{object:"procedure"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"procedure_indirect_debugger",node:"procedure",module:this,applies:["object","context"],callback:"check_func_debuggable",category:u("Debugging"),priority:10,label:u("Set breakpoint"),data:{object:"procedure",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"trigger_function_indirect_debugger",node:"trigger_function",module:this,applies:["object","context"],callback:"check_func_debuggable",priority:10,label:u("Set breakpoint"),category:u("Debugging"),icon:"fa fa-arrow-circle-right",data:{object:"trigger_function",debug_type:"indirect"},enable:"can_debug"},{name:"trigger_indirect_debugger",node:"trigger",module:this,applies:["object","context"],callback:"check_func_debuggable",priority:10,label:u("Set breakpoint"),category:u("Debugging"),icon:"fa fa-arrow-circle-right",data:{object:"trigger",debug_type:"indirect"},enable:"can_debug"},{name:"package_function_direct_debugger",node:"edbfunc",module:this,applies:["object","context"],callback:"get_function_information",category:u("Debugging"),priority:10,label:u("Debug"),data:{object:"edbfunc"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"package_function_global_debugger",node:"edbfunc",module:this,applies:["object","context"],callback:"check_func_debuggable",category:u("Debugging"),priority:10,label:u("Set breakpoint"),data:{object:"edbfunc",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"package_procedure_direct_debugger",node:"edbproc",module:this,applies:["object","context"],callback:"get_function_information",category:u("Debugging"),priority:10,label:u("Debug"),data:{object:"edbproc"},icon:"fa fa-arrow-circle-right",enable:"can_debug"},{name:"package_procedure_global_debugger",node:"edbproc",module:this,applies:["object","context"],callback:"check_func_debuggable",category:u("Debugging"),priority:10,label:u("Set breakpoint"),data:{object:"edbproc",debug_type:"indirect"},icon:"fa fa-arrow-circle-right",enable:"can_debug"}]);this.frame=new g.Frame({name:"frm_debugger",title:u("Debugger"),width:500,isCloseable:true,isPrivate:true,icon:"fa fa-bug",url:"about:blank"});this.frame.load(g.docker);var t=this;var i=setInterval(function(){if(g.preference_version()>0){t.preferences=g.get_preferences_for_module("debugger");clearInterval(i)}},0);g.onPreferencesChange("debugger",function(){t.preferences=g.get_preferences_for_module("debugger")})},can_debug:function e(t,i,n){var a=g.tree,r=i,l=t;while(r){if("catalog"==l._type){return false}r=a.hasParent(r)?a.parent(r):null;l=r?a.itemData(r):null}var o=g.tree,s=o.selected(),d=s&&s.length==1?o.itemData(s):undefined,c=d&&g.Nodes[d._type];if(!d)return false;var u=c.getTreeNodeHierarchy.apply(c,[s]);if(n&&n.debug_type&&n.debug_type=="indirect"&&!u.server.user.is_superuser)return false;var p=u.function&&u.function.funcowner||u.procedure&&u.procedure.funcowner||u.edbfunc&&u.edbfunc.funcowner||u.edbproc&&u.edbproc.funcowner;if(!(u.server.user.is_superuser||p==u.server.user.name))return false;if(d.language==undefined&&d._type=="trigger"||d.language==undefined&&d._type=="edbfunc"||d.language==undefined&&d._type=="edbproc"){return true}if(d.language!="plpgsql"&&d.language!="edbspl"){return false}return true},generate_url:function e(t,i,n){var a="{BASEURL}{URL}/{OBJTYPE}{REF}",r="";o.each(o.sortBy(o.values(o.pick(i,function(e,t){return t!="server_group"})),function(e){return e.priority}),function(e){r=s("%s/%s").sprintf(r,encodeURI(e._id)).value()});var l={URL:t,BASEURL:p("debugger.index"),REF:r,OBJTYPE:encodeURI(n.type)};return a.replace(/{(\w+)}/g,function(e,t){return l[t]})},check_func_debuggable:function e(t,i){var n=g.tree,a=i||n.selected(),r=a&&a.length==1?n.itemData(a):undefined,l=r&&g.Nodes[r._type];if(!r)return;var o=l.getTreeNodeHierarchy.apply(l,[a]),s=this.generate_url("init",o,l);var d=this;f.ajax({url:s,cache:false}).done(function(){d.start_global_debugger()}).fail(function(e){try{var t=JSON.parse(e.responseText);if(t.success==0){m.alert(u("Debugger Error"),t.errormsg)}}catch(e){console.warn(e.stack||e)}})},start_global_debugger:function e(t,i){var n=g.tree,a=i||n.selected(),r=a&&a.length==1?n.itemData(a):undefined,l=r&&g.Nodes[r._type],o=this;if(!r)return;var s=l.getTreeNodeHierarchy.apply(l,[a]),d;if(r._type=="function"){d=p("debugger.initialize_target_for_function",{debug_type:"indirect",sid:s.server._id,did:s.database._id,scid:s.schema._id,func_id:s.function._id})}else if(r._type=="procedure"){d=p("debugger.initialize_target_for_function",{debug_type:"indirect",sid:s.server._id,did:s.database._id,scid:s.schema._id,func_id:b.getProcedureId(s)})}else if(r._type=="edbfunc"){d=p("debugger.initialize_target_for_function",{debug_type:"indirect",sid:s.server._id,did:s.database._id,scid:s.schema._id,func_id:s.edbfunc._id})}else if(r._type=="edbproc"){d=p("debugger.initialize_target_for_function",{debug_type:"indirect",sid:s.server._id,did:s.database._id,scid:s.schema._id,func_id:s.edbproc._id})}else if(r._type=="trigger_function"){d=p("debugger.initialize_target_for_function",{debug_type:"indirect",sid:s.server._id,did:s.database._id,scid:s.schema._id,func_id:s.trigger_function._id})}else if(r._type=="trigger"&&"table"in s){d=p("debugger.initialize_target_for_trigger",{debug_type:"indirect",sid:s.server._id,did:s.database._id,scid:s.schema._id,func_id:s.table._id,tri_id:s.trigger._id})}else if(r._type=="trigger"&&"view"in s){d=p("debugger.initialize_target_for_trigger",{debug_type:"indirect",sid:s.server._id,did:s.database._id,scid:s.schema._id,func_id:s.view._id,tri_id:s.trigger._id})}f.ajax({url:d,method:"GET"}).done(function(t){var i=p("debugger.direct",{trans_id:t.data.debuggerTransId});if(o.preferences.debugger_new_browser_tab){window.open(i,"_blank")}else{g.Events.once("pgadmin-browser:frame:urlloaded:frm_debugger",function(e){e.openURL(i)});var e=g.docker.findPanels("properties"),n=g.docker.addPanel("frm_debugger",_.DOCK.STACKED,e[0]);n.focus();n.on(_.EVENT.CLOSED,function(){var e=p("debugger.close",{trans_id:t.data.debuggerTransId});f.ajax({url:e,method:"DELETE"})})}}).fail(function(e){try{var t=JSON.parse(e.responseText);if(t.success==0){m.alert(u("Debugger Error"),t.errormsg)}}catch(e){console.warn(e.stack||e)}})},get_function_information:function e(t,i){var n=g.tree,a=i||n.selected(),r=a&&a.length==1?n.itemData(a):undefined,l=r&&g.Nodes[r._type],o=this,s=r._type=="edbproc";if(!r)return;var d=l.getTreeNodeHierarchy.apply(l,[a]),c=this.generate_url("init",d,l);f.ajax({url:c,cache:false}).done(function(e){if(e.data[0]["require_input"]){h(e.data[0],0,s)}else{var t=g.tree,i=t.selected(),n=i&&i.length==1?t.itemData(i):undefined,a=n&&g.Nodes[n._type];if(!n)return;var r=a.getTreeNodeHierarchy.apply(a,[i]),l;if(n._type=="function"){l=p("debugger.initialize_target_for_function",{debug_type:"direct",sid:r.server._id,did:r.database._id,scid:r.schema._id,func_id:r.function._id})}else{l=p("debugger.initialize_target_for_function",{debug_type:"direct",sid:r.server._id,did:r.database._id,scid:r.schema._id,func_id:b.getProcedureId(r)})}f.ajax({url:l,method:"GET"}).done(function(t){var i=p("debugger.direct",{trans_id:t.data.debuggerTransId});if(o.preferences.debugger_new_browser_tab){window.open(i,"_blank")}else{g.Events.once("pgadmin-browser:frame:urlloaded:frm_debugger",function(e){e.openURL(i)});var e=g.docker.findPanels("properties"),n=g.docker.addPanel("frm_debugger",_.DOCK.STACKED,e[0]);n.focus();n.on(_.EVENT.CLOSED,function(){var e=p("debugger.close",{trans_id:t.data.debuggerTransId});f.ajax({url:e,method:"DELETE"})})}}).fail(function(e){m.alert(u("Debugger Target Initialization Error"),e.responseJSON.errormsg)})}}).fail(function(e){try{var t=JSON.parse(e.responseText);if(t.success==0){m.alert(u("Debugger Error"),t.errormsg)}}catch(e){console.warn(e.stack||e)}})}};return e.Tools.Debugger}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(10),i(319),i(320)],a=function(n,e,o,a,t,i,s,d){if(!s.Nodes["coll-pga_job"]){s.Nodes["coll-pga_job"]=s.Collection.extend({node:"pga_job",label:n("pga_jobs"),type:"coll-pga_job",columns:["jobid","jobname","jobenabled","jlgstatus","jobnextrun","joblastrun","jobdesc"],hasStatistics:false,canDrop:true,canDropCascade:false})}if(!s.Nodes["pga_job"]){s.Nodes["pga_job"]=s.Node.extend({parent_type:"server",type:"pga_job",dialogHelp:e("help.static",{filename:"pgagent_jobs.html"}),hasSQL:true,hasDepends:false,hasStatistics:true,hasCollectiveStatistics:true,width:"80%",height:"80%",canDrop:true,label:n("pgAgent Job"),node_image:function e(){return"icon-pga_job"},Init:function e(){if(this.initialized)return;this.initialized=true;s.add_menus([{name:"create_pga_job_on_coll",node:"coll-pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("pgAgent Job..."),icon:"wcTabIcon icon-pga_job",data:{action:"create"}},{name:"create_pga_job",node:"pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:n("pgAgent Job..."),icon:"wcTabIcon icon-pga_job",data:{action:"create"}},{name:"run_now_pga_job",node:"pga_job",module:this,applies:["object","context"],callback:"run_pga_job_now",priority:4,label:n("Run now"),data:{action:"create"},icon:"fa fa-play-circle"}])},model:s.Node.Model.extend({defaults:{jobname:"",jobid:undefined,jobenabled:true,jobhostagent:"",jobjclid:1,jobcreated:undefined,jobchanged:undefined,jobnextrun:undefined,joblastrun:undefined,jlgstatus:undefined,jobrunningat:undefined,jobdesc:"",jsteps:[],jschedules:[]},idAttribute:"jobid",parse:function e(){var t=s.Node.Model.prototype.parse.apply(this,arguments);if(t){t.jobrunningat=t.jaghostagent||n("Not running currently.");t.jlgstatus=t.jlgstatus||n("Unknown")}return t},schema:[{id:"jobname",label:n("Name"),type:"text",cellHeaderClasses:"width_percent_30"},{id:"jobid",label:n("ID"),mode:["properties"],type:"int"},{id:"jobenabled",label:n("Enabled?"),type:"switch",cellHeaderClasses:"width_percent_5"},{id:"jobclass",label:n("Job class"),type:"text",mode:["properties"]},{id:"jobjclid",label:n("Job class"),type:"int",control:"node-ajax-options",url:"classes",url_with_id:false,cache_node:"server",mode:["create","edit"],select2:{allowClear:false},helpMessage:n("Please select a class to categorize the job. This option will not affect the way the job runs.")},{id:"jobhostagent",label:n("Host agent"),type:"text",mode:["edit","create"],helpMessage:n("Enter the hostname of a machine running pgAgent if you wish to ensure only that machine will run this job. Leave blank if any host may run the job.")},{id:"jobhostagent",label:n("Host agent"),type:"text",mode:["properties"]},{id:"jobcreated",type:"text",mode:["properties"],label:n("Created")},{id:"jobchanged",type:"text",mode:["properties"],label:n("Changed")},{id:"jobnextrun",type:"text",mode:["properties"],label:n("Next run"),cellHeaderClasses:"width_percent_20"},{id:"joblastrun",type:"text",mode:["properties"],label:n("Last run"),cellHeaderClasses:"width_percent_20"},{id:"jlgstatus",type:"text",label:n("Last result"),cellHeaderClasses:"width_percent_5",mode:["properties"]},{id:"jobrunningat",type:"text",mode:["properties"],label:n("Running at")},{id:"jobdesc",label:n("Comment"),type:"multiline",cellHeaderClasses:"width_percent_15"},{id:"jsteps",label:"",group:n("Steps"),type:"collection",mode:["edit","create"],model:s.Nodes["pga_jobstep"].model,canEdit:true,control:"sub-node-collection",canAdd:true,canDelete:true,showError:false,columns:["jstname","jstenabled","jstkind","jstconntype","jstonerror"]},{id:"jschedules",label:"",group:n("Schedules"),type:"collection",mode:["edit","create"],control:"sub-node-collection",canAdd:true,canDelete:true,canEdit:true,model:s.Nodes["pga_schedule"].model,showError:false,columns:["jscname","jscenabled","jscstart","jscend"]}],validate:function e(){var t=this.get("jobname");if(a.isUndefined(t)||a.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){var i=n("Name cannot be empty.");this.errorModel.set("jobname",i);return i}else{this.errorModel.unset("jobname")}return null}}),run_pga_job_now:function e(t){var i=t||{},n=this,a=s.tree,r=i.item||a.selected(),l=r&&r.length==1?a.itemData(r):undefined;if(!l)return false;o.ajax({url:n.generate_url(r,"run_now",l,true),method:"PUT"}).done(function(){a.unload(r)}).fail(function(e,t,i){d.pgRespErrorNotify(e,i);a.unload(r)});return false}})}return s.Nodes["pga_job"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(5),i(17),i(22),i(19),i(6),i(12)],a=function(o,e,t,s,d,i,n,a,r,l){if(!n.Nodes["coll-pga_jobstep"]){n.Nodes["coll-pga_jobstep"]=n.Collection.extend({node:"pga_jobstep",label:o("Steps"),type:"coll-pga_jobstep",columns:["jstid","jstname","jstenabled","jstkind","jstconntype","jstonerror"],hasStatistics:false})}var c=l.Extension.SwitchCell.extend({initialize:function e(){l.Extension.SwitchCell.prototype.initialize.apply(this,arguments);l.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){var t=this.model,i=this.column,n=this.column.get("editable"),a=this.$el.find("input[type=checkbox]").first(),r=i.get("name"),l;l=s.isFunction(n)?!!n.apply(i,[t]):!!n;if(l){this.$el.addClass("editable");a.bootstrapSwitch("disabled",false)}else{this.$el.removeClass("editable");a.bootstrapSwitch("disabled",true);setTimeout(function(){t.set(r,true)},10)}this.delegateEvents();return this},remove:l.Extension.DependentCell.prototype.remove});if(!n.Nodes["pga_jobstep"]){n.Nodes["pga_jobstep"]=n.Node.extend({parent_type:"pga_job",type:"pga_jobstep",dialogHelp:e("help.static",{filename:"pgagent_jobs.html"}),hasSQL:true,hasDepends:false,hasStatistics:true,hasCollectiveStatistics:true,width:"70%",height:"80%",canDrop:true,label:o("Step"),node_image:function e(){return"icon-pga_jobstep"},Init:function e(){if(this.initialized)return;this.initialized=true;n.add_menus([{name:"create_pga_jobstep_on_job",node:"pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Job Step..."),data:{action:"create"},icon:"wcTabIcon icon-pga_jobstep"},{name:"create_pga_jobstep_on_coll",node:"coll-pga_jobstep",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Job Step..."),data:{action:"create"},icon:"wcTabIcon icon-pga_jobstep"},{name:"create_pga_jobstep",node:"pga_jobstep",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:o("Job Step..."),data:{action:"create"},icon:"wcTabIcon icon-pga_jobstep"}])},model:n.Node.Model.extend({defaults:{jstid:null,jstjobid:null,jstname:"",jstdesc:"",jstenabled:true,jstkind:true,jstconntype:true,jstcode:"",jstconnstr:null,jstdbname:null,jstonerror:"f",jstnextrun:""},initialize:function e(){n.Node.Model.prototype.initialize.apply(this,arguments);if(this.isNew()&&this.get("jstconntype")){var t=arguments&&arguments.length>1&&arguments[1];if(t){this.set("jstdbname",(t["node_info"]||t.collection.top["node_info"])["server"]["db"])}}},idAttribute:"jstid",schema:[{id:"jstid",label:o("ID"),type:"int",cellHeaderClasses:"width_percent_5",mode:["properties"]},{id:"jstname",label:o("Name"),type:"text",disabled:false,cellHeaderClasses:"width_percent_60"},{id:"jstenabled",label:o("Enabled?"),type:"switch",disabled:function e(){return false}},{id:"jstkind",label:o("Kind"),type:"switch",options:{onText:o("SQL"),offText:o("Batch"),onColor:"primary",offColor:"primary"},control:r.SwitchControl,disabled:function e(){return false}},{id:"jstconntype",label:o("Connection type"),type:"switch",deps:["jstkind"],mode:["properties"],disabled:function e(t){return!t.get("jstkind")},options:{onText:o("Local"),offText:o("Remote"),onColor:"primary",offColor:"primary",width:"65"}},{id:"jstconntype",label:o("Connection type"),type:"switch",deps:["jstkind"],mode:["create","edit"],disabled:function e(t){return!t.get("jstkind")},cell:c,editable:function e(t){return t.get("jstkind")},options:{onText:o("Local"),offText:o("Remote"),onColor:"primary",offColor:"primary",width:"65"},helpMessage:o("Select <b>Local</b> if the job step will execute on the local database server, or <b>Remote</b> to specify a remote database server.")},{id:"jstdbname",label:o("Database"),type:"text",mode:["properties"],disabled:function e(){return false}},{id:"jstconnstr",type:"text",mode:["properties"],label:o("Connection string")},{id:"jstdbname",label:o("Database"),type:"text",control:"node-list-by-name",node:"database",cache_node:"database",select2:{allowClear:true,placeholder:""},disabled:function e(t){return!t.get("jstkind")||!t.get("jstconntype")},deps:["jstkind","jstconntype"],mode:["create","edit"],helpMessage:o("Please select the database on which the job step will run.")},{id:"jstconnstr",label:o("Connection string"),type:"text",deps:["jstkind","jstconntype"],disabled:function e(t){return!t.get("jstkind")||t.get("jstconntype")},helpMessage:d(o("Please specify the connection string for the remote database server. Each parameter setting is in the form keyword = value. Spaces around the equal sign are optional. To write an empty value, or a value containing spaces, surround it with single quotes, e.g., keyword = 'a value'. Single quotes and backslashes within the value must be escaped with a backslash, i.e., ' and \\.<br>For more information, please see the documentation on %s")).sprintf('<a href="https://www.postgresql.org/docs/current/libpq-connect.html#LIBPQ-CONNSTRING" target="_blank">libpq connection strings</a>').value(),mode:["create","edit"]},{id:"jstonerror",label:o("On error"),cell:"select2",control:"select2",options:[{label:o("Fail"),value:"f"},{label:o("Success"),value:"s"},{label:o("Ignore"),value:"i"}],select2:{allowClear:false},disabled:function e(){return false}},{id:"jstdesc",label:o("Comment"),type:"multiline"},{id:"jstcode",label:"",cell:"string",deps:["jstkind"],type:"text",group:o("Code"),control:r.SqlFieldControl.extend({render:function e(){if(this.model.get("jstkind")){this.field.set("label",o("SQL query"))}else{this.field.set("label",o("Script"))}return r.SqlFieldControl.prototype.render.apply(this,arguments)}})}],validate:function e(){var t=this.get("jstname"),i=null,n;if(s.isUndefined(t)||s.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){i=o("Name cannot be empty.");this.errorModel.set("jstname",i)}else{this.errorModel.unset("jstname")}if(this.get("jstkind")){if(this.get("jstconntype")){this.errorModel.unset("jstconnstr");t=this.get("jstdbname");if(s.isUndefined(t)||s.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){n=o("Please select a database.");i=i||n;this.errorModel.set("jstdbname",n)}else{this.errorModel.unset("jstdbname")}}else{this.errorModel.unset("jstdbname");var a=/\s*\b(\w+)\s*=\s*('([^'\\]*(?:\\.[^'\\]*)*)'|[\w|\.]*)/g;t=this.get("jstconnstr");if(s.isUndefined(t)||s.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){n=o("Please enter a connection string.")}else if(String(t).replace(a,"")!=""){n=o("Please enter a valid connection string.")}else{var r,l={host:true,hostaddr:true,port:true,dbname:true,user:true,password:true,connect_timeout:true,client_encoding:true,application_name:true,options:true,fallback_application_name:true,sslmode:true,sslcert:true,sslkey:true,sslrootcert:true,sslcrl:true,keepalives:true,service:true,keepalives_idle:true,keepalives_interval:true,keepalives_count:true,sslcompression:true,requirepeer:true,krbsrvname:true,gsslib:true};while(r=a.exec(t)){if(l[r[1]]){if(r[2])continue;n=o("Please enter a valid connection string.");break}n=d(o("Invalid parameter in the connection string - %s.")).sprintf(r[1]).value();break}}if(n){i=i||n;this.errorModel.set("jstconnstr",n)}else{this.errorModel.unset("jstconnstr")}}}else{this.errorModel.unset("jstconnstr");this.errorModel.unset("jstdbname")}t=this.get("jstcode");if(s.isUndefined(t)||s.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){n=o("Please specify code to execute.");i=i||n;this.errorModel.set("jstcode",n)}else{this.errorModel.unset("jstcode")}t=this.get("jstonerror");if(!s.isUndefined(t)&&!s.isNull(t)&&String(t).replace(/^\s+|\s+$/g,"")==""){n=o("Please select valid on error option .");this.errorModel.set("jstonerror",n)}else{this.errorModel.unset("jstonerror")}return i}})})}return n.Nodes["pga_job"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";var n,a;!(n=[i(2),i(4),i(0),i(1),i(8),i(3),i(48),i(5),i(17),i(6),i(12)],a=function(s,e,t,d,i,n,c,a,r,l,o){if(!a.Nodes["coll-pga_schedule"]){a.Nodes["coll-pga_schedule"]=a.Collection.extend({node:"pga_schedule",label:s("Schedules"),type:"coll-pga_schedule",columns:["jscid","jscname","jscenabled"],hasStatistics:false})}if(!a.Nodes["pga_schedule"]){var u=[s("Sunday"),s("Monday"),s("Tuesday"),s("Wednesday"),s("Thursday"),s("Friday"),s("Saturday")],p=[s("1st"),s("2nd"),s("3rd"),s("4th"),s("5th"),s("6th"),s("7th"),s("8th"),s("9th"),s("10th"),s("11th"),s("12th"),s("13th"),s("14th"),s("15th"),s("16th"),s("17th"),s("18th"),s("19th"),s("20th"),s("21st"),s("22nd"),s("23rd"),s("24th"),s("25th"),s("26th"),s("27th"),s("28th"),s("29th"),s("30th"),s("31st"),s("Last day")],f=[s("January"),s("February"),s("March"),s("April"),s("May"),s("June"),s("July"),s("August"),s("September"),s("October"),s("November"),s("December")],m=[s("00"),s("01"),s("02"),s("03"),s("04"),s("05"),s("06"),s("07"),s("08"),s("09"),s("10"),s("11"),s("12"),s("13"),s("14"),s("15"),s("16"),s("17"),s("18"),s("19"),s("20"),s("21"),s("22"),s("23")],g=[s("00"),s("01"),s("02"),s("03"),s("04"),s("05"),s("06"),s("07"),s("08"),s("09"),s("10"),s("11"),s("12"),s("13"),s("14"),s("15"),s("16"),s("17"),s("18"),s("19"),s("20"),s("21"),s("22"),s("23"),s("24"),s("25"),s("26"),s("27"),s("28"),s("29"),s("30"),s("31"),s("32"),s("33"),s("34"),s("35"),s("36"),s("37"),s("38"),s("39"),s("40"),s("41"),s("42"),s("43"),s("44"),s("45"),s("46"),s("47"),s("48"),s("49"),s("50"),s("51"),s("52"),s("53"),s("54"),s("55"),s("56"),s("57"),s("58"),s("59")],h=o.Extension.MomentCell.extend({editor:o.Extension.DatetimePickerEditor,render:function e(){this.$el.empty();var t=this.model;this.$el.text(this.formatter.fromRaw(t.get(this.column.get("name")),t)||s("<any>"));this.delegateEvents();return this}}),b=o.Extension.MomentCell.extend({editor:o.Extension.DatetimePickerEditor}),_=function e(t,i){var a=this;a.selector=t;a.indexes=i;this.fromRaw=function(e){if(!d.isArray(e)){return e}var t=[],i=0,n=[];for(;i<e.length;i++){if(!e[i])continue;t.push(a.selector[i]);n.push(i+1)}return a.indexes?n:t.join(", ")};this.toRaw=function(e){if(!a.indexes)return e;var t=[],i=0,n=a.selector.length;for(;i<n;i++){t.push(d.indexOf(e,String(i+1))!=-1)}return t};return a},v=function e(t){var i=t.field.get("selector"),n=t.model.get(t.field.get("name")),a=[];if(i){a=d.map(i,function(e,t){return{label:e,value:t+1,selected:n[t]}})}return a},y=a.Node.Model.extend({defaults:{jexid:undefined,jexdate:null,jextime:null},idAttribute:"jexid",schema:[{id:"jexdate",type:"text",label:s("Date"),editable:true,placeholder:s("<any>"),cell:h,options:{format:"YYYY-MM-DD"},displayFormat:"YYYY-MM-DD",modelFormat:"YYYY-MM-DD",cellHeaderClasses:"width_percent_50",allowEmpty:true},{id:"jextime",type:"text",placeholder:s("<any>"),label:s("Time"),editable:true,cell:h,options:{format:"HH:mm",buttons:{showToday:false}},displayFormat:"HH:mm",modelFormat:"HH:mm:ss",displayInUTC:true,allowEmpty:true,cellHeaderClasses:"width_percent_50",modalInUTC:true}],validate:function e(){var t=this,i=this.collection,n,a=false,r=this.get("jexdate")||"<any>",l=this.get("jextime")||"<any>",o=this.get("jexid")||this.cid;t.errorModel.unset("jscdate");if(r==l&&r=="<any>"){n=s("Please specify date/time.");t.errorModel.set("jscdate",n);return n}i.each(function(e){if(a||o==(e.get("jexid")||e.cid))return;if(r==(e.get("jexdate")||"<any>")&&l==(e.get("jextime")||"<any>")){n=s("Please specify unique set of exceptions.");if(e.errorModel.get("jscdate")!=n)t.errorModel.set("jscdate",n);a=true}});return n}});var w=l.Control.extend({template:d.template(["<div>","  <%=infotext%>","</div>"].join("\n")),className:"pgadmin-control-group"});a.Nodes["pga_schedule"]=a.Node.extend({parent_type:"pga_job",type:"pga_schedule",dialogHelp:e("help.static",{filename:"pgagent_jobs.html"}),hasSQL:true,hasDepends:false,hasStatistics:false,canDrop:true,label:s("Schedule"),node_image:"icon-pga_schedule",Init:function e(){if(this.initialized)return;this.initialized=true;a.add_menus([{name:"create_pga_schedule_on_job",node:"pga_job",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Schedule..."),icon:"wcTabIcon icon-pga_schedule",data:{action:"create"}},{name:"create_pga_schedule_on_coll",node:"coll-pga_schedule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Schedule..."),icon:"wcTabIcon icon-pga_schedule",data:{action:"create"}},{name:"create_pga_schedule",node:"pga_schedule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:s("Schedule..."),icon:"wcTabIcon icon-pga_schedule",data:{action:"create"}}])},model:a.Node.Model.extend({defaults:{jscid:null,jscjobid:null,jscname:"",jscdesc:"",jscenabled:true,jscstart:null,jscend:null,jscweekdays:d.map(u,function(){return false}),jscmonthdays:d.map(p,function(){return false}),jscmonths:d.map(f,function(){return false}),jschours:d.map(m,function(){return false}),jscminutes:d.map(g,function(){return false}),jscexceptions:[]},idAttribute:"jscid",parse:function e(t){t.jscexceptions=[];if(t.jexid&&t.jexid.length){var i=0;for(;i<t.jexid.length;i++){t.jscexceptions.push({jexid:t.jexid[i],jexdate:t.jexdate[i],jextime:t.jextime[i]})}}delete t.jexid;delete t.jexdate;delete t.jextime;return a.Node.Model.prototype.parse.apply(this,arguments)},schema:[{id:"jscid",label:s("ID"),type:"int",cellHeaderClasses:"width_percent_5",mode:["properties"]},{id:"jscname",label:s("Name"),type:"text",cellHeaderClasses:"width_percent_45",disabled:function e(){return false}},{id:"jscenabled",label:s("Enabled?"),type:"switch",disabled:function e(){return false},cellHeaderClasses:"width_percent_5"},{id:"jscstart",label:s("Start"),type:"text",control:"datetimepicker",cell:b,disabled:function e(){return false},displayInUTC:false,displayFormat:"YYYY-MM-DD HH:mm:ss Z",modelFormat:"YYYY-MM-DD HH:mm:ss Z",options:{format:"YYYY-MM-DD HH:mm:ss Z",minDate:c().add(0,"m")},cellHeaderClasses:"width_percent_25"},{id:"jscend",label:s("End"),type:"text",control:"datetimepicker",cell:b,disabled:function e(){return false},displayInUTC:false,displayFormat:"YYYY-MM-DD HH:mm:ss Z",options:{format:"YYYY-MM-DD HH:mm:ss Z",minDate:c().add(0,"m")},cellHeaderClasses:"width_percent_25",modelFormat:"YYYY-MM-DD HH:mm:ss Z"},{id:"jscweekdays",label:s("Week days"),type:"text",control:l.Control.extend({formatter:new _(u,false)}),mode:["properties"]},{id:"jscmonthdays",label:s("Month days"),type:"text",control:l.Control.extend({formatter:new _(p,false)}),mode:["properties"]},{id:"jscmonths",label:s("Months"),type:"text",control:l.Control.extend({formatter:new _(f,false)}),mode:["properties"]},{id:"jschours",label:s("Hours"),type:"text",control:l.Control.extend({formatter:new _(m,false)}),mode:["properties"]},{id:"jscminutes",label:s("Minutes"),type:"text",control:l.Control.extend({formatter:new _(g,false)}),mode:["properties"]},{id:"jscexceptions",label:s("Exceptions"),type:"text",control:l.Control.extend({formatter:new function(){this.fromRaw=function(e){var t="",i=0,n;if(!e){return t}for(;i<e.length;i++){n=e[i];if(i)t+=", ";t+="["+String((n.jexdate||"")+" "+(n.jextime||"")).replace(/^\s+|\s+$/g,"")+"]"}return t};this.toRaw=function(e){return e};return this}}),mode:["properties"]},{type:"control",mode:["create","edit"],group:s("Repeat"),infotext:s("Schedules are specified using a <b>cron-style</b> format.<br/><ul><li>For each selected time or date element, the schedule will execute.<br/>e.g. To execute at 5 minutes past every hour, simply select 05 in the Minutes list box.<br/></li><li>Values from more than one field may be specified in order to further control the schedule.<br/>e.g. To execute at 12:05 and 14:05 every Monday and Thursday, you would click minute 05, hours 12 and 14, and weekdays Monday and Thursday.</li><li>For additional flexibility, the Month Days check list includes an extra Last Day option. This matches the last day of the month, whether it happens to be the 28th, 29th, 30th or 31st.</li></ul>"),control:w},{type:"nested",label:s("Days"),group:s("Repeat"),mode:["create","edit"],control:l.FieldsetControl.extend({render:function e(){var t=l.FieldsetControl.prototype.render.apply(this,arguments);return t}}),schema:[{id:"jscweekdays",label:s("Week Days"),cell:"select2",group:s("Days"),control:"select2",type:"array",select2:{first_empty:false,multiple:true,allowClear:true,placeholder:s("Select the weekdays..."),width:"style",dropdownAdapter:t.fn.select2.amd.require("select2/selectAllAdapter")},selector:u,formatter:new _(u,true),options:v},{id:"jscmonthdays",label:s("Month Days"),cell:"select2",group:s("Days"),control:"select2",type:"array",select2:{first_empty:false,multiple:true,allowClear:true,placeholder:s("Select the month days..."),width:"style",dropdownAdapter:t.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(p,true),selector:p,options:v},{id:"jscmonths",label:s("Months"),cell:"select2",group:s("Days"),control:"select2",type:"array",select2:{first_empty:false,multiple:true,allowClear:true,placeholder:s("Select the months..."),width:"style",dropdownAdapter:t.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(f,true),selector:f,options:v}]},{type:"nested",control:"fieldset",label:s("Times"),group:s("Repeat"),mode:["create","edit"],schema:[{id:"jschours",label:s("Hours"),cell:"select2",group:s("Times"),control:"select2",type:"array",select2:{first_empty:false,multiple:true,allowClear:true,placeholder:s("Select the hours..."),width:"style",dropdownAdapter:t.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(m,true),selector:m,options:v},{id:"jscminutes",label:s("Minutes"),cell:"select2",group:s("Times"),control:"select2",type:"array",select2:{first_empty:false,multiple:true,allowClear:true,placeholder:s("Select the minutes..."),width:"style",dropdownAdapter:t.fn.select2.amd.require("select2/selectAllAdapter")},formatter:new _(g,true),selector:g,options:v}]},{id:"jscexceptions",type:"collection",mode:["edit","create"],label:"",canEdit:false,model:y,canAdd:true,group:s("Exceptions"),canDelete:true,cols:["jexdate","jextime"],control:"sub-node-collection"},{id:"jscdesc",label:s("Comment"),type:"multiline"}],validate:function e(){var t=this.get("jscname"),i=null,n;if(d.isUndefined(t)||d.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){n=s("Name cannot be empty.");this.errorModel.set("jscname",n);i=n}else{this.errorModel.unset("jscname")}t=this.get("jscstart");if(d.isUndefined(t)||d.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){n=s("Please enter the start time.");if(t==""){this.set("jscstart",undefined)}this.errorModel.set("jscstart",n);i=i||n}else{this.errorModel.unset("jscstart")}if(!i){t=this.get("jscend");if(d.isUndefined(t)||d.isNull(t)||String(t).replace(/^\s+|\s+$/g,"")==""){if(t==""){this.set("jscend",undefined)}return}var a=this.get("jscstart"),r=this.get("jscend"),l=a.split(" "),o=r.split(" ");l=c(l[0]+" "+l[1]);o=c(o[0]+" "+o[1]);if(o.isBefore(l)){i=s("Start time must be less than end time");this.errorModel.set("jscstart",i)}}return i}})})}return a.Nodes["pga_schedule"]}.apply(t,n),a!==undefined&&(e.exports=a))},function(e,t,i){"use strict";i(322)},function(e,t,i){"use strict";i(323)},function(e,t,i){"use strict";i(324);i(85)},function(e,t,i){"use strict";i(325)},function(e,t,i){"use strict";var n=l(i(5));var a=l(i(2));var r=i(326);function l(e){return e&&e.__esModule?e:{default:e}}var o=(0,r.initialize)(n.default,a.default);e.exports={pgBrowser:o}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initialize=n;function n(e,t){if(!e.Nodes["coll-external_table"]){e.Nodes["coll-external_table"]=e.Collection.extend({node:"external_table",label:t("External Tables"),type:"coll-external_tables",columns:["name","fdwowner","description"]})}if(!e.Nodes["external_table"]){e.Nodes["external_table"]=e.Node.extend({parent_type:"database",type:"external_table",label:t("External Table"),collection_type:"coll-external_table",hasSQL:true,model:e.Node.Model.extend({defaults:{name:undefined,type:undefined,encoding:undefined,format_type:undefined,format_option:undefined,external_options:undefined,command:undefined,execute_on:undefined},schema:[{id:"name",label:t("Name"),type:"text",mode:["properties"]},{id:"type",label:t("Type"),type:"text",mode:["properties"]},{id:"encoding",label:t("Encoding"),type:"text",mode:["properties"]},{id:"format_type",label:t("Format Type"),type:"text",mode:["properties"]},{id:"format_option",label:t("Format Optionos"),type:"text",mode:["properties"]},{id:"external_options",label:t("External Options"),type:"text",mode:["properties"]},{id:"command",label:t("Command"),type:"text",mode:["properties"]},{id:"execute_on",label:t("Execute on"),type:"text",mode:["properties"]}]})})}return e}}])["default"]});